(self.webpackChunklearnAngular=self.webpackChunklearnAngular||[]).push([[179],{2011:(rt,Ee,L)=>{"use strict";L.d(Ee,{hO:()=>Be,xv:()=>ue,Dh:()=>ae,GT:()=>he,cc:()=>Ie,on:()=>H,pX:()=>ie});var m=L(5e3),J=L(127),F=L(5813);rt=L.hmd(rt);const oe=["ngOnDestroy"],ie=(re,ge,be,me={})=>new Proxy(re,{get:(Ve,Te)=>be.runOutsideAngular(()=>{var Je;if(re[Te])return(null===(Je=null==me?void 0:me.spy)||void 0===Je?void 0:Je.get)&&me.spy.get(Te,re[Te]),re[Te];if(oe.indexOf(Te)>-1)return()=>{};const Ge=ge.toPromise().then(ht=>{const X=ht&&ht[Te];return"function"==typeof X?X.bind(ht):X&&X.then?X.then(pe=>be.run(()=>pe)):be.run(()=>X)});return new Proxy(()=>{},{get:(ht,X)=>Ge[X],apply:(ht,X,pe)=>Ge.then(_e=>{var we;const Me=_e&&_e(...pe);return(null===(we=null==me?void 0:me.spy)||void 0===we?void 0:we.apply)&&me.spy.apply(Te,pe,Me),Me})})})}),he=(re,ge)=>{ge.forEach(be=>{Object.getOwnPropertyNames(be.prototype||be).forEach(me=>{Object.defineProperty(re.prototype,me,Object.getOwnPropertyDescriptor(be.prototype||be,me))})})};class se{constructor(ge){return ge}}const ae=new m.OlP("angularfire2.app.options"),ue=new m.OlP("angularfire2.app.name");function H(re,ge,be){const Ve="object"==typeof be&&be||{};Ve.name=Ve.name||"string"==typeof be&&be||"[DEFAULT]";const Je=J.Z.apps.filter(Ge=>Ge&&Ge.name===Ve.name)[0]||ge.runOutsideAngular(()=>J.Z.initializeApp(re,Ve));try{JSON.stringify(re)!==JSON.stringify(Je.options)&&q("error",`${Je.name} Firebase App already initialized with different options${rt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(Ge){}return new se(Je)}const q=(re,...ge)=>{(0,m.X6Q)()&&"undefined"!=typeof console&&console[re](...ge)},ee={provide:se,useFactory:H,deps:[ae,m.R0b,[new m.FiY,ue]]};let Be=(()=>{class re{constructor(be){J.Z.registerVersion("angularfire",F.q4.full,"core"),J.Z.registerVersion("angularfire",F.q4.full,"app-compat"),J.Z.registerVersion("angular",m.q4F.full,be.toString())}static initializeApp(be,me){return{ngModule:re,providers:[{provide:ae,useValue:be},{provide:ue,useValue:me}]}}}return re.\u0275fac=function(be){return new(be||re)(m.LFG(m.Lbi))},re.\u0275mod=m.oAB({type:re}),re.\u0275inj=m.cJS({providers:[ee]}),re})();function Ie(re,ge,be,me,Ve){const[,Te,Je]=globalThis.\u0275AngularfireInstanceCache.find(Ge=>Ge[0]===re)||[];if(Te)return function ke(re,ge){try{return re.toString()===ge.toString()}catch(be){return re===ge}}(Ve,Je)||(K("error",`${ge} was already initialized on the ${be} Firebase App with different settings.${Fe?" You may need to reload as Firebase is not HMR aware.":""}`),K("warn",{is:Ve,was:Je})),Te;{const Ge=me();return globalThis.\u0275AngularfireInstanceCache.push([re,Ge,Ve]),Ge}}const Fe=!!rt.hot,K=(re,...ge)=>{(0,m.X6Q)()&&"undefined"!=typeof console&&console[re](...ge)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(rt,Ee,L)=>{"use strict";L.d(Ee,{q4:()=>If,iC:()=>Jo,fc:()=>ec,HU:()=>Uu,vb:()=>Tf,JM:()=>wd});var m=L(5e3),J=L(5867),F=L(5861),oe=L(9681),ie=L(2090),he=L(4859),se=L(1877),ae=L(2940);const ue="@firebase/installations",H="0.5.5",ee=`w:${H}`,Be="FIS_v2",ge=new ie.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function be(T){return T instanceof ie.ZR&&T.code.includes("request-failed")}function me({projectId:T}){return`https://firebaseinstallations.googleapis.com/v1/projects/${T}/installations`}function Ve(T){return{token:T.token,requestStatus:2,expiresIn:_e(T.expiresIn),creationTime:Date.now()}}function Te(T,C){return Je.apply(this,arguments)}function Je(){return(Je=(0,F.Z)(function*(T,C){const B=(yield C.json()).error;return ge.create("request-failed",{requestName:T,serverCode:B.code,serverMessage:B.message,serverStatus:B.status})})).apply(this,arguments)}function Ge({apiKey:T}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":T})}function ht(T,{refreshToken:C}){const k=Ge(T);return k.append("Authorization",function we(T){return`${Be} ${T}`}(C)),k}function X(T){return pe.apply(this,arguments)}function pe(){return(pe=(0,F.Z)(function*(T){const C=yield T();return C.status>=500&&C.status<600?T():C})).apply(this,arguments)}function _e(T){return Number(T.replace("s","000"))}function Me(T,C){return de.apply(this,arguments)}function de(){return(de=(0,F.Z)(function*(T,{fid:C}){const k=me(T),Q={method:"POST",headers:Ge(T),body:JSON.stringify({fid:C,authVersion:Be,appId:T.appId,sdkVersion:ee})},Se=yield X(()=>fetch(k,Q));if(Se.ok){const ze=yield Se.json();return{fid:ze.fid||C,registrationStatus:2,refreshToken:ze.refreshToken,authToken:Ve(ze.authToken)}}throw yield Te("Create Installation",Se)})).apply(this,arguments)}function Dt(T){return new Promise(C=>{setTimeout(C,T)})}const jn=/^[cdef][\w-]{21}$/;function nt(){try{const T=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(T),T[0]=112+T[0]%16;const k=function Lr(T){return function Ft(T){return btoa(String.fromCharCode(...T)).replace(/\+/g,"-").replace(/\//g,"_")}(T).substr(0,22)}(T);return jn.test(k)?k:""}catch(T){return""}}function en(T){return`${T.appName}!${T.appId}`}const Dr=new Map;function Zt(T,C){const k=en(T);Dn(k,C),function Ci(T,C){const k=function gn(){return!Ut&&"BroadcastChannel"in self&&(Ut=new BroadcastChannel("[Firebase] FID Change"),Ut.onmessage=T=>{Dn(T.data.key,T.data.fid)}),Ut}();k&&k.postMessage({key:T,fid:C}),function lo(){0===Dr.size&&Ut&&(Ut.close(),Ut=null)}()}(k,C)}function Dn(T,C){const k=Dr.get(T);if(k)for(const B of k)B(C)}let Ut=null;const Ae="firebase-installations-store";let pr=null;function Xe(){return pr||(pr=(0,ae.openDb)("firebase-installations-database",1,T=>{0===T.oldVersion&&T.createObjectStore(Ae)})),pr}function hi(T,C){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,F.Z)(function*(T,C){const k=en(T),Z=(yield Xe()).transaction(Ae,"readwrite"),Q=Z.objectStore(Ae),Se=yield Q.get(k);return yield Q.put(C,k),yield Z.complete,(!Se||Se.fid!==C.fid)&&Zt(T,C.fid),C})).apply(this,arguments)}function $n(T){return Fs.apply(this,arguments)}function Fs(){return(Fs=(0,F.Z)(function*(T){const C=en(T),B=(yield Xe()).transaction(Ae,"readwrite");yield B.objectStore(Ae).delete(C),yield B.complete})).apply(this,arguments)}function dt(T,C){return tt.apply(this,arguments)}function tt(){return(tt=(0,F.Z)(function*(T,C){const k=en(T),Z=(yield Xe()).transaction(Ae,"readwrite"),Q=Z.objectStore(Ae),Se=yield Q.get(k),ze=C(Se);return void 0===ze?yield Q.delete(k):yield Q.put(ze,k),yield Z.complete,ze&&(!Se||Se.fid!==ze.fid)&&Zt(T,ze.fid),ze})).apply(this,arguments)}function St(T){return ln.apply(this,arguments)}function ln(){return(ln=(0,F.Z)(function*(T){let C;const k=yield dt(T,B=>{const Z=Fr(B),Q=At(T,Z);return C=Q.registrationPromise,Q.installationEntry});return""===k.fid?{installationEntry:yield C}:{installationEntry:k,registrationPromise:C}})).apply(this,arguments)}function Fr(T){return mn(T||{fid:nt(),registrationStatus:0})}function At(T,C){if(0===C.registrationStatus){if(!navigator.onLine)return{installationEntry:C,registrationPromise:Promise.reject(ge.create("app-offline"))};const k={fid:C.fid,registrationStatus:1,registrationTime:Date.now()},B=function et(T,C){return ut.apply(this,arguments)}(T,k);return{installationEntry:k,registrationPromise:B}}return 1===C.registrationStatus?{installationEntry:C,registrationPromise:xl(T)}:{installationEntry:C}}function ut(){return(ut=(0,F.Z)(function*(T,C){try{return hi(T,yield Me(T,C))}catch(k){throw be(k)&&409===k.customData.serverCode?yield $n(T):yield hi(T,{fid:C.fid,registrationStatus:0}),k}})).apply(this,arguments)}function xl(T){return co.apply(this,arguments)}function co(){return(co=(0,F.Z)(function*(T){let C=yield ft(T);for(;1===C.registrationStatus;)yield Dt(100),C=yield ft(T);if(0===C.registrationStatus){const{installationEntry:k,registrationPromise:B}=yield St(T);return B||k}return C})).apply(this,arguments)}function ft(T){return dt(T,C=>{if(!C)throw ge.create("installation-not-found");return mn(C)})}function mn(T){return function Ur(T){return 1===T.registrationStatus&&T.registrationTime+1e4<Date.now()}(T)?{fid:T.fid,registrationStatus:0}:T}function ps(T,C){return j.apply(this,arguments)}function j(){return(j=(0,F.Z)(function*({appConfig:T,platformLoggerProvider:C},k){const B=W(T,k),Z=ht(T,k),Q=C.getImmediate({optional:!0});Q&&Z.append("x-firebase-client",Q.getPlatformInfoString());const ze={method:"POST",headers:Z,body:JSON.stringify({installation:{sdkVersion:ee}})},je=yield X(()=>fetch(B,ze));if(je.ok)return Ve(yield je.json());throw yield Te("Generate Auth Token",je)})).apply(this,arguments)}function W(T,{fid:C}){return`${me(T)}/${C}/authTokens:generate`}function G(T){return ve.apply(this,arguments)}function ve(){return(ve=(0,F.Z)(function*(T,C=!1){let k;const B=yield dt(T.appConfig,Q=>{if(!Sn(Q))throw ge.create("not-registered");const Se=Q.authToken;if(!C&&Br(Se))return Q;if(1===Se.requestStatus)return k=te(T,C),Q;{if(!navigator.onLine)throw ge.create("app-offline");const ze=gr(Q);return k=cn(T,ze),ze}});return k?yield k:B.authToken})).apply(this,arguments)}function te(T,C){return $e.apply(this,arguments)}function $e(){return($e=(0,F.Z)(function*(T,C){let k=yield yt(T.appConfig);for(;1===k.authToken.requestStatus;)yield Dt(100),k=yield yt(T.appConfig);const B=k.authToken;return 0===B.requestStatus?G(T,C):B})).apply(this,arguments)}function yt(T){return dt(T,C=>{if(!Sn(C))throw ge.create("not-registered");return function Us(T){return 1===T.requestStatus&&T.requestTime+1e4<Date.now()}(C.authToken)?Object.assign(Object.assign({},C),{authToken:{requestStatus:0}}):C})}function cn(T,C){return Hn.apply(this,arguments)}function Hn(){return(Hn=(0,F.Z)(function*(T,C){try{const k=yield ps(T,C),B=Object.assign(Object.assign({},C),{authToken:k});return yield hi(T.appConfig,B),k}catch(k){if(!be(k)||401!==k.customData.serverCode&&404!==k.customData.serverCode){const B=Object.assign(Object.assign({},C),{authToken:{requestStatus:0}});yield hi(T.appConfig,B)}else yield $n(T.appConfig);throw k}})).apply(this,arguments)}function Sn(T){return void 0!==T&&2===T.registrationStatus}function Br(T){return 2===T.requestStatus&&!function Mt(T){const C=Date.now();return C<T.creationTime||T.creationTime+T.expiresIn<C+36e5}(T)}function gr(T){const C={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},T),{authToken:C})}function Po(){return(Po=(0,F.Z)(function*(T){const C=T,{installationEntry:k,registrationPromise:B}=yield St(C.appConfig);return B?B.catch(console.error):G(C).catch(console.error),k.fid})).apply(this,arguments)}function ho(){return(ho=(0,F.Z)(function*(T,C=!1){const k=T;return yield er(k.appConfig),(yield G(k,C)).token})).apply(this,arguments)}function er(T){return qn.apply(this,arguments)}function qn(){return(qn=(0,F.Z)(function*(T){const{registrationPromise:C}=yield St(T);C&&(yield C)})).apply(this,arguments)}function ma(T){return ge.create("missing-app-config-values",{valueName:T})}const Yr="installations",Rt=T=>{const C=T.getProvider("app").getImmediate(),k=function Wn(T){if(!T||!T.options)throw ma("App Configuration");if(!T.name)throw ma("App Name");const C=["projectId","apiKey","appId"];for(const k of C)if(!T.options[k])throw ma(k);return{appName:T.name,projectId:T.options.projectId,apiKey:T.options.apiKey,appId:T.options.appId}}(C);return{app:C,appConfig:k,platformLoggerProvider:(0,oe._getProvider)(C,"platform-logger"),_delete:()=>Promise.resolve()}},qt=T=>{const C=T.getProvider("app").getImmediate(),k=(0,oe._getProvider)(C,Yr).getImmediate();return{getId:()=>function Pl(T){return Po.apply(this,arguments)}(k),getToken:Z=>function Eu(T){return ho.apply(this,arguments)}(k,Z)}};(function An(){(0,oe._registerComponent)(new he.wA(Yr,Rt,"PUBLIC")),(0,oe._registerComponent)(new he.wA("installations-internal",qt,"PRIVATE"))})(),(0,oe.registerVersion)(ue,H),(0,oe.registerVersion)(ue,H,"esm2017");const Sr="@firebase/remote-config",Rn=new ie.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Ag{constructor(C,k,B,Z){this.client=C,this.storage=k,this.storageCache=B,this.logger=Z}isCachedDataFresh(C,k){if(!k)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const B=Date.now()-k,Z=B<=C;return this.logger.debug(`Config fetch cache check. Cache age millis: ${B}. Cache max age millis (minimumFetchIntervalMillis setting): ${C}. Is cache hit: ${Z}.`),Z}fetch(C){var k=this;return(0,F.Z)(function*(){const[B,Z]=yield Promise.all([k.storage.getLastSuccessfulFetchTimestampMillis(),k.storage.getLastSuccessfulFetchResponse()]);if(Z&&k.isCachedDataFresh(C.cacheMaxAgeMillis,B))return Z;C.eTag=Z&&Z.eTag;const Q=yield k.client.fetch(C),Se=[k.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Q.status&&Se.push(k.storage.setLastSuccessfulFetchResponse(Q)),yield Promise.all(Se),Q})()}}function af(T=navigator){return T.languages&&T.languages[0]||T.language}class xi{constructor(C,k,B,Z,Q,Se){this.firebaseInstallations=C,this.sdkVersion=k,this.namespace=B,this.projectId=Z,this.apiKey=Q,this.appId=Se}fetch(C){var k=this;return(0,F.Z)(function*(){const[B,Z]=yield Promise.all([k.firebaseInstallations.getId(),k.firebaseInstallations.getToken()]),Se=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${k.projectId}/namespaces/${k.namespace}:fetch?key=${k.apiKey}`,ze={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":C.eTag||"*"},je={sdk_version:k.sdkVersion,app_instance_id:B,app_instance_id_token:Z,app_id:k.appId,language_code:af()},Bt={method:"POST",headers:ze,body:JSON.stringify(je)},Kt=fetch(Se,Bt),Gr=new Promise(($i,ss)=>{C.signal.addEventListener(()=>{const Qs=new Error("The operation was aborted.");Qs.name="AbortError",ss(Qs)})});let Yn;try{yield Promise.race([Kt,Gr]),Yn=yield Kt}catch($i){let ss="fetch-client-network";throw"AbortError"===$i.name&&(ss="fetch-timeout"),Rn.create(ss,{originalErrorMessage:$i.message})}let on=Yn.status;const Vi=Yn.headers.get("ETag")||void 0;let ji,Ys;if(200===Yn.status){let $i;try{$i=yield Yn.json()}catch(ss){throw Rn.create("fetch-client-parse",{originalErrorMessage:ss.message})}ji=$i.entries,Ys=$i.state}if("INSTANCE_STATE_UNSPECIFIED"===Ys?on=500:"NO_CHANGE"===Ys?on=304:("NO_TEMPLATE"===Ys||"EMPTY_CONFIG"===Ys)&&(ji={}),304!==on&&200!==on)throw Rn.create("fetch-status",{httpStatus:on});return{status:on,eTag:Vi,config:ji}})()}}class Qc{constructor(C,k){this.client=C,this.storage=k}fetch(C){var k=this;return(0,F.Z)(function*(){const B=(yield k.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return k.attemptFetch(C,B)})()}attemptFetch(C,{throttleEndTimeMillis:k,backoffCount:B}){var Z=this;return(0,F.Z)(function*(){yield function ya(T,C){return new Promise((k,B)=>{const Z=Math.max(C-Date.now(),0),Q=setTimeout(k,Z);T.addEventListener(()=>{clearTimeout(Q),B(Rn.create("fetch-throttle",{throttleEndTimeMillis:C}))})})}(C.signal,k);try{const Q=yield Z.client.fetch(C);return yield Z.storage.deleteThrottleMetadata(),Q}catch(Q){if(!function uf(T){if(!(T instanceof ie.ZR&&T.customData))return!1;const C=Number(T.customData.httpStatus);return 429===C||500===C||503===C||504===C}(Q))throw Q;const Se={throttleEndTimeMillis:Date.now()+(0,ie.$s)(B),backoffCount:B+1};return yield Z.storage.setThrottleMetadata(Se),Z.attemptFetch(C,Se)}})()}}class Rg{constructor(C,k,B,Z,Q){this.app=C,this._client=k,this._storageCache=B,this._storage=Z,this._logger=Q,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function va(T,C){const k=T.target.error||void 0;return Rn.create(C,{originalErrorMessage:k&&k.message})}const Oo="app_namespace_store";class xg{constructor(C,k,B,Z=function Xc(){return new Promise((T,C)=>{try{const k=indexedDB.open("firebase_remote_config",1);k.onerror=B=>{C(va(B,"storage-open"))},k.onsuccess=B=>{T(B.target.result)},k.onupgradeneeded=B=>{0===B.oldVersion&&B.target.result.createObjectStore(Oo,{keyPath:"compositeKey"})}}catch(k){C(Rn.create("storage-open",{originalErrorMessage:k}))}})}()){this.appId=C,this.appName=k,this.namespace=B,this.openDbPromise=Z}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(C){return this.set("last_fetch_status",C)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(C){return this.set("last_successful_fetch_timestamp_millis",C)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(C){return this.set("last_successful_fetch_response",C)}getActiveConfig(){return this.get("active_config")}setActiveConfig(C){return this.set("active_config",C)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(C){return this.set("active_config_etag",C)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(C){return this.set("throttle_metadata",C)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(C){var k=this;return(0,F.Z)(function*(){const B=yield k.openDbPromise;return new Promise((Z,Q)=>{const ze=B.transaction([Oo],"readonly").objectStore(Oo),je=k.createCompositeKey(C);try{const Bt=ze.get(je);Bt.onerror=Kt=>{Q(va(Kt,"storage-get"))},Bt.onsuccess=Kt=>{const Gr=Kt.target.result;Z(Gr?Gr.value:void 0)}}catch(Bt){Q(Rn.create("storage-get",{originalErrorMessage:Bt&&Bt.message}))}})})()}set(C,k){var B=this;return(0,F.Z)(function*(){const Z=yield B.openDbPromise;return new Promise((Q,Se)=>{const je=Z.transaction([Oo],"readwrite").objectStore(Oo),Bt=B.createCompositeKey(C);try{const Kt=je.put({compositeKey:Bt,value:k});Kt.onerror=Gr=>{Se(va(Gr,"storage-set"))},Kt.onsuccess=()=>{Q()}}catch(Kt){Se(Rn.create("storage-set",{originalErrorMessage:Kt&&Kt.message}))}})})()}delete(C){var k=this;return(0,F.Z)(function*(){const B=yield k.openDbPromise;return new Promise((Z,Q)=>{const ze=B.transaction([Oo],"readwrite").objectStore(Oo),je=k.createCompositeKey(C);try{const Bt=ze.delete(je);Bt.onerror=Kt=>{Q(va(Kt,"storage-delete"))},Bt.onsuccess=()=>{Z()}}catch(Bt){Q(Rn.create("storage-delete",{originalErrorMessage:Bt&&Bt.message}))}})})()}createCompositeKey(C){return[this.appId,this.appName,this.namespace,C].join()}}class ed{constructor(C){this.storage=C}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var C=this;return(0,F.Z)(function*(){const k=C.storage.getLastFetchStatus(),B=C.storage.getLastSuccessfulFetchTimestampMillis(),Z=C.storage.getActiveConfig(),Q=yield k;Q&&(C.lastFetchStatus=Q);const Se=yield B;Se&&(C.lastSuccessfulFetchTimestampMillis=Se);const ze=yield Z;ze&&(C.activeConfig=ze)})()}setLastFetchStatus(C){return this.lastFetchStatus=C,this.storage.setLastFetchStatus(C)}setLastSuccessfulFetchTimestampMillis(C){return this.lastSuccessfulFetchTimestampMillis=C,this.storage.setLastSuccessfulFetchTimestampMillis(C)}setActiveConfig(C){return this.activeConfig=C,this.storage.setActiveConfig(C)}}function td(){return Ll.apply(this,arguments)}function Ll(){return(Ll=(0,F.Z)(function*(){if(!(0,ie.hl)())return!1;try{return yield(0,ie.eu)()}catch(T){return!1}})).apply(this,arguments)}!function Pg(){(0,oe._registerComponent)(new he.wA("remote-config",function T(C,{instanceIdentifier:k}){const B=C.getProvider("app").getImmediate(),Z=C.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw Rn.create("registration-window");if(!(0,ie.hl)())throw Rn.create("indexed-db-unavailable");const{projectId:Q,apiKey:Se,appId:ze}=B.options;if(!Q)throw Rn.create("registration-project-id");if(!Se)throw Rn.create("registration-api-key");if(!ze)throw Rn.create("registration-app-id");const je=new xg(ze,B.name,k=k||"firebase"),Bt=new ed(je),Kt=new se.Yd(Sr);Kt.logLevel=se.in.ERROR;const Gr=new xi(Z,oe.SDK_VERSION,k,Q,Se,ze),Yn=new Qc(Gr,je),on=new Ag(Yn,je,Bt,Kt),Vi=new Rg(B,on,Bt,je,Kt);return function tn(T){const C=(0,ie.m9)(T);C._initializePromise||(C._initializePromise=C._storageCache.loadFromStorage().then(()=>{C._isInitializationComplete=!0}))}(Vi),Vi},"PUBLIC").setMultipleInstances(!0)),(0,oe.registerVersion)(Sr,"0.3.4"),(0,oe.registerVersion)(Sr,"0.3.4","esm2017")}();const nd="/firebase-messaging-sw.js",mo="/firebase-cloud-messaging-push-scope",Iu="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",_o="google.c.a.c_id",Ia="google.c.a.c_l",Vs="google.c.a.ts",bu="google.c.a.e";var Ar=(()=>{return(T=Ar||(Ar={})).PUSH_RECEIVED="push-received",T.NOTIFICATION_CLICKED="notification-clicked",Ar;var T})();function Pi(T){const C=new Uint8Array(T);return btoa(String.fromCharCode(...C)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Fl(T){const k=(T+"=".repeat((4-T.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),B=atob(k),Z=new Uint8Array(B.length);for(let Q=0;Q<B.length;++Q)Z[Q]=B.charCodeAt(Q);return Z}const Qr="fcm_token_details_db",id="fcm_token_object_Store";function Tu(T){return sd.apply(this,arguments)}function sd(){return sd=(0,F.Z)(function*(T){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Q=>Q.name).includes(Qr))return null;let C=null;return(yield(0,ae.openDb)(Qr,5,function(){var B=(0,F.Z)(function*(Z){var Q;if(Z.oldVersion<2||!Z.objectStoreNames.contains(id))return;const Se=Z.transaction.objectStore(id),ze=yield Se.index("fcmSenderId").get(T);if(yield Se.clear(),ze)if(2===Z.oldVersion){const je=ze;if(!je.auth||!je.p256dh||!je.endpoint)return;C={token:je.fcmToken,createTime:null!==(Q=je.createTime)&&void 0!==Q?Q:Date.now(),subscriptionOptions:{auth:je.auth,p256dh:je.p256dh,endpoint:je.endpoint,swScope:je.swScope,vapidKey:"string"==typeof je.vapidKey?je.vapidKey:Pi(je.vapidKey)}}}else if(3===Z.oldVersion){const je=ze;C={token:je.fcmToken,createTime:je.createTime,subscriptionOptions:{auth:Pi(je.auth),p256dh:Pi(je.p256dh),endpoint:je.endpoint,swScope:je.swScope,vapidKey:Pi(je.vapidKey)}}}else if(4===Z.oldVersion){const je=ze;C={token:je.fcmToken,createTime:je.createTime,subscriptionOptions:{auth:Pi(je.auth),p256dh:Pi(je.p256dh),endpoint:je.endpoint,swScope:je.swScope,vapidKey:Pi(je.vapidKey)}}}});return function(Z){return B.apply(this,arguments)}}())).close(),yield(0,ae.deleteDb)(Qr),yield(0,ae.deleteDb)("fcm_vapid_details_db"),yield(0,ae.deleteDb)("undefined"),Ul(C)?C:null}),sd.apply(this,arguments)}function Ul(T){if(!T||!T.subscriptionOptions)return!1;const{subscriptionOptions:C}=T;return"number"==typeof T.createTime&&T.createTime>0&&"string"==typeof T.token&&T.token.length>0&&"string"==typeof C.auth&&C.auth.length>0&&"string"==typeof C.p256dh&&C.p256dh.length>0&&"string"==typeof C.endpoint&&C.endpoint.length>0&&"string"==typeof C.swScope&&C.swScope.length>0&&"string"==typeof C.vapidKey&&C.vapidKey.length>0}const js="firebase-messaging-store";let ad=null;function nn(){return ad||(ad=(0,ae.openDb)("firebase-messaging-database",1,T=>{0===T.oldVersion&&T.createObjectStore(js)})),ad}function cf(T){return Lo.apply(this,arguments)}function Lo(){return(Lo=(0,F.Z)(function*(T){const C=es(T),B=yield(yield nn()).transaction(js).objectStore(js).get(C);if(B)return B;{const Z=yield Tu(T.appConfig.senderId);if(Z)return yield Zn(T,Z),Z}})).apply(this,arguments)}function Zn(T,C){return Fn.apply(this,arguments)}function Fn(){return(Fn=(0,F.Z)(function*(T,C){const k=es(T),Z=(yield nn()).transaction(js,"readwrite");return yield Z.objectStore(js).put(C,k),yield Z.complete,C})).apply(this,arguments)}function ms(T){return Fo.apply(this,arguments)}function Fo(){return(Fo=(0,F.Z)(function*(T){const C=es(T),B=(yield nn()).transaction(js,"readwrite");yield B.objectStore(js).delete(C),yield B.complete})).apply(this,arguments)}function es({appConfig:T}){return T.appId}const zn=new ie.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function ts(T,C){return Bl.apply(this,arguments)}function Bl(){return(Bl=(0,F.Z)(function*(T,C){const k=yield Ta(T),B=Bo(C),Z={method:"POST",headers:k,body:JSON.stringify(B)};let Q;try{Q=yield(yield fetch(rr(T.appConfig),Z)).json()}catch(Se){throw zn.create("token-subscribe-failed",{errorInfo:Se})}if(Q.error)throw zn.create("token-subscribe-failed",{errorInfo:Q.error.message});if(!Q.token)throw zn.create("token-subscribe-no-token");return Q.token})).apply(this,arguments)}function Hr(T,C){return $s.apply(this,arguments)}function $s(){return($s=(0,F.Z)(function*(T,C){const k=yield Ta(T),B=Bo(C.subscriptionOptions),Z={method:"PATCH",headers:k,body:JSON.stringify(B)};let Q;try{Q=yield(yield fetch(`${rr(T.appConfig)}/${C.token}`,Z)).json()}catch(Se){throw zn.create("token-update-failed",{errorInfo:Se})}if(Q.error)throw zn.create("token-update-failed",{errorInfo:Q.error.message});if(!Q.token)throw zn.create("token-update-no-token");return Q.token})).apply(this,arguments)}function Uo(T,C){return pt.apply(this,arguments)}function pt(){return(pt=(0,F.Z)(function*(T,C){const B={method:"DELETE",headers:yield Ta(T)};try{const Q=yield(yield fetch(`${rr(T.appConfig)}/${C}`,B)).json();if(Q.error)throw zn.create("token-unsubscribe-failed",{errorInfo:Q.error.message})}catch(Z){throw zn.create("token-unsubscribe-failed",{errorInfo:Z})}})).apply(this,arguments)}function rr({projectId:T}){return`https://fcmregistrations.googleapis.com/v1/projects/${T}/registrations`}function Ta(T){return Ca.apply(this,arguments)}function Ca(){return(Ca=(0,F.Z)(function*({appConfig:T,installations:C}){const k=yield C.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":T.apiKey,"x-goog-firebase-installations-auth":`FIS ${k}`})})).apply(this,arguments)}function Bo({p256dh:T,auth:C,endpoint:k,vapidKey:B}){const Z={web:{endpoint:k,auth:C,p256dh:T}};return B!==Iu&&(Z.web.applicationPubKey=B),Z}const Vo=6048e5;function Vl(T){return Cu.apply(this,arguments)}function Cu(){return(Cu=(0,F.Z)(function*(T){const C=yield Jr(T.swRegistration,T.vapidKey),k={vapidKey:T.vapidKey,swScope:T.swRegistration.scope,endpoint:C.endpoint,auth:Pi(C.getKey("auth")),p256dh:Pi(C.getKey("p256dh"))},B=yield cf(T.firebaseDependencies);if(B){if(Su(B.subscriptionOptions,k))return Date.now()>=B.createTime+Vo?Du(T,{token:B.token,createTime:Date.now(),subscriptionOptions:k}):B.token;try{yield Uo(T.firebaseDependencies,B.token)}catch(Z){console.warn(Z)}return yo(T.firebaseDependencies,k)}return yo(T.firebaseDependencies,k)})).apply(this,arguments)}function De(T){return Pt.apply(this,arguments)}function Pt(){return(Pt=(0,F.Z)(function*(T){const C=yield cf(T.firebaseDependencies);C&&(yield Uo(T.firebaseDependencies,C.token),yield ms(T.firebaseDependencies));const k=yield T.swRegistration.pushManager.getSubscription();return!k||k.unsubscribe()})).apply(this,arguments)}function Du(T,C){return rn.apply(this,arguments)}function rn(){return(rn=(0,F.Z)(function*(T,C){try{const k=yield Hr(T.firebaseDependencies,C),B=Object.assign(Object.assign({},C),{token:k,createTime:Date.now()});return yield Zn(T.firebaseDependencies,B),k}catch(k){throw yield De(T),k}})).apply(this,arguments)}function yo(T,C){return Hs.apply(this,arguments)}function Hs(){return(Hs=(0,F.Z)(function*(T,C){const B={token:yield ts(T,C),createTime:Date.now(),subscriptionOptions:C};return yield Zn(T,B),B.token})).apply(this,arguments)}function Jr(T,C){return _s.apply(this,arguments)}function _s(){return(_s=(0,F.Z)(function*(T,C){return(yield T.pushManager.getSubscription())||T.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Fl(C)})})).apply(this,arguments)}function Su(T,C){return C.vapidKey===T.vapidKey&&C.endpoint===T.endpoint&&C.auth===T.auth&&C.p256dh===T.p256dh}function Au(T){const C={from:T.from,collapseKey:T.collapse_key,messageId:T.fcmMessageId};return function Ru(T,C){if(!C.notification)return;T.notification={};const k=C.notification.title;k&&(T.notification.title=k);const B=C.notification.body;B&&(T.notification.body=B);const Z=C.notification.image;Z&&(T.notification.image=Z)}(C,T),function jo(T,C){!C.data||(T.data=C.data)}(C,T),function Da(T,C){if(!C.fcmOptions)return;T.fcmOptions={};const k=C.fcmOptions.link;k&&(T.fcmOptions.link=k);const B=C.fcmOptions.analytics_label;B&&(T.fcmOptions.analyticsLabel=B)}(C,T),C}function Kn(T){return"object"==typeof T&&!!T&&_o in T}function ki(T,C){const k=[];for(let B=0;B<T.length;B++)k.push(T.charAt(B)),B<C.length&&k.push(C.charAt(B));return k.join("")}function ys(T){return zn.create("missing-app-config-values",{valueName:T})}ki("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),ki("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Mi{constructor(C,k,B){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Z=function xu(T){if(!T||!T.options)throw ys("App Configuration Object");if(!T.name)throw ys("App Name");const C=["projectId","apiKey","appId","messagingSenderId"],{options:k}=T;for(const B of C)if(!k[B])throw ys(B);return{appName:T.name,projectId:k.projectId,apiKey:k.apiKey,appId:k.appId,senderId:k.messagingSenderId}}(C);this.firebaseDependencies={app:C,appConfig:Z,installations:k,analyticsProvider:B}}_delete(){return Promise.resolve()}}function ud(T){return $o.apply(this,arguments)}function $o(){return($o=(0,F.Z)(function*(T){try{T.swRegistration=yield navigator.serviceWorker.register(nd,{scope:mo}),T.swRegistration.update().catch(()=>{})}catch(C){throw zn.create("failed-service-worker-registration",{browserErrorMessage:C.message})}})).apply(this,arguments)}function Pu(T,C){return Sa.apply(this,arguments)}function Sa(){return(Sa=(0,F.Z)(function*(T,C){if(!C&&!T.swRegistration&&(yield ud(T)),C||!T.swRegistration){if(!(C instanceof ServiceWorkerRegistration))throw zn.create("invalid-sw-registration");T.swRegistration=C}})).apply(this,arguments)}function Ho(T,C){return Aa.apply(this,arguments)}function Aa(){return(Aa=(0,F.Z)(function*(T,C){C?T.vapidKey=C:T.vapidKey||(T.vapidKey=Iu)})).apply(this,arguments)}function xa(){return(xa=(0,F.Z)(function*(T,C){if(!navigator)throw zn.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw zn.create("permission-blocked");return yield Ho(T,null==C?void 0:C.vapidKey),yield Pu(T,null==C?void 0:C.serviceWorkerRegistration),Vl(T)})).apply(this,arguments)}function jl(T,C,k){return $l.apply(this,arguments)}function $l(){return($l=(0,F.Z)(function*(T,C,k){const B=qo(C);(yield T.firebaseDependencies.analyticsProvider.get()).logEvent(B,{message_id:k[_o],message_name:k[Ia],message_time:k[Vs],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function qo(T){switch(T){case Ar.NOTIFICATION_CLICKED:return"notification_open";case Ar.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Pa(){return(Pa=(0,F.Z)(function*(T,C){const k=C.data;if(!k.isFirebaseMessaging)return;T.onMessageHandler&&k.messageType===Ar.PUSH_RECEIVED&&("function"==typeof T.onMessageHandler?T.onMessageHandler(Au(k)):T.onMessageHandler.next(Au(k)));const B=k.data;Kn(B)&&"1"===B[bu]&&(yield jl(T,k.messageType,B))})).apply(this,arguments)}const Hl="@firebase/messaging",ku=T=>{const C=new Mi(T.getProvider("app").getImmediate(),T.getProvider("installations-internal").getImmediate(),T.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",k=>function ld(T,C){return Pa.apply(this,arguments)}(C,k)),C},cd=T=>{const C=T.getProvider("messaging").getImmediate();return{getToken:B=>function Ra(T,C){return xa.apply(this,arguments)}(C,B)}};function ir(){return Un.apply(this,arguments)}function Un(){return(Un=(0,F.Z)(function*(){return"undefined"!=typeof window&&(0,ie.hl)()&&(yield(0,ie.eu)())&&(0,ie.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function kg(){(0,oe._registerComponent)(new he.wA("messaging",ku,"PUBLIC")),(0,oe._registerComponent)(new he.wA("messaging-internal",cd,"PRIVATE")),(0,oe.registerVersion)(Hl,"0.9.7"),(0,oe.registerVersion)(Hl,"0.9.7","esm2017")}();const qs="analytics",Mu="firebase_id",hd="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",vs="https://www.googletagmanager.com/gtag/js",yn=new se.Yd("@firebase/analytics");function gf(T){return Promise.all(T.map(C=>C.catch(k=>k)))}function Mg(T,C){const k=document.createElement("script");k.src=`${vs}?l=${T}&id=${C}`,k.async=!0,document.head.appendChild(k)}function Ou(T,C,k,B,Z,Q){return fd.apply(this,arguments)}function fd(){return(fd=(0,F.Z)(function*(T,C,k,B,Z,Q){const Se=B[Z];try{if(Se)yield C[Se];else{const je=(yield gf(k)).find(Bt=>Bt.measurementId===Z);je&&(yield C[je.appId])}}catch(ze){yn.error(ze)}T("config",Z,Q)})).apply(this,arguments)}function Oa(T,C,k,B,Z){return pd.apply(this,arguments)}function pd(){return(pd=(0,F.Z)(function*(T,C,k,B,Z){try{let Q=[];if(Z&&Z.send_to){let Se=Z.send_to;Array.isArray(Se)||(Se=[Se]);const ze=yield gf(k);for(const je of Se){const Bt=ze.find(Gr=>Gr.measurementId===je),Kt=Bt&&C[Bt.appId];if(!Kt){Q=[];break}Q.push(Kt)}}0===Q.length&&(Q=Object.values(C)),yield Promise.all(Q),T("event",B,Z||{})}catch(Q){yn.error(Q)}})).apply(this,arguments)}function sn(){const T=window.document.getElementsByTagName("script");for(const C of Object.values(T))if(C.src&&C.src.includes(vs))return C;return null}const Ke=new ie.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),mf=new class sr{constructor(C={},k=1e3){this.throttleMetadata=C,this.intervalMillis=k}getThrottleMetadata(C){return this.throttleMetadata[C]}setThrottleMetadata(C,k){this.throttleMetadata[C]=k}deleteThrottleMetadata(C){delete this.throttleMetadata[C]}};function La(T){return new Headers({Accept:"application/json","x-goog-api-key":T})}function gd(T){return Fa.apply(this,arguments)}function Fa(){return(Fa=(0,F.Z)(function*(T){var C;const{appId:k,apiKey:B}=T,Z={method:"GET",headers:La(B)},Q=hd.replace("{app-id}",k),Se=yield fetch(Q,Z);if(200!==Se.status&&304!==Se.status){let ze="";try{const je=yield Se.json();(null===(C=je.error)||void 0===C?void 0:C.message)&&(ze=je.error.message)}catch(je){}throw Ke.create("config-fetch-failed",{httpStatus:Se.status,responseMessage:ze})}return Se.json()})).apply(this,arguments)}function md(T){return ns.apply(this,arguments)}function ns(){return(ns=(0,F.Z)(function*(T,C=mf,k){const{appId:B,apiKey:Z,measurementId:Q}=T.options;if(!B)throw Ke.create("no-app-id");if(!Z){if(Q)return{measurementId:Q,appId:B};throw Ke.create("no-api-key")}const Se=C.getThrottleMetadata(B)||{backoffCount:0,throttleEndTimeMillis:Date.now()},ze=new Zl;return setTimeout((0,F.Z)(function*(){ze.abort()}),void 0!==k?k:6e4),rs({appId:B,apiKey:Z,measurementId:Q},Se,ze,C)})).apply(this,arguments)}function rs(T,C,k){return vt.apply(this,arguments)}function vt(){return(vt=(0,F.Z)(function*(T,{throttleEndTimeMillis:C,backoffCount:k},B,Z=mf){const{appId:Q,measurementId:Se}=T;try{yield _f(B,C)}catch(ze){if(Se)return yn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Se} provided in the "measurementId" field in the local Firebase config. [${ze.message}]`),{appId:Q,measurementId:Se};throw ze}try{const ze=yield gd(T);return Z.deleteThrottleMetadata(Q),ze}catch(ze){if(!Ua(ze)){if(Z.deleteThrottleMetadata(Q),Se)return yn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Se} provided in the "measurementId" field in the local Firebase config. [${ze.message}]`),{appId:Q,measurementId:Se};throw ze}const je=503===Number(ze.customData.httpStatus)?(0,ie.$s)(k,Z.intervalMillis,30):(0,ie.$s)(k,Z.intervalMillis),Bt={throttleEndTimeMillis:Date.now()+je,backoffCount:k+1};return Z.setThrottleMetadata(Q,Bt),yn.debug(`Calling attemptFetch again in ${je} millis`),rs(T,Bt,B,Z)}})).apply(this,arguments)}function _f(T,C){return new Promise((k,B)=>{const Z=Math.max(C-Date.now(),0),Q=setTimeout(k,Z);T.addEventListener(()=>{clearTimeout(Q),B(Ke.create("fetch-throttle",{throttleEndTimeMillis:C}))})})}function Ua(T){if(!(T instanceof ie.ZR&&T.customData))return!1;const C=Number(T.customData.httpStatus);return 429===C||500===C||503===C||504===C}class Zl{constructor(){this.listeners=[]}addEventListener(C){this.listeners.push(C)}abort(){this.listeners.forEach(C=>C())}}function Ba(){return dn.apply(this,arguments)}function dn(){return(dn=(0,F.Z)(function*(){if(!(0,ie.hl)())return yn.warn(Ke.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ie.eu)()}catch(T){return yn.warn(Ke.create("indexeddb-unavailable",{errorInfo:T}).message),!1}return!0})).apply(this,arguments)}function Wo(){return(Wo=(0,F.Z)(function*(T,C,k,B,Z,Q,Se){var ze;const je=md(T);je.then(on=>{k[on.measurementId]=on.appId,T.options.measurementId&&on.measurementId!==T.options.measurementId&&yn.warn(`The measurement ID in the local Firebase config (${T.options.measurementId}) does not match the measurement ID fetched from the server (${on.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(on=>yn.error(on)),C.push(je);const Bt=Ba().then(on=>{if(on)return B.getId()}),[Kt,Gr]=yield Promise.all([je,Bt]);sn()||Mg(Q,Kt.measurementId),Z("js",new Date);const Yn=null!==(ze=null==Se?void 0:Se.config)&&void 0!==ze?ze:{};return Yn.origin="firebase",Yn.update=!0,null!=Gr&&(Yn[Mu]=Gr),Z("config",Kt.measurementId,Yn),Kt.measurementId})).apply(this,arguments)}class zl{constructor(C){this.app=C}_delete(){return delete Oi[this.app.options.appId],Promise.resolve()}}let Oi={},Kl=[];const Go={};let zo,Bn,Zo="dataLayer",Fu=!1;function En(T,C,k){!function vo(){const T=[];if((0,ie.ru)()&&T.push("This is a browser extension environment."),(0,ie.zI)()||T.push("Cookies are not available."),T.length>0){const C=T.map((B,Z)=>`(${Z+1}) ${B}`).join(" "),k=Ke.create("invalid-analytics-context",{errorInfo:C});yn.warn(k.message)}}();const B=T.options.appId;if(!B)throw Ke.create("no-app-id");if(!T.options.apiKey){if(!T.options.measurementId)throw Ke.create("no-api-key");yn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${T.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Oi[B])throw Ke.create("already-exists",{id:B});if(!Fu){!function Na(T){let C=[];Array.isArray(window[T])?C=window[T]:window[T]=C}(Zo);const{wrappedGtag:Q,gtagCore:Se}=function Gl(T,C,k,B,Z){let Q=function(...Se){window[B].push(arguments)};return window[Z]&&"function"==typeof window[Z]&&(Q=window[Z]),window[Z]=function Ng(T,C,k,B){function Q(){return(Q=(0,F.Z)(function*(Se,ze,je){try{"event"===Se?yield Oa(T,C,k,ze,je):"config"===Se?yield Ou(T,C,k,B,ze,je):T("set",ze)}catch(Bt){yn.error(Bt)}})).apply(this,arguments)}return function Z(Se,ze,je){return Q.apply(this,arguments)}}(Q,T,C,k),{gtagCore:Q,wrappedGtag:window[Z]}}(Oi,Kl,Go,Zo,"gtag");Bn=Q,zo=Se,Fu=!0}return Oi[B]=function Lu(T,C,k,B,Z,Q,Se){return Wo.apply(this,arguments)}(T,Kl,Go,C,zo,Zo,k),new zl(T)}function ja(){return(ja=(0,F.Z)(function*(T,C,k,B,Z){if(Z&&Z.global)T("event",k,B);else{const Q=yield C;T("event",k,Object.assign(Object.assign({},B),{send_to:Q}))}})).apply(this,arguments)}function Yo(){return Yl.apply(this,arguments)}function Yl(){return(Yl=(0,F.Z)(function*(){if((0,ie.ru)()||!(0,ie.zI)()||!(0,ie.hl)())return!1;try{return yield(0,ie.eu)()}catch(T){return!1}})).apply(this,arguments)}const wo="@firebase/analytics";!function In(){(0,oe._registerComponent)(new he.wA(qs,(C,{options:k})=>En(C.getProvider("app").getImmediate(),C.getProvider("installations-internal").getImmediate(),k),"PUBLIC")),(0,oe._registerComponent)(new he.wA("analytics-internal",function T(C){try{const k=C.getProvider(qs).getImmediate();return{logEvent:(B,Z,Q)=>function Wr(T,C,k,B){T=(0,ie.m9)(T),function xn(T,C,k,B,Z){return ja.apply(this,arguments)}(Bn,Oi[T.app.options.appId],C,k,B).catch(Z=>yn.error(Z))}(k,B,Z,Q)}}catch(k){throw Ke.create("interop-component-reg-failed",{reason:k})}},"PRIVATE")),(0,oe.registerVersion)(wo,"0.7.5"),(0,oe.registerVersion)(wo,"0.7.5","esm2017")}();var Qo=L(4408),Og=L(7565);const fi=new class Ef extends Og.v{}(class Fi extends Qo.o{constructor(C,k){super(C,k),this.scheduler=C,this.work=k}schedule(C,k=0){return k>0?super.schedule(C,k):(this.delay=k,this.state=C,this.scheduler.flush(this),this)}execute(C,k){return k>0||this.closed?super.execute(C,k):this._execute(C,k)}requestAsyncId(C,k,B=0){return null!=B&&B>0||null==B&&this.delay>0?super.requestAsyncId(C,k,B):C.flush(this)}});var yd=L(4986),Ha=L(8505),Ks=L(5363),Ql=L(9468);const If=new m.GfV("7.2.0"),vd="__angularfire_symbol__analyticsIsSupported",Wa="__angularfire_symbol__remoteConfigIsSupported",Ga="__angularfire_symbol__messagingIsSupported";function wd(T,C,k){if(C){if(1===C.length)return C[0];const Q=C.filter(Se=>Se.app===k);if(1===Q.length)return Q[0]}return k.container.getProvider(T).getImmediate({optional:!0})}globalThis[vd]||(globalThis[vd]=Yo().then(T=>globalThis.__angularfire_symbol__analyticsIsSupportedValue=T)),globalThis[Ga]||(globalThis[Ga]=ir().then(T=>globalThis.__angularfire_symbol__messagingIsSupportedValue=T)),globalThis[Wa]||(globalThis[Wa]=td().then(T=>globalThis.__angularfire_symbol__remoteConfigIsSupportedValue=T));const Tf=(T,C)=>{const k=C?[C]:(0,J.C6)(),B=[];return k.forEach(Z=>{Z.container.getProvider(T).instances.forEach(Se=>{B.includes(Se)||B.push(Se)})}),B};function Rr(){}class Xl{constructor(C,k=fi){this.zone=C,this.delegate=k}now(){return this.delegate.now()}schedule(C,k,B){const Z=this.zone;return this.delegate.schedule(function(Se){Z.runGuarded(()=>{C.apply(this,[Se])})},k,B)}}class Za{constructor(C){this.zone=C,this.task=null}call(C,k){const B=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Rr,{},Rr,Rr)),k.pipe((0,Ha.b)({next:B,complete:B,error:B})).subscribe(C).add(B)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Uu=(()=>{class T{constructor(k){this.ngZone=k,this.outsideAngular=k.runOutsideAngular(()=>new Xl(Zone.current)),this.insideAngular=k.run(()=>new Xl(Zone.current,yd.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return T.\u0275fac=function(k){return new(k||T)(m.LFG(m.R0b))},T.\u0275prov=m.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})();function Bi(){const T=globalThis.\u0275AngularFireScheduler;if(!T)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return T}function ec(T){return T.pipe((0,Ks.Q)(Bi().outsideAngular))}function Jo(T){return Bi(),function Bu(T){return function(k){return(k=k.lift(new Za(T.ngZone))).pipe((0,Ql.R)(T.outsideAngular),(0,Ks.Q)(T.insideAngular))}}(Bi())(T)}},2090:(rt,Ee,L)=>{"use strict";L.d(Ee,{BH:()=>Be,LL:()=>de,ZR:()=>Me,gQ:()=>Ae,zI:()=>pe,hu:()=>J,g5:()=>F,US:()=>he,tV:()=>ue,h$:()=>se,$s:()=>ft,r3:()=>Ti,Sg:()=>Ie,ne:()=>pr,p$:()=>H,vZ:()=>Ut,ZB:()=>q,gK:()=>dt,pd:()=>fs,m9:()=>ps,z$:()=>ke,GJ:()=>Zt,jU:()=>re,ru:()=>ge,d:()=>me,xb:()=>Dn,w1:()=>Ve,hl:()=>ht,uI:()=>Fe,UG:()=>K,Yr:()=>Je,b$:()=>be,G6:()=>Ge,Mn:()=>Te,w9:()=>Dr,cI:()=>jn,UI:()=>Ci,xO:()=>lo,zd:()=>Kr,DV:()=>Ki,ug:()=>At,dS:()=>Fr,Pz:()=>ot,Dv:()=>Fs,Wj:()=>St,lb:()=>ln,eu:()=>X});const J=function(j,W){if(!j)throw F(W)},F=function(j){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+j)},oe=function(j){const W=[];let G=0;for(let ve=0;ve<j.length;ve++){let te=j.charCodeAt(ve);te<128?W[G++]=te:te<2048?(W[G++]=te>>6|192,W[G++]=63&te|128):55296==(64512&te)&&ve+1<j.length&&56320==(64512&j.charCodeAt(ve+1))?(te=65536+((1023&te)<<10)+(1023&j.charCodeAt(++ve)),W[G++]=te>>18|240,W[G++]=te>>12&63|128,W[G++]=te>>6&63|128,W[G++]=63&te|128):(W[G++]=te>>12|224,W[G++]=te>>6&63|128,W[G++]=63&te|128)}return W},he={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(j,W){if(!Array.isArray(j))throw Error("encodeByteArray takes an array as a parameter");this.init_();const G=W?this.byteToCharMapWebSafe_:this.byteToCharMap_,ve=[];for(let te=0;te<j.length;te+=3){const $e=j[te],yt=te+1<j.length,cn=yt?j[te+1]:0,Hn=te+2<j.length,Sn=Hn?j[te+2]:0;let gr=(15&cn)<<2|Sn>>6,Us=63&Sn;Hn||(Us=64,yt||(gr=64)),ve.push(G[$e>>2],G[(3&$e)<<4|cn>>4],G[gr],G[Us])}return ve.join("")},encodeString(j,W){return this.HAS_NATIVE_SUPPORT&&!W?btoa(j):this.encodeByteArray(oe(j),W)},decodeString(j,W){return this.HAS_NATIVE_SUPPORT&&!W?atob(j):function(j){const W=[];let G=0,ve=0;for(;G<j.length;){const te=j[G++];if(te<128)W[ve++]=String.fromCharCode(te);else if(te>191&&te<224){const $e=j[G++];W[ve++]=String.fromCharCode((31&te)<<6|63&$e)}else if(te>239&&te<365){const Hn=((7&te)<<18|(63&j[G++])<<12|(63&j[G++])<<6|63&j[G++])-65536;W[ve++]=String.fromCharCode(55296+(Hn>>10)),W[ve++]=String.fromCharCode(56320+(1023&Hn))}else{const $e=j[G++],yt=j[G++];W[ve++]=String.fromCharCode((15&te)<<12|(63&$e)<<6|63&yt)}}return W.join("")}(this.decodeStringToByteArray(j,W))},decodeStringToByteArray(j,W){this.init_();const G=W?this.charToByteMapWebSafe_:this.charToByteMap_,ve=[];for(let te=0;te<j.length;){const $e=G[j.charAt(te++)],cn=te<j.length?G[j.charAt(te)]:0;++te;const Sn=te<j.length?G[j.charAt(te)]:64;++te;const Mt=te<j.length?G[j.charAt(te)]:64;if(++te,null==$e||null==cn||null==Sn||null==Mt)throw Error();ve.push($e<<2|cn>>4),64!==Sn&&(ve.push(cn<<4&240|Sn>>2),64!==Mt&&ve.push(Sn<<6&192|Mt))}return ve},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let j=0;j<this.ENCODED_VALS.length;j++)this.byteToCharMap_[j]=this.ENCODED_VALS.charAt(j),this.charToByteMap_[this.byteToCharMap_[j]]=j,this.byteToCharMapWebSafe_[j]=this.ENCODED_VALS_WEBSAFE.charAt(j),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[j]]=j,j>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(j)]=j,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(j)]=j)}}},se=function(j){const W=oe(j);return he.encodeByteArray(W,!0)},ae=function(j){return se(j).replace(/\./g,"")},ue=function(j){try{return he.decodeString(j,!0)}catch(W){console.error("base64Decode failed: ",W)}return null};function H(j){return q(void 0,j)}function q(j,W){if(!(W instanceof Object))return W;switch(W.constructor){case Date:return new Date(W.getTime());case Object:void 0===j&&(j={});break;case Array:j=[];break;default:return W}for(const G in W)!W.hasOwnProperty(G)||!ee(G)||(j[G]=q(j[G],W[G]));return j}function ee(j){return"__proto__"!==j}class Be{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((W,G)=>{this.resolve=W,this.reject=G})}wrapCallback(W){return(G,ve)=>{G?this.reject(G):this.resolve(ve),"function"==typeof W&&(this.promise.catch(()=>{}),1===W.length?W(G):W(G,ve))}}}function Ie(j,W){if(j.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const ve=W||"demo-project",te=j.iat||0,$e=j.sub||j.user_id;if(!$e)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const yt=Object.assign({iss:`https://securetoken.google.com/${ve}`,aud:ve,iat:te,exp:te+3600,auth_time:te,sub:$e,user_id:$e,firebase:{sign_in_provider:"custom",identities:{}}},j);return[ae(JSON.stringify({alg:"none",type:"JWT"})),ae(JSON.stringify(yt)),""].join(".")}function ke(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Fe(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ke())}function K(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(j){return!1}}function re(){return"object"==typeof self&&self.self===self}function ge(){const j="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof j&&void 0!==j.id}function be(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function me(){return ke().indexOf("Electron/")>=0}function Ve(){const j=ke();return j.indexOf("MSIE ")>=0||j.indexOf("Trident/")>=0}function Te(){return ke().indexOf("MSAppHost/")>=0}function Je(){return!1}function Ge(){return!K()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ht(){return"object"==typeof indexedDB}function X(){return new Promise((j,W)=>{try{let G=!0;const ve="validate-browser-context-for-indexeddb-analytics-module",te=self.indexedDB.open(ve);te.onsuccess=()=>{te.result.close(),G||self.indexedDB.deleteDatabase(ve),j(!0)},te.onupgradeneeded=()=>{G=!1},te.onerror=()=>{var $e;W((null===($e=te.error)||void 0===$e?void 0:$e.message)||"")}}catch(G){W(G)}})}function pe(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class Me extends Error{constructor(W,G,ve){super(G),this.code=W,this.customData=ve,this.name="FirebaseError",Object.setPrototypeOf(this,Me.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,de.prototype.create)}}class de{constructor(W,G,ve){this.service=W,this.serviceName=G,this.errors=ve}create(W,...G){const ve=G[0]||{},te=`${this.service}/${W}`,$e=this.errors[W],yt=$e?function Dt(j,W){return j.replace(Ft,(G,ve)=>{const te=W[ve];return null!=te?String(te):`<${ve}?>`})}($e,ve):"Error";return new Me(te,`${this.serviceName}: ${yt} (${te}).`,ve)}}const Ft=/\{\$([^}]+)}/g;function jn(j){return JSON.parse(j)}function ot(j){return JSON.stringify(j)}const nt=function(j){let W={},G={},ve={},te="";try{const $e=j.split(".");W=jn(ue($e[0])||""),G=jn(ue($e[1])||""),te=$e[2],ve=G.d||{},delete G.d}catch($e){}return{header:W,claims:G,data:ve,signature:te}},Dr=function(j){const G=nt(j).claims;return!!G&&"object"==typeof G&&G.hasOwnProperty("iat")},Zt=function(j){const W=nt(j).claims;return"object"==typeof W&&!0===W.admin};function Ti(j,W){return Object.prototype.hasOwnProperty.call(j,W)}function Ki(j,W){if(Object.prototype.hasOwnProperty.call(j,W))return j[W]}function Dn(j){for(const W in j)if(Object.prototype.hasOwnProperty.call(j,W))return!1;return!0}function Ci(j,W,G){const ve={};for(const te in j)Object.prototype.hasOwnProperty.call(j,te)&&(ve[te]=W.call(G,j[te],te,j));return ve}function Ut(j,W){if(j===W)return!0;const G=Object.keys(j),ve=Object.keys(W);for(const te of G){if(!ve.includes(te))return!1;const $e=j[te],yt=W[te];if(gn($e)&&gn(yt)){if(!Ut($e,yt))return!1}else if($e!==yt)return!1}for(const te of ve)if(!G.includes(te))return!1;return!0}function gn(j){return null!==j&&"object"==typeof j}function lo(j){const W=[];for(const[G,ve]of Object.entries(j))Array.isArray(ve)?ve.forEach(te=>{W.push(encodeURIComponent(G)+"="+encodeURIComponent(te))}):W.push(encodeURIComponent(G)+"="+encodeURIComponent(ve));return W.length?"&"+W.join("&"):""}function Kr(j){const W={};return j.replace(/^\?/,"").split("&").forEach(ve=>{if(ve){const[te,$e]=ve.split("=");W[decodeURIComponent(te)]=decodeURIComponent($e)}}),W}function fs(j){const W=j.indexOf("?");if(!W)return"";const G=j.indexOf("#",W);return j.substring(W,G>0?G:void 0)}class Ae{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let W=1;W<this.blockSize;++W)this.pad_[W]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(W,G){G||(G=0);const ve=this.W_;if("string"==typeof W)for(let Mt=0;Mt<16;Mt++)ve[Mt]=W.charCodeAt(G)<<24|W.charCodeAt(G+1)<<16|W.charCodeAt(G+2)<<8|W.charCodeAt(G+3),G+=4;else for(let Mt=0;Mt<16;Mt++)ve[Mt]=W[G]<<24|W[G+1]<<16|W[G+2]<<8|W[G+3],G+=4;for(let Mt=16;Mt<80;Mt++){const gr=ve[Mt-3]^ve[Mt-8]^ve[Mt-14]^ve[Mt-16];ve[Mt]=4294967295&(gr<<1|gr>>>31)}let Sn,Br,te=this.chain_[0],$e=this.chain_[1],yt=this.chain_[2],cn=this.chain_[3],Hn=this.chain_[4];for(let Mt=0;Mt<80;Mt++){Mt<40?Mt<20?(Sn=cn^$e&(yt^cn),Br=1518500249):(Sn=$e^yt^cn,Br=1859775393):Mt<60?(Sn=$e&yt|cn&($e|yt),Br=2400959708):(Sn=$e^yt^cn,Br=3395469782);const gr=(te<<5|te>>>27)+Sn+Hn+Br+ve[Mt]&4294967295;Hn=cn,cn=yt,yt=4294967295&($e<<30|$e>>>2),$e=te,te=gr}this.chain_[0]=this.chain_[0]+te&4294967295,this.chain_[1]=this.chain_[1]+$e&4294967295,this.chain_[2]=this.chain_[2]+yt&4294967295,this.chain_[3]=this.chain_[3]+cn&4294967295,this.chain_[4]=this.chain_[4]+Hn&4294967295}update(W,G){if(null==W)return;void 0===G&&(G=W.length);const ve=G-this.blockSize;let te=0;const $e=this.buf_;let yt=this.inbuf_;for(;te<G;){if(0===yt)for(;te<=ve;)this.compress_(W,te),te+=this.blockSize;if("string"==typeof W){for(;te<G;)if($e[yt]=W.charCodeAt(te),++yt,++te,yt===this.blockSize){this.compress_($e),yt=0;break}}else for(;te<G;)if($e[yt]=W[te],++yt,++te,yt===this.blockSize){this.compress_($e),yt=0;break}}this.inbuf_=yt,this.total_+=G}digest(){const W=[];let G=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let te=this.blockSize-1;te>=56;te--)this.buf_[te]=255&G,G/=256;this.compress_(this.buf_);let ve=0;for(let te=0;te<5;te++)for(let $e=24;$e>=0;$e-=8)W[ve]=this.chain_[te]>>$e&255,++ve;return W}}function pr(j,W){const G=new Xe(j,W);return G.subscribe.bind(G)}class Xe{constructor(W,G){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=G,this.task.then(()=>{W(this)}).catch(ve=>{this.error(ve)})}next(W){this.forEachObserver(G=>{G.next(W)})}error(W){this.forEachObserver(G=>{G.error(W)}),this.close(W)}complete(){this.forEachObserver(W=>{W.complete()}),this.close()}subscribe(W,G,ve){let te;if(void 0===W&&void 0===G&&void 0===ve)throw new Error("Missing Observer.");te=function Ht(j,W){if("object"!=typeof j||null===j)return!1;for(const G of W)if(G in j&&"function"==typeof j[G])return!0;return!1}(W,["next","error","complete"])?W:{next:W,error:G,complete:ve},void 0===te.next&&(te.next=$n),void 0===te.error&&(te.error=$n),void 0===te.complete&&(te.complete=$n);const $e=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?te.error(this.finalError):te.complete()}catch(yt){}}),this.observers.push(te),$e}unsubscribeOne(W){void 0===this.observers||void 0===this.observers[W]||(delete this.observers[W],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(W){if(!this.finalized)for(let G=0;G<this.observers.length;G++)this.sendOne(G,W)}sendOne(W,G){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[W])try{G(this.observers[W])}catch(ve){"undefined"!=typeof console&&console.error&&console.error(ve)}})}close(W){this.finalized||(this.finalized=!0,void 0!==W&&(this.finalError=W),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $n(){}const Fs=function(j,W,G,ve){let te;if(ve<W?te="at least "+W:ve>G&&(te=0===G?"none":"no more than "+G),te)throw new Error(j+" failed: Was called with "+ve+(1===ve?" argument.":" arguments.")+" Expects "+te+".")};function dt(j,W){return`${j} failed: ${W} argument `}function St(j,W,G,ve){if((!ve||G)&&"function"!=typeof G)throw new Error(dt(j,W)+"must be a valid function.")}function ln(j,W,G,ve){if((!ve||G)&&("object"!=typeof G||null===G))throw new Error(dt(j,W)+"must be a valid context object.")}const Fr=function(j){const W=[];let G=0;for(let ve=0;ve<j.length;ve++){let te=j.charCodeAt(ve);if(te>=55296&&te<=56319){const $e=te-55296;ve++,J(ve<j.length,"Surrogate pair missing trail surrogate."),te=65536+($e<<10)+(j.charCodeAt(ve)-56320)}te<128?W[G++]=te:te<2048?(W[G++]=te>>6|192,W[G++]=63&te|128):te<65536?(W[G++]=te>>12|224,W[G++]=te>>6&63|128,W[G++]=63&te|128):(W[G++]=te>>18|240,W[G++]=te>>12&63|128,W[G++]=te>>6&63|128,W[G++]=63&te|128)}return W},At=function(j){let W=0;for(let G=0;G<j.length;G++){const ve=j.charCodeAt(G);ve<128?W++:ve<2048?W+=2:ve>=55296&&ve<=56319?(W+=4,G++):W+=3}return W};function ft(j,W=1e3,G=2){const ve=W*Math.pow(G,j),te=Math.round(.5*ve*(Math.random()-.5)*2);return Math.min(144e5,ve+te)}function ps(j){return j&&j._delegate?j._delegate:j}},1406:(rt,Ee,L)=>{"use strict";var m=L(5e3);let J=null;function F(){return J}const se=new m.OlP("DocumentToken");let ae=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=m.Yz7({token:n,factory:function(){return function ue(){return(0,m.LFG)(q)}()},providedIn:"platform"}),n})();const H=new m.OlP("Location Initialized");let q=(()=>{class n extends ae{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return F().getBaseHref(this._doc)}onPopState(t){const r=F().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=F().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){ee()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){ee()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(se))},n.\u0275prov=m.Yz7({token:n,factory:function(){return function Be(){return new q((0,m.LFG)(se))}()},providedIn:"platform"}),n})();function ee(){return!!window.history.pushState}function Ie(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function ke(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Fe(n){return n&&"?"!==n[0]?"?"+n:n}let K=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=m.Yz7({token:n,factory:function(){return function re(n){const e=(0,m.LFG)(se).location;return new be((0,m.LFG)(ae),e&&e.origin||"")}()},providedIn:"root"}),n})();const ge=new m.OlP("appBaseHref");let be=(()=>{class n extends K{constructor(t,r){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Ie(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Fe(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,u){const c=this.prepareExternalUrl(i+Fe(u));this._platformLocation.pushState(t,r,c)}replaceState(t,r,i,u){const c=this.prepareExternalUrl(i+Fe(u));this._platformLocation.replaceState(t,r,c)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(ae),m.LFG(ge,8))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})(),me=(()=>{class n extends K{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Ie(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,u){let c=this.prepareExternalUrl(i+Fe(u));0==c.length&&(c=this._platformLocation.pathname),this._platformLocation.pushState(t,r,c)}replaceState(t,r,i,u){let c=this.prepareExternalUrl(i+Fe(u));0==c.length&&(c=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,c)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(ae),m.LFG(ge,8))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})(),Ve=(()=>{class n{constructor(t,r){this._subject=new m.vpe,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=ke(Ge(i)),this._platformStrategy.onPopState(u=>{this._subject.emit({url:this.path(!0),pop:!0,state:u.state,type:u.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Fe(r))}normalize(t){return n.stripTrailingSlash(function Je(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,Ge(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._platformStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Fe(r)),i)}replaceState(t,r="",i=null){this._platformStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Fe(r)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformStrategy).historyGo)||void 0===i||i.call(r,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=Fe,n.joinWithSlash=Ie,n.stripTrailingSlash=ke,n.\u0275fac=function(t){return new(t||n)(m.LFG(K),m.LFG(ae))},n.\u0275prov=m.Yz7({token:n,factory:function(){return function Te(){return new Ve((0,m.LFG)(K),(0,m.LFG)(ae))}()},providedIn:"root"}),n})();function Ge(n){return n.replace(/\/index.html$/,"")}var pe=(()=>((pe=pe||{})[pe.Zero=0]="Zero",pe[pe.One=1]="One",pe[pe.Two=2]="Two",pe[pe.Few=3]="Few",pe[pe.Many=4]="Many",pe[pe.Other=5]="Other",pe))();const fs=m.kL8;class $t{}let Rn=(()=>{class n extends $t{constructor(t){super(),this.locale=t}getPluralCategory(t,r){switch(fs(r||this.locale)(t)){case pe.Zero:return"zero";case pe.One:return"one";case pe.Two:return"two";case pe.Few:return"few";case pe.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(m.soG))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})(),jr=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new tn,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){zc("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){zc("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(m.Y36(m.s_b),m.Y36(m.Rgc))},n.\u0275dir=m.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class tn{constructor(){this.$implicit=null,this.ngIf=null}}function zc(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,m.AaK)(e)}'.`)}class ya{createSubscription(e,t){return e.subscribe({next:t,error:r=>{throw r}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class uf{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}onDestroy(e){}}const Qc=new uf,lf=new ya;let Ml=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if((0,m.QGY)(t))return Qc;if((0,m.F4k)(t))return lf;throw function xi(n,e){return new m.vHH(2100,"")}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(m.Y36(m.sBO,16))},n.\u0275pipe=m.Yjl({name:"async",type:n,pure:!1}),n})(),bu=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({providers:[{provide:$t,useClass:Rn}]}),n})();function ba(n){return"server"===n}let Ul=(()=>{class n{}return n.\u0275prov=(0,m.Yz7)({token:n,providedIn:"root",factory:()=>new od((0,m.LFG)(se),window)}),n})();class od{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function js(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const u=i.shadowRoot;if(u){const c=u.getElementById(e)||u.querySelector(`[name="${e}"]`);if(c)return c}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,u=this.offset();this.window.scrollTo(r-u[0],i-u[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=zt(this.window.history)||zt(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function zt(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Lo extends class cf extends class he{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function ie(n){J||(J=n)}(new Lo)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Fn(){return Zn=Zn||document.querySelector("base"),Zn?Zn.getAttribute("href"):null}();return null==t?null:function Fo(n){ms=ms||document.createElement("a"),ms.setAttribute("href",n);const e=ms.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Zn=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function ko(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,u]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(u)}return null}(document.cookie,e)}}let ms,Zn=null;const es=new m.OlP("TRANSITION_ID"),zn=[{provide:m.ip1,useFactory:function $r(n,e,t){return()=>{t.get(m.CZH).donePromise.then(()=>{const r=F(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let u=0;u<i.length;u++)r.remove(i[u])})}},deps:[es,se,m.zs3],multi:!0}];class ts{static init(){(0,m.VLi)(new ts)}addToWindow(e){m.dqk.getAngularTestability=(r,i=!0)=>{const u=e.findTestabilityInTree(r,i);if(null==u)throw new Error("Could not find testability for element.");return u},m.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),m.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),m.dqk.frameworkStabilizers||(m.dqk.frameworkStabilizers=[]),m.dqk.frameworkStabilizers.push(r=>{const i=m.dqk.getAllAngularTestabilities();let u=i.length,c=!1;const f=function(y){c=c||y,u--,0==u&&r(c)};i.forEach(function(y){y.whenStable(f)})})}findTestabilityInTree(e,t,r){if(null==t)return null;const i=e.getTestability(t);return null!=i?i:r?F().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let Bl=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();const Hr=new m.OlP("EventManagerPlugins");let $s=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let u=0;u<i.length;u++){const c=i[u];if(c.supports(t))return this._eventNameToPlugin.set(t,c),c}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(Hr),m.LFG(m.R0b))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();class Uo{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=F().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let pt=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})(),rr=(()=>{class n extends pt{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(u=>{const c=this._doc.createElement("style");c.textContent=u,i.push(r.appendChild(c))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(Ta),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Ta))}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(se))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();function Ta(n){F().remove(n)}const Ca={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Bo=/%COMP%/g;function rn(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?rn(n,i,t):(i=i.replace(Bo,n),t.push(i))}return t}function yo(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Jr=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new _s(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case m.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new Ru(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case m.ifc.ShadowDom:return new jo(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=rn(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(m.LFG($s),m.LFG(rr),m.LFG(m.AFp))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();class _s{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Ca[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,r){e&&e.insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const u=Ca[i];u?e.setAttributeNS(u,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=Ca[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(m.JOm.DashCase|m.JOm.Important)?e.style.setProperty(t,r,i&m.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&m.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,yo(r)):this.eventManager.addEventListener(e,t,yo(r))}}class Ru extends _s{constructor(e,t,r,i){super(e),this.component=r;const u=rn(i+"-"+r.id,r.styles,[]);t.addStyles(u),this.contentAttr=function Pt(n){return"_ngcontent-%COMP%".replace(Bo,n)}(i+"-"+r.id),this.hostAttr=function Du(n){return"_nghost-%COMP%".replace(Bo,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class jo extends _s{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=rn(i.id,i.styles,[]);for(let c=0;c<u.length;c++){const f=document.createElement("style");f.textContent=u[c],this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Da=(()=>{class n extends Uo{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(se))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();const Kn=["alt","control","meta","shift"],xu={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ys={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Mi={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let ud=(()=>{class n extends Uo{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const u=n.parseEventName(r),c=n.eventCallback(u.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>F().onAndCancel(t,u.domEventName,c))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const u=n._normalizeKey(r.pop());let c="";if(Kn.forEach(y=>{const I=r.indexOf(y);I>-1&&(r.splice(I,1),c+=y+".")}),c+=u,0!=r.length||0===u.length)return null;const f={};return f.domEventName=i,f.fullKey=c,f}static getEventFullKey(t){let r="",i=function $o(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&ys.hasOwnProperty(e)&&(e=ys[e]))}return xu[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),Kn.forEach(u=>{u!=i&&Mi[u](t)&&(r+=u+".")}),r+=i,r}static eventCallback(t,r,i){return u=>{n.getEventFullKey(u)===t&&i.runGuarded(()=>r(u))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(se))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();const Ra=(0,m.eFA)(m._c5,"browser",[{provide:m.Lbi,useValue:"browser"},{provide:m.g9A,useValue:function Pu(){Lo.makeCurrent(),ts.init()},multi:!0},{provide:se,useFactory:function Ho(){return(0,m.RDi)(document),document},deps:[]}]),xa=[{provide:m.zSh,useValue:"root"},{provide:m.qLn,useFactory:function Sa(){return new m.qLn},deps:[]},{provide:Hr,useClass:Da,multi:!0,deps:[se,m.R0b,m.Lbi]},{provide:Hr,useClass:ud,multi:!0,deps:[se]},{provide:Jr,useClass:Jr,deps:[$s,rr,m.AFp]},{provide:m.FYo,useExisting:Jr},{provide:pt,useExisting:rr},{provide:rr,useClass:rr,deps:[se]},{provide:m.dDg,useClass:m.dDg,deps:[m.R0b]},{provide:$s,useClass:$s,deps:[Hr,m.R0b]},{provide:class nn{},useClass:Bl,deps:[]}];let jl=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:m.AFp,useValue:t.appId},{provide:es,useExisting:m.AFp},zn]}}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(n,12))},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({providers:xa,imports:[bu,m.hGG]}),n})();"undefined"!=typeof window&&window;var sn=L(8996),Ws=L(7669);function Ke(...n){const e=(0,Ws.yG)(n);return(0,sn.D)(n,e)}var Gs=L(7579);class Ni extends Gs.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}var sr=L(8306);const{isArray:mf}=Array,{getPrototypeOf:La,prototype:gd,keys:Fa}=Object;var rs=L(4671),vt=L(4004);const{isArray:_f}=Array;var dn=L(5403),Lu=L(9672);function Wo(...n){const e=(0,Ws.yG)(n),t=(0,Ws.jO)(n),{args:r,keys:i}=function md(n){if(1===n.length){const e=n[0];if(mf(e))return{args:e,keys:null};if(function ns(n){return n&&"object"==typeof n&&La(n)===gd}(e)){const t=Fa(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n);if(0===r.length)return(0,sn.D)([],e);const u=new sr.y(function zl(n,e,t=rs.y){return r=>{Oi(e,()=>{const{length:i}=n,u=new Array(i);let c=i,f=i;for(let y=0;y<i;y++)Oi(e,()=>{const I=(0,sn.D)(n[y],e);let S=!1;I.subscribe(new dn.Q(r,A=>{u[y]=A,S||(S=!0,f--),f||r.next(t(u.slice()))},()=>{--c||r.complete()}))},r)},r)}}(r,e,i?c=>function Ba(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}(i,c):rs.y));return t?u.pipe(function Zl(n){return(0,vt.U)(e=>function Ua(n,e){return _f(e)?n(...e):n(e)}(n,e))}(t)):u}function Oi(n,e,t){n?(0,Lu.f)(t,n,e):e()}const Go=(0,L(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var Zo=L(8189);function zo(...n){return function Va(){return(0,Zo.J)(1)}()((0,sn.D)(n,(0,Ws.yG)(n)))}var Bn=L(8421);function Fu(n){return new sr.y(e=>{(0,Bn.Xf)(n()).subscribe(e)})}var Ko=L(515),vo=L(727),En=L(4482);function xn(){return(0,En.e)((n,e)=>{let t=null;n._refCount++;const r=new dn.Q(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,u=t;t=null,i&&(!u||i===u)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class ja extends sr.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,En.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new vo.w0;const t=this.getSubject();e.add(this.source.subscribe(new dn.Q(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=vo.w0.EMPTY)}return e}refCount(){return xn()(this)}}function vn(n,e){return(0,En.e)((t,r)=>{let i=null,u=0,c=!1;const f=()=>c&&!i&&r.complete();t.subscribe(new dn.Q(r,y=>{null==i||i.unsubscribe();let I=0;const S=u++;(0,Bn.Xf)(n(y,S)).subscribe(i=new dn.Q(r,A=>r.next(e?e(y,A,S,I++):A),()=>{i=null,f()}))},()=>{c=!0,f()}))})}var is=L(5698);function Li(...n){const e=(0,Ws.yG)(n);return(0,En.e)((t,r)=>{(e?zo(n,t,e):zo(n,t)).subscribe(r)})}function Zs(n,e,t,r,i){return(u,c)=>{let f=t,y=e,I=0;u.subscribe(new dn.Q(c,S=>{const A=I++;y=f?n(y,S,A):(f=!0,S),r&&c.next(y)},i&&(()=>{f&&c.next(y),c.complete()})))}}function zs(n,e){return(0,En.e)(Zs(n,e,arguments.length>=2,!0))}function qr(n,e){return(0,En.e)((t,r)=>{let i=0;t.subscribe(new dn.Q(r,u=>n.call(e,u,i++)&&r.next(u)))})}function Xr(n){return(0,En.e)((e,t)=>{let u,r=null,i=!1;r=e.subscribe(new dn.Q(t,void 0,void 0,c=>{u=(0,Bn.Xf)(n(c,Xr(n)(e))),r?(r.unsubscribe(),r=null,u.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,u.subscribe(t))})}var Pn=L(5577),_d=L(576);function Wt(n,e){return(0,_d.m)(e)?(0,Pn.z)(n,e,1):(0,Pn.z)(n,1)}function Yo(n){return n<=0?()=>Ko.E:(0,En.e)((e,t)=>{let r=[];e.subscribe(new dn.Q(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Yl(n=yf){return(0,En.e)((e,t)=>{let r=!1;e.subscribe(new dn.Q(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function yf(){return new Go}function vf(n){return(0,En.e)((e,t)=>{let r=!1;e.subscribe(new dn.Q(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function $a(n,e){const t=arguments.length>=2;return r=>r.pipe(n?qr((i,u)=>n(i,u,r)):rs.y,(0,is.q)(1),t?vf(e):Yl(()=>new Go))}var Wr=L(8505);class ws{constructor(e,t){this.id=e,this.url=t}}class In extends ws{constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Qo extends ws{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Fi extends ws{constructor(e,t,r){super(e,t),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Og extends ws{constructor(e,t,r){super(e,t),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Ef extends ws{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fi extends ws{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ui extends ws{constructor(e,t,r,i,u){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=u}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class yd extends ws{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ha extends ws{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ks{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ql{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class If{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qa{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class vd{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bf{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Wa{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const ct="primary";class Ga{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ei(n){return new Ga(n)}const Lg="ngNavigationCancelingError";function Jl(n){const e=Error("NavigationCancelingError: "+n);return e[Lg]=!0,e}function wd(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let u=0;u<r.length;u++){const c=r[u],f=n[u];if(c.startsWith(":"))i[c.substring(1)]=f;else if(c!==f.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Rr(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let u=0;u<t.length;u++)if(i=t[u],!Xl(n[i],e[i]))return!1;return!0}function Xl(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,u)=>r[u]===i)}return n===e}function Za(n){return Array.prototype.concat.apply([],n)}function Uu(n){return n.length>0?n[n.length-1]:null}function mr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function wn(n){return(0,m.CqO)(n)?n:(0,m.QGY)(n)?(0,sn.D)(Promise.resolve(n)):Ke(n)}const za={exact:function Vu(n,e,t){if(!je(n.segments,e.segments)||!B(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!Vu(n.children[r],e.children[r],t))return!1;return!0},subset:C},Jo={exact:function Cf(n,e){return Rr(n,e)},subset:function T(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Xl(n[t],e[t]))},ignored:()=>!0};function Bu(n,e,t){return za[t.paths](n.root,e.root,t.matrixParams)&&Jo[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function C(n,e,t){return k(n,e,e.segments,t)}function k(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!je(i,t)||e.hasChildren()||!B(i,t,r))}if(n.segments.length===t.length){if(!je(n.segments,t)||!B(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!C(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),u=t.slice(n.segments.length);return!!(je(n.segments,i)&&B(n.segments,i,r)&&n.children[ct])&&k(n.children[ct],e,u,r)}}function B(n,e,t){return e.every((r,i)=>Jo[t](n[i].parameters,r.parameters))}class Z{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ei(this.queryParams)),this._queryParamMap}toString(){return Yn.serialize(this)}}class Q{constructor(e,t){this.segments=e,this.children=t,this.parent=null,mr(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return on(this)}}class Se{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ei(this.parameters)),this._parameterMap}toString(){return Ed(this)}}function je(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}class Kt{}class Gr{parse(e){const t=new G_(e);return new Z(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Vi(e.root,!0)}`,r=function ju(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${Ys(t)}=${Ys(i)}`).join("&"):`${Ys(t)}=${Ys(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function $i(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Yn=new Gr;function on(n){return n.segments.map(e=>Ed(e)).join("/")}function Vi(n,e){if(!n.hasChildren())return on(n);if(e){const t=n.children[ct]?Vi(n.children[ct],!1):"",r=[];return mr(n.children,(i,u)=>{u!==ct&&r.push(`${u}:${Vi(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function Bt(n,e){let t=[];return mr(n.children,(r,i)=>{i===ct&&(t=t.concat(e(r,i)))}),mr(n.children,(r,i)=>{i!==ct&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===ct?[Vi(n.children[ct],!1)]:[`${i}:${Vi(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[ct]?`${on(n)}/${t[0]}`:`${on(n)}/(${t.join("//")})`}}function ji(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ys(n){return ji(n).replace(/%3B/gi,";")}function ss(n){return ji(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Qs(n){return decodeURIComponent(n)}function tc(n){return Qs(n.replace(/\+/g,"%20"))}function Ed(n){return`${ss(n.path)}${function Df(n){return Object.keys(n).map(e=>`;${ss(e)}=${ss(n[e])}`).join("")}(n.parameters)}`}const $u=/^[^\/()?;=#]+/;function nc(n){const e=n.match($u);return e?e[0]:""}const $0=/^[^=?&#]+/,Sf=/^[^&#]+/;class G_{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Q([],{}):new Q([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[ct]=new Q(e,t)),r}parseSegment(){const e=nc(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Se(Qs(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=nc(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=nc(this.remaining);i&&(r=i,this.capture(r))}e[Qs(t)]=Qs(r)}parseQueryParam(e){const t=function Ug(n){const e=n.match($0);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const c=function H0(n){const e=n.match(Sf);return e?e[0]:""}(this.remaining);c&&(r=c,this.capture(r))}const i=tc(t),u=tc(r);if(e.hasOwnProperty(i)){let c=e[i];Array.isArray(c)||(c=[c],e[i]=c),c.push(u)}else e[i]=u}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=nc(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let u;r.indexOf(":")>-1?(u=r.substr(0,r.indexOf(":")),this.capture(u),this.capture(":")):e&&(u=ct);const c=this.parseChildren();t[u]=1===Object.keys(c).length?c[ct]:new Q([],c),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class Id{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Af(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=Af(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Hu(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Hu(e,this._root).map(t=>t.value)}}function Af(n,e){if(n===e.value)return e;for(const t of e.children){const r=Af(n,t);if(r)return r}return null}function Hu(n,e){if(n===e.value)return[e];for(const t of e.children){const r=Hu(n,t);if(r.length)return r.unshift(e),r}return[]}class Hi{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Es(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class bd extends Id{constructor(e,t){super(e),this.snapshot=t,ic(this,e)}toString(){return this.snapshot.toString()}}function rc(n,e){const t=function Bg(n,e){const c=new Wu([],{},{},"",{},ct,e,null,n.root,-1,{});return new Td("",new Hi(c,[]))}(n,e),r=new Ni([new Se("",{})]),i=new Ni({}),u=new Ni({}),c=new Ni({}),f=new Ni(""),y=new os(r,i,c,f,u,ct,e,t.root);return y.snapshot=t.root,new bd(new Hi(y,[]),t)}class os{constructor(e,t,r,i,u,c,f,y){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=u,this.outlet=c,this.component=f,this._futureSnapshot=y}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,vt.U)(e=>ei(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,vt.U)(e=>ei(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function qu(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],u=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(u.component)break;r--}}return function Vg(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Wu{constructor(e,t,r,i,u,c,f,y,I,S,A){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=u,this.outlet=c,this.component=f,this.routeConfig=y,this._urlSegment=I,this._lastPathIndex=S,this._resolve=A}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ei(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ei(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Td extends Id{constructor(e,t){super(t),this.url=e,ic(this,t)}toString(){return jg(this._root)}}function ic(n,e){e.value._routerState=n,e.children.forEach(t=>ic(n,t))}function jg(n){const e=n.children.length>0?` { ${n.children.map(jg).join(", ")} } `:"";return`${n.value}${e}`}function Cd(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Rr(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Rr(e.params,t.params)||n.params.next(t.params),function Tf(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Rr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Rr(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function sc(n,e){const t=Rr(n.params,e.params)&&function ze(n,e){return je(n,e)&&n.every((t,r)=>Rr(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||sc(n.parent,e.parent))}function oc(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function Xo(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return oc(n,r,i);return oc(n,r)})}(n,e,t);return new Hi(r,i)}{if(n.shouldAttach(e.value)){const u=n.retrieve(e.value);if(null!==u){const c=u.route;return c.value._futureSnapshot=e.value,c.children=e.children.map(f=>oc(n,f)),c}}const r=function Ka(n){return new os(new Ni(n.url),new Ni(n.params),new Ni(n.queryParams),new Ni(n.fragment),new Ni(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(u=>oc(n,u));return new Hi(r,i)}}function Rf(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function ac(n){return"object"==typeof n&&null!=n&&n.outlets}function $g(n,e,t,r,i){let u={};return r&&mr(r,(c,f)=>{u[f]=Array.isArray(c)?c.map(y=>`${y}`):`${c}`}),new Z(t.root===n?e:Dd(t.root,n,e),u,i)}function Dd(n,e,t){const r={};return mr(n.children,(i,u)=>{r[u]=i===e?t:Dd(i,e,t)}),new Q(n.segments,r)}class K_{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Rf(r[0]))throw new Error("Root segment cannot have matrix parameters");const i=r.find(ac);if(i&&i!==Uu(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class xf{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function X_(n,e,t){if(n||(n=new Q([],{})),0===n.segments.length&&n.hasChildren())return Sd(n,e,t);const r=function Gu(n,e,t){let r=0,i=e;const u={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return u;const c=n.segments[i],f=t[r];if(ac(f))break;const y=`${f}`,I=r<t.length-1?t[r+1]:null;if(i>0&&void 0===y)break;if(y&&I&&"object"==typeof I&&void 0===I.outlets){if(!Pf(y,I,c))return u;r+=2}else{if(!Pf(y,{},c))return u;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const u=new Q(n.segments.slice(0,r.pathIndex),{});return u.children[ct]=new Q(n.segments.slice(r.pathIndex),n.children),Sd(u,0,i)}return r.match&&0===i.length?new Q(n.segments,{}):r.match&&!n.hasChildren()?Ad(n,e,t):r.match?Sd(n,0,i):Ad(n,e,t)}function Sd(n,e,t){if(0===t.length)return new Q(n.segments,{});{const r=function J_(n){return ac(n[0])?n[0].outlets:{[ct]:n}}(t),i={};return mr(r,(u,c)=>{"string"==typeof u&&(u=[u]),null!==u&&(i[c]=X_(n.children[c],e,u))}),mr(n.children,(u,c)=>{void 0===r[c]&&(i[c]=u)}),new Q(n.segments,i)}}function Ad(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const u=t[i];if(ac(u)){const y=Js(u.outlets);return new Q(r,y)}if(0===i&&Rf(t[0])){r.push(new Se(n.segments[e].path,Zu(t[0]))),i++;continue}const c=ac(u)?u.outlets[ct]:`${u}`,f=i<t.length-1?t[i+1]:null;c&&f&&Rf(f)?(r.push(new Se(c,Zu(f))),i+=2):(r.push(new Se(c,{})),i++)}return new Q(r,{})}function Js(n){const e={};return mr(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=Ad(new Q([],{}),0,t))}),e}function Zu(n){const e={};return mr(n,(t,r)=>e[r]=`${t}`),e}function Pf(n,e,t){return n==t.path&&Rr(e,t.parameters)}class kf{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Cd(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Es(t);e.children.forEach(u=>{const c=u.value.outlet;this.deactivateRoutes(u,i[c],r),delete i[c]}),mr(i,(u,c)=>{this.deactivateRouteAndItsChildren(u,r)})}deactivateRoutes(e,t,r){const i=e.value,u=t?t.value:null;if(i===u)if(i.component){const c=r.getContext(i.outlet);c&&this.deactivateChildRoutes(e,t,c.children)}else this.deactivateChildRoutes(e,t,r);else u&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,u=Es(e);for(const c of Object.keys(u))this.deactivateRouteAndItsChildren(u[c],i);if(r&&r.outlet){const c=r.outlet.detach(),f=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:c,route:e,contexts:f})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,u=Es(e);for(const c of Object.keys(u))this.deactivateRouteAndItsChildren(u[c],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=Es(t);e.children.forEach(u=>{this.activateRoutes(u,i[u.value.outlet],r),this.forwardEvent(new bf(u.value.snapshot))}),e.children.length&&this.forwardEvent(new qa(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,u=t?t.value:null;if(Cd(i),i===u)if(i.component){const c=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,c.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const c=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const f=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),c.children.onOutletReAttached(f.contexts),c.attachRef=f.componentRef,c.route=f.route.value,c.outlet&&c.outlet.attach(f.componentRef,f.route.value),Cd(f.route.value),this.activateChildRoutes(e,null,c.children)}else{const f=function q0(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),y=f?f.module.componentFactoryResolver:null;c.attachRef=null,c.route=i,c.resolver=y,c.outlet&&c.outlet.activateWith(i,y),this.activateChildRoutes(e,null,c.children)}}else this.activateChildRoutes(e,null,r)}}class Wg{constructor(e,t){this.routes=e,this.module=t}}function Ya(n){return"function"==typeof n}function Is(n){return n instanceof Z}const uc=Symbol("INITIAL_VALUE");function Qa(){return vn(n=>Wo(n.map(e=>e.pipe((0,is.q)(1),Li(uc)))).pipe(zs((e,t)=>{let r=!1;return t.reduce((i,u,c)=>i!==uc?i:(u===uc&&(r=!0),r||!1!==u&&c!==t.length-1&&!Is(u)?i:u),e)},uc),qr(e=>e!==uc),(0,vt.U)(e=>Is(e)?e:!0===e),(0,is.q)(1)))}class ey{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new zu,this.attachRef=null}}class zu{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const r=this.getOrCreateContext(e);r.outlet=t,this.contexts.set(e,r)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new ey,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let lc=(()=>{class n{constructor(t,r,i,u,c){this.parentContexts=t,this.location=r,this.resolver=i,this.changeDetector=c,this.activated=null,this._activatedRoute=null,this.activateEvents=new m.vpe,this.deactivateEvents=new m.vpe,this.attachEvents=new m.vpe,this.detachEvents=new m.vpe,this.name=u||ct,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const c=(r=r||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),f=this.parentContexts.getOrCreateContext(this.name).children,y=new Rd(t,f,this.location.injector);this.activated=this.location.createComponent(c,this.location.length,y),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(m.Y36(zu),m.Y36(m.s_b),m.Y36(m._Vd),m.$8M("name"),m.Y36(m.sBO))},n.\u0275dir=m.lG2({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class Rd{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===os?this.route:e===zu?this.childContexts:this.parent.get(e,t)}}let Zg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,r){1&t&&m._UZ(0,"router-outlet")},directives:[lc],encapsulation:2}),n})();function xd(n,e=""){for(let t=0;t<n.length;t++){const r=n[t];G0(r,hn(e,r))}}function G0(n,e){n.children&&xd(n.children,e)}function hn(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function Lf(n){const e=n.children&&n.children.map(Lf),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ct&&(t.component=Zg),t}function as(n){return n.outlet||ct}function Ku(n,e){const t=n.filter(r=>as(r)===e);return t.push(...n.filter(r=>as(r)!==e)),t}const Ff={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Yu(n,e,t){var r;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},Ff):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const u=(e.matcher||wd)(t,n,e);if(!u)return Object.assign({},Ff);const c={};mr(u.posParams,(y,I)=>{c[I]=y.path});const f=u.consumed.length>0?Object.assign(Object.assign({},c),u.consumed[u.consumed.length-1].parameters):c;return{matched:!0,consumedSegments:u.consumed,lastChild:u.consumed.length,parameters:f,positionalParamSegments:null!==(r=u.posParams)&&void 0!==r?r:{}}}function Pd(n,e,t,r,i="corrected"){if(t.length>0&&function ny(n,e,t){return t.some(r=>cc(n,e,r)&&as(r)!==ct)}(n,t,r)){const c=new Q(e,function Uf(n,e,t,r){const i={};i[ct]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const u of t)if(""===u.path&&as(u)!==ct){const c=new Q([],{});c._sourceSegment=n,c._segmentIndexShift=e.length,i[as(u)]=c}return i}(n,e,r,new Q(t,n.children)));return c._sourceSegment=n,c._segmentIndexShift=e.length,{segmentGroup:c,slicedSegments:[]}}if(0===t.length&&function Z0(n,e,t){return t.some(r=>cc(n,e,r))}(n,t,r)){const c=new Q(n.segments,function ty(n,e,t,r,i,u){const c={};for(const f of r)if(cc(n,t,f)&&!i[as(f)]){const y=new Q([],{});y._sourceSegment=n,y._segmentIndexShift="legacy"===u?n.segments.length:e.length,c[as(f)]=y}return Object.assign(Object.assign({},i),c)}(n,e,t,r,n.children,i));return c._sourceSegment=n,c._segmentIndexShift=e.length,{segmentGroup:c,slicedSegments:t}}const u=new Q(n.segments,n.children);return u._sourceSegment=n,u._segmentIndexShift=e.length,{segmentGroup:u,slicedSegments:t}}function cc(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function Qu(n,e,t,r){return!!(as(n)===r||r!==ct&&cc(e,t,n))&&("**"===n.path||Yu(e,n,t).matched)}function Zr(n,e,t){return 0===e.length&&!n.children[t]}class Ja{constructor(e){this.segmentGroup=e||null}}class Bf{constructor(e){this.urlTree=e}}function dc(n){return new sr.y(e=>e.error(new Ja(n)))}function _r(n){return new sr.y(e=>e.error(new Bf(n)))}function Xa(n){return new sr.y(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${n}'`)))}class jf{constructor(e,t,r,i,u){this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=u,this.allowRedirects=!0,this.ngModule=e.get(m.h0i)}apply(){const e=Pd(this.urlTree.root,[],[],this.config).segmentGroup,t=new Q(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,ct).pipe((0,vt.U)(u=>this.createUrlTree($f(u),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Xr(u=>{if(u instanceof Bf)return this.allowRedirects=!1,this.match(u.urlTree);throw u instanceof Ja?this.noMatchError(u):u}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,ct).pipe((0,vt.U)(i=>this.createUrlTree($f(i),e.queryParams,e.fragment))).pipe(Xr(i=>{throw i instanceof Ja?this.noMatchError(i):i}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,r){const i=e.segments.length>0?new Q([],{[ct]:e}):e;return new Z(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,vt.U)(u=>new Q([],u))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const u of Object.keys(r.children))"primary"===u?i.unshift(u):i.push(u);return(0,sn.D)(i).pipe(Wt(u=>{const c=r.children[u],f=Ku(t,u);return this.expandSegmentGroup(e,f,c,u).pipe((0,vt.U)(y=>({segment:y,outlet:u})))}),zs((u,c)=>(u[c.outlet]=c.segment,u),{}),function wf(n,e){const t=arguments.length>=2;return r=>r.pipe(n?qr((i,u)=>n(i,u,r)):rs.y,Yo(1),t?vf(e):Yl(()=>new Go))}())}expandSegment(e,t,r,i,u,c){return(0,sn.D)(r).pipe(Wt(f=>this.expandSegmentAgainstRoute(e,t,r,f,i,u,c).pipe(Xr(I=>{if(I instanceof Ja)return Ke(null);throw I}))),$a(f=>!!f),Xr((f,y)=>{if(f instanceof Go||"EmptyError"===f.name){if(Zr(t,i,u))return Ke(new Q([],{}));throw new Ja(t)}throw f}))}expandSegmentAgainstRoute(e,t,r,i,u,c,f){return Qu(i,t,u,c)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,u,c):f&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,u,c):dc(t):dc(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,u,c){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,c):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,u,c)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const u=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?_r(u):this.lineralizeSegments(r,u).pipe((0,Pn.z)(c=>{const f=new Q(c,{});return this.expandSegment(e,f,t,c,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,u,c){const{matched:f,consumedSegments:y,lastChild:I,positionalParamSegments:S}=Yu(t,i,u);if(!f)return dc(t);const A=this.applyRedirectCommands(y,i.redirectTo,S);return i.redirectTo.startsWith("/")?_r(A):this.lineralizeSegments(i,A).pipe((0,Pn.z)(M=>this.expandSegment(e,t,r,M.concat(u.slice(I)),c,!1)))}matchSegmentAgainstRoute(e,t,r,i,u){if("**"===r.path)return r.loadChildren?(r._loadedConfig?Ke(r._loadedConfig):this.configLoader.load(e.injector,r)).pipe((0,vt.U)(M=>(r._loadedConfig=M,new Q(i,{})))):Ke(new Q(i,{}));const{matched:c,consumedSegments:f,lastChild:y}=Yu(t,r,i);if(!c)return dc(t);const I=i.slice(y);return this.getChildConfig(e,r,i).pipe((0,Pn.z)(A=>{const M=A.module,V=A.routes,{segmentGroup:z,slicedSegments:ye}=Pd(t,f,I,V),Pe=new Q(z.segments,z.children);if(0===ye.length&&Pe.hasChildren())return this.expandChildren(M,V,Pe).pipe((0,vt.U)(lt=>new Q(f,lt)));if(0===V.length&&0===ye.length)return Ke(new Q(f,{}));const _t=as(r)===u;return this.expandSegment(M,Pe,V,ye,_t?ct:u,!0).pipe((0,vt.U)(It=>new Q(f.concat(It.segments),It.children)))}))}getChildConfig(e,t,r){return t.children?Ke(new Wg(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Ke(t._loadedConfig):this.runCanLoadGuards(e.injector,t,r).pipe((0,Pn.z)(i=>i?this.configLoader.load(e.injector,t).pipe((0,vt.U)(u=>(t._loadedConfig=u,u))):function Vf(n){return new sr.y(e=>e.error(Jl(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`)))}(t))):Ke(new Wg([],e))}runCanLoadGuards(e,t,r){const i=t.canLoad;return i&&0!==i.length?Ke(i.map(c=>{const f=e.get(c);let y;if(function Nf(n){return n&&Ya(n.canLoad)}(f))y=f.canLoad(t,r);else{if(!Ya(f))throw new Error("Invalid CanLoad guard");y=f(t,r)}return wn(y)})).pipe(Qa(),(0,Wr.b)(c=>{if(!Is(c))return;const f=Jl(`Redirecting to "${this.urlSerializer.serialize(c)}"`);throw f.url=c,f}),(0,vt.U)(c=>!0===c)):Ke(!0)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return Ke(r);if(i.numberOfChildren>1||!i.children[ct])return Xa(e.redirectTo);i=i.children[ct]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreatreUrlTree(e,t,r,i){const u=this.createSegmentGroup(e,t.root,r,i);return new Z(u,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return mr(e,(i,u)=>{if("string"==typeof i&&i.startsWith(":")){const f=i.substring(1);r[u]=t[f]}else r[u]=i}),r}createSegmentGroup(e,t,r,i){const u=this.createSegments(e,t.segments,r,i);let c={};return mr(t.children,(f,y)=>{c[y]=this.createSegmentGroup(e,f,r,i)}),new Q(u,c)}createSegments(e,t,r,i){return t.map(u=>u.path.startsWith(":")?this.findPosParam(e,u,i):this.findOrReturn(u,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}function $f(n){const e={};for(const r of Object.keys(n.children)){const u=$f(n.children[r]);(u.segments.length>0||u.hasChildren())&&(e[r]=u)}return function kd(n){if(1===n.numberOfChildren&&n.children[ct]){const e=n.children[ct];return new Q(n.segments.concat(e.segments),e.children)}return n}(new Q(n.segments,e))}class hc{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class fc{constructor(e,t){this.component=e,this.route=t}}function iy(n,e,t){const r=n._root;return pc(r,e?e._root:null,t,[r.value])}function eu(n,e,t){const r=function oy(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:t).get(n)}function pc(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const u=Es(e);return n.children.forEach(c=>{(function Hf(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const u=n.value,c=e?e.value:null,f=t?t.getContext(n.value.outlet):null;if(c&&u.routeConfig===c.routeConfig){const y=function ay(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!je(n.url,e.url);case"pathParamsOrQueryParamsChange":return!je(n.url,e.url)||!Rr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!sc(n,e)||!Rr(n.queryParams,e.queryParams);default:return!sc(n,e)}}(c,u,u.routeConfig.runGuardsAndResolvers);y?i.canActivateChecks.push(new hc(r)):(u.data=c.data,u._resolvedData=c._resolvedData),pc(n,e,u.component?f?f.children:null:t,r,i),y&&f&&f.outlet&&f.outlet.isActivated&&i.canDeactivateChecks.push(new fc(f.outlet.component,c))}else c&&ea(e,f,i),i.canActivateChecks.push(new hc(r)),pc(n,null,u.component?f?f.children:null:t,r,i)})(c,u[c.value.outlet],t,r.concat([c.value]),i),delete u[c.value.outlet]}),mr(u,(c,f)=>ea(c,t.getContext(f),i)),i}function ea(n,e,t){const r=Es(n),i=n.value;mr(r,(u,c)=>{ea(u,i.component?e?e.children.getContext(c):null:e,t)}),t.canDeactivateChecks.push(new fc(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class Gf{}function Zf(n){return new sr.y(e=>e.error(n))}class Md{constructor(e,t,r,i,u,c){this.rootComponentType=e,this.config=t,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=u,this.relativeLinkResolution=c}recognize(){const e=Pd(this.urlTree.root,[],[],this.config.filter(c=>void 0===c.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,ct);if(null===t)return null;const r=new Wu([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},ct,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Hi(r,t),u=new Td(this.url,i);return this.inheritParamsAndData(u._root),u}inheritParamsAndData(e){const t=e.value,r=qu(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,r)}processChildren(e,t){const r=[];for(const u of Object.keys(t.children)){const c=t.children[u],f=Ku(e,u),y=this.processSegmentGroup(f,c,u);if(null===y)return null;r.push(...y)}const i=tu(r);return function qi(n){n.sort((e,t)=>e.value.outlet===ct?-1:t.value.outlet===ct?1:e.value.outlet.localeCompare(t.value.outlet))}(i),i}processSegment(e,t,r,i){for(const u of e){const c=this.processSegmentAgainstRoute(u,t,r,i);if(null!==c)return c}return Zr(t,r,i)?[]:null}processSegmentAgainstRoute(e,t,r,i){if(e.redirectTo||!Qu(e,t,r,i))return null;let u,c=[],f=[];if("**"===e.path){const V=r.length>0?Uu(r).parameters:{};u=new Wu(r,V,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Nd(e),as(e),e.component,e,zf(t),fy(t)+r.length,py(e))}else{const V=Yu(t,e,r);if(!V.matched)return null;c=V.consumedSegments,f=r.slice(V.lastChild),u=new Wu(c,V.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Nd(e),as(e),e.component,e,zf(t),fy(t)+c.length,py(e))}const y=function mc(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(e),{segmentGroup:I,slicedSegments:S}=Pd(t,c,f,y.filter(V=>void 0===V.redirectTo),this.relativeLinkResolution);if(0===S.length&&I.hasChildren()){const V=this.processChildren(y,I);return null===V?null:[new Hi(u,V)]}if(0===y.length&&0===S.length)return[new Hi(u,[])];const A=as(e)===i,M=this.processSegment(y,I,S,A?ct:i);return null===M?null:[new Hi(u,M)]}}function Yg(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function tu(n){const e=[],t=new Set;for(const r of n){if(!Yg(r)){e.push(r);continue}const i=e.find(u=>r.value.routeConfig===u.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=tu(r.children);e.push(new Hi(r.value,i))}return e.filter(r=>!t.has(r))}function zf(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function fy(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function Nd(n){return n.data||{}}function py(n){return n.resolve||{}}function ta(n){return vn(e=>{const t=n(e);return t?(0,sn.D)(t).pipe((0,vt.U)(()=>e)):Ke(e)})}class _c extends class Ld{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const yc=new m.OlP("ROUTES");class Ts{constructor(e,t,r,i){this.injector=e,this.compiler=t,this.onLoadStartListener=r,this.onLoadEndListener=i}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const i=this.loadModuleFactory(t.loadChildren).pipe((0,vt.U)(u=>{this.onLoadEndListener&&this.onLoadEndListener(t);const c=u.create(e);return new Wg(Za(c.injector.get(yc,void 0,m.XFs.Self|m.XFs.Optional)).map(Lf),c)}),Xr(u=>{throw t._loader$=void 0,u}));return t._loader$=new ja(i,()=>new Gs.x).pipe(xn()),t._loader$}loadModuleFactory(e){return wn(e()).pipe((0,Pn.z)(t=>t instanceof m.YKP?Ke(t):(0,sn.D)(this.compiler.compileModuleAsync(t))))}}class nu{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function Ud(n){throw n}function Jg(n,e,t){return e.parse("/")}function Bd(n,e){return Ke(null)}const Yf={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},my={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ni=(()=>{class n{constructor(t,r,i,u,c,f,y){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=i,this.location=u,this.config=y,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Gs.x,this.errorHandler=Ud,this.malformedUriErrorHandler=Jg,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Bd,afterPreactivation:Bd},this.urlHandlingStrategy=new nu,this.routeReuseStrategy=new _c,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=c.get(m.h0i),this.console=c.get(m.c2e);const A=c.get(m.R0b);this.isNgZoneEnabled=A instanceof m.R0b&&m.R0b.isInAngularZone(),this.resetConfig(y),this.currentUrlTree=function ec(){return new Z(new Q([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Ts(c,f,M=>this.triggerEvent(new Ks(M)),M=>this.triggerEvent(new Ql(M))),this.routerState=rc(this.currentUrlTree,this.rootComponentType),this.transitions=new Ni({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(qr(i=>0!==i.id),(0,vt.U)(i=>Object.assign(Object.assign({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),vn(i=>{let u=!1,c=!1;return Ke(i).pipe((0,Wr.b)(f=>{this.currentNavigation={id:f.id,initialUrl:f.currentRawUrl,extractedUrl:f.extractedUrl,trigger:f.source,extras:f.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),vn(f=>{const y=this.browserUrlTree.toString(),I=!this.navigated||f.extractedUrl.toString()!==y||y!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||I)&&this.urlHandlingStrategy.shouldProcessUrl(f.rawUrl))return _(f.source)&&(this.browserUrlTree=f.extractedUrl),Ke(f).pipe(vn(A=>{const M=this.transitions.getValue();return r.next(new In(A.id,this.serializeUrl(A.extractedUrl),A.source,A.restoredState)),M!==this.transitions.getValue()?Ko.E:Promise.resolve(A)}),function zg(n,e,t,r){return vn(i=>function ry(n,e,t,r,i){return new jf(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,vt.U)(u=>Object.assign(Object.assign({},i),{urlAfterRedirects:u}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Wr.b)(A=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:A.urlAfterRedirects})}),function xr(n,e,t,r,i){return(0,Pn.z)(u=>function hy(n,e,t,r,i="emptyOnly",u="legacy"){try{const c=new Md(n,e,t,r,i,u).recognize();return null===c?Zf(new Gf):Ke(c)}catch(c){return Zf(c)}}(n,e,u.urlAfterRedirects,t(u.urlAfterRedirects),r,i).pipe((0,vt.U)(c=>Object.assign(Object.assign({},u),{targetSnapshot:c}))))}(this.rootComponentType,this.config,A=>this.serializeUrl(A),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Wr.b)(A=>{if("eager"===this.urlUpdateStrategy){if(!A.extras.skipLocationChange){const V=this.urlHandlingStrategy.merge(A.urlAfterRedirects,A.rawUrl);this.setBrowserUrl(V,A)}this.browserUrlTree=A.urlAfterRedirects}const M=new Ef(A.id,this.serializeUrl(A.extractedUrl),this.serializeUrl(A.urlAfterRedirects),A.targetSnapshot);r.next(M)}));if(I&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:M,extractedUrl:V,source:z,restoredState:ye,extras:Pe}=f,_t=new In(M,this.serializeUrl(V),z,ye);r.next(_t);const wt=rc(V,this.rootComponentType).snapshot;return Ke(Object.assign(Object.assign({},f),{targetSnapshot:wt,urlAfterRedirects:V,extras:Object.assign(Object.assign({},Pe),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=f.rawUrl,f.resolve(null),Ko.E}),ta(f=>{const{targetSnapshot:y,id:I,extractedUrl:S,rawUrl:A,extras:{skipLocationChange:M,replaceUrl:V}}=f;return this.hooks.beforePreactivation(y,{navigationId:I,appliedUrlTree:S,rawUrlTree:A,skipLocationChange:!!M,replaceUrl:!!V})}),(0,Wr.b)(f=>{const y=new fi(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot);this.triggerEvent(y)}),(0,vt.U)(f=>Object.assign(Object.assign({},f),{guards:iy(f.targetSnapshot,f.currentSnapshot,this.rootContexts)})),function gc(n,e){return(0,Pn.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:u,canDeactivateChecks:c}}=t;return 0===c.length&&0===u.length?Ke(Object.assign(Object.assign({},t),{guardsResult:!0})):function Kg(n,e,t,r){return(0,sn.D)(n).pipe((0,Pn.z)(i=>function Wf(n,e,t,r,i){const u=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return u&&0!==u.length?Ke(u.map(f=>{const y=eu(f,e,i);let I;if(function Of(n){return n&&Ya(n.canDeactivate)}(y))I=wn(y.canDeactivate(n,e,t,r));else{if(!Ya(y))throw new Error("Invalid CanDeactivate guard");I=wn(y(n,e,t,r))}return I.pipe($a())})).pipe(Qa()):Ke(!0)}(i.component,i.route,t,e,r)),$a(i=>!0!==i,!0))}(c,r,i,n).pipe((0,Pn.z)(f=>f&&function Mf(n){return"boolean"==typeof n}(f)?function uy(n,e,t,r){return(0,sn.D)(e).pipe(Wt(i=>zo(function cy(n,e){return null!==n&&e&&e(new If(n)),Ke(!0)}(i.route.parent,r),function ly(n,e){return null!==n&&e&&e(new vd(n)),Ke(!0)}(i.route,r),function qf(n,e,t){const r=e[e.length-1],u=e.slice(0,e.length-1).reverse().map(c=>function sy(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(c)).filter(c=>null!==c).map(c=>Fu(()=>Ke(c.guards.map(y=>{const I=eu(y,c.node,t);let S;if(function W0(n){return n&&Ya(n.canActivateChild)}(I))S=wn(I.canActivateChild(r,n));else{if(!Ya(I))throw new Error("Invalid CanActivateChild guard");S=wn(I(r,n))}return S.pipe($a())})).pipe(Qa())));return Ke(u).pipe(Qa())}(n,i.path,t),function dy(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return Ke(!0);const i=r.map(u=>Fu(()=>{const c=eu(u,e,t);let f;if(function Gg(n){return n&&Ya(n.canActivate)}(c))f=wn(c.canActivate(e,n));else{if(!Ya(c))throw new Error("Invalid CanActivate guard");f=wn(c(e,n))}return f.pipe($a())}));return Ke(i).pipe(Qa())}(n,i.route,t))),$a(i=>!0!==i,!0))}(r,u,n,e):Ke(f)),(0,vt.U)(f=>Object.assign(Object.assign({},t),{guardsResult:f})))})}(this.ngModule.injector,f=>this.triggerEvent(f)),(0,Wr.b)(f=>{if(Is(f.guardsResult)){const I=Jl(`Redirecting to "${this.serializeUrl(f.guardsResult)}"`);throw I.url=f.guardsResult,I}const y=new Ui(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot,!!f.guardsResult);this.triggerEvent(y)}),qr(f=>!!f.guardsResult||(this.restoreHistory(f),this.cancelNavigationTransition(f,""),!1)),ta(f=>{if(f.guards.canActivateChecks.length)return Ke(f).pipe((0,Wr.b)(y=>{const I=new yd(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot);this.triggerEvent(I)}),vn(y=>{let I=!1;return Ke(y).pipe(function Od(n,e){return(0,Pn.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Ke(t);let u=0;return(0,sn.D)(i).pipe(Wt(c=>function Kf(n,e,t,r){return function gy(n,e,t,r){const i=Object.keys(n);if(0===i.length)return Ke({});const u={};return(0,sn.D)(i).pipe((0,Pn.z)(c=>function Qg(n,e,t,r){const i=eu(n,e,r);return wn(i.resolve?i.resolve(e,t):i(e,t))}(n[c],e,t,r).pipe((0,Wr.b)(f=>{u[c]=f}))),Yo(1),(0,Pn.z)(()=>Object.keys(u).length===i.length?Ke(u):Ko.E))}(n._resolve,n,e,r).pipe((0,vt.U)(u=>(n._resolvedData=u,n.data=Object.assign(Object.assign({},n.data),qu(n,t).resolve),null)))}(c.route,r,n,e)),(0,Wr.b)(()=>u++),Yo(1),(0,Pn.z)(c=>u===i.length?Ke(t):Ko.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Wr.b)({next:()=>I=!0,complete:()=>{I||(this.restoreHistory(y),this.cancelNavigationTransition(y,"At least one route resolver didn't emit any value."))}}))}),(0,Wr.b)(y=>{const I=new Ha(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot);this.triggerEvent(I)}))}),ta(f=>{const{targetSnapshot:y,id:I,extractedUrl:S,rawUrl:A,extras:{skipLocationChange:M,replaceUrl:V}}=f;return this.hooks.afterPreactivation(y,{navigationId:I,appliedUrlTree:S,rawUrlTree:A,skipLocationChange:!!M,replaceUrl:!!V})}),(0,vt.U)(f=>{const y=function Z_(n,e,t){const r=oc(n,e._root,t?t._root:void 0);return new bd(r,e)}(this.routeReuseStrategy,f.targetSnapshot,f.currentRouterState);return Object.assign(Object.assign({},f),{targetRouterState:y})}),(0,Wr.b)(f=>{this.currentUrlTree=f.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(f.urlAfterRedirects,f.rawUrl),this.routerState=f.targetRouterState,"deferred"===this.urlUpdateStrategy&&(f.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,f),this.browserUrlTree=f.urlAfterRedirects)}),((n,e,t)=>(0,vt.U)(r=>(new kf(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,f=>this.triggerEvent(f)),(0,Wr.b)({next(){u=!0},complete(){u=!0}}),function wo(n){return(0,En.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>{var f;u||c||this.cancelNavigationTransition(i,`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`),(null===(f=this.currentNavigation)||void 0===f?void 0:f.id)===i.id&&(this.currentNavigation=null)}),Xr(f=>{if(c=!0,function Fg(n){return n&&n[Lg]}(f)){const y=Is(f.url);y||(this.navigated=!0,this.restoreHistory(i,!0));const I=new Fi(i.id,this.serializeUrl(i.extractedUrl),f.message);r.next(I),y?setTimeout(()=>{const S=this.urlHandlingStrategy.merge(f.url,this.rawUrlTree),A={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||_(i.source)};this.scheduleNavigation(S,"imperative",null,A,{resolve:i.resolve,reject:i.reject,promise:i.promise})},0):i.resolve(!1)}else{this.restoreHistory(i,!0);const y=new Og(i.id,this.serializeUrl(i.extractedUrl),f);r.next(y);try{i.resolve(this.errorHandler(f))}catch(I){i.reject(I)}}return Ko.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{var i;const u={replaceUrl:!0},c=(null===(i=t.state)||void 0===i?void 0:i.navigationId)?t.state:null;if(c){const y=Object.assign({},c);delete y.navigationId,delete y.\u0275routerPageId,0!==Object.keys(y).length&&(u.state=y)}const f=this.parseUrl(t.url);this.scheduleNavigation(f,r,c,u)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){xd(t),this.config=t.map(Lf),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:u,fragment:c,queryParamsHandling:f,preserveFragment:y}=r,I=i||this.routerState.root,S=y?this.currentUrlTree.fragment:c;let A=null;switch(f){case"merge":A=Object.assign(Object.assign({},this.currentUrlTree.queryParams),u);break;case"preserve":A=this.currentUrlTree.queryParams;break;default:A=u||null}return null!==A&&(A=this.removeEmptyProps(A)),function z_(n,e,t,r,i){if(0===t.length)return $g(e.root,e.root,e,r,i);const u=function Hg(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new K_(!0,0,n);let e=0,t=!1;const r=n.reduce((i,u,c)=>{if("object"==typeof u&&null!=u){if(u.outlets){const f={};return mr(u.outlets,(y,I)=>{f[I]="string"==typeof y?y.split("/"):y}),[...i,{outlets:f}]}if(u.segmentPath)return[...i,u.segmentPath]}return"string"!=typeof u?[...i,u]:0===c?(u.split("/").forEach((f,y)=>{0==y&&"."===f||(0==y&&""===f?t=!0:".."===f?e++:""!=f&&i.push(f))}),i):[...i,u]},[]);return new K_(t,e,r)}(t);if(u.toRoot())return $g(e.root,new Q([],{}),e,r,i);const c=function Y_(n,e,t){if(n.isAbsolute)return new xf(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const u=t.snapshot._urlSegment;return new xf(u,u===e.root,0)}const r=Rf(n.commands[0])?0:1;return function Q_(n,e,t){let r=n,i=e,u=t;for(;u>i;){if(u-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new xf(r,!1,i-u)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+r,n.numberOfDoubleDots)}(u,e,n),f=c.processChildren?Sd(c.segmentGroup,c.index,u.commands):X_(c.segmentGroup,c.index,u.commands);return $g(c.segmentGroup,f,e,r,i)}(I,this.currentUrlTree,t,A,null!=S?S:null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=Is(t)?t:this.parseUrl(t),u=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(u,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function _y(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?Object.assign({},Yf):!1===r?Object.assign({},my):r,Is(t))return Bu(this.currentUrlTree,t,i);const u=this.parseUrl(t);return Bu(this.currentUrlTree,u,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const u=t[i];return null!=u&&(r[i]=u),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Qo(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,r,i,u,c){var f,y,I;if(this.disposed)return Promise.resolve(!1);const S=this.transitions.value,A=_(r)&&S&&!_(S.source),M=S.rawUrl.toString()===t.toString(),V=S.id===(null===(f=this.currentNavigation)||void 0===f?void 0:f.id);if(A&&M&&V)return Promise.resolve(!0);let ye,Pe,_t;c?(ye=c.resolve,Pe=c.reject,_t=c.promise):_t=new Promise((lt,un)=>{ye=lt,Pe=un});const wt=++this.navigationId;let It;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),It=i&&i.\u0275routerPageId?i.\u0275routerPageId:u.replaceUrl||u.skipLocationChange?null!==(y=this.browserPageId)&&void 0!==y?y:0:(null!==(I=this.browserPageId)&&void 0!==I?I:0)+1):It=0,this.setTransition({id:wt,targetPageId:It,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:u,resolve:ye,reject:Pe,promise:_t,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),_t.catch(lt=>Promise.reject(lt))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),u=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",u):this.location.go(i,"",u)}restoreHistory(t,r=!1){var i,u;if("computed"===this.canceledNavigationResolution){const c=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===c?this.currentUrlTree===(null===(u=this.currentNavigation)||void 0===u?void 0:u.finalUrl)&&0===c&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(c)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r){const i=new Fi(t.id,this.serializeUrl(t.extractedUrl),r);this.triggerEvent(i),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){m.$Z()},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();function _(n){return"imperative"!==n}let p=(()=>{class n{constructor(t,r,i){this.router=t,this.route=r,this.locationStrategy=i,this.commands=null,this.href=null,this.onChanges=new Gs.x,this.subscription=t.events.subscribe(u=>{u instanceof Qo&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:null}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,r,i,u,c){if(0!==t||r||i||u||c||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const f={skipLocationChange:w(this.skipLocationChange),replaceUrl:w(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,f),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:w(this.preserveFragment)})}}return n.\u0275fac=function(t){return new(t||n)(m.Y36(ni),m.Y36(os),m.Y36(K))},n.\u0275dir=m.lG2({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,r){1&t&&m.NdJ("click",function(u){return r.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),2&t&&m.uIk("target",r.target)("href",r.href,m.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[m.TTD]}),n})();function w(n){return""===n||!!n}class ${}class Ne{preload(e,t){return Ke(null)}}let xe=(()=>{class n{constructor(t,r,i,u){this.router=t,this.injector=i,this.preloadingStrategy=u,this.loader=new Ts(i,r,y=>t.triggerEvent(new Ks(y)),y=>t.triggerEvent(new Ql(y)))}setUpPreloading(){this.subscription=this.router.events.pipe(qr(t=>t instanceof Qo),Wt(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(m.h0i);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const u of r)if(u.loadChildren&&!u.canLoad&&u._loadedConfig){const c=u._loadedConfig;i.push(this.processRoutes(c.module,c.routes))}else u.loadChildren&&!u.canLoad?i.push(this.preloadConfig(t,u)):u.children&&i.push(this.processRoutes(t,u.children));return(0,sn.D)(i).pipe((0,Zo.J)(),(0,vt.U)(u=>{}))}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?Ke(r._loadedConfig):this.loader.load(t.injector,r)).pipe((0,Pn.z)(u=>(r._loadedConfig=u,this.processRoutes(u.module,u.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(ni),m.LFG(m.Sil),m.LFG(m.zs3),m.LFG($))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})(),Qe=(()=>{class n{constructor(t,r,i={}){this.router=t,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof In?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Qo&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Wa&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new Wa(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){m.$Z()},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();const Tt=new m.OlP("ROUTER_CONFIGURATION"),Qn=new m.OlP("ROUTER_FORROOT_GUARD"),na=[Ve,{provide:Kt,useClass:Gr},{provide:ni,useFactory:function Xf(n,e,t,r,i,u,c={},f,y){const I=new ni(null,n,e,t,r,i,Za(u));return f&&(I.urlHandlingStrategy=f),y&&(I.routeReuseStrategy=y),function Ju(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(c,I),c.enableTracing&&I.events.subscribe(S=>{var A,M;null===(A=console.group)||void 0===A||A.call(console,`Router Event: ${S.constructor.name}`),console.log(S.toString()),console.log(S),null===(M=console.groupEnd)||void 0===M||M.call(console)}),I},deps:[Kt,zu,Ve,m.zs3,m.Sil,yc,Tt,[class Fd{},new m.FiY],[class ti{},new m.FiY]]},zu,{provide:os,useFactory:function wc(n){return n.routerState.root},deps:[ni]},xe,Ne,class ne{preload(e,t){return t().pipe(Xr(()=>Ke(null)))}},{provide:Tt,useValue:{enableTracing:!1}}];function ru(){return new m.PXZ("Router",ni)}let Vd=(()=>{class n{constructor(t,r){}static forRoot(t,r){return{ngModule:n,providers:[na,vc(t),{provide:Qn,useFactory:jd,deps:[[ni,new m.FiY,new m.tp0]]},{provide:Tt,useValue:r||{}},{provide:K,useFactory:Jf,deps:[ae,[new m.tBr(ge),new m.FiY],Tt]},{provide:Qe,useFactory:Qf,deps:[ni,Ul,Tt]},{provide:$,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:Ne},{provide:m.PXZ,multi:!0,useFactory:ru},[$d,{provide:m.ip1,multi:!0,useFactory:Ec,deps:[$d]},{provide:em,useFactory:Xg,deps:[$d]},{provide:m.tb,multi:!0,useExisting:em}]]}}static forChild(t){return{ngModule:n,providers:[vc(t)]}}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(Qn,8),m.LFG(ni,8))},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({}),n})();function Qf(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new Qe(n,e,t)}function Jf(n,e,t={}){return t.useHash?new me(n,e):new be(n,e)}function jd(n){return"guarded"}function vc(n){return[{provide:m.deG,multi:!0,useValue:n},{provide:yc,multi:!0,useValue:n}]}let $d=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Gs.x}appInitializer(){return this.injector.get(H,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const i=new Promise(f=>r=f),u=this.injector.get(ni),c=this.injector.get(Tt);return"disabled"===c.initialNavigation?(u.setUpLocationChangeListener(),r(!0)):"enabled"===c.initialNavigation||"enabledBlocking"===c.initialNavigation?(u.hooks.afterPreactivation=()=>this.initNavigation?Ke(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),u.initialNavigation()):r(!0),i})}bootstrapListener(t){const r=this.injector.get(Tt),i=this.injector.get(xe),u=this.injector.get(Qe),c=this.injector.get(ni),f=this.injector.get(m.z2F);t===f.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&c.initialNavigation(),i.setUpPreloading(),u.init(),c.resetRootComponentType(f.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(m.zs3))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();function Ec(n){return n.appInitializer.bind(n)}function Xg(n){return n.bootstrapListener.bind(n)}const em=new m.OlP("Router Initializer");let z0=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-admin-orders"]],decls:2,vars:0,template:function(t,r){1&t&&(m.TgZ(0,"p"),m._uU(1,"admin-orders works!"),m.qZA())},styles:[""]}),n})(),hC=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-admin-products"]],decls:2,vars:0,template:function(t,r){1&t&&(m.TgZ(0,"p"),m._uU(1,"admin-products works!"),m.qZA())},styles:[""]}),n})(),fC=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-admin-users"]],decls:2,vars:0,template:function(t,r){1&t&&(m.TgZ(0,"p"),m._uU(1,"admin-users works!"),m.qZA())},styles:[""]}),n})(),K0=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-checkout"]],decls:2,vars:0,template:function(t,r){1&t&&(m.TgZ(0,"p"),m._uU(1,"checkout works!"),m.qZA())},styles:[""]}),n})(),yy=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-home"]],decls:2,vars:0,template:function(t,r){1&t&&(m.TgZ(0,"p"),m._uU(1,"home works!"),m.qZA())},styles:[""]}),n})();var Hd=L(127),Y0=L(6451),tp=L(5363),pC=L(6063);class Q0 extends Gs.x{constructor(e=1/0,t=1/0,r=pC.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:u,_windowTime:c}=this;t||(r.push(e),!i&&r.push(u.now()+c)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,u=i.slice();for(let c=0;c<u.length&&!e.closed;c+=r?1:2)e.next(u[c]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,u=(i?1:2)*e;if(e<1/0&&u<r.length&&r.splice(0,r.length-u),!i){const c=t.now();let f=0;for(let y=1;y<r.length&&r[y]<=c;y+=2)f=y;f&&r.splice(0,f+1)}}}var J0=L(3099);function X0(n,e,t){var r,i;let u,c=!1;return n&&"object"==typeof n?(u=null!==(r=n.bufferSize)&&void 0!==r?r:1/0,e=null!==(i=n.windowTime)&&void 0!==i?i:1/0,c=!!n.refCount,t=n.scheduler):u=null!=n?n:1/0,(0,J0.B)({connector:()=>new Q0(u,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}function Xs(n,e){return(0,_d.m)(e)?vn(()=>n,e):vn(()=>n)}var vy=L(9468),Yt=L(5813),Pr=L(2011);L(5867);var fe=L(5861),ri=L(9681),ia=L(4859),O=L(2090),sa=L(1877);const np=new Map,nm={activated:!1,tokenObservers:[]},Iy={initialized:!1,enabled:!1};function yr(n){return np.get(n)||nm}function Cs(n,e){np.set(n,e)}function by(){return Iy}class bC{constructor(e,t,r,i,u){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=u,this.pending=null,this.nextErrorWaitInterval=i,i>u)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,fe.Z)(function*(){t.stop();try{t.pending=new O.BH,yield function Wx(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new O.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const pi=new O.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function im(n){if(!yr(n).activated)throw pi.create("use-before-activation",{appName:n.name})}function aE(n,e){return uE.apply(this,arguments)}function uE(){return(uE=(0,fe.Z)(function*({url:n,body:e},t){const r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});i&&(r["X-Firebase-Client"]=i.getPlatformInfoString());const u={method:"POST",body:JSON.stringify(e),headers:r};let c,f;try{c=yield fetch(n,u)}catch(A){throw pi.create("fetch-network-error",{originalErrorMessage:A.message})}if(200!==c.status)throw pi.create("fetch-status-error",{httpStatus:c.status});try{f=yield c.json()}catch(A){throw pi.create("fetch-parse-error",{originalErrorMessage:A.message})}const y=f.ttl.match(/^([\d.]+)(s)$/);if(!y||!y[2]||isNaN(Number(y[1])))throw pi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${f.ttl}`});const I=1e3*Number(y[1]),S=Date.now();return{token:f.attestationToken,expireTimeMillis:S+I,issuedAtTimeMillis:S}})).apply(this,arguments)}function Kx(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1beta/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const eo="firebase-app-check-store";let om=null;function Sy(){return om||(om=new Promise((n,e)=>{try{const t=indexedDB.open("firebase-app-check-database",1);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(pi.create("storage-open",{originalErrorMessage:null===(i=r.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(eo,{keyPath:"compositeKey"})}}catch(t){e(pi.create("storage-open",{originalErrorMessage:t.message}))}}),om)}function am(){return(am=(0,fe.Z)(function*(n,e){const r=(yield Sy()).transaction(eo,"readwrite"),u=r.objectStore(eo).put({compositeKey:n,value:e});return new Promise((c,f)=>{u.onsuccess=y=>{c()},r.onerror=y=>{var I;f(pi.create("storage-set",{originalErrorMessage:null===(I=y.target.error)||void 0===I?void 0:I.message}))}})})).apply(this,arguments)}const qd=new sa.Yd("@firebase/app-check");function Wd(n,e){return(0,O.hl)()?function lE(n,e){return function iu(n,e){return am.apply(this,arguments)}(function dE(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{qd.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Ic(){return by().enabled}function Zd(){return el.apply(this,arguments)}function el(){return(el=(0,fe.Z)(function*(){const n=by();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const hE={error:"UNKNOWN_ERROR"};function fE(n){return O.US.encodeString(JSON.stringify(n),!1)}function zd(n){return sp.apply(this,arguments)}function sp(){return(sp=(0,fe.Z)(function*(n,e=!1){const t=n.app;im(t);const r=yr(t);let u,i=r.token;if(!i){const y=yield r.cachedTokenPromise;y&&op(y)&&(i=y)}if(!e&&i&&op(i))return{token:i.token};let f,c=!1;if(Ic()){r.exchangeTokenPromise||(r.exchangeTokenPromise=aE(Kx(t,yield Zd()),n.platformLoggerProvider).then(I=>(r.exchangeTokenPromise=void 0,I)),c=!0);const y=yield r.exchangeTokenPromise;return yield Wd(t,y),Cs(t,Object.assign(Object.assign({},r),{token:y})),{token:y.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(y=>(r.exchangeTokenPromise=void 0,y)),c=!0),i=yield r.exchangeTokenPromise}catch(y){"appCheck/throttled"===y.code?qd.warn(y.message):qd.error(y),u=y}return i?(f={token:i.token},Cs(t,Object.assign(Object.assign({},r),{token:i})),yield Wd(t,i)):f=mE(u),c&&SC(t,f),f})).apply(this,arguments)}function Kd(n,e){const t=yr(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),Cs(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function pE(n){const{app:e}=n,t=yr(e);let r=t.tokenRefresher;r||(r=function gE(n){const{app:e}=n;return new bC((0,fe.Z)(function*(){let r;if(r=yr(e).token?yield zd(n,!0):yield zd(n),r.error)throw r.error}),()=>!0,()=>{const t=yr(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),Cs(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function SC(n,e){const t=yr(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch(i){}}function op(n){return n.expireTimeMillis-Date.now()>0}function mE(n){return{token:fE(hE),error:n}}class AC{constructor(e,t){this.app=e,this.platformLoggerProvider=t}_delete(){const{tokenObservers:e}=yr(this.app);for(const t of e)Kd(this.app,t.next);return Promise.resolve()}}const CE="app-check-internal";!function nP(){(0,ri._registerComponent)(new ia.wA("app-check",n=>function _E(n,e){return new AC(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("platform-logger")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(CE).initialize()})),(0,ri._registerComponent)(new ia.wA(CE,n=>function RC(n){return{getToken:e=>zd(n,e),addTokenListener:e=>function um(n,e,t,r){const{app:i}=n,u=yr(i),c={next:t,error:r,type:e};if(Cs(i,Object.assign(Object.assign({},u),{tokenObservers:[...u.tokenObservers,c]})),u.token&&op(u.token)){const f=u.token;Promise.resolve().then(()=>{t({token:f.token}),pE(n)}).catch(()=>{})}u.cachedTokenPromise.then(()=>pE(n))}(n,"INTERNAL",e),removeTokenListener:e=>Kd(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,ri.registerVersion)("@firebase/app-check","0.5.3")}();class lp{constructor(){return(0,Yt.vb)("app-check")}}"undefined"!=typeof window&&window;const lm=new m.OlP("angularfire2.auth.use-emulator"),cm=new m.OlP("angularfire2.auth.settings"),dm=new m.OlP("angularfire2.auth.tenant-id"),hm=new m.OlP("angularfire2.auth.langugage-code"),Eo=new m.OlP("angularfire2.auth.use-device-language"),Yd=new m.OlP("angularfire.auth.persistence"),Fy=(n,e,t,r,i,u,c,f)=>(0,Pr.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const y=e.runOutsideAngular(()=>n.auth());if(t&&y.useEmulator(...t),r&&(y.tenantId=r),y.languageCode=i,u&&y.useDeviceLanguage(),c)for(const[I,S]of Object.entries(c))y.settings[I]=S;return f&&y.setPersistence(f),y},[t,r,i,u,c,f]);let dp=(()=>{class n{constructor(t,r,i,u,c,f,y,I,S,A,M,V){const z=new Gs.x,ye=Ke(void 0).pipe((0,tp.Q)(c.outsideAngular),vn(()=>u.runOutsideAngular(()=>Promise.resolve().then(L.bind(L,5735)))),(0,vt.U)(()=>(0,Pr.on)(t,u,r)),(0,vt.U)(Pe=>Fy(Pe,u,f,I,S,A,y,M)),X0({bufferSize:1,refCount:!1}));if(ba(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Ke(null);else{ye.pipe($a()).subscribe();const _t=ye.pipe(vn(lt=>lt.getRedirectResult().then(un=>un,()=>null)),Yt.iC,X0({bufferSize:1,refCount:!1})),wt=ye.pipe(vn(lt=>new sr.y(un=>({unsubscribe:u.runOutsideAngular(()=>lt.onAuthStateChanged(bi=>un.next(bi),bi=>un.error(bi),()=>un.complete()))})))),It=ye.pipe(vn(lt=>new sr.y(un=>({unsubscribe:u.runOutsideAngular(()=>lt.onIdTokenChanged(bi=>un.next(bi),bi=>un.error(bi),()=>un.complete()))}))));this.authState=_t.pipe(Xs(wt),(0,vy.R)(c.outsideAngular),(0,tp.Q)(c.insideAngular)),this.user=_t.pipe(Xs(It),(0,vy.R)(c.outsideAngular),(0,tp.Q)(c.insideAngular)),this.idToken=this.user.pipe(vn(lt=>lt?(0,sn.D)(lt.getIdToken()):Ke(null))),this.idTokenResult=this.user.pipe(vn(lt=>lt?(0,sn.D)(lt.getIdTokenResult()):Ke(null))),this.credential=(0,Y0.T)(_t,z,this.authState.pipe(qr(lt=>!lt))).pipe((0,vt.U)(lt=>(null==lt?void 0:lt.user)?lt:null),(0,vy.R)(c.outsideAngular),(0,tp.Q)(c.insideAngular))}return(0,Pr.pX)(this,ye,u,{spy:{apply:(Pe,_t,wt)=>{(Pe.startsWith("signIn")||Pe.startsWith("createUser"))&&wt.then(It=>z.next(It))}}})}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(Pr.Dh),m.LFG(Pr.xv,8),m.LFG(m.Lbi),m.LFG(m.R0b),m.LFG(Yt.HU),m.LFG(lm,8),m.LFG(cm,8),m.LFG(dm,8),m.LFG(hm,8),m.LFG(Eo,8),m.LFG(Yd,8),m.LFG(lp,8))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),uP=(()=>{class n{constructor(){Hd.Z.registerVersion("angularfire",Yt.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({providers:[dp]}),n})(),bc=(()=>{class n{constructor(t,r){this.afauth=t,this.router=r,this.user$=t.authState}login(){this.afauth.signInWithRedirect(new Hd.Z.auth.GoogleAuthProvider)}logout(){this.afauth.signOut()}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(dp),m.LFG(os))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),PE=(()=>{class n{constructor(t){this.service=t}ngOnInit(){}login(){this.service.login()}}return n.\u0275fac=function(t){return new(t||n)(m.Y36(bc))},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-login"]],decls:10,vars:0,consts:[[1,"container"],[1,"row","mx-0"],[1,"col-lg-4","mx-auto"],[1,"form-signin"],[1,"text-center"],["src","https://getbootstrap.com/docs/5.1/assets/brand/bootstrap-logo.svg","alt","","width","72","height","57",1,"mb-4"],[1,"h3","mb-3","fw-normal","text-center"],[1,"w-100","btn","btn-lg","btn-primary",3,"click"]],template:function(t,r){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"main",3),m.TgZ(4,"div",4),m._UZ(5,"img",5),m.qZA(),m.TgZ(6,"h1",6),m._uU(7,"Please sign in"),m.qZA(),m.TgZ(8,"button",7),m.NdJ("click",function(){return r.login()}),m._uU(9," Sign in with google "),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA())},styles:[""]}),n})(),Uy=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-my-orders"]],decls:2,vars:0,template:function(t,r){1&t&&(m.TgZ(0,"p"),m._uU(1,"my-orders works!"),m.qZA())},styles:[""]}),n})(),hp=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-order-success"]],decls:2,vars:0,template:function(t,r){1&t&&(m.TgZ(0,"p"),m._uU(1,"order-success works!"),m.qZA())},styles:[""]}),n})(),VC=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-products"]],decls:2,vars:0,template:function(t,r){1&t&&(m.TgZ(0,"p"),m._uU(1,"products works!"),m.qZA())},styles:[""]}),n})(),By=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-shopping-cart"]],decls:185,vars:0,consts:[[1,"container"],[1,"py-5","text-center"],["src","https://getbootstrap.com/docs/5.1/assets/brand/bootstrap-logo.svg","alt","","width","72","height","57",1,"d-block","mx-auto","mb-4"],[1,"lead"],[1,"row","g-5"],[1,"col-md-5","col-lg-4","order-md-last"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"text-primary"],[1,"badge","bg-primary","rounded-pill"],[1,"list-group","mb-3"],[1,"list-group-item","d-flex","justify-content-between","lh-sm"],[1,"my-0"],[1,"text-muted"],[1,"list-group-item","d-flex","justify-content-between","bg-light"],[1,"text-success"],[1,"list-group-item","d-flex","justify-content-between"],[1,"card","p-2"],[1,"input-group"],["type","text","placeholder","Promo code",1,"form-control"],["type","submit",1,"btn","btn-secondary"],[1,"col-md-7","col-lg-8"],[1,"mb-3"],["novalidate","",1,"needs-validation"],[1,"row","g-3"],[1,"col-sm-6"],["for","firstName",1,"form-label"],["type","text","id","firstName","placeholder","","value","","required","",1,"form-control"],[1,"invalid-feedback"],["for","lastName",1,"form-label"],["type","text","id","lastName","placeholder","","value","","required","",1,"form-control"],[1,"col-12"],["for","username",1,"form-label"],[1,"input-group","has-validation"],[1,"input-group-text"],["type","text","id","username","placeholder","Username","required","",1,"form-control"],["for","email",1,"form-label"],["type","email","id","email","placeholder","you@example.com",1,"form-control"],["for","address",1,"form-label"],["type","text","id","address","placeholder","1234 Main St","required","",1,"form-control"],["for","address2",1,"form-label"],["type","text","id","address2","placeholder","Apartment or suite",1,"form-control"],[1,"col-md-5"],["for","country",1,"form-label"],["id","country","required","",1,"form-select"],["value",""],[1,"col-md-4"],["for","state",1,"form-label"],["id","state","required","",1,"form-select"],[1,"col-md-3"],["for","zip",1,"form-label"],["type","text","id","zip","placeholder","","required","",1,"form-control"],[1,"my-4"],[1,"form-check"],["type","checkbox","id","same-address",1,"form-check-input"],["for","same-address",1,"form-check-label"],["type","checkbox","id","save-info",1,"form-check-input"],["for","save-info",1,"form-check-label"],[1,"my-3"],["id","credit","name","paymentMethod","type","radio","checked","","required","",1,"form-check-input"],["for","credit",1,"form-check-label"],["id","debit","name","paymentMethod","type","radio","required","",1,"form-check-input"],["for","debit",1,"form-check-label"],["id","paypal","name","paymentMethod","type","radio","required","",1,"form-check-input"],["for","paypal",1,"form-check-label"],[1,"row","gy-3"],[1,"col-md-6"],["for","cc-name",1,"form-label"],["type","text","id","cc-name","placeholder","","required","",1,"form-control"],["for","cc-number",1,"form-label"],["type","text","id","cc-number","placeholder","","required","",1,"form-control"],["for","cc-expiration",1,"form-label"],["type","text","id","cc-expiration","placeholder","","required","",1,"form-control"],["for","cc-cvv",1,"form-label"],["type","text","id","cc-cvv","placeholder","","required","",1,"form-control"],["type","submit",1,"w-100","btn","btn-primary","btn-lg"]],template:function(t,r){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"main"),m.TgZ(2,"div",1),m._UZ(3,"img",2),m.TgZ(4,"h2"),m._uU(5,"Checkout form"),m.qZA(),m.TgZ(6,"p",3),m._uU(7,"Below is an example form built entirely with Bootstrap\u2019s form controls. Each required form group has a validation state that can be triggered by attempting to submit the form without completing it."),m.qZA(),m.qZA(),m.TgZ(8,"div",4),m.TgZ(9,"div",5),m.TgZ(10,"h4",6),m.TgZ(11,"span",7),m._uU(12,"Your cart"),m.qZA(),m.TgZ(13,"span",8),m._uU(14,"3"),m.qZA(),m.qZA(),m.TgZ(15,"ul",9),m.TgZ(16,"li",10),m.TgZ(17,"div"),m.TgZ(18,"h6",11),m._uU(19,"Product name"),m.qZA(),m.TgZ(20,"small",12),m._uU(21,"Brief description"),m.qZA(),m.qZA(),m.TgZ(22,"span",12),m._uU(23,"$12"),m.qZA(),m.qZA(),m.TgZ(24,"li",10),m.TgZ(25,"div"),m.TgZ(26,"h6",11),m._uU(27,"Second product"),m.qZA(),m.TgZ(28,"small",12),m._uU(29,"Brief description"),m.qZA(),m.qZA(),m.TgZ(30,"span",12),m._uU(31,"$8"),m.qZA(),m.qZA(),m.TgZ(32,"li",10),m.TgZ(33,"div"),m.TgZ(34,"h6",11),m._uU(35,"Third item"),m.qZA(),m.TgZ(36,"small",12),m._uU(37,"Brief description"),m.qZA(),m.qZA(),m.TgZ(38,"span",12),m._uU(39,"$5"),m.qZA(),m.qZA(),m.TgZ(40,"li",13),m.TgZ(41,"div",14),m.TgZ(42,"h6",11),m._uU(43,"Promo code"),m.qZA(),m.TgZ(44,"small"),m._uU(45,"EXAMPLECODE"),m.qZA(),m.qZA(),m.TgZ(46,"span",14),m._uU(47,"\u2212$5"),m.qZA(),m.qZA(),m.TgZ(48,"li",15),m.TgZ(49,"span"),m._uU(50,"Total (USD)"),m.qZA(),m.TgZ(51,"strong"),m._uU(52,"$20"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(53,"form",16),m.TgZ(54,"div",17),m._UZ(55,"input",18),m.TgZ(56,"button",19),m._uU(57,"Redeem"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(58,"div",20),m.TgZ(59,"h4",21),m._uU(60,"Billing address"),m.qZA(),m.TgZ(61,"form",22),m.TgZ(62,"div",23),m.TgZ(63,"div",24),m.TgZ(64,"label",25),m._uU(65,"First name"),m.qZA(),m._UZ(66,"input",26),m.TgZ(67,"div",27),m._uU(68," Valid first name is required. "),m.qZA(),m.qZA(),m.TgZ(69,"div",24),m.TgZ(70,"label",28),m._uU(71,"Last name"),m.qZA(),m._UZ(72,"input",29),m.TgZ(73,"div",27),m._uU(74," Valid last name is required. "),m.qZA(),m.qZA(),m.TgZ(75,"div",30),m.TgZ(76,"label",31),m._uU(77,"Username"),m.qZA(),m.TgZ(78,"div",32),m.TgZ(79,"span",33),m._uU(80,"@"),m.qZA(),m._UZ(81,"input",34),m.TgZ(82,"div",27),m._uU(83," Your username is required. "),m.qZA(),m.qZA(),m.qZA(),m.TgZ(84,"div",30),m.TgZ(85,"label",35),m._uU(86,"Email "),m.TgZ(87,"span",12),m._uU(88,"(Optional)"),m.qZA(),m.qZA(),m._UZ(89,"input",36),m.TgZ(90,"div",27),m._uU(91," Please enter a valid email address for shipping updates. "),m.qZA(),m.qZA(),m.TgZ(92,"div",30),m.TgZ(93,"label",37),m._uU(94,"Address"),m.qZA(),m._UZ(95,"input",38),m.TgZ(96,"div",27),m._uU(97," Please enter your shipping address. "),m.qZA(),m.qZA(),m.TgZ(98,"div",30),m.TgZ(99,"label",39),m._uU(100,"Address 2 "),m.TgZ(101,"span",12),m._uU(102,"(Optional)"),m.qZA(),m.qZA(),m._UZ(103,"input",40),m.qZA(),m.TgZ(104,"div",41),m.TgZ(105,"label",42),m._uU(106,"Country"),m.qZA(),m.TgZ(107,"select",43),m.TgZ(108,"option",44),m._uU(109,"Choose..."),m.qZA(),m.TgZ(110,"option"),m._uU(111,"United States"),m.qZA(),m.qZA(),m.TgZ(112,"div",27),m._uU(113," Please select a valid country. "),m.qZA(),m.qZA(),m.TgZ(114,"div",45),m.TgZ(115,"label",46),m._uU(116,"State"),m.qZA(),m.TgZ(117,"select",47),m.TgZ(118,"option",44),m._uU(119,"Choose..."),m.qZA(),m.TgZ(120,"option"),m._uU(121,"California"),m.qZA(),m.qZA(),m.TgZ(122,"div",27),m._uU(123," Please provide a valid state. "),m.qZA(),m.qZA(),m.TgZ(124,"div",48),m.TgZ(125,"label",49),m._uU(126,"Zip"),m.qZA(),m._UZ(127,"input",50),m.TgZ(128,"div",27),m._uU(129," Zip code required. "),m.qZA(),m.qZA(),m.qZA(),m._UZ(130,"hr",51),m.TgZ(131,"div",52),m._UZ(132,"input",53),m.TgZ(133,"label",54),m._uU(134,"Shipping address is the same as my billing address"),m.qZA(),m.qZA(),m.TgZ(135,"div",52),m._UZ(136,"input",55),m.TgZ(137,"label",56),m._uU(138,"Save this information for next time"),m.qZA(),m.qZA(),m._UZ(139,"hr",51),m.TgZ(140,"h4",21),m._uU(141,"Payment"),m.qZA(),m.TgZ(142,"div",57),m.TgZ(143,"div",52),m._UZ(144,"input",58),m.TgZ(145,"label",59),m._uU(146,"Credit card"),m.qZA(),m.qZA(),m.TgZ(147,"div",52),m._UZ(148,"input",60),m.TgZ(149,"label",61),m._uU(150,"Debit card"),m.qZA(),m.qZA(),m.TgZ(151,"div",52),m._UZ(152,"input",62),m.TgZ(153,"label",63),m._uU(154,"PayPal"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(155,"div",64),m.TgZ(156,"div",65),m.TgZ(157,"label",66),m._uU(158,"Name on card"),m.qZA(),m._UZ(159,"input",67),m.TgZ(160,"small",12),m._uU(161,"Full name as displayed on card"),m.qZA(),m.TgZ(162,"div",27),m._uU(163," Name on card is required "),m.qZA(),m.qZA(),m.TgZ(164,"div",65),m.TgZ(165,"label",68),m._uU(166,"Credit card number"),m.qZA(),m._UZ(167,"input",69),m.TgZ(168,"div",27),m._uU(169," Credit card number is required "),m.qZA(),m.qZA(),m.TgZ(170,"div",48),m.TgZ(171,"label",70),m._uU(172,"Expiration"),m.qZA(),m._UZ(173,"input",71),m.TgZ(174,"div",27),m._uU(175," Expiration date required "),m.qZA(),m.qZA(),m.TgZ(176,"div",48),m.TgZ(177,"label",72),m._uU(178,"CVV"),m.qZA(),m._UZ(179,"input",73),m.TgZ(180,"div",27),m._uU(181," Security code required "),m.qZA(),m.qZA(),m.qZA(),m._UZ(182,"hr",51),m.TgZ(183,"button",74),m._uU(184,"Continue to checkout"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA())},styles:[""]}),n})(),Tc=(()=>{class n{constructor(t,r){this.auth=t,this.router=r}canActivate(t,r){return this.auth.user$.pipe((0,vt.U)(i=>!!i||(this.router.navigate(["/login"],{queryParams:{returnUrl:r.url}}),!1)))}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(bc),m.LFG(ni))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const kE=[{path:"",component:yy},{path:"login",component:PE},{path:"products",component:VC},{path:"shopping-cart",component:By},{path:"checkout",component:K0,canActivate:[Tc]},{path:"order-success",component:hp,canActivate:[Tc]},{path:"my-orders",component:Uy},{path:"admin/products",component:hC,canActivate:[Tc]},{path:"admin/users",component:fC,canActivate:[Tc]},{path:"admin/orders",component:z0,canActivate:[Tc]}];let ME=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({imports:[[Vd.forRoot(kE)],Vd]}),n})();function jC(n,e){1&n&&(m.TgZ(0,"a",18),m._uU(1," Login "),m.qZA())}function Vy(n,e){if(1&n){const t=m.EpF();m.TgZ(0,"div",19),m.TgZ(1,"a",20),m._uU(2),m.qZA(),m.TgZ(3,"ul",21),m.TgZ(4,"li"),m.TgZ(5,"a",22),m.NdJ("click",function(){return m.CHM(t),m.oxw().logout()}),m._uU(6,"Logout"),m.qZA(),m.qZA(),m.qZA(),m.qZA()}if(2&n){const t=e.ngIf;m.xp6(2),m.hij(" ",t.displayName," ")}}let $C=(()=>{class n{constructor(t){this.service=t}ngOnInit(){}logout(){this.service.logout()}}return n.\u0275fac=function(t){return new(t||n)(m.Y36(bc))},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-header"]],decls:29,vars:4,consts:[[1,"header"],["aria-label","Main navigation",1,"navbar","navbar-expand-lg","fixed-top","navbar-dark","bg-dark"],[1,"container"],["routerLink","/",1,"navbar-brand"],["type","button","id","navbarSideCollapse","aria-label","Toggle navigation",1,"navbar-toggler","p-0","border-0"],[1,"navbar-toggler-icon"],["id","navbarsExampleDefault",1,"navbar-collapse","offcanvas-collapse","mr-5"],[1,"navbar-nav","mx-auto","mb-2","mb-lg-0"],[1,"nav-item","mx-3"],["aria-current","page","routerLink","/shopping-cart",1,"nav-link","active"],[1,"nav-item","mx-3","dropdown"],["href","#","id","dropdown01","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","dropdown-toggle"],["aria-labelledby","dropdown01",1,"dropdown-menu"],["routerLink","/my-orders",1,"dropdown-item"],["routerLink","/admin/orders",1,"dropdown-item"],["routerLink","/admin/products",1,"dropdown-item"],["anonymouse",""],["class","dropdown",4,"ngIf","ngIfElse"],["routerLink","/login",1,"nav-link","text-white","mx-3"],[1,"dropdown"],["href","#","id","dropdown02","data-bs-toggle","dropdown","aria-expanded","false",1,"text-white","dropdown-toggle"],["aria-labelledby","dropdown02",1,"dropdown-menu"],[1,"dropdown-item",2,"cursor","pointer",3,"click"]],template:function(t,r){if(1&t&&(m.TgZ(0,"header",0),m.TgZ(1,"nav",1),m.TgZ(2,"div",2),m.TgZ(3,"a",3),m._uU(4,"Souq"),m.qZA(),m.TgZ(5,"button",4),m._UZ(6,"span",5),m.qZA(),m.TgZ(7,"div",6),m.TgZ(8,"ul",7),m.TgZ(9,"li",8),m.TgZ(10,"a",9),m._uU(11,"Shopping Cart"),m.qZA(),m.qZA(),m.TgZ(12,"li",10),m.TgZ(13,"a",11),m._uU(14," Orders "),m.qZA(),m.TgZ(15,"ul",12),m.TgZ(16,"li"),m.TgZ(17,"a",13),m._uU(18,"My Orders"),m.qZA(),m.qZA(),m.TgZ(19,"li"),m.TgZ(20,"a",14),m._uU(21,"Manage Orders"),m.qZA(),m.qZA(),m.TgZ(22,"li"),m.TgZ(23,"a",15),m._uU(24,"Manage Products"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.YNc(25,jC,2,0,"ng-template",null,16,m.W1O),m.YNc(27,Vy,7,1,"div",17),m.ALo(28,"async"),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t){const i=m.MAs(26);m.xp6(27),m.Q6J("ngIf",m.lcZ(28,2,r.service.user$))("ngIfElse",i)}},directives:[p,jr],pipes:[Ml],styles:[""]}),n})(),HC=(()=>{class n{constructor(t,r,i){this.auth=t,this.router=r,this.auth.user$.subscribe(u=>{if(u){let c=this.router.snapshot.queryParamMap.get("returnUrl")||"/";i.navigateByUrl(c)}})}}return n.\u0275fac=function(t){return new(t||n)(m.Y36(bc),m.Y36(os),m.Y36(ni))},n.\u0275cmp=m.Xpm({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(t,r){1&t&&(m._UZ(0,"app-header"),m._UZ(1,"router-outlet"))},directives:[$C,lc],styles:[""]}),n})();const jy_firebase={projectId:"souq-1c5b8",appId:"1:639437724541:web:08fbd9ba4bf190409e8a14",storageBucket:"souq-1c5b8.appspot.com",apiKey:"AIzaSyCaIUqdIs8ovsB0qHSBZ0d0feHJ0W0I040",authDomain:"souq-1c5b8.firebaseapp.com",messagingSenderId:"639437724541",measurementId:"G-E8917CXZ50"};var tl=L(4986),$y=L(3942);const OE="firebasestorage.googleapis.com",Cc="storageBucket";class Jn extends O.ZR{constructor(e,t){super(Hy(e),`Firebase Storage: ${t} (${Hy(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Jn.prototype)}_codeEquals(e){return Hy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function Hy(n){return"storage/"+n}function us(){return new Jn("unknown","An unknown error occurred, please check the error payload for server response.")}function VE(){return new Jn("canceled","User canceled the upload/download.")}function KC(){return new Jn("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Qd(n){return new Jn("invalid-argument",n)}function QC(){return new Jn("app-deleted","The Firebase app was deleted.")}function JC(n){return new Jn("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Dc(n,e){return new Jn("invalid-format","String does not match format '"+n+"': "+e)}function fp(n){throw new Jn("internal-error","Internal error: "+n)}class ii{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ii.makeFromUrl(e,t)}catch(i){return new ii(e,"")}if(""===r.path)return r;throw function zC(n){return new Jn("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",f=new RegExp("^gs://"+i+"(/(.*))?$","i");function I(lt){lt.path_=decodeURIComponent(lt.path)}const A=t.replace(/[.]/g,"\\."),It=[{regex:f,indices:{bucket:1,path:3},postModify:function u(lt){"/"===lt.path.charAt(lt.path.length-1)&&(lt.path_=lt.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${A}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:I},{regex:new RegExp(`^https?://${t===OE?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:I}];for(let lt=0;lt<It.length;lt++){const un=It[lt],bi=un.regex.exec(e);if(bi){let j0=bi[un.indices.path];j0||(j0=""),r=new ii(bi[un.indices.bucket],j0),un.postModify(r);break}}if(null==r)throw function ZC(n){return new Jn("invalid-url","Invalid URL '"+n+"'.")}(e);return r}}class HE{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function pp(n){return"string"==typeof n||n instanceof String}function Wy(n){return Gy()&&n instanceof Blob}function Gy(){return"undefined"!=typeof Blob}function WE(n,e,t,r){if(r<e)throw Qd(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Qd(`Invalid value for '${n}'. Expected ${t} or less.`)}function oa(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Zy(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var nl=(()=>{return(n=nl||(nl={}))[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",nl;var n})();class zy{constructor(e,t,r,i,u,c,f,y,I,S,A){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=u,this.additionalRetryCodes_=c,this.callback_=f,this.errorCallback_=y,this.timeout_=I,this.progressCallback_=S,this.connectionFactory_=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((M,V)=>{this.resolve_=M,this.reject_=V,this.start_()})}start_(){const t=(r,i)=>{const u=this.resolve_,c=this.reject_,f=i.connection;if(i.wasSuccessCode)try{const y=this.callback_(f,f.getResponse());!function cP(n){return void 0!==n}(y)?u():u(y)}catch(y){c(y)}else if(null!==f){const y=us();y.serverResponse=f.getErrorText(),c(this.errorCallback_?this.errorCallback_(f,y):y)}else c(i.canceled?this.appDelete_?QC():VE():function GC(){return new Jn("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}())};this.canceled_?t(0,new fm(!1,null,!0)):this.backoffId_=function lP(n,e,t){let r=1,i=null,u=null,c=!1,f=0;function y(){return 2===f}let I=!1;function S(...Pe){I||(I=!0,e.apply(null,Pe))}function A(Pe){i=setTimeout(()=>{i=null,n(V,y())},Pe)}function M(){u&&clearTimeout(u)}function V(Pe,..._t){if(I)return void M();if(Pe)return M(),void S.call(null,Pe,..._t);if(y()||c)return M(),void S.call(null,Pe,..._t);let It;r<64&&(r*=2),1===f?(f=2,It=0):It=1e3*(r+Math.random()),A(It)}let z=!1;function ye(Pe){z||(z=!0,M(),!I&&(null!==i?(Pe||(f=2),clearTimeout(i),A(0)):Pe||(f=1)))}return A(0),u=setTimeout(()=>{c=!0,ye(!0)},t),ye}((r,i)=>{if(i)return void r(!1,new fm(!1,null,!0));const u=this.connectionFactory_();this.pendingConnection_=u;const c=f=>{null!==this.progressCallback_&&this.progressCallback_(f.loaded,f.lengthComputable?f.total:-1)};null!==this.progressCallback_&&u.addUploadProgressListener(c),u.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&u.removeUploadProgressListener(c),this.pendingConnection_=null;const f=u.getErrorCode()===nl.NO_ERROR,y=u.getStatus();if(!f||this.isRetryStatusCode_(y)){const S=u.getErrorCode()===nl.ABORT;return void r(!1,new fm(!1,null,S))}const I=-1!==this.successCodes_.indexOf(y);r(!0,new fm(I,u))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function Io(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,i=-1!==[408,429].indexOf(e),u=-1!==this.additionalRetryCodes_.indexOf(e);return t||i||u}}class fm{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Jd(...n){const e=function pm(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(Gy())return new Blob(n);throw new Jn("unsupported-environment","This browser doesn't seem to support creating Blobs")}const Ss={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ky{constructor(e,t){this.data=e,this.contentType=t||null}}function mp(n,e){switch(n){case Ss.RAW:return new Ky(bo(e));case Ss.BASE64:case Ss.BASE64URL:return new Ky(si(n,e));case Ss.DATA_URL:return new Ky(function gm(n){const e=new rl(n);return e.base64?si(Ss.BASE64,e.rest):function _p(n){let e;try{e=decodeURIComponent(n)}catch(t){throw Dc(Ss.DATA_URL,"Malformed data URL.")}return bo(e)}(e.rest)}(e),function no(n){return new rl(n).contentType}(e))}throw us()}function bo(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function si(n,e){switch(n){case Ss.BASE64:{const i=-1!==e.indexOf("-"),u=-1!==e.indexOf("_");if(i||u)throw Dc(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Ss.BASE64URL:{const i=-1!==e.indexOf("+"),u=-1!==e.indexOf("/");if(i||u)throw Dc(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function gp(n){return atob(n)}(e)}catch(i){throw Dc(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class rl{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Dc(Ss.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function Yy(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-";base64".length):r),this.rest=e.substring(e.indexOf(",")+1)}}class Wi{constructor(e,t){let r=0,i="";Wy(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Wy(this.data_)){const i=function iD(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new Wi(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Wi(r,!0)}}static getBlob(...e){if(Gy()){const t=e.map(r=>r instanceof Wi?r.data_:r);return new Wi(Jd.apply(null,t))}{const t=e.map(c=>pp(c)?mp(Ss.RAW,c).data:c.data_);let r=0;t.forEach(c=>{r+=c.byteLength});const i=new Uint8Array(r);let u=0;return t.forEach(c=>{for(let f=0;f<c.length;f++)i[u++]=c[f]}),new Wi(i,!0)}}uploadData(){return this.data_}}function il(n){let e;try{e=JSON.parse(n)}catch(t){return null}return function qE(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function Sc(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function th(n,e){return e}class vr{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||th}}let su=null;function rh(){if(su)return su;const n=[];n.push(new vr("bucket")),n.push(new vr("generation")),n.push(new vr("metageneration")),n.push(new vr("name","fullPath",!0));const t=new vr("name");t.xform=function e(u,c){return function nh(n){return!pp(n)||n.length<2?n:Sc(n)}(c)},n.push(t);const i=new vr("size");return i.xform=function r(u,c){return void 0!==c?Number(c):c},n.push(i),n.push(new vr("timeCreated")),n.push(new vr("updated")),n.push(new vr("md5Hash",null,!0)),n.push(new vr("cacheControl",null,!0)),n.push(new vr("contentDisposition",null,!0)),n.push(new vr("contentEncoding",null,!0)),n.push(new vr("contentLanguage",null,!0)),n.push(new vr("contentType",null,!0)),n.push(new vr("metadata","customMetadata",!0)),su=n,su}function Qy(n,e,t){const r=il(e);return null===r?null:function ZE(n,e,t){const r={type:"file"},i=t.length;for(let u=0;u<i;u++){const c=t[u];r[c.local]=c.xform(r,e[c.server])}return function GE(n,e){Object.defineProperty(n,"ref",{get:function t(){const u=new ii(n.bucket,n.fullPath);return e._makeStorageReference(u)}})}(r,n),r}(n,r,t)}function mm(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const u=e[i];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const Jy="prefixes";class To{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function aa(n){if(!n)throw us()}function yp(n,e){return function t(r,i){const u=Qy(n,i,e);return aa(null!==u),u}}function ih(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function UE(){return new Jn("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function FE(){return new Jn("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function LE(n){return new Jn("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function BE(n){return new Jn("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):r,i.serverResponse=r.serverResponse,i}}function sh(n){const e=ih(n);return function t(r,i){let u=e(r,i);return 404===r.getStatus()&&(u=function qy(n){return new Jn("object-not-found","Object '"+n+"' does not exist.")}(n.path)),u.serverResponse=i.serverResponse,u}}function QE(n,e,t){const i=oa(e.fullServerUrl(),n.host,n._protocol),c=n.maxOperationRetryTime,f=new To(i,"GET",yp(n,t),c);return f.errorHandler=sh(e),f}function JE(n,e,t,r,i){const u={};u.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(u.delimiter=t),r&&(u.pageToken=r),i&&(u.maxResults=i);const f=oa(e.bucketOnlyServerUrl(),n.host,n._protocol),I=n.maxOperationRetryTime,S=new To(f,"GET",function YE(n,e){return function t(r,i){const u=function sD(n,e,t){const r=il(t);return null===r?null:function KE(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Jy])for(const i of t[Jy]){const u=i.replace(/\/$/,""),c=n._makeStorageReference(new ii(e,u));r.prefixes.push(c)}if(t.items)for(const i of t.items){const u=n._makeStorageReference(new ii(e,i.name));r.items.push(u)}return r}(n,e,r)}(n,e,i);return aa(null!==u),u}}(n,e.bucket),I);return S.urlParams=u,S.errorHandler=ih(e),S}function _m(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function ev(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class tv{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function tI(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch(i){aa(!1)}return aa(!!t&&-1!==(e||["active"]).indexOf(t)),t}const cD={STATE_CHANGED:"state_changed"},wr={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function rv(n){switch(n){case"running":case"pausing":case"canceling":return wr.RUNNING;case"paused":return wr.PAUSED;case"success":return wr.SUCCESS;case"canceled":return wr.CANCELED;default:return wr.ERROR}}class nI{constructor(e,t,r){if(function dP(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=r?r:void 0;else{const u=e;this.next=u.next,this.error=u.error,this.complete=u.complete}}}function oh(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class dD extends class ym{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=nl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=nl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=nl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw fp("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const u in i)i.hasOwnProperty(u)&&this.xhr_.setRequestHeader(u,i[u].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw fp("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw fp("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw fp("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw fp("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function ro(){return new dD}class rI{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=rh(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=i,this._transition("error"))},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this._promise=new Promise((i,u)=>{this._resolve=i,this._reject=u,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function fP(n,e,t,r,i){const u=e.bucketOnlyServerUrl(),c=_m(e,r,i),f={name:c.fullPath},y=oa(u,n.host,n._protocol),S={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},A=mm(c,t),z=new To(y,"POST",function V(ye){let Pe;tI(ye);try{Pe=ye.getResponseHeader("X-Goog-Upload-URL")}catch(_t){aa(!1)}return aa(pp(Pe)),Pe},n.maxUploadRetryTime);return z.urlParams=f,z.headers=S,z.body=A,z.errorHandler=ih(e),z}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ro,e,t);this._request=i,i.getPromise().then(u=>{this._request=void 0,this._uploadUrl=u,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function lD(n,e,t,r){const y=new To(t,"POST",function u(I){const S=tI(I,["active","final"]);let A=null;try{A=I.getResponseHeader("X-Goog-Upload-Size-Received")}catch(V){aa(!1)}A||aa(!1);const M=Number(A);return aa(!isNaN(M)),new tv(M,r.size(),"final"===S)},n.maxUploadRetryTime);return y.headers={"X-Goog-Upload-Command":"query"},y.errorHandler=ih(e),y}(this._ref.storage,this._ref._location,e,this._blob),u=this._ref.storage._makeRequest(i,ro,t,r);this._request=u,u.getPromise().then(c=>{c=c,this._request=void 0,this._updateProgress(c.current),this._needToFetchStatus=!1,c.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new tv(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,u)=>{let c;try{c=function pP(n,e,t,r,i,u,c,f){const y=new tv(0,0);if(c?(y.current=c.current,y.total=c.total):(y.current=0,y.total=r.size()),r.size()!==y.total)throw function $E(){return new Jn("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const I=y.total-y.current;let S=I;i>0&&(S=Math.min(S,i));const A=y.current,z={"X-Goog-Upload-Command":S===I?"upload, finalize":"upload","X-Goog-Upload-Offset":`${y.current}`},ye=r.slice(A,A+S);if(null===ye)throw KC();const It=new To(t,"POST",function Pe(lt,un){const bi=tI(lt,["active","final"]),sf=y.current+S,j0=r.size();let Vx;return Vx="final"===bi?yp(e,u)(lt,un):null,new tv(sf,j0,"final"===bi,Vx)},e.maxUploadRetryTime);return It.headers=z,It.body=ye.uploadData(),It.progressCallback=f||null,It.errorHandler=ih(n),It}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(y){return this._error=y,void this._transition("error")}const f=this._ref.storage._makeRequest(c,ro,i,u);this._request=f,f.getPromise().then(y=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(y.current),y.finalized?(this._metadata=y.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=QE(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,ro,e,t);this._request=i,i.getPromise().then(u=>{this._request=void 0,this._metadata=u,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function eI(n,e,t,r,i){const u=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"},y=function f(){let It="";for(let lt=0;lt<2;lt++)It+=Math.random().toString().slice(2);return It}();c["Content-Type"]="multipart/related; boundary="+y;const I=_m(e,r,i),S=mm(I,t),V=Wi.getBlob("--"+y+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+S+"\r\n--"+y+"\r\nContent-Type: "+I.contentType+"\r\n\r\n",r,"\r\n--"+y+"--");if(null===V)throw KC();const z={name:I.fullPath},ye=oa(u,n.host,n._protocol),_t=n.maxUploadRetryTime,wt=new To(ye,"POST",yp(n,t),_t);return wt.urlParams=z,wt.headers=c,wt.body=V.uploadData(),wt.errorHandler=ih(e),wt}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ro,e,t);this._request=i,i.getPromise().then(u=>{this._request=void 0,this._metadata=u,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=VE(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=rv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const u=new nI(t||void 0,r||void 0,i||void 0);return this._addObserver(u),()=>{this._removeObserver(u)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(rv(this._state)){case wr.SUCCESS:oh(this._resolve.bind(null,this.snapshot))();break;case wr.CANCELED:case wr.ERROR:oh(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(rv(this._state)){case wr.RUNNING:case wr.PAUSED:e.next&&oh(e.next.bind(e,this.snapshot))();break;case wr.SUCCESS:e.complete&&oh(e.complete.bind(e))();break;default:e.error&&oh(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class sl{constructor(e,t){this._service=e,this._location=t instanceof ii?t:ii.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new sl(e,t)}get root(){const e=new ii(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Sc(this._location.path)}get storage(){return this._service}get parent(){const e=function Xd(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new ii(this._location.bucket,e);return new sl(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw JC(e)}}function sI(n,e,t){return oI.apply(this,arguments)}function oI(){return(oI=(0,fe.Z)(function*(n,e,t){const i=yield ah(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield sI(n,e,i.nextPageToken))})).apply(this,arguments)}function ah(n,e){null!=e&&"number"==typeof e.maxResults&&WE("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=JE(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,ro)}function lv(n){n._throwIfRoot("getDownloadURL");const e=function aD(n,e,t){const i=oa(e.fullServerUrl(),n.host,n._protocol),c=n.maxOperationRetryTime,f=new To(i,"GET",function oD(n,e){return function t(r,i){const u=Qy(n,i,e);return aa(null!==u),function zE(n,e,t,r){const i=il(e);if(null===i||!pp(i.downloadTokens))return null;const u=i.downloadTokens;if(0===u.length)return null;const c=encodeURIComponent;return u.split(",").map(I=>{const A=n.fullPath;return oa("/b/"+c(n.bucket)+"/o/"+c(A),t,r)+Zy({alt:"media",token:I})})[0]}(u,i,n.host,n._protocol)}}(n,t),c);return f.errorHandler=sh(e),f}(n.storage,n._location,rh());return n.storage.makeRequestWithTokens(e,ro).then(t=>{if(null===t)throw function YC(){return new Jn("no-download-url","The given file does not have any download URLs.")}();return t})}function vm(n,e){const t=function eh(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new ii(n._location.bucket,t);return new sl(n.storage,r)}function yD(n,e){if(n instanceof hv){const t=n;if(null==t._bucket)throw function jE(){return new Jn("no-default-bucket","No default bucket found. Did you set the '"+Cc+"' property when initializing the app?")}();const r=new sl(t,t._bucket);return null!=e?yD(r,e):r}return void 0!==e?vm(n,e):n}function vD(n,e){if(e&&function cv(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof hv)return function uI(n,e){return new sl(n,e)}(n,e);throw Qd("To use ref(service, url), the first argument must be a Storage instance.")}return yD(n,e)}function dv(n,e){const t=null==e?void 0:e[Cc];return null==t?null:ii.makeFromBucketSpec(t,n)}class hv{constructor(e,t,r,i,u){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=u,this._bucket=null,this._host=OE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ii.makeFromBucketSpec(i,this._host):dv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?ii.makeFromBucketSpec(this._url,e):dv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){WE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){WE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,fe.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,fe.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new sl(this,e)}_makeRequest(e,t,r,i){if(this._deleted)return new HE(QC());{const u=function rD(n,e,t,r,i,u){const c=Zy(n.urlParams),f=n.url+c,y=Object.assign({},n.headers);return function tD(n,e){e&&(n["X-Firebase-GMPID"]=e)}(y,e),function XC(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(y,t),function eD(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(y,u),function nD(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(y,r),new zy(f,n.method,y,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i)}(e,this._appId,r,i,t,this._firebaseVersion);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}makeRequestWithTokens(e,t){var r=this;return(0,fe.Z)(function*(){const[i,u]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,u).getPromise()})()}}const fv="@firebase/storage";function pI(n,e){return vD(n=(0,O.m9)(n),e)}function yI(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new hv(t,r,i,e,ri.SDK_VERSION)}!function vI(){(0,ri._registerComponent)(new ia.wA("storage",yI,"PUBLIC").setMultipleInstances(!0)),(0,ri.registerVersion)(fv,"0.9.1",""),(0,ri.registerVersion)(fv,"0.9.1","esm2017")}();class vp{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class mv{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new vp(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new vp(r,this,this._ref))},t)}on(e,t,r,i){let u;return t&&(u="function"==typeof t?c=>t(new vp(c,this,this._ref)):{next:t.next?c=>t.next(new vp(c,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,u,r||void 0,i||void 0)}}class _v{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new ol(e,this._service))}get items(){return this._delegate.items.map(e=>new ol(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class ol{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function gI(n,e){return vm(n,e)}(this._delegate,e);return new ol(t,this.storage)}get root(){return new ol(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new ol(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new mv(function ID(n,e,t){return function ov(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new rI(n,new Wi(e),t)}(n=(0,O.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=Ss.RAW,r){this._throwIfRoot("putString");const i=mp(t,e),u=Object.assign({},r);return null==u.contentType&&null!=i.contentType&&(u.contentType=i.contentType),new mv(new rI(this._delegate,new Wi(i.data,!0),u),this)}listAll(){return function fI(n){return function av(n){const e={prefixes:[],items:[]};return sI(n,e).then(()=>e)}(n=(0,O.m9)(n))}(this._delegate).then(e=>new _v(e,this.storage))}list(e){return function gv(n,e){return ah(n=(0,O.m9)(n),e)}(this._delegate,e||void 0).then(t=>new _v(t,this.storage))}getMetadata(){return function dI(n){return function aI(n){n._throwIfRoot("getMetadata");const e=QE(n.storage,n._location,rh());return n.storage.makeRequestWithTokens(e,ro)}(n=(0,O.m9)(n))}(this._delegate)}updateMetadata(e){return function hI(n,e){return function uv(n,e){n._throwIfRoot("updateMetadata");const t=function hP(n,e,t,r){const u=oa(e.fullServerUrl(),n.host,n._protocol),f=mm(t,r),I=n.maxOperationRetryTime,S=new To(u,"PATCH",yp(n,r),I);return S.headers={"Content-Type":"application/json; charset=utf-8"},S.body=f,S.errorHandler=sh(e),S}(n.storage,n._location,e,rh());return n.storage.makeRequestWithTokens(t,ro)}(n=(0,O.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function bD(n){return lv(n=(0,O.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function TD(n){return function _D(n){n._throwIfRoot("deleteObject");const e=function uD(n,e){const r=oa(e.fullServerUrl(),n.host,n._protocol),f=new To(r,"DELETE",function c(y,I){},n.maxOperationRetryTime);return f.successCodes=[200,204],f.errorHandler=sh(e),f}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,ro)}(n=(0,O.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw JC(e)}}class wI{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(EI(e))throw Qd("ref() expected a child path but got a URL, use refFromURL instead.");return new ol(pI(this._delegate,e),this)}refFromURL(e){if(!EI(e))throw Qd("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ii.makeFromUrl(e,this._delegate.host)}catch(t){throw Qd("refFromUrl() expected a valid full URL but got an invalid one.")}return new ol(pI(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function _I(n,e,t,r={}){!function lI(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,O.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function EI(n){return/^[A-Za-z]+:\/\//.test(n)}function bI(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new wI(t,r)}function yv(n){const e=function RD(n){return new sr.y(e=>{const t=c=>e.next(c);t(n.snapshot);const u=n.on("state_changed",t);return n.then(c=>{t(c),e.complete()},c=>{t(n.snapshot),(c=>{e.error(c)})(c)}),function(){u()}}).pipe(function NE(n,e=tl.z){return(0,En.e)((t,r)=>{let i=null,u=null,c=null;const f=()=>{if(i){i.unsubscribe(),i=null;const I=u;u=null,r.next(I)}};function y(){const I=c+n,S=e.now();if(S<I)return i=this.schedule(void 0,I-S),void r.add(i);f()}t.subscribe(new dn.Q(r,I=>{u=I,c=e.now(),i||(i=e.schedule(y,n),r.add(i))},()=>{f(),r.complete()},void 0,()=>{u=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,vt.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function Em(n){return{getDownloadURL:()=>Ke(void 0).pipe(Yt.fc,vn(()=>n.getDownloadURL()),Yt.iC),getMetadata:()=>Ke(void 0).pipe(Yt.fc,vn(()=>n.getMetadata()),Yt.iC),delete:()=>(0,sn.D)(n.delete()),child:e=>Em(n.child(e)),updateMetadata:e=>(0,sn.D)(n.updateMetadata(e)),put:(e,t)=>yv(n.put(e,t)),putString:(e,t,r)=>yv(n.putString(e,t,r)),list:e=>(0,sn.D)(n.list(e)),listAll:()=>(0,sn.D)(n.listAll())}}!function AD(n){const e={TaskState:wr,TaskEvent:cD,StringFormat:Ss,Storage:wI,Reference:ol};n.INTERNAL.registerComponent(new ia.wA("storage-compat",bI,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.1.9")}($y.Z);const TI=new m.OlP("angularfire2.storageBucket"),CI=new m.OlP("angularfire2.storage.maxUploadRetryTime"),uh=new m.OlP("angularfire2.storage.maxOperationRetryTime"),xD=new m.OlP("angularfire2.storage.use-emulator");let PD=(()=>{class n{constructor(t,r,i,u,c,f,y,I,S,A){const M=(0,Pr.on)(t,c,r);this.storage=(0,Pr.cc)(`${M.name}.storage.${i}`,"AngularFireStorage",M.name,()=>{const V=c.runOutsideAngular(()=>M.storage(i||void 0)),z=S;return z&&V.useEmulator(...z),y&&V.setMaxUploadRetryTime(y),I&&V.setMaxOperationRetryTime(I),V},[y,I])}ref(t){return Em(this.storage.ref(t))}refFromURL(t){return Em(this.storage.refFromURL(t))}upload(t,r,i){return Em(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(Pr.Dh),m.LFG(Pr.xv,8),m.LFG(TI,8),m.LFG(m.Lbi),m.LFG(m.R0b),m.LFG(Yt.HU),m.LFG(CI,8),m.LFG(uh,8),m.LFG(xD,8),m.LFG(lp,8))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),MD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({}),n})(),DI=(()=>{class n{constructor(){Hd.Z.registerVersion("angularfire",Yt.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({providers:[PD],imports:[MD]}),n})();function SI(){return(0,En.e)((n,e)=>{let t,r=!1;n.subscribe(new dn.Q(e,i=>{const u=t;t=i,r&&e.next([u,i]),r=!0}))})}function vv(n,e=rs.y){return n=null!=n?n:AI,(0,En.e)((t,r)=>{let i,u=!0;t.subscribe(new dn.Q(r,c=>{const f=e(c);(u||!n(i,f))&&(u=!1,i=f,r.next(c))}))})}function AI(n,e){return n===e}L(5735);var We,ND="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},au={},As=As||{},gt=ND||self;function wp(){}function Im(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Ep(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var wv="closure_uid_"+(1e9*Math.random()>>>0),LD=0;function Ev(n,e,t){return n.call.apply(n.bind,arguments)}function Ip(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function oi(n,e,t){return(oi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ev:Ip).apply(null,arguments)}function bp(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ai(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,i,u){for(var c=Array(arguments.length-2),f=2;f<arguments.length;f++)c[f-2]=arguments[f];return e.prototype[i].apply(r,c)}}function uu(){this.s=this.s,this.o=this.o}var bm={};uu.prototype.s=!1,uu.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function OD(n){return Object.prototype.hasOwnProperty.call(n,wv)&&n[wv]||(n[wv]=++LD)}(this);delete bm[n]}},uu.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const xI=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},Iv=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){const r=n.length,i="string"==typeof n?n.split(""):n;for(let u=0;u<r;u++)u in i&&e.call(t,i[u],u,n)};function bv(n){return Array.prototype.concat.apply([],arguments)}function lh(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Tp(n){return/^[\s\xa0]*$/.test(n)}var mi,Tv=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function gi(n,e){return-1!=n.indexOf(e)}function Tm(n,e){return n<e?-1:n>e?1:0}e:{var Cv=gt.navigator;if(Cv){var Dv=Cv.userAgent;if(Dv){mi=Dv;break e}}mi=""}function Cm(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function kI(n){const e={};for(const t in n)e[t]=n[t];return e}var MI="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function NI(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let u=0;u<MI.length;u++)t=MI[u],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Sv(n){return Sv[" "](n),n}Sv[" "]=wp;var Dm,n,UD=gi(mi,"Opera"),ch=gi(mi,"Trident")||gi(mi,"MSIE"),OI=gi(mi,"Edge"),Av=OI||ch,LI=gi(mi,"Gecko")&&!(gi(mi.toLowerCase(),"webkit")&&!gi(mi,"Edge"))&&!(gi(mi,"Trident")||gi(mi,"MSIE"))&&!gi(mi,"Edge"),BD=gi(mi.toLowerCase(),"webkit")&&!gi(mi,"Edge");function FI(){var n=gt.document;return n?n.documentMode:void 0}e:{var Rv="",xv=(n=mi,LI?/rv:([^\);]+)(\)|;)/.exec(n):OI?/Edge\/([\d\.]+)/.exec(n):ch?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):BD?/WebKit\/(\S+)/.exec(n):UD?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(xv&&(Rv=xv?xv[1]:""),ch){var Pv=FI();if(null!=Pv&&Pv>parseFloat(Rv)){Dm=String(Pv);break e}}Dm=Rv}var VD={};var UI=gt.document&&ch&&(FI()||parseInt(Dm,10))||void 0,BI=function(){if(!gt.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{gt.addEventListener("test",wp,e),gt.removeEventListener("test",wp,e)}catch(t){}return n}();function ui(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}function dh(n,e){if(ui.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(LI){e:{try{Sv(e.nodeName);var i=!0;break e}catch(u){}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:VI[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&dh.Z.h.call(this)}}ui.prototype.h=function(){this.defaultPrevented=!0},ai(dh,ui);var VI={2:"touch",3:"pen",4:"mouse"};dh.prototype.h=function(){dh.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var hh="closure_listenable_"+(1e6*Math.random()|0),jI=0;function $I(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ia=i,this.key=++jI,this.ca=this.fa=!1}function Cp(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function ua(n){this.src=n,this.g={},this.h=0}function Mv(n,e){var t=e.type;if(t in n.g){var u,r=n.g[t],i=xI(r,e);(u=0<=i)&&Array.prototype.splice.call(r,i,1),u&&(Cp(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Nv(n,e,t,r){for(var i=0;i<n.length;++i){var u=n[i];if(!u.ca&&u.listener==e&&u.capture==!!t&&u.ia==r)return i}return-1}ua.prototype.add=function(n,e,t,r,i){var u=n.toString();(n=this.g[u])||(n=this.g[u]=[],this.h++);var c=Nv(n,e,r,i);return-1<c?(e=n[c],t||(e.fa=!1)):((e=new $I(e,this.src,u,!!r,i)).fa=t,n.push(e)),e};var al="closure_lm_"+(1e6*Math.random()|0),HI={};function Am(n,e,t,r,i){if(r&&r.once)return Ov(n,e,t,r,i);if(Array.isArray(e)){for(var u=0;u<e.length;u++)Am(n,e[u],t,r,i);return null}return t=Fv(t),n&&n[hh]?n.N(e,t,Ep(r)?!!r.capture:!!r,i):$D(n,e,t,!1,r,i)}function $D(n,e,t,r,i,u){if(!e)throw Error("Invalid event type");var c=Ep(i)?!!i.capture:!!i,f=Lv(n);if(f||(n[al]=f=new ua(n)),(t=f.add(e,t,r,c,u)).proxy)return t;if(r=function qI(){var e=qD;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)BI||(i=c),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(WI(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function Ov(n,e,t,r,i){if(Array.isArray(e)){for(var u=0;u<e.length;u++)Ov(n,e[u],t,r,i);return null}return t=Fv(t),n&&n[hh]?n.O(e,t,Ep(r)?!!r.capture:!!r,i):$D(n,e,t,!0,r,i)}function HD(n,e,t,r,i){if(Array.isArray(e))for(var u=0;u<e.length;u++)HD(n,e[u],t,r,i);else r=Ep(r)?!!r.capture:!!r,t=Fv(t),n&&n[hh]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Nv(u=n.g[e],t,r,i))&&(Cp(u[t]),Array.prototype.splice.call(u,t,1),0==u.length&&(delete n.g[e],n.h--))):n&&(n=Lv(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Nv(e,t,r,i)),(t=-1<n?e[n]:null)&&mt(t))}function mt(n){if("number"!=typeof n&&n&&!n.ca){var e=n.src;if(e&&e[hh])Mv(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(WI(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Lv(e))?(Mv(t,n),0==t.h&&(t.src=null,e[al]=null)):Cp(n)}}}function WI(n){return n in HI?HI[n]:HI[n]="on"+n}function qD(n,e){if(n.ca)n=!0;else{e=new dh(e,this);var t=n.listener,r=n.ia||n.src;n.fa&&mt(n),n=t.call(r,e)}return n}function Lv(n){return(n=n[al])instanceof ua?n:null}var fh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fv(n){return"function"==typeof n?n:(n[fh]||(n[fh]=function(e){return n.handleEvent(e)}),n[fh])}function or(){uu.call(this),this.i=new ua(this),this.P=this,this.I=null}function Er(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new ui(e,n);else if(e instanceof ui)e.target=e.target||n;else{var i=e;NI(e=new ui(r,n),i)}if(i=!0,t)for(var u=t.length-1;0<=u;u--){var c=e.g=t[u];i=bn(c,r,!0,e)&&i}if(i=bn(c=e.g=n,r,!0,e)&&i,i=bn(c,r,!1,e)&&i,t)for(u=0;u<t.length;u++)i=bn(c=e.g=t[u],r,!1,e)&&i}function bn(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,u=0;u<e.length;++u){var c=e[u];if(c&&!c.ca&&c.capture==t){var f=c.listener,y=c.ia||c.src;c.fa&&Mv(n.i,c),i=!1!==f.call(y,r)&&i}}return i&&!r.defaultPrevented}ai(or,uu),or.prototype[hh]=!0,or.prototype.removeEventListener=function(n,e,t,r){HD(this,n,e,t,r)},or.prototype.M=function(){if(or.Z.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Cp(t[r]);delete n.g[e],n.h--}}this.I=null},or.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},or.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var GI=gt.JSON.stringify;function ZI(){var n=QI;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var xm,zI=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new KI,n=>n.reset());class KI{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function YI(n){gt.setTimeout(()=>{throw n},0)}function Rm(n,e){xm||function GD(){var n=gt.Promise.resolve(void 0);xm=function(){n.then(Dp)}}(),Uv||(xm(),Uv=!0),QI.add(n,e)}var Uv=!1,QI=new class WD{constructor(){this.h=this.g=null}add(e,t){const r=zI.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function Dp(){for(var n;n=ZI();){try{n.h.call(n.g)}catch(t){YI(t)}var e=zI;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Uv=!1}function Pm(n,e){or.call(this),this.h=n||1,this.g=e||gt,this.j=oi(this.kb,this),this.l=Date.now()}function Bv(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}function Vv(n,e,t){if("function"==typeof n)t&&(n=oi(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=oi(n.handleEvent,n)}return 2147483647<Number(e)?-1:gt.setTimeout(n,e||0)}function Sp(n){n.g=Vv(()=>{n.g=null,n.i&&(n.i=!1,Sp(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}ai(Pm,or),(We=Pm.prototype).da=!1,We.S=null,We.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Er(this,"tick"),this.da&&(Bv(this),this.start()))}},We.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},We.M=function(){Pm.Z.M.call(this),Bv(this),delete this.g};class JI extends uu{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Sp(this)}M(){super.M(),this.g&&(gt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ph(n){uu.call(this),this.h=n,this.g={}}ai(ph,uu);var jv=[];function XI(n,e,t,r){Array.isArray(t)||(t&&(jv[0]=t.toString()),t=jv);for(var i=0;i<t.length;i++){var u=Am(e,t[i],r||n.handleEvent,!1,n.h||n);if(!u)break;n.g[u.key]=u}}function gh(n){Cm(n.g,function(e,t){this.g.hasOwnProperty(t)&&mt(e)},n),n.g={}}function ul(){this.g=!0}function mh(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function tb(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var u=i[0];if("noop"!=u&&"stop"!=u&&"close"!=u)for(var c=1;c<i.length;c++)i[c]=""}}}return GI(t)}catch(f){return e}}(n,t)+(r?" "+r:"")})}ph.prototype.M=function(){ph.Z.M.call(this),gh(this)},ph.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ul.prototype.Aa=function(){this.g=!1},ul.prototype.info=function(){};var ll={},nb=null;function Ap(){return nb=nb||new or}function rb(n){ui.call(this,ll.Ma,n)}function Rp(n){const e=Ap();Er(e,new rb(e,n))}function KD(n,e){ui.call(this,ll.STAT_EVENT,n),this.stat=e}function ls(n){const e=Ap();Er(e,new KD(e,n))}function YD(n,e){ui.call(this,ll.Na,n),this.size=e}function km(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return gt.setTimeout(function(){n()},e)}ll.Ma="serverreachability",ai(rb,ui),ll.STAT_EVENT="statevent",ai(KD,ui),ll.Na="timingevent",ai(YD,ui);var xp={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Pp={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function $v(){}function Hv(){}$v.prototype.h=null;var Gv,lu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function qv(){ui.call(this,"d")}function Wv(){ui.call(this,"c")}function Mm(){}function kp(n,e,t,r){this.l=n,this.j=e,this.m=t,this.X=r||1,this.V=new ph(this),this.P=QD,this.W=new Pm(n=Av?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Zv}function Zv(){this.i=null,this.g="",this.h=!1}ai(qv,ui),ai(Wv,ui),ai(Mm,$v),Mm.prototype.g=function(){return new XMLHttpRequest},Mm.prototype.i=function(){return{}},Gv=new Mm;var QD=45e3,zv={},cu={};function Kv(n,e,t){n.K=1,n.v=Op(du(e)),n.s=t,n.U=!0,Yv(n,null)}function Yv(n,e){n.F=Date.now(),_h(n),n.A=du(n.v);var t=n.A,r=n.X;Array.isArray(r)||(r=[String(r)]),hb(t.h,"t",r),n.C=0,t=n.l.H,n.h=new Zv,n.g=dw(n.l,t?e:null,!n.s),0<n.O&&(n.L=new JI(oi(n.Ia,n,n.g),n.O)),XI(n.V,n.g,"readystatechange",n.gb),e=n.H?kI(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),Rp(1),function ZD(n,e,t,r,i,u){n.info(function(){if(n.g)if(u)for(var c="",f=u.split("&"),y=0;y<f.length;y++){var I=f[y].split("=");if(1<I.length){var S=I[0];I=I[1];var A=S.split("_");c=2<=A.length&&"type"==A[1]?c+(S+"=")+I+"&":c+(S+"=redacted&")}}else c=null;else c=u;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+c})}(n.j,n.u,n.A,n.m,n.X,n.s)}function sb(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Ba}function Qv(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=JD(n,t),i==cu){4==e&&(n.o=4,ls(14),r=!1),mh(n.j,n.m,null,"[Incomplete Response]");break}if(i==zv){n.o=4,ls(15),mh(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}mh(n.j,n.m,i,null),Nm(n,i)}sb(n)&&i!=cu&&i!=zv&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,ls(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.aa&&(n.aa=!0,(e=n.l).g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),uw(e),e.L=!0,ls(11))):(mh(n.j,n.m,t,"[Invalid Chunked Response]"),cl(n),Mp(n))}function JD(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?cu:(t=Number(e.substring(t,r)),isNaN(t)?zv:(r+=1)+t>e.length?cu:(e=e.substr(r,t),n.C=r+t,e))}function _h(n){n.Y=Date.now()+n.P,ob(n,n.P)}function ob(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=km(oi(n.eb,n),e)}function yh(n){n.B&&(gt.clearTimeout(n.B),n.B=null)}function Mp(n){0==n.l.G||n.I||Ab(n.l,n)}function cl(n){yh(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,Bv(n.W),gh(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Nm(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||Pc(t.i,n)))if(t.I=n.N,!n.J&&Pc(t.i,n)&&3==t.G){try{var r=t.Ca.g.parse(e)}catch(I){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(t.u)t.ta=i[1],0<t.ta-t.U&&37500>i[2]&&t.N&&0==t.A&&!t.v&&(t.v=km(oi(t.ab,t),6e3));else{if(t.g){if(!(t.g.F+3e3<n.F))break e;Wm(t),Bp(t)}aw(t),ls(18)}if(1>=mb(t.i)&&t.ka){try{t.ka()}catch(I){}t.ka=void 0}}else fl(t,11)}else if((n.J||t.g==n)&&Wm(t),!Tp(e))for(i=t.Ca.g.parse(e),e=0;e<i.length;e++){let I=i[e];if(t.U=I[0],I=I[1],2==t.G)if("c"==I[0]){t.J=I[1],t.la=I[2];const S=I[3];null!=S&&(t.ma=S,t.h.info("VER="+t.ma));const A=I[4];null!=A&&(t.za=A,t.h.info("SVER="+t.za));const M=I[5];null!=M&&"number"==typeof M&&0<M&&(t.K=r=1.5*M,t.h.info("backChannelRequestTimeoutMs_="+r)),r=t;const V=n.g;if(V){const z=V.g?V.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(z){var u=r.i;!u.g&&(gi(z,"spdy")||gi(z,"quic")||gi(z,"h2"))&&(u.j=u.l,u.g=new Set,u.h&&(nw(u,u.h),u.h=null))}if(r.D){const ye=V.g?V.g.getResponseHeader("X-HTTP-Session-Id"):null;ye&&(r.sa=ye,kn(r.F,r.D,ye))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms"));var c=n;if((r=t).oa=cw(r,r.H?r.la:null,r.W),c.J){kc(r.i,c);var f=c,y=r.K;y&&f.setTimeout(y),f.B&&(yh(f),_h(f)),r.g=c}else Db(r);0<t.l.length&&Ch(t)}else"stop"!=I[0]&&"close"!=I[0]||fl(t,7);else 3==t.G&&("stop"==I[0]||"close"==I[0]?"stop"==I[0]?fl(t,7):bb(t):"noop"!=I[0]&&t.j&&t.j.wa(I),t.A=0)}Rp(4)}catch(I){}}function Jv(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Im(n)||"string"==typeof n)Iv(n,e,void 0);else{if(n.T&&"function"==typeof n.T)var t=n.T();else if(n.R&&"function"==typeof n.R)t=void 0;else if(Im(n)||"string"==typeof n){t=[];for(var r=n.length,i=0;i<r;i++)t.push(i)}else for(i in t=[],r=0,n)t[r++]=i;r=function XD(n){if(n.R&&"function"==typeof n.R)return n.R();if("string"==typeof n)return n.split("");if(Im(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length;for(var u=0;u<i;u++)e.call(void 0,r[u],t&&t[u],n)}}function vh(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var r=0;r<t;r+=2)this.set(arguments[r],arguments[r+1])}else if(n)if(n instanceof vh)for(t=n.T(),r=0;r<t.length;r++)this.set(t[r],n.get(t[r]));else for(r in n)this.set(r,n[r])}function Np(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var r=n.g[e];Ac(n.h,r)&&(n.g[t++]=r),e++}n.g.length=t}if(n.i!=n.g.length){var i={};for(t=e=0;e<n.g.length;)Ac(i,r=n.g[e])||(n.g[t++]=r,i[r]=1),e++;n.g.length=t}}function Ac(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(We=kp.prototype).setTimeout=function(n){this.P=n},We.gb=function(n){n=n.target;const e=this.L;e&&3==cs(n)?e.l():this.Ia(n)},We.Ia=function(n){try{if(n==this.g)e:{const S=cs(this.g);var e=this.g.Da();const A=this.g.ba();if(!(3>S)&&(3!=S||Av||this.g&&(this.h.h||this.g.ga()||ow(this.g)))){this.I||4!=S||7==e||Rp(8==e||0>=A?3:2),yh(this);var t=this.g.ba();this.N=t;t:if(sb(this)){var r=ow(this.g);n="";var i=r.length,u=4==cs(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){cl(this),Mp(this);var c="";break t}this.h.i=new gt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:u&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,c=this.h.g}else c=this.g.ga();if(this.i=200==t,function zD(n,e,t,r,i,u,c){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+u+" "+c})}(this.j,this.u,this.A,this.m,this.X,S,t),this.i){if(this.$&&!this.J){t:{if(this.g){var f,y=this.g;if((f=y.g?y.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Tp(f)){var I=f;break t}}I=null}if(!(t=I)){this.i=!1,this.o=3,ls(12),cl(this),Mp(this);break e}mh(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Nm(this,t)}this.U?(Qv(this,S,c),Av&&this.i&&3==S&&(XI(this.V,this.W,"tick",this.fb),this.W.start())):(mh(this.j,this.m,c,null),Nm(this,c)),4==S&&cl(this),this.i&&!this.I&&(4==S?Ab(this.l,this):(this.i=!1,_h(this)))}else 400==t&&0<c.indexOf("Unknown SID")?(this.o=3,ls(12)):(this.o=0,ls(13)),cl(this),Mp(this)}}}catch(S){}},We.fb=function(){if(this.g){var n=cs(this.g),e=this.g.ga();this.C<e.length&&(yh(this),Qv(this,n,e),this.i&&4!=n&&_h(this))}},We.cancel=function(){this.I=!0,cl(this)},We.eb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function eb(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Rp(3),ls(17)),cl(this),this.o=2,Mp(this)):ob(this,this.Y-n)},(We=vh.prototype).R=function(){Np(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n},We.T=function(){return Np(this),this.g.concat()},We.get=function(n,e){return Ac(this.h,n)?this.h[n]:e},We.set=function(n,e){Ac(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e},We.forEach=function(n,e){for(var t=this.T(),r=0;r<t.length;r++){var i=t[r],u=this.get(i);n.call(e,u,i,this)}};var Xv=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rc(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof Rc){this.g=void 0!==e?e:n.g,Om(this,n.j),this.s=n.s,Lm(this,n.i),Fm(this,n.m),this.l=n.l,e=n.h;var t=new xc;t.i=e.i,e.g&&(t.g=new vh(e.g),t.h=e.h),ab(this,t),this.o=n.o}else n&&(t=String(n).match(Xv))?(this.g=!!e,Om(this,t[1]||"",!0),this.s=Lp(t[2]||""),Lm(this,t[3]||"",!0),Fm(this,t[4]),this.l=Lp(t[5]||"",!0),ab(this,t[6]||"",!0),this.o=Lp(t[7]||"")):(this.g=!!e,this.h=new xc(null,this.g))}function du(n){return new Rc(n)}function Om(n,e,t){n.j=t?Lp(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Lm(n,e,t){n.i=t?Lp(e,!0):e}function Fm(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function ab(n,e,t){e instanceof xc?(n.h=e,function iS(n,e){e&&!n.j&&(dl(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(db(this,r),hb(this,i,t))},n)),n.j=e}(n.h,n.g)):(t||(e=wh(e,tw)),n.h=new xc(e,n.g))}function kn(n,e,t){n.h.set(e,t)}function Op(n){return kn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Lp(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function wh(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,nS),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function nS(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Rc.prototype.toString=function(){var n=[],e=this.j;e&&n.push(wh(e,lb,!0),":");var t=this.i;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(wh(e,lb,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&n.push("/"),n.push(wh(t,"/"==t.charAt(0)?ew:rS,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",wh(t,cb)),n.join("")};var lb=/[#\/\?@]/g,rS=/[#\?:]/g,ew=/[#\?]/g,tw=/[#\?@]/g,cb=/#/g;function xc(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function dl(n){n.g||(n.g=new vh,n.h=0,n.i&&function eS(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var u=n[t].substring(0,r);i=n[t].substring(r+1)}else u=n[t];e(u,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function db(n,e){dl(n),e=Eh(n,e),Ac(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,Ac((n=n.g).h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&Np(n)))}function Um(n,e){return dl(n),e=Eh(n,e),Ac(n.g.h,e)}function hb(n,e,t){db(n,e),0<t.length&&(n.i=null,n.g.set(Eh(n,e),lh(t)),n.h+=t.length)}function Eh(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function pb(n){this.l=n||gb,n=gt.PerformanceNavigationTiming?0<(n=gt.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(gt.g&&gt.g.Ea&&gt.g.Ea()&&gt.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(We=xc.prototype).add=function(n,e){dl(this),this.i=null,n=Eh(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},We.forEach=function(n,e){dl(this),this.g.forEach(function(t,r){Iv(t,function(i){n.call(e,i,r,this)},this)},this)},We.T=function(){dl(this);for(var n=this.g.R(),e=this.g.T(),t=[],r=0;r<e.length;r++)for(var i=n[r],u=0;u<i.length;u++)t.push(e[r]);return t},We.R=function(n){dl(this);var e=[];if("string"==typeof n)Um(this,n)&&(e=bv(e,this.g.get(Eh(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=bv(e,n[t])}return e},We.set=function(n,e){return dl(this),this.i=null,Um(this,n=Eh(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},We.get=function(n,e){return n&&0<(n=this.R(n)).length?String(n[0]):e},We.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var r=e[t],i=encodeURIComponent(String(r));r=this.R(r);for(var u=0;u<r.length;u++){var c=i;""!==r[u]&&(c+="="+encodeURIComponent(String(r[u]))),n.push(c)}}return this.i=n.join("&")};var gb=10;function sS(n){return!!n.h||!!n.g&&n.g.size>=n.j}function mb(n){return n.h?1:n.g?n.g.size:0}function Pc(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function nw(n,e){n.g?n.g.add(e):n.h=e}function kc(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Ih(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return lh(n.i)}function rw(){}function mP(){this.g=new rw}function _b(n,e,t){const r=t||"";try{Jv(n,function(i,u){let c=i;Ep(i)&&(c=GI(i)),e.push(r+u+"="+encodeURIComponent(c))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Bm(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(u){}}function Fp(n){this.l=n.$b||null,this.j=n.ib||!1}function Vm(n,e){or.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=jm,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}pb.prototype.cancel=function(){if(this.i=Ih(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},rw.prototype.stringify=function(n){return gt.JSON.stringify(n,void 0)},rw.prototype.parse=function(n){return gt.JSON.parse(n,void 0)},ai(Fp,$v),Fp.prototype.g=function(){return new Vm(this.l,this.j)},Fp.prototype.i=function(n){return function(){return n}}({}),ai(Vm,or);var jm=0;function iw(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}function Mc(n){n.readyState=4,n.l=null,n.j=null,n.A=null,hl(n)}function hl(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(We=Vm.prototype).open=function(n,e){if(this.readyState!=jm)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,hl(this)},We.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||gt).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},We.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Mc(this)),this.readyState=jm},We.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,hl(this)),this.g&&(this.readyState=3,hl(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==gt.ReadableStream&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;iw(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))},We.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Mc(this):hl(this),3==this.readyState&&iw(this)}},We.Ua=function(n){this.g&&(this.response=this.responseText=n,Mc(this))},We.Ta=function(n){this.g&&(this.response=n,Mc(this))},We.ha=function(){this.g&&Mc(this)},We.setRequestHeader=function(n,e){this.v.append(n,e)},We.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},We.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(Vm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Up=gt.JSON.parse;function Ir(n){or.call(this),this.headers=new vh,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=sw,this.K=this.L=!1}ai(Ir,or);var sw="",yb=/^https?$/i,aS=["POST","PUT"];function lS(n){return"content-type"==n.toLowerCase()}function $m(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,vb(n),Hm(n)}function vb(n){n.D||(n.D=!0,Er(n,"complete"),Er(n,"error"))}function cS(n){if(n.h&&void 0!==As&&(!n.C[1]||4!=cs(n)||2!=n.ba()))if(n.v&&4==cs(n))Vv(n.Fa,0,n);else if(Er(n,"readystatechange"),4==cs(n)){n.h=!1;try{const f=n.ba();e:switch(f){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===f){var i=String(n.H).match(Xv)[1]||null;if(!i&&gt.self&&gt.self.location){var u=gt.self.location.protocol;i=u.substr(0,u.length-1)}r=!yb.test(i?i.toLowerCase():"")}t=r}if(t)Er(n,"complete"),Er(n,"success");else{n.m=6;try{var c=2<cs(n)?n.g.statusText:""}catch(y){c=""}n.j=c+" ["+n.ba()+"]",vb(n)}}finally{Hm(n)}}}function Hm(n,e){if(n.g){wb(n);const t=n.g,r=n.C[0]?wp:null;n.g=null,n.C=null,e||Er(n,"ready");try{t.onreadystatechange=r}catch(i){}}}function wb(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(gt.clearTimeout(n.A),n.A=null)}function cs(n){return n.g?n.g.readyState:0}function ow(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case sw:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Eb(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=function bh(n){let e="";return Cm(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):kn(n,e,t))}function Th(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Ib(n){this.za=0,this.l=[],this.h=new ul,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Th("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Th("baseRetryDelayMs",5e3,n),this.$a=Th("retryDelaySeedMs",1e4,n),this.Ya=Th("forwardChannelMaxRetries",2,n),this.ra=Th("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new pb(n&&n.concurrentRequestLimit),this.Ca=new mP,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||!1!==n.Xb}function bb(n){if(dS(n),3==n.G){var e=n.V++,t=du(n.F);kn(t,"SID",n.J),kn(t,"RID",e),kn(t,"TYPE","terminate"),Vp(n,t),(e=new kp(n,n.h,e,void 0)).K=2,e.v=Op(du(t)),t=!1,gt.navigator&&gt.navigator.sendBeacon&&(t=gt.navigator.sendBeacon(e.v.toString(),"")),!t&&gt.Image&&((new Image).src=e.v,t=!0),t||(e.g=dw(e.l,null),e.g.ea(e.v)),e.F=Date.now(),_h(e)}lw(n)}function Bp(n){n.g&&(uw(n),n.g.cancel(),n.g=null)}function dS(n){Bp(n),n.u&&(gt.clearTimeout(n.u),n.u=null),Wm(n),n.i.cancel(),n.m&&("number"==typeof n.m&&gt.clearTimeout(n.m),n.m=null)}function qm(n,e){n.l.push(new class{constructor(n,e){this.h=n,this.g=e}}(n.Za++,e)),3==n.G&&Ch(n)}function Ch(n){sS(n.i)||n.m||(n.m=!0,Rm(n.Ha,n),n.C=0)}function Tb(n,e){var t;t=e?e.m:n.V++;const r=du(n.F);kn(r,"SID",n.J),kn(r,"RID",t),kn(r,"AID",n.U),Vp(n,r),n.o&&n.s&&Eb(r,n.o,n.s),t=new kp(n,n.h,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=Cb(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),nw(n.i,t),Kv(t,r,e)}function Vp(n,e){n.j&&Jv({},function(t,r){kn(e,r,t)})}function Cb(n,e,t){t=Math.min(n.l.length,t);var r=n.j?oi(n.j.Oa,n.j,n):null;e:{var i=n.l;let u=-1;for(;;){const c=["count="+t];-1==u?0<t?(u=i[0].h,c.push("ofs="+u)):u=0:c.push("ofs="+u);let f=!0;for(let y=0;y<t;y++){let I=i[y].h;const S=i[y].g;if(I-=u,0>I)u=Math.max(0,i[y].h-100),f=!1;else try{_b(S,c,"req"+I+"_")}catch(A){r&&r(S)}}if(f){r=c.join("&");break e}}}return n=n.l.splice(0,t),e.D=n,r}function Db(n){n.g||n.u||(n.Y=1,Rm(n.Ga,n),n.A=0)}function aw(n){return!(n.g||n.u||3<=n.A||(n.Y++,n.u=km(oi(n.Ga,n),Dh(n,n.A)),n.A++,0))}function uw(n){null!=n.B&&(gt.clearTimeout(n.B),n.B=null)}function Sb(n){n.g=new kp(n,n.h,"rpc",n.Y),null===n.o&&(n.g.H=n.s),n.g.O=0;var e=du(n.oa);kn(e,"RID","rpc"),kn(e,"SID",n.J),kn(e,"CI",n.N?"0":"1"),kn(e,"AID",n.U),Vp(n,e),kn(e,"TYPE","xmlhttp"),n.o&&n.s&&Eb(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=Op(du(e)),t.s=null,t.U=!0,Yv(t,n)}function Wm(n){null!=n.v&&(gt.clearTimeout(n.v),n.v=null)}function Ab(n,e){var t=null;if(n.g==e){Wm(n),uw(n),n.g=null;var r=2}else{if(!Pc(n.i,e))return;t=e.D,kc(n.i,e),r=1}if(n.I=e.N,0!=n.G)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;Er(r=Ap(),new YD(r,t,e,i)),Ch(n)}else Db(n);else if(3==(i=e.o)||0==i&&0<n.I||!(1==r&&function hS(n,e){return!(mb(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.l=e.D.concat(n.l),0):1==n.G||2==n.G||n.C>=(n.Xa?0:n.Ya)||(n.m=km(oi(n.Ha,n,e),Dh(n,n.C)),n.C++,0)))}(n,e)||2==r&&aw(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:fl(n,5);break;case 4:fl(n,10);break;case 3:fl(n,6);break;default:fl(n,2)}}function Dh(n,e){let t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function fl(n,e){if(n.h.info("Error code "+e),2==e){var t=null;n.j&&(t=null);var r=oi(n.jb,n);t||(t=new Rc("//www.google.com/images/cleardot.gif"),gt.location&&"http"==gt.location.protocol||Om(t,"https"),Op(t)),function oS(n,e){const t=new ul;if(gt.Image){const r=new Image;r.onload=bp(Bm,t,r,"TestLoadImage: loaded",!0,e),r.onerror=bp(Bm,t,r,"TestLoadImage: error",!1,e),r.onabort=bp(Bm,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=bp(Bm,t,r,"TestLoadImage: timeout",!1,e),gt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else ls(2);n.G=0,n.j&&n.j.va(e),lw(n),dS(n)}function lw(n){n.G=0,n.I=-1,n.j&&((0!=Ih(n.i).length||0!=n.l.length)&&(n.i.i.length=0,lh(n.l),n.l.length=0),n.j.ua())}function cw(n,e,t){let r=function ub(n){return n instanceof Rc?du(n):new Rc(n,void 0)}(t);if(""!=r.i)e&&Lm(r,e+"."+r.i),Fm(r,r.m);else{const i=gt.location;r=function tS(n,e,t,r){var i=new Rc(null,void 0);return n&&Om(i,n),e&&Lm(i,e),t&&Fm(i,t),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,t)}return n.aa&&Cm(n.aa,function(i,u){kn(r,u,i)}),t=n.sa,(e=n.D)&&t&&kn(r,e,t),kn(r,"VER",n.ma),Vp(n,r),r}function dw(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ir(t&&n.Ba&&!n.qa?new Fp({ib:!0}):n.qa)).L=n.H,e}function hw(){}function jp(){if(ch&&!(10<=Number(UI)))throw Error("Environmental error: no available transport.")}function Rs(n,e){or.call(this),this.g=new Ib(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!Tp(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Tp(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Sh(this)}function fw(n){qv.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Rb(){Wv.call(this),this.status=1}function Sh(n){this.g=n}(We=Ir.prototype).ea=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Gv.g(),this.C=function ib(n){return n.h||(n.h=n.i())}(this.u?this.u:Gv),this.g.onreadystatechange=oi(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(u){return void $m(this,u)}n=t||"";const i=new vh(this.headers);r&&Jv(r,function(u,c){i.set(c,u)}),r=function PI(n){e:{var e=lS;const t=n.length,r="string"==typeof n?n.split(""):n;for(let i=0;i<t;i++)if(i in r&&e.call(void 0,r[i],i,n)){e=i;break e}e=-1}return 0>e?null:"string"==typeof n?n.charAt(e):n[e]}(i.T()),t=gt.FormData&&n instanceof gt.FormData,!(0<=xI(aS,e))||r||t||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(u,c){this.g.setRequestHeader(c,u)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{wb(this),0<this.B&&((this.K=function uS(n){return ch&&function jD(){return function FD(n){var e=VD;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=Tv(String(Dm)).split("."),t=Tv("9").split("."),r=Math.max(e.length,t.length);for(let c=0;0==n&&c<r;c++){var i=e[c]||"",u=t[c]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==i[0].length&&0==u[0].length)break;n=Tm(0==i[1].length?0:parseInt(i[1],10),0==u[1].length?0:parseInt(u[1],10))||Tm(0==i[2].length,0==u[2].length)||Tm(i[2],u[2]),i=i[3],u=u[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=oi(this.pa,this)):this.A=Vv(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(u){$m(this,u)}},We.pa=function(){void 0!==As&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Er(this,"timeout"),this.abort(8))},We.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Er(this,"complete"),Er(this,"abort"),Hm(this))},We.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Hm(this,!0)),Ir.Z.M.call(this)},We.Fa=function(){this.s||(this.F||this.v||this.l?cS(this):this.cb())},We.cb=function(){cS(this)},We.ba=function(){try{return 2<cs(this)?this.g.status:-1}catch(n){return-1}},We.ga=function(){try{return this.g?this.g.responseText:""}catch(n){return""}},We.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Up(e)}},We.Da=function(){return this.m},We.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(We=Ib.prototype).ma=8,We.G=1,We.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch(e){}},We.Ha=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;const i=new kp(this,this.h,n,void 0);let u=this.s;if(this.P&&(u?(u=kI(u),NI(u,this.P)):u=this.P),null===this.o&&(i.H=u),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var r=this.l[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Cb(this,i,e),kn(t=du(this.F),"RID",n),kn(t,"CVER",22),this.D&&kn(t,"X-HTTP-Session-Id",this.D),Vp(this,t),this.o&&u&&Eb(t,this.o,u),nw(this.i,i),this.Ra&&kn(t,"TYPE","init"),this.ja?(kn(t,"$req",e),kn(t,"SID","null"),i.$=!0,Kv(i,t,null)):Kv(i,t,e),this.G=2}}else 3==this.G&&(n?Tb(this,n):0==this.l.length||sS(this.i)||Tb(this))},We.Ga=function(){if(this.u=null,Sb(this),this.$&&!(this.L||null==this.g||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=km(oi(this.bb,this),n)}},We.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ls(10),Bp(this),Sb(this))},We.ab=function(){null!=this.v&&(this.v=null,Bp(this),aw(this),ls(19))},We.jb=function(n){n?(this.h.info("Successfully pinged google.com"),ls(2)):(this.h.info("Failed to ping google.com"),ls(1))},(We=hw.prototype).xa=function(){},We.wa=function(){},We.va=function(){},We.ua=function(){},We.Oa=function(){},jp.prototype.g=function(n,e){return new Rs(n,e)},ai(Rs,or),Rs.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),Rm(oi(n.hb,n,e))),ls(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=cw(n,null,n.W),Ch(n)},Rs.prototype.close=function(){bb(this.g)},Rs.prototype.u=function(n){if("string"==typeof n){var e={};e.__data__=n,qm(this.g,e)}else this.v?((e={}).__data__=GI(n),qm(this.g,e)):qm(this.g,n)},Rs.prototype.M=function(){this.g.j=null,delete this.j,bb(this.g),delete this.g,Rs.Z.M.call(this)},ai(fw,qv),ai(Rb,Wv),ai(Sh,hw),Sh.prototype.xa=function(){Er(this.g,"a")},Sh.prototype.wa=function(n){Er(this.g,new fw(n))},Sh.prototype.va=function(n){Er(this.g,new Rb(n))},Sh.prototype.ua=function(){Er(this.g,"b")},jp.prototype.createWebChannel=jp.prototype.g,Rs.prototype.send=Rs.prototype.u,Rs.prototype.open=Rs.prototype.m,Rs.prototype.close=Rs.prototype.close,xp.NO_ERROR=0,xp.TIMEOUT=8,xp.HTTP_ERROR=6,Pp.COMPLETE="complete",Hv.EventType=lu,lu.OPEN="a",lu.CLOSE="b",lu.ERROR="c",lu.MESSAGE="d",or.prototype.listen=or.prototype.N,Ir.prototype.listenOnce=Ir.prototype.O,Ir.prototype.getLastError=Ir.prototype.La,Ir.prototype.getLastErrorCode=Ir.prototype.Da,Ir.prototype.getStatus=Ir.prototype.ba,Ir.prototype.getResponseJson=Ir.prototype.Qa,Ir.prototype.getResponseText=Ir.prototype.ga,Ir.prototype.send=Ir.prototype.ea;var fS=au.createWebChannelTransport=function(){return new jp},pS=au.getStatEventTarget=function(){return Ap()},Nc=au.ErrorCode=xp,gS=au.EventType=Pp,pw=au.Event=ll,Co=au.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},mS=au.FetchXmlHttpFactory=Fp,Ah=au.WebChannel=Hv,$p=au.XhrIo=Ir;const xb="@firebase/firestore";class li{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}li.UNAUTHENTICATED=new li(null),li.GOOGLE_CREDENTIALS=new li("google-credentials-uid"),li.FIRST_PARTY=new li("first-party-uid"),li.MOCK_USER=new li("mock-user");let Rh="9.6.3";const Do=new sa.Yd("@firebase/firestore");function xh(){return Do.logLevel}function Le(n,...e){if(Do.logLevel<=sa.in.DEBUG){const t=e.map(Hp);Do.debug(`Firestore (${Rh}): ${n}`,...t)}}function ar(n,...e){if(Do.logLevel<=sa.in.ERROR){const t=e.map(Hp);Do.error(`Firestore (${Rh}): ${n}`,...t)}}function Ph(n,...e){if(Do.logLevel<=sa.in.WARN){const t=e.map(Hp);Do.warn(`Firestore (${Rh}): ${n}`,...t)}}function Hp(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch(t){return n}}function at(n="Unexpected state"){const e=`FIRESTORE (${Rh}) INTERNAL ASSERTION FAILED: `+n;throw ar(e),new Error(e)}function Et(n,e){n||at()}function qe(n,e){return n}const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends O.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Mr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Gm{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gw{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(li.UNAUTHENTICATED))}shutdown(){}}class vS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class wS{constructor(e){this.t=e,this.currentUser=li.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const u=I=>this.i!==i?(i=this.i,t(I)):Promise.resolve();let c=new Mr;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Mr,e.enqueueRetryable(()=>u(this.currentUser))};const f=()=>{const I=c;e.enqueueRetryable((0,fe.Z)(function*(){yield I.promise,yield u(r.currentUser)}))},y=I=>{Le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=I,this.auth.addAuthTokenListener(this.o),f()};this.t.onInit(I=>y(I)),setTimeout(()=>{if(!this.auth){const I=this.t.getImmediate({optional:!0});I?y(I):(Le("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Mr)}},0),f()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Et("string"==typeof r.accessToken),new Gm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Et(null===e||"string"==typeof e),new li(e)}}class ES{constructor(e,t,r){this.type="FirstParty",this.user=li.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const i=e.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class IS{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new ES(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(li.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _w{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null}start(e,t){this.o=i=>{e.enqueueRetryable(()=>{return null!=(u=i).error&&Le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`),t(u.token);var u})};const r=i=>{Le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?r(i):Le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Et("string"==typeof t.token),new mw(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class xs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.p(r),this.T=r=>t.writeSequenceNumber(r))}p(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.T&&this.T(e),e}}function Pb(n){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}xs.I=-1;class yw{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=Pb(40);for(let u=0;u<i.length;++u)r.length<20&&i[u]<t&&(r+=e.charAt(i[u]%e.length))}return r}}function Vt(n,e){return n<e?-1:n>e?1:0}function Oc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function vw(n){return n+"\0"}class zr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Re(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Re(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Re(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return zr.fromMillis(Date.now())}static fromDate(e){return zr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new zr(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Vt(this.nanoseconds,e.nanoseconds):Vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new zr(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function ww(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ur(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Lc(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class qp{constructor(e,t,r){void 0===t?t=0:t>e.length&&at(),void 0===r?r=e.length-t:r>e.length-t&&at(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===qp.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qp?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const u=e.get(i),c=t.get(i);if(u<c)return-1;if(u>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Xt extends qp{construct(e,t,r){return new Xt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Re(le.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Xt(t)}static emptyPath(){return new Xt([])}}const _P=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lr extends qp{construct(e,t,r){return new lr(e,t,r)}static isValidIdentifier(e){return _P.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new lr(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const u=()=>{if(0===r.length)throw new Re(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;i<e.length;){const f=e[i];if("\\"===f){if(i+1===e.length)throw new Re(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const y=e[i+1];if("\\"!==y&&"."!==y&&"`"!==y)throw new Re(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=y,i+=2}else"`"===f?(c=!c,i++):"."!==f||c?(r+=f,i++):(u(),i++)}if(u(),c)throw new Re(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lr(t)}static emptyPath(){return new lr([])}}class kh{constructor(e){this.fields=e,e.sort(lr.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oc(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Nr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Nr(t)}static fromUint8Array(e){const t=function(r){let i="";for(let u=0;u<r.length;++u)i+=String.fromCharCode(r[u]);return i}(e);return new Nr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nr.EMPTY_BYTE_STRING=new Nr("");const kb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pl(n){if(Et(!!n),"string"==typeof n){let e=0;const t=kb.exec(n);if(Et(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:br(n.seconds),nanos:br(n.nanos)}}function br(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function gl(n){return"string"==typeof n?Nr.fromBase64String(n):Nr.fromUint8Array(n)}function Zm(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Iw(n){const e=n.mapValue.fields.__previous_value__;return Zm(e)?Iw(e):e}function ml(n){const e=pl(n.mapValue.fields.__local_write_time__.timestampValue);return new zr(e.seconds,e.nanos)}function hu(n){return null==n}function bw(n){return 0===n&&1/n==-1/0}function Tw(n){return"number"==typeof n&&Number.isInteger(n)&&!bw(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class st{constructor(e){this.path=e}static fromPath(e){return new st(Xt.fromString(e))}static fromName(e){return new st(Xt.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===Xt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Xt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new st(new Xt(e.slice()))}}function _l(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zm(n)?4:10:at()}function Ps(n,e){if(n===e)return!0;const t=_l(n);if(t!==_l(e))return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ml(n).isEqual(ml(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const u=pl(r.timestampValue),c=pl(i.timestampValue);return u.seconds===c.seconds&&u.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,gl(n.bytesValue).isEqual(gl(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return br(r.geoPointValue.latitude)===br(i.geoPointValue.latitude)&&br(r.geoPointValue.longitude)===br(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return br(r.integerValue)===br(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const u=br(r.doubleValue),c=br(i.doubleValue);return u===c?bw(u)===bw(c):isNaN(u)&&isNaN(c)}return!1}(n,e);case 9:return Oc(n.arrayValue.values||[],e.arrayValue.values||[],Ps);case 10:return function(r,i){const u=r.mapValue.fields||{},c=i.mapValue.fields||{};if(ww(u)!==ww(c))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(void 0===c[f]||!Ps(u[f],c[f])))return!1;return!0}(n,e);default:return at()}var i}function Mh(n,e){return void 0!==(n.values||[]).find(t=>Ps(t,e))}function Nh(n,e){if(n===e)return 0;const t=_l(n),r=_l(e);if(t!==r)return Vt(t,r);switch(t){case 0:return 0;case 1:return Vt(n.booleanValue,e.booleanValue);case 2:return function(i,u){const c=br(i.integerValue||i.doubleValue),f=br(u.integerValue||u.doubleValue);return c<f?-1:c>f?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1}(n,e);case 3:return zm(n.timestampValue,e.timestampValue);case 4:return zm(ml(n),ml(e));case 5:return Vt(n.stringValue,e.stringValue);case 6:return function(i,u){const c=gl(i),f=gl(u);return c.compareTo(f)}(n.bytesValue,e.bytesValue);case 7:return function(i,u){const c=i.split("/"),f=u.split("/");for(let y=0;y<c.length&&y<f.length;y++){const I=Vt(c[y],f[y]);if(0!==I)return I}return Vt(c.length,f.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,u){const c=Vt(br(i.latitude),br(u.latitude));return 0!==c?c:Vt(br(i.longitude),br(u.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,u){const c=i.values||[],f=u.values||[];for(let y=0;y<c.length&&y<f.length;++y){const I=Nh(c[y],f[y]);if(I)return I}return Vt(c.length,f.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,u){const c=i.fields||{},f=Object.keys(c),y=u.fields||{},I=Object.keys(y);f.sort(),I.sort();for(let S=0;S<f.length&&S<I.length;++S){const A=Vt(f[S],I[S]);if(0!==A)return A;const M=Nh(c[f[S]],y[I[S]]);if(0!==M)return M}return Vt(f.length,I.length)}(n.mapValue,e.mapValue);default:throw at()}}function zm(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Vt(n,e);const t=pl(n),r=pl(e),i=Vt(t.seconds,r.seconds);return 0!==i?i:Vt(t.nanos,r.nanos)}function Wp(n){return Mb(n)}function Mb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=pl(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?gl(n.bytesValue).toBase64():"referenceValue"in n?st.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",u=!0;for(const c of r.values||[])u?u=!1:i+=",",i+=Mb(c);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let u="{",c=!0;for(const f of i)c?c=!1:u+=",",u+=`${f}:${Mb(r.fields[f])}`;return u+"}"}(n.mapValue):at();var e}function Km(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Cw(n){return!!n&&"integerValue"in n}function Ym(n){return!!n&&"arrayValue"in n}function Dw(n){return!!n&&"nullValue"in n}function Nb(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Gp(n){return!!n&&"mapValue"in n}function Oh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ur(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Oh(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Oh(n.arrayValue.values[t]);return e}return Object.assign({},n)}class _i{constructor(e){this.value=e}static empty(){return new _i({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Gp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oh(t)}setAll(e){let t=lr.emptyPath(),r={},i=[];e.forEach((c,f)=>{if(!t.isImmediateParentOf(f)){const y=this.getFieldsMap(t);this.applyChanges(y,r,i),r={},i=[],t=f.popLast()}c?r[f.lastSegment()]=Oh(c):i.push(f.lastSegment())});const u=this.getFieldsMap(t);this.applyChanges(u,r,i)}delete(e){const t=this.field(e.popLast());Gp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ps(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Gp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ur(t,(i,u)=>e[i]=u);for(const i of r)delete e[i]}clone(){return new _i(Oh(this.value))}}function Ob(n){const e=[];return ur(n.fields,(t,r)=>{const i=new lr([t]);if(Gp(r)){const u=Ob(r.mapValue).fields;if(0===u.length)e.push(i);else for(const c of u)e.push(i.child(c))}else e.push(i)}),new kh(e)}class Tn{constructor(e,t,r,i,u){this.key=e,this.documentType=t,this.version=r,this.data=i,this.documentState=u}static newInvalidDocument(e){return new Tn(e,0,Ct.min(),_i.empty(),0)}static newFoundDocument(e,t,r){return new Tn(e,1,t,r,0)}static newNoDocument(e,t){return new Tn(e,2,t,_i.empty(),0)}static newUnknownDocument(e,t){return new Tn(e,3,t,_i.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_i.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_i.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class TS{constructor(e,t=null,r=[],i=[],u=null,c=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=u,this.startAt=c,this.endAt=f,this.R=null}}function Sw(n,e=null,t=[],r=[],i=null,u=null,c=null){return new TS(n,e,t,r,i,u,c)}function Lh(n){const e=qe(n);if(null===e.R){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>function yP(n){return n.field.canonicalString()+n.op.toString()+Wp(n.value)}(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),hu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Fc(e.startAt)),e.endAt&&(t+="|ub:",t+=Fc(e.endAt)),e.R=t}return e.R}function Zp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!Aw(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!Ps(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Rw(n.startAt,e.startAt)&&Rw(n.endAt,e.endAt)}function Qm(n){return st.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class Gi extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.P(e,t,r):new Fb(e,t,r):"array-contains"===t?new EP(e,r):"in"===t?new IP(e,r):"not-in"===t?new bP(e,r):"array-contains-any"===t?new TP(e,r):new Gi(e,t,r)}static P(e,t,r){return"in"===t?new vP(e,r):new wP(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(Nh(t,this.value)):null!==t&&_l(this.value)===_l(t)&&this.v(Nh(t,this.value))}v(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return at()}}V(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Fb extends Gi{constructor(e,t,r){super(e,t,r),this.key=st.fromName(r.referenceValue)}matches(e){const t=st.comparator(e.key,this.key);return this.v(t)}}class vP extends Gi{constructor(e,t){super(e,"in",t),this.keys=CS(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class wP extends Gi{constructor(e,t){super(e,"not-in",t),this.keys=CS(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function CS(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>st.fromName(r.referenceValue))}class EP extends Gi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ym(t)&&Mh(t.arrayValue,this.value)}}class IP extends Gi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Mh(this.value.arrayValue,t)}}class bP extends Gi{constructor(e,t){super(e,"not-in",t)}matches(e){if(Mh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Mh(this.value.arrayValue,t)}}class TP extends Gi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ym(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Mh(this.value.arrayValue,r))}}class Jm{constructor(e,t){this.position=e,this.before=t}}function Fc(n){return`${n.before?"b":"a"}:${n.position.map(e=>Wp(e)).join(",")}`}class zp{constructor(e,t="asc"){this.field=e,this.dir=t}}function Aw(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function Uc(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const u=e[i],c=n.position[i];if(r=u.field.isKeyField()?st.comparator(st.fromName(c.referenceValue),t.key):Nh(c,t.data.field(u.field)),"desc"===u.dir&&(r*=-1),0!==r)break}return n.before?r<=0:r<0}function Rw(n,e){if(null===n)return null===e;if(null===e||n.before!==e.before||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ps(n.position[t],e.position[t]))return!1;return!0}class fu{constructor(e,t=null,r=[],i=[],u=null,c="F",f=null,y=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=u,this.limitType=c,this.startAt=f,this.endAt=y,this.S=null,this.D=null}}function Ub(n,e,t,r,i,u,c,f){return new fu(n,e,t,r,i,u,c,f)}function yl(n){return new fu(n)}function Kp(n){return!hu(n.limit)&&"F"===n.limitType}function Yp(n){return!hu(n.limit)&&"L"===n.limitType}function Xm(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function Bb(n){for(const e of n.filters)if(e.V())return e.field;return null}function e_(n){return null!==n.collectionGroup}function pu(n){const e=qe(n);if(null===e.S){e.S=[];const t=Bb(e),r=Xm(e);if(null!==t&&null===r)t.isKeyField()||e.S.push(new zp(t)),e.S.push(new zp(lr.keyField(),"asc"));else{let i=!1;for(const u of e.explicitOrderBy)e.S.push(u),u.field.isKeyField()&&(i=!0);if(!i){const u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.S.push(new zp(lr.keyField(),u))}}}return e.S}function ks(n){const e=qe(n);if(!e.D)if("F"===e.limitType)e.D=Sw(e.path,e.collectionGroup,pu(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const u of pu(e))t.push(new zp(u.field,"desc"===u.dir?"asc":"desc"));const r=e.endAt?new Jm(e.endAt.position,!e.endAt.before):null,i=e.startAt?new Jm(e.startAt.position,!e.startAt.before):null;e.D=Sw(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.D}function DS(n,e,t){return new fu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function t_(n,e){return Zp(ks(n),ks(e))&&n.limitType===e.limitType}function SS(n){return`${Lh(ks(n))}|lt:${n.limitType}`}function xw(n){return`Query(target=${function Lb(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${Wp(r.value)}`;var r}).join(", ")}]`),hu(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: "+Fc(n.startAt)),n.endAt&&(e+=", endAt: "+Fc(n.endAt)),`Target(${e})`}(ks(n))}; limitType=${n.limitType})`}function Bc(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):st.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!Uc(t.startAt,pu(t),r)||t.endAt&&Uc(t.endAt,pu(t),r)));var t,r}function Vb(n){return(e,t)=>{let r=!1;for(const i of pu(n)){const u=CP(i,e,t);if(0!==u)return u;r=r||i.field.isKeyField()}return 0}}function CP(n,e,t){const r=n.field.isKeyField()?st.comparator(e.key,t.key):function(i,u,c){const f=u.data.field(i),y=c.data.field(i);return null!==f&&null!==y?Nh(f,y):at()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return at()}}function jb(n,e){if(n.C){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bw(e)?"-0":e}}function n_(n){return{integerValue:""+n}}function $b(n,e){return Tw(e)?n_(e):jb(n,e)}class yi{constructor(){this._=void 0}}function AS(n,e,t){return n instanceof Fh?function(r,i){const u={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(u.fields.__previous_value__=i),{mapValue:u}}(t,e):n instanceof gu?kw(n,e):n instanceof vl?qb(n,e):function(r,i){const u=Hb(r,i),c=Mw(u)+Mw(r.N);return Cw(u)&&Cw(r.N)?n_(c):jb(r.k,c)}(n,e)}function Pw(n,e,t){return n instanceof gu?kw(n,e):n instanceof vl?qb(n,e):t}function Hb(n,e){return n instanceof Vc?Cw(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class Fh extends yi{}class gu extends yi{constructor(e){super(),this.elements=e}}function kw(n,e){const t=Wb(e);for(const r of n.elements)t.some(i=>Ps(i,r))||t.push(r);return{arrayValue:{values:t}}}class vl extends yi{constructor(e){super(),this.elements=e}}function qb(n,e){let t=Wb(e);for(const r of n.elements)t=t.filter(i=>!Ps(i,r));return{arrayValue:{values:t}}}class Vc extends yi{constructor(e,t){super(),this.k=e,this.N=t}}function Mw(n){return br(n.integerValue||n.doubleValue)}function Wb(n){return Ym(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Qp{constructor(e,t){this.field=e,this.transform=t}}class So{constructor(e,t){this.version=e,this.transformResults=t}}class Tr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Tr}static exists(e){return new Tr(void 0,e)}static updateTime(e){return new Tr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ow(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class r_{}function Gb(n,e,t){n instanceof i_?function(r,i,u){const c=r.value.clone(),f=zb(r.fieldTransforms,i,u.transformResults);c.setAll(f),i.convertToFoundDocument(u.version,c).setHasCommittedMutations()}(n,e,t):n instanceof mu?function(r,i,u){if(!Ow(r.precondition,i))return void i.convertToUnknownDocument(u.version);const c=zb(r.fieldTransforms,i,u.transformResults),f=i.data;f.setAll(Uw(r)),f.setAll(c),i.convertToFoundDocument(u.version,f).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Lw(n,e,t){var i;n instanceof i_?function(r,i,u){if(!Ow(r.precondition,i))return;const c=r.value.clone(),f=Kb(r.fieldTransforms,u,i);c.setAll(f),i.convertToFoundDocument(Zb(i),c).setHasLocalMutations()}(n,e,t):n instanceof mu?function(r,i,u){if(!Ow(r.precondition,i))return;const c=Kb(r.fieldTransforms,u,i),f=i.data;f.setAll(Uw(r)),f.setAll(c),i.convertToFoundDocument(Zb(i),f).setHasLocalMutations()}(n,e,t):Ow(n.precondition,i=e)&&i.convertToNoDocument(Ct.min())}function RS(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),u=Hb(r.transform,i||null);null!=u&&(null==t&&(t=_i.empty()),t.set(r.field,u))}return t||null}function Fw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Oc(t,r,(i,u)=>function Nw(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof gu&&r instanceof gu||t instanceof vl&&r instanceof vl?Oc(t.elements,r.elements,Ps):t instanceof Vc&&r instanceof Vc?Ps(t.N,r.N):t instanceof Fh&&r instanceof Fh);var t,r}(i,u))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}function Zb(n){return n.isFoundDocument()?n.version:Ct.min()}class i_ extends r_{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}}class mu extends r_{constructor(e,t,r,i,u=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=u,this.type=1}}function Uw(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function zb(n,e,t){const r=new Map;Et(n.length===t.length);for(let i=0;i<t.length;i++){const u=n[i],c=u.transform,f=e.data.field(u.field);r.set(u.field,Pw(c,f,t[i]))}return r}function Kb(n,e,t){const r=new Map;for(const i of n){const u=i.transform,c=t.data.field(i.field);r.set(i.field,AS(u,c,e))}return r}class Uh extends r_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class jc extends r_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}class Bw{constructor(e){this.count=e}}var cr,Gt;function Vw(n){switch(n){default:return at();case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0}}function jw(n){if(void 0===n)return ar("GRPC error has no .code"),le.UNKNOWN;switch(n){case cr.OK:return le.OK;case cr.CANCELLED:return le.CANCELLED;case cr.UNKNOWN:return le.UNKNOWN;case cr.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case cr.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case cr.INTERNAL:return le.INTERNAL;case cr.UNAVAILABLE:return le.UNAVAILABLE;case cr.UNAUTHENTICATED:return le.UNAUTHENTICATED;case cr.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case cr.NOT_FOUND:return le.NOT_FOUND;case cr.ALREADY_EXISTS:return le.ALREADY_EXISTS;case cr.PERMISSION_DENIED:return le.PERMISSION_DENIED;case cr.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case cr.ABORTED:return le.ABORTED;case cr.OUT_OF_RANGE:return le.OUT_OF_RANGE;case cr.UNIMPLEMENTED:return le.UNIMPLEMENTED;case cr.DATA_LOSS:return le.DATA_LOSS;default:return at()}}(Gt=cr||(cr={}))[Gt.OK=0]="OK",Gt[Gt.CANCELLED=1]="CANCELLED",Gt[Gt.UNKNOWN=2]="UNKNOWN",Gt[Gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gt[Gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gt[Gt.NOT_FOUND=5]="NOT_FOUND",Gt[Gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gt[Gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gt[Gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gt[Gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gt[Gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gt[Gt.ABORTED=10]="ABORTED",Gt[Gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gt[Gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gt[Gt.INTERNAL=13]="INTERNAL",Gt[Gt.UNAVAILABLE=14]="UNAVAILABLE",Gt[Gt.DATA_LOSS=15]="DATA_LOSS";class Or{constructor(e,t){this.comparator=e,this.root=t||vi.EMPTY}insert(e,t){return new Or(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,vi.BLACK,null,null))}remove(e){return new Or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new s_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new s_(this.root,e,this.comparator,!1)}getReverseIterator(){return new s_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new s_(this.root,e,this.comparator,!0)}}class s_{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?r(e.key,t):1,i&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(0===u){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vi{constructor(e,t,r,i,u){this.key=e,this.value=t,this.color=null!=r?r:vi.RED,this.left=null!=i?i:vi.EMPTY,this.right=null!=u?u:vi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,u){return new vi(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=u?u:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const u=r(e,i.key);return i=u<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===u?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return vi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return vi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw at();const e=this.left.check();if(e!==this.right.check())throw at();return e+(this.isRed()?0:1)}}vi.EMPTY=null,vi.RED=!0,vi.BLACK=!1,vi.EMPTY=new class{constructor(){this.size=0}get key(){throw at()}get value(){throw at()}get color(){throw at()}get left(){throw at()}get right(){throw at()}copy(n,e,t,r,i){return this}insert(n,e,t){return new vi(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class dr{constructor(e){this.comparator=e,this.data=new Or(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new $w(this.data.getIterator())}getIteratorFrom(e){return new $w(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof dr)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,u=r.getNext().key;if(0!==this.comparator(i,u))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new dr(this.comparator);return t.data=e,t}}class $w{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const xS=new Or(st.comparator);function io(){return xS}const PS=new Or(st.comparator);function Yb(){return PS}const DP=new Or(st.comparator);function kS(){return DP}const SP=new dr(st.comparator);function fn(...n){let e=SP;for(const t of n)e=e.add(t);return e}const MS=new dr(Vt);function $c(){return MS}class Jp{constructor(e,t,r,i,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t){const r=new Map;return r.set(e,Xp.createSynthesizedTargetChangeForCurrentChange(e,t)),new Jp(Ct.min(),r,$c(),io(),fn())}}class Xp{constructor(e,t,r,i,u){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t){return new Xp(Nr.EMPTY_BYTE_STRING,t,fn(),fn(),fn())}}class eg{constructor(e,t,r,i){this.$=e,this.removedTargetIds=t,this.key=r,this.O=i}}class wl{constructor(e,t){this.targetId=e,this.M=t}}class Hw{constructor(e,t,r=Nr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class o_{constructor(){this.F=0,this.L=a_(),this.B=Nr.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}get current(){return this.U}get resumeToken(){return this.B}get K(){return 0!==this.F}get j(){return this.q}W(e){e.approximateByteSize()>0&&(this.q=!0,this.B=e)}G(){let e=fn(),t=fn(),r=fn();return this.L.forEach((i,u)=>{switch(u){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:at()}}),new Xp(this.B,this.U,e,t,r)}H(){this.q=!1,this.L=a_()}J(e,t){this.q=!0,this.L=this.L.insert(e,t)}Y(e){this.q=!0,this.L=this.L.remove(e)}X(){this.F+=1}Z(){this.F-=1}tt(){this.q=!0,this.U=!0}}class qw{constructor(e){this.et=e,this.nt=new Map,this.st=io(),this.it=Qb(),this.rt=new dr(Vt)}ot(e){for(const t of e.$)e.O&&e.O.isFoundDocument()?this.ct(t,e.O):this.at(t,e.key,e.O);for(const t of e.removedTargetIds)this.at(t,e.key,e.O)}ut(e){this.forEachTarget(e,t=>{const r=this.ht(t);switch(e.state){case 0:this.lt(t)&&r.W(e.resumeToken);break;case 1:r.Z(),r.K||r.H(),r.W(e.resumeToken);break;case 2:r.Z(),r.K||this.removeTarget(t);break;case 3:this.lt(t)&&(r.tt(),r.W(e.resumeToken));break;case 4:this.lt(t)&&(this.ft(t),r.W(e.resumeToken));break;default:at()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.nt.forEach((r,i)=>{this.lt(i)&&t(i)})}dt(e){const t=e.targetId,r=e.M.count,i=this.wt(t);if(i){const u=i.target;if(Qm(u))if(0===r){const c=new st(u.path);this.at(t,c,Tn.newNoDocument(c,Ct.min()))}else Et(1===r);else this._t(t)!==r&&(this.ft(t),this.rt=this.rt.add(t))}}gt(e){const t=new Map;this.nt.forEach((u,c)=>{const f=this.wt(c);if(f){if(u.current&&Qm(f.target)){const y=new st(f.target.path);null!==this.st.get(y)||this.yt(c,y)||this.at(c,y,Tn.newNoDocument(y,e))}u.j&&(t.set(c,u.G()),u.H())}});let r=fn();this.it.forEach((u,c)=>{let f=!0;c.forEachWhile(y=>{const I=this.wt(y);return!I||2===I.purpose||(f=!1,!1)}),f&&(r=r.add(u))});const i=new Jp(e,t,this.rt,this.st,r);return this.st=io(),this.it=Qb(),this.rt=new dr(Vt),i}ct(e,t){if(!this.lt(e))return;const r=this.yt(e,t.key)?2:0;this.ht(e).J(t.key,r),this.st=this.st.insert(t.key,t),this.it=this.it.insert(t.key,this.Tt(t.key).add(e))}at(e,t,r){if(!this.lt(e))return;const i=this.ht(e);this.yt(e,t)?i.J(t,1):i.Y(t),this.it=this.it.insert(t,this.Tt(t).delete(e)),r&&(this.st=this.st.insert(t,r))}removeTarget(e){this.nt.delete(e)}_t(e){const t=this.ht(e).G();return this.et.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}X(e){this.ht(e).X()}ht(e){let t=this.nt.get(e);return t||(t=new o_,this.nt.set(e,t)),t}Tt(e){let t=this.it.get(e);return t||(t=new dr(Vt),this.it=this.it.insert(e,t)),t}lt(e){const t=null!==this.wt(e);return t||Le("WatchChangeAggregator","Detected inactive target",e),t}wt(e){const t=this.nt.get(e);return t&&t.K?null:this.et.Et(e)}ft(e){this.nt.set(e,new o_),this.et.getRemoteKeysForTarget(e).forEach(t=>{this.at(e,t,null)})}yt(e,t){return this.et.getRemoteKeysForTarget(e).has(t)}}function Qb(){return new Or(st.comparator)}function a_(){return new Or(st.comparator)}const Ww={asc:"ASCENDING",desc:"DESCENDING"},Jb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Xb{constructor(e,t){this.databaseId=e,this.C=t}}function u_(n,e){return n.C?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function NS(n,e){return n.C?e.toBase64():e.toUint8Array()}function AP(n,e){return u_(n,e.toTimestamp())}function ci(n){return Et(!!n),Ct.fromTimestamp(function(e){const t=pl(e);return new zr(t.seconds,t.nanos)}(n))}function eT(n,e){return(t=n,new Xt(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function OS(n){const e=Xt.fromString(n);return Et(aT(e)),e}function l_(n,e){return eT(n.databaseId,e.path)}function Ao(n,e){const t=OS(e);if(t.get(1)!==n.databaseId.projectId)throw new Re(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Re(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new st(nT(t))}function Gw(n,e){return eT(n.databaseId,e)}function tT(n){const e=OS(n);return 4===e.length?Xt.emptyPath():nT(e)}function tg(n){return new Xt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function nT(n){return Et(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Zw(n,e,t){return{name:l_(n,e),fields:t.value.mapValue.fields}}function zw(n,e,t){const r=Ao(n,e.name),i=ci(e.updateTime),u=new _i({mapValue:{fields:e.fields}}),c=Tn.newFoundDocument(r,i,u);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function c_(n,e){let t;if(e instanceof i_)t={update:Zw(n,e.key,e.value)};else if(e instanceof Uh)t={delete:l_(n,e.key)};else if(e instanceof mu)t={update:Zw(n,e.key,e.data),updateMask:$S(e.fieldMask)};else{if(!(e instanceof jc))return at();t={verify:l_(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,u){const c=u.transform;if(c instanceof Fh)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof gu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof vl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Vc)return{fieldPath:u.field.canonicalString(),increment:c.N};throw at()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:AP(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:at()),t;var i}function Kw(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?Tr.updateTime(ci(i.updateTime)):void 0!==i.exists?Tr.exists(i.exists):Tr.none():Tr.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(u,c){let f=null;"setToServerValue"in c?(Et("REQUEST_TIME"===c.setToServerValue),f=new Fh):"appendMissingElements"in c?f=new gu(c.appendMissingElements.values||[]):"removeAllFromArray"in c?f=new vl(c.removeAllFromArray.values||[]):"increment"in c?f=new Vc(u,c.increment):at();const y=lr.fromServerFormat(c.fieldPath);return new Qp(y,f)}(n,i)):[];var i;if(e.update){const i=Ao(n,e.update.name),u=new _i({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=new kh((e.updateMask.fieldPaths||[]).map(I=>lr.fromServerFormat(I)));return new mu(i,u,c,t,r)}return new i_(i,u,t,r)}if(e.delete){const i=Ao(n,e.delete);return new Uh(i,t)}if(e.verify){const i=Ao(n,e.verify);return new jc(i,t)}return at()}function FS(n,e){return{documents:[Gw(n,e.path)]}}function Yw(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=Gw(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Gw(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(f){if(0===f.length)return;const y=f.map(I=>function(S){if("=="===S.op){if(Nb(S.value))return{unaryFilter:{field:Bh(S.field),op:"IS_NAN"}};if(Dw(S.value))return{unaryFilter:{field:Bh(S.field),op:"IS_NULL"}}}else if("!="===S.op){if(Nb(S.value))return{unaryFilter:{field:Bh(S.field),op:"IS_NOT_NAN"}};if(Dw(S.value))return{unaryFilter:{field:Bh(S.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bh(S.field),op:BS(S.op),value:S.value}}}(I));return 1===y.length?y[0]:{compositeFilter:{op:"AND",filters:y}}}(e.filters);i&&(t.structuredQuery.where=i);const u=function(f){if(0!==f.length)return f.map(y=>{return{field:Bh((I=y).field),direction:RP(I.dir)};var I})}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const c=(y=e.limit,n.C||hu(y)?y:{value:y});var y;return null!==c&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=sT(e.startAt)),e.endAt&&(t.structuredQuery.endAt=sT(e.endAt)),t}function ng(n){let e=tT(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Et(1===r);const S=t.from[0];S.allDescendants?i=S.collectionId:e=e.child(S.collectionId)}let u=[];t.where&&(u=iT(t.where));let c=[];t.orderBy&&(c=t.orderBy.map(S=>{return new zp(Vh((A=S).field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction));var A}));let f=null;t.limit&&(f=function(S){let A;return A="object"==typeof S?S.value:S,hu(A)?null:A}(t.limit));let y=null;t.startAt&&(y=oT(t.startAt));let I=null;return t.endAt&&(I=oT(t.endAt)),Ub(e,i,c,u,f,"F",y,I)}function iT(n){return n?void 0!==n.unaryFilter?[jS(n)]:void 0!==n.fieldFilter?[VS(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>iT(e)).reduce((e,t)=>e.concat(t)):at():[]}function sT(n){return{before:n.before,values:n.position}}function oT(n){return new Jm(n.values||[],!!n.before)}function RP(n){return Ww[n]}function BS(n){return Jb[n]}function Bh(n){return{fieldPath:n.canonicalString()}}function Vh(n){return lr.fromServerFormat(n.fieldPath)}function VS(n){return Gi.create(Vh(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return at()}}(n.fieldFilter.op),n.fieldFilter.value)}function jS(n){switch(n.unaryFilter.op){case"IS_NAN":const e=Vh(n.unaryFilter.field);return Gi.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=Vh(n.unaryFilter.field);return Gi.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Vh(n.unaryFilter.field);return Gi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Vh(n.unaryFilter.field);return Gi.create(i,"!=",{nullValue:"NULL_VALUE"});default:return at()}}function $S(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function aT(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Ro(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=HS(e)),e=xP(n.get(t),e);return HS(e)}function xP(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const u=n.charAt(i);switch(u){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=u}}return t}function HS(n){return n+"\x01\x01"}function El(n){const e=n.length;if(Et(e>=2),2===e)return Et("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Xt.emptyPath();const t=e-2,r=[];let i="";for(let u=0;u<e;){const c=n.indexOf("\x01",u);switch((c<0||c>t)&&at(),n.charAt(c+1)){case"\x01":const f=n.substring(u,c);let y;0===i.length?y=f:(i+=f,y=i,i=""),r.push(y);break;case"\x10":i+=n.substring(u,c),i+="\0";break;case"\x11":i+=n.substring(u,c+1);break;default:at()}u=c+2}return new Xt(r)}class PP{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class so{constructor(e,t,r){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=r}}so.store="owner",so.key="owner";class Il{constructor(e,t,r){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=r}}Il.store="mutationQueues",Il.keyPath="userId";class Mn{constructor(e,t,r,i,u){this.userId=e,this.batchId=t,this.localWriteTimeMs=r,this.baseMutations=i,this.mutations=u}}Mn.store="mutations",Mn.keyPath="batchId",Mn.userMutationsIndex="userMutationsIndex",Mn.userMutationsKeyPath=["userId","batchId"];class Zi{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,Ro(t)]}static key(e,t,r){return[e,Ro(t),r]}}Zi.store="documentMutations",Zi.PLACEHOLDER=new Zi;class kP{constructor(e,t){this.path=e,this.readTime=t}}class MP{constructor(e,t){this.path=e,this.version=t}}class s{constructor(e,t,r,i,u,c){this.unknownDocument=e,this.noDocument=t,this.document=r,this.hasCommittedMutations=i,this.readTime=u,this.parentPath=c}}s.store="remoteDocuments",s.readTimeIndex="readTimeIndex",s.readTimeIndexPath="readTime",s.collectionReadTimeIndex="collectionReadTimeIndex",s.collectionReadTimeIndexPath=["parentPath","readTime"];class o{constructor(e){this.byteSize=e}}o.store="remoteDocumentGlobal",o.key="remoteDocumentGlobalKey";class a{constructor(e,t,r,i,u,c,f){this.targetId=e,this.canonicalId=t,this.readTime=r,this.resumeToken=i,this.lastListenSequenceNumber=u,this.lastLimboFreeSnapshotVersion=c,this.query=f}}a.store="targets",a.keyPath="targetId",a.queryTargetsIndexName="queryTargetsIndex",a.queryTargetsKeyPath=["canonicalId","targetId"];class l{constructor(e,t,r){this.targetId=e,this.path=t,this.sequenceNumber=r}}l.store="targetDocuments",l.keyPath=["targetId","path"],l.documentTargetsIndex="documentTargetsIndex",l.documentTargetsKeyPath=["path","targetId"];class d{constructor(e,t,r,i){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=r,this.targetCount=i}}d.key="targetGlobalKey",d.store="targetGlobal";class g{constructor(e,t){this.collectionId=e,this.parent=t}}g.store="collectionParents",g.keyPath=["collectionId","parent"];class v{constructor(e,t,r,i){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=r,this.inForeground=i}}v.store="clientMetadata",v.keyPath="clientId";class E{constructor(e,t,r){this.bundleId=e,this.createTime=t,this.version=r}}E.store="bundles",E.keyPath="bundleId";class b{constructor(e,t,r){this.name=e,this.readTime=t,this.bundledQuery=r}}b.store="namedQueries",b.keyPath="name";const R=[Il.store,Mn.store,Zi.store,s.store,a.store,so.store,d.store,l.store,v.store,o.store,g.store,E.store,b.store],P="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class U{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&at(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new N((r,i)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(r,i)},this.catchCallback=u=>{this.wrapFailure(t,u).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof N?t:N.resolve(t)}catch(t){return N.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):N.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):N.reject(t)}static resolve(e){return new N((t,r)=>{t(e)})}static reject(e){return new N((t,r)=>{r(e)})}static waitFor(e){return new N((t,r)=>{let i=0,u=0,c=!1;e.forEach(f=>{++i,f.next(()=>{++u,c&&u===i&&t()},y=>r(y))}),c=!0,u===i&&t()})}static or(e){let t=N.resolve(!1);for(const r of e)t=t.next(i=>i?N.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,u)=>{r.push(t.call(this,i,u))}),this.waitFor(r)}}class Y{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.It=new Mr,this.transaction.oncomplete=()=>{this.It.resolve()},this.transaction.onabort=()=>{t.error?this.It.reject(new Ue(e,t.error)):this.It.resolve()},this.transaction.onerror=r=>{const i=Qt(r.target.error);this.It.reject(new Ue(e,i))}}static open(e,t,r,i){try{return new Y(t,e.transaction(i,r))}catch(u){throw new Ue(t,u)}}get At(){return this.It.promise}abort(e){e&&this.It.reject(e),this.aborted||(Le("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const t=this.transaction.objectStore(e);return new Ce(t)}}class ce{constructor(e,t,r){this.name=e,this.version=t,this.Rt=r,12.2===ce.bt((0,O.z$)())&&ar("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Le("SimpleDb","Removing database:",e),it(window.indexedDB.deleteDatabase(e)).toPromise()}static Pt(){if(!(0,O.hl)())return!1;if(ce.vt())return!0;const e=(0,O.z$)(),t=ce.bt(e),r=0<t&&t<10,i=ce.Vt(e),u=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||u)}static vt(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.St)}static Dt(e,t){return e.store(t)}static bt(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static Vt(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}Ct(e){var t=this;return(0,fe.Z)(function*(){return t.db||(Le("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const u=indexedDB.open(t.name,t.version);u.onsuccess=c=>{r(c.target.result)},u.onblocked=()=>{i(new Ue(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},u.onerror=c=>{const f=c.target.error;i("VersionError"===f.name?new Re(le.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===f.name?new Re(le.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+f):new Ue(e,f))},u.onupgradeneeded=c=>{Le("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',c.oldVersion),t.Rt.Nt(c.target.result,u.transaction,c.oldVersion,t.version).next(()=>{Le("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.kt&&(t.db.onversionchange=r=>t.kt(r)),t.db})()}xt(e){this.kt=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var u=this;return(0,fe.Z)(function*(){const c="readonly"===t;let f=0;for(;;){++f;try{u.db=yield u.Ct(e);const y=Y.open(u.db,e,c?"readonly":"readwrite",r),I=i(y).catch(S=>(y.abort(S),N.reject(S))).toPromise();return I.catch(()=>{}),yield y.At,I}catch(y){const I="FirebaseError"!==y.name&&f<3;if(Le("SimpleDb","Transaction failed with error:",y.message,"Retrying:",I),u.close(),!I)return Promise.reject(y)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Oe{constructor(e){this.$t=e,this.Ot=!1,this.Mt=null}get isDone(){return this.Ot}get Ft(){return this.Mt}set cursor(e){this.$t=e}done(){this.Ot=!0}Lt(e){this.Mt=e}delete(){return it(this.$t.delete())}}class Ue extends Re{constructor(e,t){super(le.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ze(n){return"IndexedDbTransactionError"===n.name}class Ce{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(Le("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Le("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),it(r)}add(e){return Le("SimpleDb","ADD",this.store.name,e,e),it(this.store.add(e))}get(e){return it(this.store.get(e)).next(t=>(void 0===t&&(t=null),Le("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Le("SimpleDb","DELETE",this.store.name,e),it(this.store.delete(e))}count(){return Le("SimpleDb","COUNT",this.store.name),it(this.store.count())}Bt(e,t){const r=this.cursor(this.options(e,t)),i=[];return this.Ut(r,(u,c)=>{i.push(c)}).next(()=>i)}qt(e,t){Le("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.Kt=!1;const i=this.cursor(r);return this.Ut(i,(u,c,f)=>f.delete())}jt(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.Ut(i,t)}Qt(e){const t=this.cursor({});return new N((r,i)=>{t.onerror=u=>{const c=Qt(u.target.error);i(c)},t.onsuccess=u=>{const c=u.target.result;c?e(c.primaryKey,c.value).next(f=>{f?c.continue():r()}):r()}})}Ut(e,t){const r=[];return new N((i,u)=>{e.onerror=c=>{u(c.target.error)},e.onsuccess=c=>{const f=c.target.result;if(!f)return void i();const y=new Oe(f),I=t(f.primaryKey,f.value,y);if(I instanceof N){const S=I.catch(A=>(y.done(),N.reject(A)));r.push(S)}y.isDone?i():null===y.Ft?f.continue():f.continue(y.Ft)}}).next(()=>N.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Kt?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function it(n){return new N((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=Qt(r.target.error);t(i)}})}let Nt=!1;function Qt(n){const e=ce.bt((0,O.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Nt||(Nt=!0,setTimeout(()=>{throw r},0)),r}}return n}class ds extends U{constructor(e,t){super(),this.Wt=e,this.currentSequenceNumber=t}}function Cr(n,e){const t=qe(n);return ce.Dt(t.Wt,e)}class rg{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const u=this.mutations[i];u.key.isEqual(e.key)&&Gb(u,e,r[i])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&Lw(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&Lw(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(t=>{const r=e.get(t.key),i=r;this.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Ct.min())})}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),fn())}isEqual(e){return this.batchId===e.batchId&&Oc(this.mutations,e.mutations,(t,r)=>Fw(t,r))&&Oc(this.baseMutations,e.baseMutations,(t,r)=>Fw(t,r))}}class ig{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Et(e.mutations.length===r.length);let i=kS();const u=e.mutations;for(let c=0;c<u.length;c++)i=i.insert(u[c].key,r[c].version);return new ig(e,t,r,i)}}class la{constructor(e,t,r,i,u=Ct.min(),c=Ct.min(),f=Nr.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=f}withSequenceNumber(e){return new la(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new la(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class h_{constructor(e){this.Gt=e}}function sg(n,e){if(e.document)return zw(n.Gt,e.document,!!e.hasCommittedMutations);if(e.noDocument){const t=st.fromSegments(e.noDocument.path),r=g_(e.noDocument.readTime),i=Tn.newNoDocument(t,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){const t=st.fromSegments(e.unknownDocument.path),r=g_(e.unknownDocument.version);return Tn.newUnknownDocument(t,r)}return at()}function f_(n,e,t){const r=og(t),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){const u={name:l_(f=n.Gt,(y=e).key),fields:y.data.value.mapValue.fields,updateTime:u_(f,y.version.toTimestamp())};return new s(null,null,u,e.hasCommittedMutations,r,i)}var f,y;if(e.isNoDocument()){const u=e.key.path.toArray(),c=bl(e.version),f=e.hasCommittedMutations;return new s(null,new kP(u,c),null,f,r,i)}if(e.isUnknownDocument()){const u=e.key.path.toArray(),c=bl(e.version);return new s(new MP(u,c),null,null,!0,r,i)}return at()}function og(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function p_(n){const e=new zr(n[0],n[1]);return Ct.fromTimestamp(e)}function bl(n){const e=n.toTimestamp();return new PP(e.seconds,e.nanoseconds)}function g_(n){const e=new zr(n.seconds,n.nanoseconds);return Ct.fromTimestamp(e)}function m_(n,e){const t=(e.baseMutations||[]).map(u=>Kw(n.Gt,u));for(let u=0;u<e.mutations.length-1;++u){const c=e.mutations[u];u+1<e.mutations.length&&void 0!==e.mutations[u+1].transform&&(c.updateTransforms=e.mutations[u+1].transform.fieldTransforms,e.mutations.splice(u+1,1),++u)}const r=e.mutations.map(u=>Kw(n.Gt,u)),i=zr.fromMillis(e.localWriteTimeMs);return new rg(e.batchId,i,t,r)}function Qw(n){const e=g_(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?g_(n.lastLimboFreeSnapshotVersion):Ct.min();let r;var i;return void 0!==n.query.documents?(Et(1===(i=n.query).documents.length),r=ks(yl(tT(i.documents[0])))):r=ks(ng(n.query)),new la(r,n.targetId,0,n.lastListenSequenceNumber,e,t,Nr.fromBase64String(n.resumeToken))}function NP(n,e){const t=bl(e.snapshotVersion),r=bl(e.lastLimboFreeSnapshotVersion);let i;i=Qm(e.target)?FS(n.Gt,e.target):Yw(n.Gt,e.target);const u=e.resumeToken.toBase64();return new a(e.targetId,Lh(e.target),t,u,e.sequenceNumber,r,i)}function qS(n){const e=ng({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?DS(e,e.limit,"L"):e}class HO{getBundleMetadata(e,t){return OP(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:g_(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return OP(e).put({bundleId:(r=t).id,createTime:bl(ci(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return LP(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:qS(i.bundledQuery),readTime:g_(i.readTime)};var i})}saveNamedQuery(e,t){return LP(e).put({name:(r=t).name,readTime:bl(ci(r.readTime)),bundledQuery:r.bundledQuery});var r}}function OP(n){return Cr(n,E.store)}function LP(n){return Cr(n,b.store)}class qO{constructor(){this.zt=new WS}addToCollectionParentIndex(e,t){return this.zt.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.zt.getEntries(t))}}class WS{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new dr(Xt.comparator),u=!i.has(r);return this.index[t]=i.add(r),u}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new dr(Xt.comparator)).toArray()}}class WO{constructor(){this.Ht=new WS}addToCollectionParentIndex(e,t){if(!this.Ht.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Ht.add(t)});const u={collectionId:r,parent:Ro(i)};return FP(e).put(u)}return N.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[vw(t),""],!1,!0);return FP(e).Bt(i).next(u=>{for(const c of u){if(c.collectionId!==t)break;r.push(El(c.parent))}return r})}}function FP(n){return Cr(n,g.store)}const UP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class oo{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new oo(e,oo.DEFAULT_COLLECTION_PERCENTILE,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function BP(n,e,t){const r=n.store(Mn.store),i=n.store(Zi.store),u=[],c=IDBKeyRange.only(t.batchId);let f=0;const y=r.jt({range:c},(S,A,M)=>(f++,M.delete()));u.push(y.next(()=>{Et(1===f)}));const I=[];for(const S of t.mutations){const A=Zi.key(e,S.key.path,t.batchId);u.push(i.delete(A)),I.push(S.key)}return N.waitFor(u).next(()=>I)}function uT(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw at();e=n.noDocument}return JSON.stringify(e).length}oo.DEFAULT_COLLECTION_PERCENTILE=10,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oo.DEFAULT=new oo(41943040,oo.DEFAULT_COLLECTION_PERCENTILE,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oo.DISABLED=new oo(-1,0,0);class GS{constructor(e,t,r,i){this.userId=e,this.k=t,this.Jt=r,this.referenceDelegate=i,this.Yt={}}static Xt(e,t,r,i){Et(""!==e.uid);const u=e.isAuthenticated()?e.uid:"";return new GS(u,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return jh(e).jt({index:Mn.userMutationsIndex,range:r},(i,u,c)=>{t=!1,c.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const u=__(e),c=jh(e);return c.add({}).next(f=>{Et("number"==typeof f);const y=new rg(f,t,r,i),I=function(M,V,z){const ye=z.baseMutations.map(_t=>c_(M.Gt,_t)),Pe=z.mutations.map(_t=>c_(M.Gt,_t));return new Mn(V,z.batchId,z.localWriteTime.toMillis(),ye,Pe)}(this.k,this.userId,y),S=[];let A=new dr((M,V)=>Vt(M.canonicalString(),V.canonicalString()));for(const M of i){const V=Zi.key(this.userId,M.key.path,f);A=A.add(M.key.path.popLast()),S.push(c.put(I)),S.push(u.put(V,Zi.PLACEHOLDER))}return A.forEach(M=>{S.push(this.Jt.addToCollectionParentIndex(e,M))}),e.addOnCommittedListener(()=>{this.Yt[f]=y.keys()}),N.waitFor(S).next(()=>y)})}lookupMutationBatch(e,t){return jh(e).get(t).next(r=>r?(Et(r.userId===this.userId),m_(this.k,r)):null)}Zt(e,t){return this.Yt[t]?N.resolve(this.Yt[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Yt[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let u=null;return jh(e).jt({index:Mn.userMutationsIndex,range:i},(c,f,y)=>{f.userId===this.userId&&(Et(f.batchId>=r),u=m_(this.k,f)),y.done()}).next(()=>u)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return jh(e).jt({index:Mn.userMutationsIndex,range:t,reverse:!0},(i,u,c)=>{r=u.batchId,c.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return jh(e).Bt(Mn.userMutationsIndex,t).next(r=>r.map(i=>m_(this.k,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Zi.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),u=[];return __(e).jt({range:i},(c,f,y)=>{const[I,S,A]=c,M=El(S);if(I===this.userId&&t.path.isEqual(M))return jh(e).get(A).next(V=>{if(!V)throw at();Et(V.userId===this.userId),u.push(m_(this.k,V))});y.done()}).next(()=>u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dr(Vt);const i=[];return t.forEach(u=>{const c=Zi.prefixForPath(this.userId,u.path),f=IDBKeyRange.lowerBound(c),y=__(e).jt({range:f},(I,S,A)=>{const[M,V,z]=I,ye=El(V);M===this.userId&&u.path.isEqual(ye)?r=r.add(z):A.done()});i.push(y)}),N.waitFor(i).next(()=>this.te(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,u=Zi.prefixForPath(this.userId,r),c=IDBKeyRange.lowerBound(u);let f=new dr(Vt);return __(e).jt({range:c},(y,I,S)=>{const[A,M,V]=y,z=El(M);A===this.userId&&r.isPrefixOf(z)?z.length===i&&(f=f.add(V)):S.done()}).next(()=>this.te(e,f))}te(e,t){const r=[],i=[];return t.forEach(u=>{i.push(jh(e).get(u).next(c=>{if(null===c)throw at();Et(c.userId===this.userId),r.push(m_(this.k,c))}))}),N.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return BP(e.Wt,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.ee(t.batchId)}),N.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ee(e){delete this.Yt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return N.resolve();const r=IDBKeyRange.lowerBound(Zi.prefixForUser(this.userId)),i=[];return __(e).jt({range:r},(u,c,f)=>{if(u[0]===this.userId){const y=El(u[1]);i.push(y)}else f.done()}).next(()=>{Et(0===i.length)})})}containsKey(e,t){return VP(e,this.userId,t)}ne(e){return jP(e).get(this.userId).next(t=>t||new Il(this.userId,-1,""))}}function VP(n,e,t){const r=Zi.prefixForPath(e,t.path),i=r[1],u=IDBKeyRange.lowerBound(r);let c=!1;return __(n).jt({range:u,Kt:!0},(f,y,I)=>{const[S,A,M]=f;S===e&&A===i&&(c=!0),I.done()}).next(()=>c)}function jh(n){return Cr(n,Mn.store)}function __(n){return Cr(n,Zi.store)}function jP(n){return Cr(n,Il.store)}class ag{constructor(e){this.se=e}next(){return this.se+=2,this.se}static ie(){return new ag(0)}static re(){return new ag(-1)}}class GO{constructor(e,t){this.referenceDelegate=e,this.k=t}allocateTargetId(e){return this.oe(e).next(t=>{const r=new ag(t.highestTargetId);return t.highestTargetId=r.next(),this.ce(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.oe(e).next(t=>Ct.fromTimestamp(new zr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.oe(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.oe(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.ce(e,i)))}addTargetData(e,t){return this.ae(e,t).next(()=>this.oe(e).next(r=>(r.targetCount+=1,this.ue(t,r),this.ce(e,r))))}updateTargetData(e,t){return this.ae(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>y_(e).delete(t.targetId)).next(()=>this.oe(e)).next(r=>(Et(r.targetCount>0),r.targetCount-=1,this.ce(e,r)))}removeTargets(e,t,r){let i=0;const u=[];return y_(e).jt((c,f)=>{const y=Qw(f);y.sequenceNumber<=t&&null===r.get(y.targetId)&&(i++,u.push(this.removeTargetData(e,y)))}).next(()=>N.waitFor(u)).next(()=>i)}forEachTarget(e,t){return y_(e).jt((r,i)=>{const u=Qw(i);t(u)})}oe(e){return $P(e).get(d.key).next(t=>(Et(null!==t),t))}ce(e,t){return $P(e).put(d.key,t)}ae(e,t){return y_(e).put(NP(this.k,t))}ue(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.oe(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Lh(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let u=null;return y_(e).jt({range:i,index:a.queryTargetsIndexName},(c,f,y)=>{const I=Qw(f);Zp(t,I.target)&&(u=I,y.done())}).next(()=>u)}addMatchingKeys(e,t,r){const i=[],u=$h(e);return t.forEach(c=>{const f=Ro(c.path);i.push(u.put(new l(r,f))),i.push(this.referenceDelegate.addReference(e,r,c))}),N.waitFor(i)}removeMatchingKeys(e,t,r){const i=$h(e);return N.forEach(t,u=>{const c=Ro(u.path);return N.waitFor([i.delete([r,c]),this.referenceDelegate.removeReference(e,r,u)])})}removeMatchingKeysForTargetId(e,t){const r=$h(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=$h(e);let u=fn();return i.jt({range:r,Kt:!0},(c,f,y)=>{const I=El(c[1]),S=new st(I);u=u.add(S)}).next(()=>u)}containsKey(e,t){const r=Ro(t.path),i=IDBKeyRange.bound([r],[vw(r)],!1,!0);let u=0;return $h(e).jt({index:l.documentTargetsIndex,Kt:!0,range:i},([c,f],y,I)=>{0!==c&&(u++,I.done())}).next(()=>u>0)}Et(e,t){return y_(e).get(t).next(r=>r?Qw(r):null)}}function y_(n){return Cr(n,a.store)}function $P(n){return Cr(n,d.store)}function $h(n){return Cr(n,l.store)}function ug(n){return ZS.apply(this,arguments)}function ZS(){return ZS=(0,fe.Z)(function*(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==P)throw n;Le("LocalStore","Unexpectedly lost primary lease")}),ZS.apply(this,arguments)}function HP([n,e],[t,r]){const i=Vt(n,t);return 0===i?Vt(e,r):i}class ZO{constructor(e){this.he=e,this.buffer=new dr(HP),this.le=0}fe(){return++this.le}de(e){const t=[e,this.fe()];if(this.buffer.size<this.he)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();HP(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zO{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.we=!1,this._e=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.me(e)}stop(){this._e&&(this._e.cancel(),this._e=null)}get started(){return null!==this._e}me(e){var t=this;const r=this.we?3e5:6e4;Le("LruGarbageCollector",`Garbage collection scheduled in ${r}ms`),this._e=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",r,(0,fe.Z)(function*(){t._e=null,t.we=!0;try{yield e.collectGarbage(t.garbageCollector)}catch(i){Ze(i)?Le("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield ug(i)}yield t.me(e)}))}}class KO{constructor(e,t){this.ge=e,this.params=t}calculateTargetCount(e,t){return this.ge.ye(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return N.resolve(xs.I);const r=new ZO(t);return this.ge.forEachTarget(e,i=>r.de(i.sequenceNumber)).next(()=>this.ge.pe(e,i=>r.de(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.ge.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.ge.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Le("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(UP)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Le("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),UP):this.Te(e,t))}getCacheSize(e){return this.ge.getCacheSize(e)}Te(e,t){let r,i,u,c,f,y,I;const S=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(A=>(A>this.params.maximumSequenceNumbersToCollect?(Le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${A}`),i=this.params.maximumSequenceNumbersToCollect):i=A,c=Date.now(),this.nthSequenceNumber(e,i))).next(A=>(r=A,f=Date.now(),this.removeTargets(e,r,t))).next(A=>(u=A,y=Date.now(),this.removeOrphanedDocuments(e,r))).next(A=>(I=Date.now(),xh()<=sa.in.DEBUG&&Le("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${c-S}ms\n\tDetermined least recently used ${i} in `+(f-c)+`ms\n\tRemoved ${u} targets in `+(y-f)+`ms\n\tRemoved ${A} documents in `+(I-y)+`ms\nTotal Duration: ${I-S}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:u,documentsRemoved:A})))}}class YO{constructor(e,t){this.db=e,this.garbageCollector=new KO(this,t)}ye(e){const t=this.Ee(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Ee(e){let t=0;return this.pe(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pe(e,t){return this.Ie(e,(r,i)=>t(i))}addReference(e,t,r){return lT(e,r)}removeReference(e,t,r){return lT(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return lT(e,t)}Ae(e,t){return function(r,i){let u=!1;return jP(r).Qt(c=>VP(r,c,i).next(f=>(f&&(u=!0),N.resolve(!f)))).next(()=>u)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let u=0;return this.Ie(e,(c,f)=>{if(f<=t){const y=this.Ae(e,c).next(I=>{if(!I)return u++,r.getEntry(e,c).next(()=>(r.removeEntry(c),$h(e).delete([0,Ro(c.path)])))});i.push(y)}}).next(()=>N.waitFor(i)).next(()=>r.apply(e)).next(()=>u)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return lT(e,t)}Ie(e,t){const r=$h(e);let i,u=xs.I;return r.jt({index:l.documentTargetsIndex},([c,f],{path:y,sequenceNumber:I})=>{0===c?(u!==xs.I&&t(new st(El(i)),u),u=I,i=y):u=xs.I}).next(()=>{u!==xs.I&&t(new st(El(i)),u)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lT(n,e){return $h(n).put((r=n.currentSequenceNumber,new l(0,Ro(e.path),r)));var r}class v_{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,u]of r)if(this.equalsFn(i,e))return u}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0!==i){for(let u=0;u<i.length;u++)if(this.equalsFn(i[u][0],e))return void(i[u]=[e,t]);i.push([e,t])}else this.inner[r]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),!0;return!1}forEach(e){ur(this.inner,(t,r)=>{for(const[i,u]of r)e(i,u)})}isEmpty(){return Lc(this.inner)}}class qP{constructor(){this.changes=new v_(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:Ct.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:Tn.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?N.resolve(r.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class QO{constructor(e,t){this.k=e,this.Jt=t}addEntry(e,t,r){return Hh(e).put(cT(t),r)}removeEntry(e,t){const r=Hh(e),i=cT(t);return r.delete(i)}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Re(e,r)))}getEntry(e,t){return Hh(e).get(cT(t)).next(r=>this.be(t,r))}Pe(e,t){return Hh(e).get(cT(t)).next(r=>({document:this.be(t,r),size:uT(r)}))}getEntries(e,t){let r=io();return this.ve(e,t,(i,u)=>{const c=this.be(i,u);r=r.insert(i,c)}).next(()=>r)}Ve(e,t){let r=io(),i=new Or(st.comparator);return this.ve(e,t,(u,c)=>{const f=this.be(u,c);r=r.insert(u,f),i=i.insert(u,uT(c))}).next(()=>({documents:r,Se:i}))}ve(e,t,r){if(t.isEmpty())return N.resolve();const i=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),u=t.getIterator();let c=u.getNext();return Hh(e).jt({range:i},(f,y,I)=>{const S=st.fromSegments(f);for(;c&&st.comparator(c,S)<0;)r(c,null),c=u.getNext();c&&c.isEqual(S)&&(r(c,y),c=u.hasNext()?u.getNext():null),c?I.Lt(c.path.toArray()):I.done()}).next(()=>{for(;c;)r(c,null),c=u.hasNext()?u.getNext():null})}getDocumentsMatchingQuery(e,t,r){let i=io();const u=t.path.length+1,c={};if(r.isEqual(Ct.min())){const f=t.path.toArray();c.range=IDBKeyRange.lowerBound(f)}else{const f=t.path.toArray(),y=og(r);c.range=IDBKeyRange.lowerBound([f,y],!0),c.index=s.collectionReadTimeIndex}return Hh(e).jt(c,(f,y,I)=>{if(f.length!==u)return;const S=sg(this.k,y);t.path.isPrefixOf(S.key.path)?Bc(t,S)&&(i=i.insert(S.key,S)):I.done()}).next(()=>i)}newChangeBuffer(e){return new JO(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return WP(e).get(o.key).next(t=>(Et(!!t),t))}Re(e,t){return WP(e).put(o.key,t)}be(e,t){if(t){const r=sg(this.k,t);if(!r.isNoDocument()||!r.version.isEqual(Ct.min()))return r}return Tn.newInvalidDocument(e)}}class JO extends qP{constructor(e,t){super(),this.De=e,this.trackRemovals=t,this.Ce=new v_(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new dr((u,c)=>Vt(u.canonicalString(),c.canonicalString()));return this.changes.forEach((u,c)=>{const f=this.Ce.get(u);if(c.document.isValidDocument()){const y=f_(this.De.k,c.document,this.getReadTime(u));i=i.add(u.path.popLast()),r+=uT(y)-f,t.push(this.De.addEntry(e,u,y))}else if(r-=f,this.trackRemovals){const y=f_(this.De.k,Tn.newNoDocument(u,Ct.min()),this.getReadTime(u));t.push(this.De.addEntry(e,u,y))}else t.push(this.De.removeEntry(e,u))}),i.forEach(u=>{t.push(this.De.Jt.addToCollectionParentIndex(e,u))}),t.push(this.De.updateMetadata(e,r)),N.waitFor(t)}getFromCache(e,t){return this.De.Pe(e,t).next(r=>(this.Ce.set(t,r.size),r.document))}getAllFromCache(e,t){return this.De.Ve(e,t).next(({documents:r,Se:i})=>(i.forEach((u,c)=>{this.Ce.set(u,c)}),r))}}function WP(n){return Cr(n,o.store)}function Hh(n){return Cr(n,s.store)}function cT(n){return n.path.toArray()}class XO{constructor(e){this.k=e}Nt(e,t,r,i){Et(r<i&&r>=0&&i<=11);const u=new Y("createOrUpgrade",t);var f;r<1&&i>=1&&(e.createObjectStore(so.store),(f=e).createObjectStore(Il.store,{keyPath:Il.keyPath}),f.createObjectStore(Mn.store,{keyPath:Mn.keyPath,autoIncrement:!0}).createIndex(Mn.userMutationsIndex,Mn.userMutationsKeyPath,{unique:!0}),f.createObjectStore(Zi.store),GP(e),function(f){f.createObjectStore(s.store)}(e));let c=N.resolve();return r<3&&i>=3&&(0!==r&&(function(f){f.deleteObjectStore(l.store),f.deleteObjectStore(a.store),f.deleteObjectStore(d.store)}(e),GP(e)),c=c.next(()=>function(f){const y=f.store(d.store),I=new d(0,0,Ct.min().toTimestamp(),0);return y.put(d.key,I)}(u))),r<4&&i>=4&&(0!==r&&(c=c.next(()=>function(f,y){return y.store(Mn.store).Bt().next(I=>{f.deleteObjectStore(Mn.store),f.createObjectStore(Mn.store,{keyPath:Mn.keyPath,autoIncrement:!0}).createIndex(Mn.userMutationsIndex,Mn.userMutationsKeyPath,{unique:!0});const S=y.store(Mn.store),A=I.map(M=>S.put(M));return N.waitFor(A)})}(e,u))),c=c.next(()=>{!function(f){f.createObjectStore(v.store,{keyPath:v.keyPath})}(e)})),r<5&&i>=5&&(c=c.next(()=>this.Ne(u))),r<6&&i>=6&&(c=c.next(()=>(function(f){f.createObjectStore(o.store)}(e),this.ke(u)))),r<7&&i>=7&&(c=c.next(()=>this.xe(u))),r<8&&i>=8&&(c=c.next(()=>this.$e(e,u))),r<9&&i>=9&&(c=c.next(()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e),function(f){const y=f.objectStore(s.store);y.createIndex(s.readTimeIndex,s.readTimeIndexPath,{unique:!1}),y.createIndex(s.collectionReadTimeIndex,s.collectionReadTimeIndexPath,{unique:!1})}(t)})),r<10&&i>=10&&(c=c.next(()=>this.Oe(u))),r<11&&i>=11&&(c=c.next(()=>{(function(f){f.createObjectStore(E.store,{keyPath:E.keyPath})})(e),function(f){f.createObjectStore(b.store,{keyPath:b.keyPath})}(e)})),c}ke(e){let t=0;return e.store(s.store).jt((r,i)=>{t+=uT(i)}).next(()=>{const r=new o(t);return e.store(o.store).put(o.key,r)})}Ne(e){const t=e.store(Il.store),r=e.store(Mn.store);return t.Bt().next(i=>N.forEach(i,u=>{const c=IDBKeyRange.bound([u.userId,-1],[u.userId,u.lastAcknowledgedBatchId]);return r.Bt(Mn.userMutationsIndex,c).next(f=>N.forEach(f,y=>{Et(y.userId===u.userId);const I=m_(this.k,y);return BP(e,u.userId,I).next(()=>{})}))}))}xe(e){const t=e.store(l.store),r=e.store(s.store);return e.store(d.store).get(d.key).next(i=>{const u=[];return r.jt((c,f)=>{const y=new Xt(c),I=[0,Ro(y)];u.push(t.get(I).next(S=>S?N.resolve():t.put(new l(0,Ro(y),i.highestListenSequenceNumber))))}).next(()=>N.waitFor(u))})}$e(e,t){e.createObjectStore(g.store,{keyPath:g.keyPath});const r=t.store(g.store),i=new WS,u=c=>{if(i.add(c)){const f=c.lastSegment(),y=c.popLast();return r.put({collectionId:f,parent:Ro(y)})}};return t.store(s.store).jt({Kt:!0},(c,f)=>{const y=new Xt(c);return u(y.popLast())}).next(()=>t.store(Zi.store).jt({Kt:!0},([c,f,y],I)=>{const S=El(f);return u(S.popLast())}))}Oe(e){const t=e.store(a.store);return t.jt((r,i)=>{const u=Qw(i),c=NP(this.k,u);return t.put(c)})}}function GP(n){n.createObjectStore(l.store,{keyPath:l.keyPath}).createIndex(l.documentTargetsIndex,l.documentTargetsKeyPath,{unique:!0}),n.createObjectStore(a.store,{keyPath:a.keyPath}).createIndex(a.queryTargetsIndexName,a.queryTargetsKeyPath,{unique:!0}),n.createObjectStore(d.store)}const zS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class KS{constructor(e,t,r,i,u,c,f,y,I,S){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Me=u,this.window=c,this.document=f,this.Fe=I,this.Le=S,this.Be=null,this.Ue=!1,this.isPrimary=!1,this.networkEnabled=!0,this.qe=null,this.inForeground=!1,this.Ke=null,this.je=null,this.Qe=Number.NEGATIVE_INFINITY,this.We=A=>Promise.resolve(),!KS.Pt())throw new Re(le.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new YO(this,i),this.Ge=t+"main",this.k=new h_(y),this.ze=new ce(this.Ge,11,new XO(this.k)),this.He=new GO(this.referenceDelegate,this.k),this.Jt=new WO,this.Je=new QO(this.k,this.Jt),this.Ye=new HO,this.window&&this.window.localStorage?this.Xe=this.window.localStorage:(this.Xe=null,!1===S&&ar("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ze().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Re(le.FAILED_PRECONDITION,zS);return this.tn(),this.en(),this.nn(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.He.getHighestSequenceNumber(e))}).then(e=>{this.Be=new xs(e,this.Fe)}).then(()=>{this.Ue=!0}).catch(e=>(this.ze&&this.ze.close(),Promise.reject(e)))}sn(e){var t=this;return this.We=function(){var r=(0,fe.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ze.xt(function(){var t=(0,fe.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Me.enqueueAndForget((0,fe.Z)(function*(){t.started&&(yield t.Ze())})))}Ze(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>dT(e).put(new v(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.rn(e).next(t=>{t||(this.isPrimary=!1,this.Me.enqueueRetryable(()=>this.We(!1)))})}).next(()=>this.on(e)).next(t=>this.isPrimary&&!t?this.cn(e).next(()=>!1):!!t&&this.an(e).next(()=>!0))).catch(e=>{if(Ze(e))return Le("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Le("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Me.enqueueRetryable(()=>this.We(e)),this.isPrimary=e})}rn(e){return Jw(e).get(so.key).next(t=>N.resolve(this.un(t)))}hn(e){return dT(e).delete(this.clientId)}ln(){var e=this;return(0,fe.Z)(function*(){if(e.isPrimary&&!e.fn(e.Qe,18e5)){e.Qe=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Cr(r,v.store);return i.Bt().next(u=>{const c=e.dn(u,18e5),f=u.filter(y=>-1===c.indexOf(y));return N.forEach(f,y=>i.delete(y.clientId)).next(()=>f)})}).catch(()=>[]);if(e.Xe)for(const r of t)e.Xe.removeItem(e.wn(r.clientId))}})()}nn(){this.je=this.Me.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ze().then(()=>this.ln()).then(()=>this.nn()))}un(e){return!!e&&e.ownerId===this.clientId}on(e){return this.Le?N.resolve(!0):Jw(e).get(so.key).next(t=>{if(null!==t&&this.fn(t.leaseTimestampMs,5e3)&&!this._n(t.ownerId)){if(this.un(t)&&this.networkEnabled)return!0;if(!this.un(t)){if(!t.allowTabSynchronization)throw new Re(le.FAILED_PRECONDITION,zS);return!1}}return!(!this.networkEnabled||!this.inForeground)||dT(e).Bt().next(r=>void 0===this.dn(r,5e3).find(i=>{if(this.clientId!==i.clientId){const c=!this.inForeground&&i.inForeground,f=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||c&&f)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Le("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,fe.Z)(function*(){e.Ue=!1,e.mn(),e.je&&(e.je.cancel(),e.je=null),e.gn(),e.yn(),yield e.ze.runTransaction("shutdown","readwrite",[so.store,v.store],t=>{const r=new ds(t,xs.I);return e.cn(r).next(()=>e.hn(r))}),e.ze.close(),e.pn()})()}dn(e,t){return e.filter(r=>this.fn(r.updateTimeMs,t)&&!this._n(r.clientId))}Tn(){return this.runTransaction("getActiveClients","readonly",e=>dT(e).Bt().next(t=>this.dn(t,18e5).map(r=>r.clientId)))}get started(){return this.Ue}getMutationQueue(e){return GS.Xt(e,this.k,this.Jt,this.referenceDelegate)}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getIndexManager(){return this.Jt}getBundleCache(){return this.Ye}runTransaction(e,t,r){let u;return Le("IndexedDbPersistence","Starting transaction:",e),this.ze.runTransaction(e,"readonly"===t?"readonly":"readwrite",R,c=>(u=new ds(c,this.Be?this.Be.next():xs.I),"readwrite-primary"===t?this.rn(u).next(f=>!!f||this.on(u)).next(f=>{if(!f)throw ar(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Me.enqueueRetryable(()=>this.We(!1)),new Re(le.FAILED_PRECONDITION,P);return r(u)}).next(f=>this.an(u).next(()=>f)):this.En(u).next(()=>r(u)))).then(c=>(u.raiseOnCommittedEvent(),c))}En(e){return Jw(e).get(so.key).next(t=>{if(null!==t&&this.fn(t.leaseTimestampMs,5e3)&&!this._n(t.ownerId)&&!this.un(t)&&!(this.Le||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Re(le.FAILED_PRECONDITION,zS)})}an(e){const t=new so(this.clientId,this.allowTabSynchronization,Date.now());return Jw(e).put(so.key,t)}static Pt(){return ce.Pt()}cn(e){const t=Jw(e);return t.get(so.key).next(r=>this.un(r)?(Le("IndexedDbPersistence","Releasing primary lease."),t.delete(so.key)):N.resolve())}fn(e,t){const r=Date.now();return!(e<r-t||e>r&&(ar(`Detected an update time that is in the future: ${e} > ${r}`),1))}tn(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ke=()=>{this.Me.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ze()))},this.document.addEventListener("visibilitychange",this.Ke),this.inForeground="visible"===this.document.visibilityState)}gn(){this.Ke&&(this.document.removeEventListener("visibilitychange",this.Ke),this.Ke=null)}en(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.qe=()=>{this.mn(),(0,O.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Me.enterRestrictedMode(!0),this.Me.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.qe))}yn(){this.qe&&(this.window.removeEventListener("pagehide",this.qe),this.qe=null)}_n(e){var t;try{const r=null!==(null===(t=this.Xe)||void 0===t?void 0:t.getItem(this.wn(e)));return Le("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ar("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}mn(){if(this.Xe)try{this.Xe.setItem(this.wn(this.clientId),String(Date.now()))}catch(e){ar("Failed to set zombie client id.",e)}}pn(){if(this.Xe)try{this.Xe.removeItem(this.wn(this.clientId))}catch(e){}}wn(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Jw(n){return Cr(n,so.store)}function dT(n){return Cr(n,v.store)}function YS(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class e1{constructor(e,t){this.progress=e,this.In=t}}class ZP{constructor(e,t,r){this.Je=e,this.An=t,this.Jt=r}Rn(e,t){return this.An.getAllMutationBatchesAffectingDocumentKey(e,t).next(r=>this.bn(e,t,r))}bn(e,t,r){return this.Je.getEntry(e,t).next(i=>{for(const u of r)u.applyToLocalView(i);return i})}Pn(e,t){e.forEach((r,i)=>{for(const u of t)u.applyToLocalView(i)})}vn(e,t){return this.Je.getEntries(e,t).next(r=>this.Vn(e,r).next(()=>r))}Vn(e,t){return this.An.getAllMutationBatchesAffectingDocumentKeys(e,t).next(r=>this.Pn(t,r))}getDocumentsMatchingQuery(e,t,r){return st.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.Sn(e,t.path):e_(t)?this.Dn(e,t,r):this.Cn(e,t,r);var i}Sn(e,t){return this.Rn(e,new st(t)).next(r=>{let i=Yb();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}Dn(e,t,r){const i=t.collectionGroup;let u=Yb();return this.Jt.getCollectionParents(e,i).next(c=>N.forEach(c,f=>{const y=(I=t,S=f.child(i),new fu(S,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt));var I,S;return this.Cn(e,y,r).next(I=>{I.forEach((S,A)=>{u=u.insert(S,A)})})}).next(()=>u))}Cn(e,t,r){let i,u;return this.Je.getDocumentsMatchingQuery(e,t,r).next(c=>(i=c,this.An.getAllMutationBatchesAffectingQuery(e,t))).next(c=>(u=c,this.Nn(e,u,i).next(f=>{i=f;for(const y of u)for(const I of y.mutations){const S=I.key;let A=i.get(S);null==A&&(A=Tn.newInvalidDocument(S),i=i.insert(S,A)),Lw(I,A,y.localWriteTime),A.isFoundDocument()||(i=i.remove(S))}}))).next(()=>(i.forEach((c,f)=>{Bc(t,f)||(i=i.remove(c))}),i))}Nn(e,t,r){let i=fn();for(const c of t)for(const f of c.mutations)f instanceof mu&&null===r.get(f.key)&&(i=i.add(f.key));let u=r;return this.Je.getEntries(e,i).next(c=>(c.forEach((f,y)=>{y.isFoundDocument()&&(u=u.insert(f,y))}),u))}}class QS{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.kn=r,this.xn=i}static $n(e,t){let r=fn(),i=fn();for(const u of t.docChanges)switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}return new QS(e,t.fromCache,r,i)}}class zP{On(e){this.Mn=e}getDocumentsMatchingQuery(e,t,r,i){return 0===(u=t).filters.length&&null===u.limit&&null==u.startAt&&null==u.endAt&&(0===u.explicitOrderBy.length||1===u.explicitOrderBy.length&&u.explicitOrderBy[0].field.isKeyField())||r.isEqual(Ct.min())?this.Fn(e,t):this.Mn.vn(e,i).next(u=>{const c=this.Ln(t,u);return(Kp(t)||Yp(t))&&this.Bn(t.limitType,c,i,r)?this.Fn(e,t):(xh()<=sa.in.DEBUG&&Le("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),xw(t)),this.Mn.getDocumentsMatchingQuery(e,t,r).next(f=>(c.forEach(y=>{f=f.insert(y.key,y)}),f)))});var u}Ln(e,t){let r=new dr(Vb(e));return t.forEach((i,u)=>{Bc(e,u)&&(r=r.add(u))}),r}Bn(e,t,r,i){if(r.size!==t.size)return!0;const u="F"===e?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(i)>0)}Fn(e,t){return xh()<=sa.in.DEBUG&&Le("QueryEngine","Using full collection scan to execute query:",xw(t)),this.Mn.getDocumentsMatchingQuery(e,t,Ct.min())}}class t1{constructor(e,t,r,i){this.persistence=e,this.Un=t,this.k=i,this.qn=new Or(Vt),this.Kn=new v_(u=>Lh(u),Zp),this.jn=Ct.min(),this.An=e.getMutationQueue(r),this.Qn=e.getRemoteDocumentCache(),this.He=e.getTargetCache(),this.Wn=new ZP(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=e.getBundleCache(),this.Un.On(this.Wn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.qn))}}function KP(n,e,t,r){return new t1(n,e,t,r)}function YP(n,e){return JS.apply(this,arguments)}function JS(){return JS=(0,fe.Z)(function*(n,e){const t=qe(n);let r=t.An,i=t.Wn;const u=yield t.persistence.runTransaction("Handle user change","readonly",c=>{let f;return t.An.getAllMutationBatches(c).next(y=>(f=y,r=t.persistence.getMutationQueue(e),i=new ZP(t.Qn,r,t.persistence.getIndexManager()),r.getAllMutationBatches(c))).next(y=>{const I=[],S=[];let A=fn();for(const M of f){I.push(M.batchId);for(const V of M.mutations)A=A.add(V.key)}for(const M of y){S.push(M.batchId);for(const V of M.mutations)A=A.add(V.key)}return i.vn(c,A).next(M=>({Gn:M,removedBatchIds:I,addedBatchIds:S}))})});return t.An=r,t.Wn=i,t.Un.On(t.Wn),u}),JS.apply(this,arguments)}function n1(n,e){const t=qe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),u=t.Qn.newChangeBuffer({trackRemovals:!0});return function(c,f,y,I){const S=y.batch,A=S.keys();let M=N.resolve();return A.forEach(V=>{M=M.next(()=>I.getEntry(f,V)).next(z=>{const ye=y.docVersions.get(V);Et(null!==ye),z.version.compareTo(ye)<0&&(S.applyToRemoteDocument(z,y),z.isValidDocument()&&I.addEntry(z,y.commitVersion))})}),M.next(()=>c.An.removeMutationBatch(f,S))}(t,r,e,u).next(()=>u.apply(r)).next(()=>t.An.performConsistencyCheck(r)).next(()=>t.Wn.vn(r,i))})}function QP(n){const e=qe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.He.getLastRemoteSnapshotVersion(t))}function r1(n,e){const t=qe(n),r=e.snapshotVersion;let i=t.qn;return t.persistence.runTransaction("Apply remote event","readwrite-primary",u=>{const c=t.Qn.newChangeBuffer({trackRemovals:!0});i=t.qn;const f=[];e.targetChanges.forEach((I,S)=>{const A=i.get(S);if(!A)return;f.push(t.He.removeMatchingKeys(u,I.removedDocuments,S).next(()=>t.He.addMatchingKeys(u,I.addedDocuments,S)));let M=A.withSequenceNumber(u.currentSequenceNumber);var V,z,ye;e.targetMismatches.has(S)?M=M.withResumeToken(Nr.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):I.resumeToken.approximateByteSize()>0&&(M=M.withResumeToken(I.resumeToken,r)),i=i.insert(S,M),z=M,ye=I,(0===(V=A).resumeToken.approximateByteSize()||z.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=3e8||ye.addedDocuments.size+ye.modifiedDocuments.size+ye.removedDocuments.size>0)&&f.push(t.He.updateTargetData(u,M))});let y=io();if(e.documentUpdates.forEach((I,S)=>{e.resolvedLimboDocuments.has(I)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(u,I))}),f.push(JP(u,c,e.documentUpdates,r,void 0).next(I=>{y=I})),!r.isEqual(Ct.min())){const I=t.He.getLastRemoteSnapshotVersion(u).next(S=>t.He.setTargetsMetadata(u,u.currentSequenceNumber,r));f.push(I)}return N.waitFor(f).next(()=>c.apply(u)).next(()=>t.Wn.Vn(u,y)).next(()=>y)}).then(u=>(t.qn=i,u))}function JP(n,e,t,r,i){let u=fn();return t.forEach(c=>u=u.add(c)),e.getEntries(n,u).next(c=>{let f=io();return t.forEach((y,I)=>{const S=c.get(y),A=(null==i?void 0:i.get(y))||r;I.isNoDocument()&&I.version.isEqual(Ct.min())?(e.removeEntry(y,A),f=f.insert(y,I)):!S.isValidDocument()||I.version.compareTo(S.version)>0||0===I.version.compareTo(S.version)&&S.hasPendingWrites?(e.addEntry(I,A),f=f.insert(y,I)):Le("LocalStore","Ignoring outdated watch update for ",y,". Current version:",S.version," Watch version:",I.version)}),f})}function i1(n,e){const t=qe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.An.getNextMutationBatchAfterBatchId(r,e)))}function w_(n,e){const t=qe(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.He.getTargetData(r,e).next(u=>u?(i=u,N.resolve(i)):t.He.allocateTargetId(r).next(c=>(i=new la(e,c,0,r.currentSequenceNumber),t.He.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.qn.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.qn=t.qn.insert(r.targetId,r),t.Kn.set(e,r.targetId)),r})}function E_(n,e,t){return XS.apply(this,arguments)}function XS(){return XS=(0,fe.Z)(function*(n,e,t){const r=qe(n),i=r.qn.get(e),u=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",u,c=>r.persistence.referenceDelegate.removeTarget(c,i)))}catch(c){if(!Ze(c))throw c;Le("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}r.qn=r.qn.remove(e),r.Kn.delete(i.target)}),XS.apply(this,arguments)}function hT(n,e,t){const r=qe(n);let i=Ct.min(),u=fn();return r.persistence.runTransaction("Execute query","readonly",c=>function(f,y,I){const S=qe(f),A=S.Kn.get(I);return void 0!==A?N.resolve(S.qn.get(A)):S.He.getTargetData(y,I)}(r,c,ks(e)).next(f=>{if(f)return i=f.lastLimboFreeSnapshotVersion,r.He.getMatchingKeysForTargetId(c,f.targetId).next(y=>{u=y})}).next(()=>r.Un.getDocumentsMatchingQuery(c,e,t?i:Ct.min(),t?u:fn())).next(f=>({documents:f,zn:u})))}function XP(n,e){const t=qe(n),r=qe(t.He),i=t.qn.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",u=>r.Et(u,e).next(c=>c?c.target:null))}function ek(n){const e=qe(n);return e.persistence.runTransaction("Get new document changes","readonly",t=>function(r,i,u){const c=qe(r);let f=io(),y=og(u);const I=Hh(i),S=IDBKeyRange.lowerBound(y,!0);return I.jt({index:s.readTimeIndex,range:S},(A,M)=>{const V=sg(c.k,M);f=f.insert(V.key,V),y=M.readTime}).next(()=>({In:f,readTime:p_(y)}))}(e.Qn,t,e.jn)).then(({In:t,readTime:r})=>(e.jn=r,t))}function eA(){return eA=(0,fe.Z)(function*(n){const e=qe(n);return e.persistence.runTransaction("Synchronize last document change read time","readonly",t=>function(r){const i=Hh(r);let u=Ct.min();return i.jt({index:s.readTimeIndex,reverse:!0},(c,f,y)=>{f.readTime&&(u=p_(f.readTime)),y.done()}).next(()=>u)}(t)).then(t=>{e.jn=t})}),eA.apply(this,arguments)}function tA(){return tA=(0,fe.Z)(function*(n,e,t,r){const i=qe(n);let u=fn(),c=io(),f=kS();for(const S of t){const A=e.Hn(S.metadata.name);S.document&&(u=u.add(A)),c=c.insert(A,e.Jn(S)),f=f.insert(A,e.Yn(S.metadata.readTime))}const y=i.Qn.newChangeBuffer({trackRemovals:!0}),I=yield w_(i,(S=r,ks(yl(Xt.fromString(`__bundle__/docs/${S}`)))));var S;return i.persistence.runTransaction("Apply bundle documents","readwrite",S=>JP(S,y,c,Ct.min(),f).next(A=>(y.apply(S),A)).next(A=>i.He.removeMatchingKeysForTargetId(S,I.targetId).next(()=>i.He.addMatchingKeys(S,u,I.targetId)).next(()=>i.Wn.Vn(S,A)).next(()=>A)))}),tA.apply(this,arguments)}function a1(n,e){return nA.apply(this,arguments)}function nA(){return nA=(0,fe.Z)(function*(n,e,t=fn()){const r=yield w_(n,ks(qS(e.bundledQuery))),i=qe(n);return i.persistence.runTransaction("Save named query","readwrite",u=>{const c=ci(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return i.Ye.saveNamedQuery(u,e);const f=r.withResumeToken(Nr.EMPTY_BYTE_STRING,c);return i.qn=i.qn.insert(f.targetId,f),i.He.updateTargetData(u,f).next(()=>i.He.removeMatchingKeysForTargetId(u,r.targetId)).next(()=>i.He.addMatchingKeys(u,t,r.targetId)).next(()=>i.Ye.saveNamedQuery(u,e))})}),nA.apply(this,arguments)}class u1{constructor(e){this.k=e,this.Xn=new Map,this.Zn=new Map}getBundleMetadata(e,t){return N.resolve(this.Xn.get(t))}saveBundleMetadata(e,t){var r;return this.Xn.set(t.id,{id:(r=t).id,version:r.version,createTime:ci(r.createTime)}),N.resolve()}getNamedQuery(e,t){return N.resolve(this.Zn.get(t))}saveNamedQuery(e,t){return this.Zn.set(t.name,{name:(r=t).name,query:qS(r.bundledQuery),readTime:ci(r.readTime)}),N.resolve();var r}}class rA{constructor(){this.ts=new dr(wi.es),this.ns=new dr(wi.ss)}isEmpty(){return this.ts.isEmpty()}addReference(e,t){const r=new wi(e,t);this.ts=this.ts.add(r),this.ns=this.ns.add(r)}rs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.os(new wi(e,t))}cs(e,t){e.forEach(r=>this.removeReference(r,t))}us(e){const t=new st(new Xt([])),r=new wi(t,e),i=new wi(t,e+1),u=[];return this.ns.forEachInRange([r,i],c=>{this.os(c),u.push(c.key)}),u}hs(){this.ts.forEach(e=>this.os(e))}os(e){this.ts=this.ts.delete(e),this.ns=this.ns.delete(e)}ls(e){const t=new st(new Xt([])),r=new wi(t,e),i=new wi(t,e+1);let u=fn();return this.ns.forEachInRange([r,i],c=>{u=u.add(c.key)}),u}containsKey(e){const t=new wi(e,0),r=this.ts.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class wi{constructor(e,t){this.key=e,this.fs=t}static es(e,t){return st.comparator(e.key,t.key)||Vt(e.fs,t.fs)}static ss(e,t){return Vt(e.fs,t.fs)||st.comparator(e.key,t.key)}}class l1{constructor(e,t){this.Jt=e,this.referenceDelegate=t,this.An=[],this.ds=1,this.ws=new dr(wi.es)}checkEmpty(e){return N.resolve(0===this.An.length)}addMutationBatch(e,t,r,i){const u=this.ds;this.ds++;const c=new rg(u,t,r,i);this.An.push(c);for(const f of i)this.ws=this.ws.add(new wi(f.key,u)),this.Jt.addToCollectionParentIndex(e,f.key.path.popLast());return N.resolve(c)}lookupMutationBatch(e,t){return N.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.gs(t+1),u=i<0?0:i;return N.resolve(this.An.length>u?this.An[u]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(0===this.An.length?-1:this.ds-1)}getAllMutationBatches(e){return N.resolve(this.An.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new wi(t,0),i=new wi(t,Number.POSITIVE_INFINITY),u=[];return this.ws.forEachInRange([r,i],c=>{const f=this._s(c.fs);u.push(f)}),N.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dr(Vt);return t.forEach(i=>{const u=new wi(i,0),c=new wi(i,Number.POSITIVE_INFINITY);this.ws.forEachInRange([u,c],f=>{r=r.add(f.fs)})}),N.resolve(this.ys(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let u=r;st.isDocumentKey(u)||(u=u.child(""));const c=new wi(new st(u),0);let f=new dr(Vt);return this.ws.forEachWhile(y=>{const I=y.key.path;return!!r.isPrefixOf(I)&&(I.length===i&&(f=f.add(y.fs)),!0)},c),N.resolve(this.ys(f))}ys(e){const t=[];return e.forEach(r=>{const i=this._s(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){Et(0===this.ps(t.batchId,"removed")),this.An.shift();let r=this.ws;return N.forEach(t.mutations,i=>{const u=new wi(i.key,t.batchId);return r=r.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ws=r})}ee(e){}containsKey(e,t){const r=new wi(t,0),i=this.ws.firstAfterOrEqual(r);return N.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return N.resolve()}ps(e,t){return this.gs(e)}gs(e){return 0===this.An.length?0:e-this.An[0].batchId}_s(e){const t=this.gs(e);return t<0||t>=this.An.length?null:this.An[t]}}class c1{constructor(e,t){this.Jt=e,this.Ts=t,this.docs=new Or(st.comparator),this.size=0}addEntry(e,t,r){const i=t.key,u=this.docs.get(i),c=u?u.size:0,f=this.Ts(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:f,readTime:r}),this.size+=f-c,this.Jt.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():Tn.newInvalidDocument(t))}getEntries(e,t){let r=io();return t.forEach(i=>{const u=this.docs.get(i);r=r.insert(i,u?u.document.mutableCopy():Tn.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r){let i=io();const u=new st(t.path.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:f,value:{document:y,readTime:I}}=c.getNext();if(!t.path.isPrefixOf(f.path))break;I.compareTo(r)<=0||Bc(t,y)&&(i=i.insert(y.key,y.mutableCopy()))}return N.resolve(i)}Es(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new d1(this)}getSize(e){return N.resolve(this.size)}}class d1 extends qP{constructor(e){super(),this.De=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.document.isValidDocument()?t.push(this.De.addEntry(e,i.document,this.getReadTime(r))):this.De.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.De.getEntry(e,t)}getAllFromCache(e,t){return this.De.getEntries(e,t)}}class h1{constructor(e){this.persistence=e,this.Is=new v_(t=>Lh(t),Zp),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.As=0,this.Rs=new rA,this.targetCount=0,this.bs=ag.ie()}forEachTarget(e,t){return this.Is.forEach((r,i)=>t(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.As)}allocateTargetId(e){return this.highestTargetId=this.bs.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.As&&(this.As=t),N.resolve()}ae(e){this.Is.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.bs=new ag(t),this.highestTargetId=t),e.sequenceNumber>this.As&&(this.As=e.sequenceNumber)}addTargetData(e,t){return this.ae(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.ae(t),N.resolve()}removeTargetData(e,t){return this.Is.delete(t.target),this.Rs.us(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let i=0;const u=[];return this.Is.forEach((c,f)=>{f.sequenceNumber<=t&&null===r.get(f.targetId)&&(this.Is.delete(c),u.push(this.removeMatchingKeysForTargetId(e,f.targetId)),i++)}),N.waitFor(u).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){const r=this.Is.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.Rs.rs(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.Rs.cs(t,r);const i=this.persistence.referenceDelegate,u=[];return i&&t.forEach(c=>{u.push(i.markPotentiallyOrphaned(e,c))}),N.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.Rs.us(t),N.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Rs.ls(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.Rs.containsKey(t))}}class f1{constructor(e,t){this.Ps={},this.Be=new xs(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=e(this),this.He=new h1(this),this.Jt=new qO,this.Je=new c1(this.Jt,r=>this.referenceDelegate.vs(r)),this.k=new h_(t),this.Ye=new u1(this.k)}start(){return Promise.resolve()}shutdown(){return this.Ue=!1,Promise.resolve()}get started(){return this.Ue}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Jt}getMutationQueue(e){let t=this.Ps[e.toKey()];return t||(t=new l1(this.Jt,this.referenceDelegate),this.Ps[e.toKey()]=t),t}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getBundleCache(){return this.Ye}runTransaction(e,t,r){Le("MemoryPersistence","Starting transaction:",e);const i=new p1(this.Be.next());return this.referenceDelegate.Vs(),r(i).next(u=>this.referenceDelegate.Ss(i).next(()=>u)).toPromise().then(u=>(i.raiseOnCommittedEvent(),u))}Ds(e,t){return N.or(Object.values(this.Ps).map(r=>()=>r.containsKey(e,t)))}}class p1 extends U{constructor(e){super(),this.currentSequenceNumber=e}}class iA{constructor(e){this.persistence=e,this.Cs=new rA,this.Ns=null}static ks(e){return new iA(e)}get xs(){if(this.Ns)return this.Ns;throw at()}addReference(e,t,r){return this.Cs.addReference(r,t),this.xs.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Cs.removeReference(r,t),this.xs.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.xs.add(t.toString()),N.resolve()}removeTarget(e,t){this.Cs.us(t.targetId).forEach(i=>this.xs.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(u=>this.xs.add(u.toString()))}).next(()=>r.removeTargetData(e,t))}Vs(){this.Ns=new Set}Ss(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.xs,r=>{const i=st.fromPath(r);return this.$s(e,i).next(u=>{u||t.removeEntry(i)})}).next(()=>(this.Ns=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(r=>{r?this.xs.delete(t.toString()):this.xs.add(t.toString())})}vs(e){return 0}$s(e,t){return N.or([()=>N.resolve(this.Cs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ds(e,t)])}}function tk(n,e){return`firestore_clients_${n}_${e}`}function nk(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function sA(n,e){return`firestore_targets_${n}_${e}`}class fT{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Os(e,t,r){const i=JSON.parse(r);let u,c="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return c&&i.error&&(c="string"==typeof i.error.message&&"string"==typeof i.error.code,c&&(u=new Re(i.error.code,i.error.message))),c?new fT(e,t,i.state,u):(ar("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ms(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Xw{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Os(e,t){const r=JSON.parse(t);let i,u="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return u&&r.error&&(u="string"==typeof r.error.message&&"string"==typeof r.error.code,u&&(i=new Re(r.error.code,r.error.message))),u?new Xw(e,r.state,i):(ar("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Ms(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pT{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Os(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,u=$c();for(let c=0;i&&c<r.activeTargetIds.length;++c)i=Tw(r.activeTargetIds[c]),u=u.add(r.activeTargetIds[c]);return i?new pT(e,u):(ar("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class oA{constructor(e,t){this.clientId=e,this.onlineState=t}static Os(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new oA(t.clientId,t.onlineState):(ar("SharedClientState",`Failed to parse online state: ${e}`),null)}}class aA{constructor(){this.activeTargetIds=$c()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ls(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ms(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uA{constructor(e,t,r,i,u){this.window=e,this.Me=t,this.persistenceKey=r,this.Bs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Us=this.qs.bind(this),this.Ks=new Or(Vt),this.started=!1,this.js=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=u,this.Qs=tk(this.persistenceKey,this.Bs),this.Ws=`firestore_sequence_number_${this.persistenceKey}`,this.Ks=this.Ks.insert(this.Bs,new aA),this.Gs=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.zs=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.Hs=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.Js=`firestore_online_state_${this.persistenceKey}`,this.Ys=function(f){return`firestore_bundle_loaded_${f}`}(this.persistenceKey),this.window.addEventListener("storage",this.Us)}static Pt(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,fe.Z)(function*(){const t=yield e.syncEngine.Tn();for(const i of t){if(i===e.Bs)continue;const u=e.getItem(tk(e.persistenceKey,i));if(u){const c=pT.Os(i,u);c&&(e.Ks=e.Ks.insert(c.clientId,c))}}e.Xs();const r=e.storage.getItem(e.Js);if(r){const i=e.Zs(r);i&&e.ti(i)}for(const i of e.js)e.qs(i);e.js=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ei(this.Ks)}isActiveQueryTarget(e){let t=!1;return this.Ks.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.ni(e,"pending")}updateMutationState(e,t,r){this.ni(e,t,r),this.si(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(sA(this.persistenceKey,e));if(r){const i=Xw.Os(e,r);i&&(t=i.state)}}return this.ii.Fs(e),this.Xs(),t}removeLocalQueryTarget(e){this.ii.Ls(e),this.Xs()}isLocalQueryTarget(e){return this.ii.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(sA(this.persistenceKey,e))}updateQueryState(e,t,r){this.ri(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.si(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.oi(e)}notifyBundleLoaded(){this.ci()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Us),this.removeItem(this.Qs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Le("SharedClientState","READ",e,t),t}setItem(e,t){Le("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Le("SharedClientState","REMOVE",e),this.storage.removeItem(e)}qs(e){var t=this;const r=e;if(r.storageArea===this.storage){if(Le("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Qs)return void ar("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Me.enqueueRetryable((0,fe.Z)(function*(){if(t.started){if(null!==r.key)if(t.Gs.test(r.key)){if(null==r.newValue){const i=t.ai(r.key);return t.ui(i,null)}{const i=t.hi(r.key,r.newValue);if(i)return t.ui(i.clientId,i)}}else if(t.zs.test(r.key)){if(null!==r.newValue){const i=t.li(r.key,r.newValue);if(i)return t.fi(i)}}else if(t.Hs.test(r.key)){if(null!==r.newValue){const i=t.di(r.key,r.newValue);if(i)return t.wi(i)}}else if(r.key===t.Js){if(null!==r.newValue){const i=t.Zs(r.newValue);if(i)return t.ti(i)}}else if(r.key===t.Ws){const i=function(u){let c=xs.I;if(null!=u)try{const f=JSON.parse(u);Et("number"==typeof f),c=f}catch(f){ar("SharedClientState","Failed to read sequence number from WebStorage",f)}return c}(r.newValue);i!==xs.I&&t.sequenceNumberHandler(i)}else if(r.key===t.Ys)return t.syncEngine._i()}else t.js.push(r)}))}}get ii(){return this.Ks.get(this.Bs)}Xs(){this.setItem(this.Qs,this.ii.Ms())}ni(e,t,r){const i=new fT(this.currentUser,e,t,r),u=nk(this.persistenceKey,this.currentUser,e);this.setItem(u,i.Ms())}si(e){const t=nk(this.persistenceKey,this.currentUser,e);this.removeItem(t)}oi(e){this.storage.setItem(this.Js,JSON.stringify({clientId:this.Bs,onlineState:e}))}ri(e,t,r){const i=sA(this.persistenceKey,e),u=new Xw(e,t,r);this.setItem(i,u.Ms())}ci(){this.setItem(this.Ys,"value-not-used")}ai(e){const t=this.Gs.exec(e);return t?t[1]:null}hi(e,t){const r=this.ai(e);return pT.Os(r,t)}li(e,t){const r=this.zs.exec(e),i=Number(r[1]);return fT.Os(new li(void 0!==r[2]?r[2]:null),i,t)}di(e,t){const r=this.Hs.exec(e),i=Number(r[1]);return Xw.Os(i,t)}Zs(e){return oA.Os(e)}fi(e){var t=this;return(0,fe.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.mi(e.batchId,e.state,e.error);Le("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}wi(e){return this.syncEngine.gi(e.targetId,e.state,e.error)}ui(e,t){const r=t?this.Ks.insert(e,t):this.Ks.remove(e),i=this.ei(this.Ks),u=this.ei(r),c=[],f=[];return u.forEach(y=>{i.has(y)||c.push(y)}),i.forEach(y=>{u.has(y)||f.push(y)}),this.syncEngine.yi(c,f).then(()=>{this.Ks=r})}ti(e){this.Ks.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ei(e){let t=$c();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class rk{constructor(){this.pi=new aA,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.pi.Fs(e),this.Ti[e]||"not-current"}updateQueryState(e,t,r){this.Ti[e]=t}removeLocalQueryTarget(e){this.pi.Ls(e)}isLocalQueryTarget(e){return this.pi.activeTargetIds.has(e)}clearQueryState(e){delete this.Ti[e]}getAllActiveQueryTargets(){return this.pi.activeTargetIds}isActiveQueryTarget(e){return this.pi.activeTargetIds.has(e)}start(){return this.pi=new aA,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class g1{Ei(e){}shutdown(){}}class ik{constructor(){this.Ii=()=>this.Ai(),this.Ri=()=>this.bi(),this.Pi=[],this.vi()}Ei(e){this.Pi.push(e)}shutdown(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}vi(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}Ai(){Le("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Pi)e(0)}bi(){Le("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Pi)e(1)}static Pt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const m1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class _1{constructor(e){this.Vi=e.Vi,this.Si=e.Si}Di(e){this.Ci=e}Ni(e){this.ki=e}onMessage(e){this.xi=e}close(){this.Si()}send(e){this.Vi(e)}$i(){this.Ci()}Oi(e){this.ki(e)}Mi(e){this.xi(e)}}class y1 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.Fi=(e.ssl?"https":"http")+"://"+e.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Bi(e,t,r,i,u){const c=this.Ui(e,t);Le("RestConnection","Sending: ",c,r);const f={};return this.qi(f,i,u),this.Ki(e,c,f,r).then(y=>(Le("RestConnection","Received: ",y),y),y=>{throw Ph("RestConnection",`${e} failed with error: `,y,"url: ",c,"request:",r),y})}ji(e,t,r,i,u){return this.Bi(e,t,r,i,u)}qi(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Rh,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,u)=>e[u]=i),r&&r.headers.forEach((i,u)=>e[u]=i)}Ui(e,t){return`${this.Fi}/v1/${t}:${m1[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}Ki(e,t,r,i){return new Promise((u,c)=>{const f=new $p;f.listenOnce(gS.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case Nc.NO_ERROR:const I=f.getResponseJson();Le("Connection","XHR received:",JSON.stringify(I)),u(I);break;case Nc.TIMEOUT:Le("Connection",'RPC "'+e+'" timed out'),c(new Re(le.DEADLINE_EXCEEDED,"Request time out"));break;case Nc.HTTP_ERROR:const S=f.getStatus();if(Le("Connection",'RPC "'+e+'" failed with status:',S,"response text:",f.getResponseText()),S>0){const A=f.getResponseJson().error;if(A&&A.status&&A.message){const M=function(V){const z=V.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(z)>=0?z:le.UNKNOWN}(A.status);c(new Re(M,A.message))}else c(new Re(le.UNKNOWN,"Server responded with status "+f.getStatus()))}else c(new Re(le.UNAVAILABLE,"Connection failed."));break;default:at()}}finally{Le("Connection",'RPC "'+e+'" completed.')}});const y=JSON.stringify(i);f.send(t,"POST",y,r,15)})}Qi(e,t,r){const i=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=fS(),c=pS(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(f.xmlHttpFactory=new mS({})),this.qi(f.initMessageHeaders,t,r),(0,O.uI)()||(0,O.b$)()||(0,O.d)()||(0,O.w1)()||(0,O.Mn)()||(0,O.ru)()||(f.httpHeadersOverwriteParam="$httpHeaders");const y=i.join("");Le("Connection","Creating WebChannel: "+y,f);const I=u.createWebChannel(y,f);let S=!1,A=!1;const M=new _1({Vi:z=>{A?Le("Connection","Not sending because WebChannel is closed:",z):(S||(Le("Connection","Opening WebChannel transport."),I.open(),S=!0),Le("Connection","WebChannel sending:",z),I.send(z))},Si:()=>I.close()}),V=(z,ye,Pe)=>{z.listen(ye,_t=>{try{Pe(_t)}catch(wt){setTimeout(()=>{throw wt},0)}})};return V(I,Ah.EventType.OPEN,()=>{A||Le("Connection","WebChannel transport opened.")}),V(I,Ah.EventType.CLOSE,()=>{A||(A=!0,Le("Connection","WebChannel transport closed"),M.Oi())}),V(I,Ah.EventType.ERROR,z=>{A||(A=!0,Ph("Connection","WebChannel transport errored:",z),M.Oi(new Re(le.UNAVAILABLE,"The operation could not be completed")))}),V(I,Ah.EventType.MESSAGE,z=>{var ye;if(!A){const Pe=z.data[0];Et(!!Pe);const _t=Pe,wt=_t.error||(null===(ye=_t[0])||void 0===ye?void 0:ye.error);if(wt){Le("Connection","WebChannel received error:",wt);const It=wt.status;let lt=function(bi){const sf=cr[bi];if(void 0!==sf)return jw(sf)}(It),un=wt.message;void 0===lt&&(lt=le.INTERNAL,un="Unknown error status: "+It+" with message "+wt.message),A=!0,M.Oi(new Re(lt,un)),I.close()}else Le("Connection","WebChannel received:",Pe),M.Mi(Pe)}}),V(c,pw.STAT_EVENT,z=>{z.stat===Co.PROXY?Le("Connection","Detected buffering proxy"):z.stat===Co.NOPROXY&&Le("Connection","Detected no buffering proxy")}),setTimeout(()=>{M.$i()},0),M}}function sk(){return"undefined"!=typeof window?window:null}function gT(){return"undefined"!=typeof document?document:null}function e0(n){return new Xb(n,!0)}class lA{constructor(e,t,r=1e3,i=1.5,u=6e4){this.Me=e,this.timerId=t,this.Wi=r,this.Gi=i,this.zi=u,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}reset(){this.Hi=0}Xi(){this.Hi=this.zi}Zi(e){this.cancel();const t=Math.floor(this.Hi+this.tr()),r=Math.max(0,Date.now()-this.Yi),i=Math.max(0,t-r);i>0&&Le("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Hi} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Ji=this.Me.enqueueAfterDelay(this.timerId,i,()=>(this.Yi=Date.now(),e())),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}er(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}cancel(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}tr(){return(Math.random()-.5)*this.Hi}}class ok{constructor(e,t,r,i,u,c,f,y){this.Me=e,this.nr=r,this.sr=i,this.ir=u,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=f,this.listener=y,this.state=0,this.rr=0,this.cr=null,this.ar=null,this.stream=null,this.ur=new lA(e,t)}hr(){return 1===this.state||5===this.state||this.lr()}lr(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.dr()}stop(){var e=this;return(0,fe.Z)(function*(){e.hr()&&(yield e.close(0))})()}wr(){this.state=0,this.ur.reset()}_r(){this.lr()&&null===this.cr&&(this.cr=this.Me.enqueueAfterDelay(this.nr,6e4,()=>this.mr()))}gr(e){this.yr(),this.stream.send(e)}mr(){var e=this;return(0,fe.Z)(function*(){if(e.lr())return e.close(0)})()}yr(){this.cr&&(this.cr.cancel(),this.cr=null)}pr(){this.ar&&(this.ar.cancel(),this.ar=null)}close(e,t){var r=this;return(0,fe.Z)(function*(){r.yr(),r.pr(),r.ur.cancel(),r.rr++,4!==e?r.ur.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(ar(t.toString()),ar("Using maximum backoff delay to prevent overloading the backend."),r.ur.Xi()):t&&t.code===le.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Tr(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Ni(t)})()}Tr(){}auth(){this.state=1;const e=this.Er(this.rr),t=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.rr===t&&this.Ir(r,i)},r=>{e(()=>{const i=new Re(le.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Ar(i)})})}Ir(e,t){const r=this.Er(this.rr);this.stream=this.Rr(e,t),this.stream.Di(()=>{r(()=>(this.state=2,this.ar=this.Me.enqueueAfterDelay(this.sr,1e4,()=>(this.lr()&&(this.state=3),Promise.resolve())),this.listener.Di()))}),this.stream.Ni(i=>{r(()=>this.Ar(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}dr(){var e=this;this.state=5,this.ur.Zi((0,fe.Z)(function*(){e.state=0,e.start()}))}Ar(e){return Le("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Er(e){return t=>{this.Me.enqueueAndForget(()=>this.rr===e?t():(Le("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class v1 extends ok{constructor(e,t,r,i,u,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,c),this.k=u}Rr(e,t){return this.ir.Qi("Listen",e,t)}onMessage(e){this.ur.reset();const t=function LS(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(y=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===y?1:"REMOVE"===y?2:"CURRENT"===y?3:"RESET"===y?4:at(),i=e.targetChange.targetIds||[],u=function(y,I){return y.C?(Et(void 0===I||"string"==typeof I),Nr.fromBase64String(I||"")):(Et(void 0===I||I instanceof Uint8Array),Nr.fromUint8Array(I||new Uint8Array))}(n,e.targetChange.resumeToken),c=e.targetChange.cause,f=c&&function(y){const I=void 0===y.code?le.UNKNOWN:jw(y.code);return new Re(I,y.message||"")}(c);t=new Hw(r,i,u,f||null)}else if("documentChange"in e){const r=e.documentChange,i=Ao(n,r.document.name),u=ci(r.document.updateTime),c=new _i({mapValue:{fields:r.document.fields}}),f=Tn.newFoundDocument(i,u,c);t=new eg(r.targetIds||[],r.removedTargetIds||[],f.key,f)}else if("documentDelete"in e){const r=e.documentDelete,i=Ao(n,r.document),u=r.readTime?ci(r.readTime):Ct.min(),c=Tn.newNoDocument(i,u);t=new eg([],r.removedTargetIds||[],c.key,c)}else if("documentRemove"in e){const r=e.documentRemove,i=Ao(n,r.document);t=new eg([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return at();{const r=e.filter,u=new Bw(r.count||0);t=new wl(r.targetId,u)}}var y;return t}(this.k,e),r=function(i){if(!("targetChange"in i))return Ct.min();const u=i.targetChange;return u.targetIds&&u.targetIds.length?Ct.min():u.readTime?ci(u.readTime):Ct.min()}(e);return this.listener.br(t,r)}Pr(e){const t={};t.database=tg(this.k),t.addTarget=function(i,u){let c;const f=u.target;return c=Qm(f)?{documents:FS(i,f)}:{query:Yw(i,f)},c.targetId=u.targetId,u.resumeToken.approximateByteSize()>0?c.resumeToken=NS(i,u.resumeToken):u.snapshotVersion.compareTo(Ct.min())>0&&(c.readTime=u_(i,u.snapshotVersion.toTimestamp())),c}(this.k,e);const r=function US(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return at()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.gr(t)}vr(e){const t={};t.database=tg(this.k),t.removeTarget=e,this.gr(t)}}class w1 extends ok{constructor(e,t,r,i,u,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,c),this.k=u,this.Vr=!1}get Sr(){return this.Vr}start(){this.Vr=!1,this.lastStreamToken=void 0,super.start()}Tr(){this.Vr&&this.Dr([])}Rr(e,t){return this.ir.Qi("Write",e,t)}onMessage(e){if(Et(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Vr){this.ur.reset();const t=function d_(n,e){return n&&n.length>0?(Et(void 0!==e),n.map(t=>function(r,i){let u=ci(r.updateTime?r.updateTime:i);return u.isEqual(Ct.min())&&(u=ci(i)),new So(u,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=ci(e.commitTime);return this.listener.Cr(r,t)}return Et(!e.writeResults||0===e.writeResults.length),this.Vr=!0,this.listener.Nr()}kr(){const e={};e.database=tg(this.k),this.gr(e)}Dr(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>c_(this.k,r))};this.gr(t)}}class E1 extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.ir=r,this.k=i,this.$r=!1}Or(){if(this.$r)throw new Re(le.FAILED_PRECONDITION,"The client has already been terminated.")}Bi(e,t,r){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,u])=>this.ir.Bi(e,t,r,i,u)).catch(i=>{throw"FirebaseError"===i.name?(i.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Re(le.UNKNOWN,i.toString())})}ji(e,t,r){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,u])=>this.ir.ji(e,t,r,i,u)).catch(i=>{throw"FirebaseError"===i.name?(i.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Re(le.UNKNOWN,i.toString())})}terminate(){this.$r=!0}}class I1{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Mr=0,this.Fr=null,this.Lr=!0}Br(){0===this.Mr&&(this.Ur("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.Fr=null,this.qr("Backend didn't respond within 10 seconds."),this.Ur("Offline"),Promise.resolve())))}Kr(e){"Online"===this.state?this.Ur("Unknown"):(this.Mr++,this.Mr>=1&&(this.jr(),this.qr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Ur("Offline")))}set(e){this.jr(),this.Mr=0,"Online"===e&&(this.Lr=!1),this.Ur(e)}Ur(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}qr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Lr?(ar(t),this.Lr=!1):Le("OnlineStateTracker",t)}jr(){null!==this.Fr&&(this.Fr.cancel(),this.Fr=null)}}class b1{constructor(e,t,r,i,u){var c=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=u,this.Hr.Ei(f=>{r.enqueueAndForget((0,fe.Z)(function*(){var y;qh(c)&&(Le("RemoteStore","Restarting streams for network reachability change."),yield(y=(0,fe.Z)(function*(I){const S=qe(I);S.Gr.add(4),yield I_(S),S.Jr.set("Unknown"),S.Gr.delete(4),yield t0(S)}),function(I){return y.apply(this,arguments)})(c))}))}),this.Jr=new I1(r,i)}}function t0(n){return cA.apply(this,arguments)}function cA(){return cA=(0,fe.Z)(function*(n){if(qh(n))for(const e of n.zr)yield e(!0)}),cA.apply(this,arguments)}function I_(n){return dA.apply(this,arguments)}function dA(){return dA=(0,fe.Z)(function*(n){for(const e of n.zr)yield e(!1)}),dA.apply(this,arguments)}function mT(n,e){const t=qe(n);t.Wr.has(e.targetId)||(t.Wr.set(e.targetId,e),pA(t)?fA(t):T_(t).lr()&&hA(t,e))}function n0(n,e){const t=qe(n),r=T_(t);t.Wr.delete(e),r.lr()&&ak(t,e),0===t.Wr.size&&(r.lr()?r._r():qh(t)&&t.Jr.set("Unknown"))}function hA(n,e){n.Yr.X(e.targetId),T_(n).Pr(e)}function ak(n,e){n.Yr.X(e),T_(n).vr(e)}function fA(n){n.Yr=new qw({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Wr.get(e)||null}),T_(n).start(),n.Jr.Br()}function pA(n){return qh(n)&&!T_(n).hr()&&n.Wr.size>0}function qh(n){return 0===qe(n).Gr.size}function uk(n){n.Yr=void 0}function T1(n){return gA.apply(this,arguments)}function gA(){return gA=(0,fe.Z)(function*(n){n.Wr.forEach((e,t)=>{hA(n,e)})}),gA.apply(this,arguments)}function C1(n,e){return mA.apply(this,arguments)}function mA(){return mA=(0,fe.Z)(function*(n,e){uk(n),pA(n)?(n.Jr.Kr(e),fA(n)):n.Jr.set("Unknown")}),mA.apply(this,arguments)}function D1(n,e,t){return _A.apply(this,arguments)}function _A(){return _A=(0,fe.Z)(function*(n,e,t){if(n.Jr.set("Online"),e instanceof Hw&&2===e.state&&e.cause)try{yield(r=(0,fe.Z)(function*(i,u){const c=u.cause;for(const f of u.targetIds)i.Wr.has(f)&&(yield i.remoteSyncer.rejectListen(f,c),i.Wr.delete(f),i.Yr.removeTarget(f))}),function(i,u){return r.apply(this,arguments)})(n,e)}catch(r){Le("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield _T(n,r)}else if(e instanceof eg?n.Yr.ot(e):e instanceof wl?n.Yr.dt(e):n.Yr.ut(e),!t.isEqual(Ct.min()))try{const r=yield QP(n.localStore);t.compareTo(r)>=0&&(yield function(i,u){const c=i.Yr.gt(u);return c.targetChanges.forEach((f,y)=>{if(f.resumeToken.approximateByteSize()>0){const I=i.Wr.get(y);I&&i.Wr.set(y,I.withResumeToken(f.resumeToken,u))}}),c.targetMismatches.forEach(f=>{const y=i.Wr.get(f);if(!y)return;i.Wr.set(f,y.withResumeToken(Nr.EMPTY_BYTE_STRING,y.snapshotVersion)),ak(i,f);const I=new la(y.target,f,1,y.sequenceNumber);hA(i,I)}),i.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){Le("RemoteStore","Failed to raise snapshot:",r),yield _T(n,r)}var r}),_A.apply(this,arguments)}function _T(n,e,t){return yA.apply(this,arguments)}function yA(){return yA=(0,fe.Z)(function*(n,e,t){if(!Ze(e))throw e;n.Gr.add(1),yield I_(n),n.Jr.set("Offline"),t||(t=()=>QP(n.localStore)),n.asyncQueue.enqueueRetryable((0,fe.Z)(function*(){Le("RemoteStore","Retrying IndexedDB access"),yield t(),n.Gr.delete(1),yield t0(n)}))}),yA.apply(this,arguments)}function lk(n,e){return e().catch(t=>_T(n,t,e))}function b_(n){return vA.apply(this,arguments)}function vA(){return vA=(0,fe.Z)(function*(n){const e=qe(n),t=Wh(e);let r=e.Qr.length>0?e.Qr[e.Qr.length-1].batchId:-1;for(;S1(e);)try{const i=yield i1(e.localStore,r);if(null===i){0===e.Qr.length&&t._r();break}r=i.batchId,A1(e,i)}catch(i){yield _T(e,i)}ck(e)&&dk(e)}),vA.apply(this,arguments)}function S1(n){return qh(n)&&n.Qr.length<10}function A1(n,e){n.Qr.push(e);const t=Wh(n);t.lr()&&t.Sr&&t.Dr(e.mutations)}function ck(n){return qh(n)&&!Wh(n).hr()&&n.Qr.length>0}function dk(n){Wh(n).start()}function R1(n){return wA.apply(this,arguments)}function wA(){return wA=(0,fe.Z)(function*(n){Wh(n).kr()}),wA.apply(this,arguments)}function x1(n){return EA.apply(this,arguments)}function EA(){return EA=(0,fe.Z)(function*(n){const e=Wh(n);for(const t of n.Qr)e.Dr(t.mutations)}),EA.apply(this,arguments)}function P1(n,e,t){return IA.apply(this,arguments)}function IA(){return IA=(0,fe.Z)(function*(n,e,t){const r=n.Qr.shift(),i=ig.from(r,e,t);yield lk(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield b_(n)}),IA.apply(this,arguments)}function k1(n,e){return bA.apply(this,arguments)}function bA(){return bA=(0,fe.Z)(function*(n,e){var t;e&&Wh(n).Sr&&(yield(t=(0,fe.Z)(function*(r,i){if(Vw(u=i.code)&&u!==le.ABORTED){const c=r.Qr.shift();Wh(r).wr(),yield lk(r,()=>r.remoteSyncer.rejectFailedWrite(c.batchId,i)),yield b_(r)}var u}),function(r,i){return t.apply(this,arguments)})(n,e)),ck(n)&&dk(n)}),bA.apply(this,arguments)}function TA(n,e){return CA.apply(this,arguments)}function CA(){return CA=(0,fe.Z)(function*(n,e){const t=qe(n);e?(t.Gr.delete(2),yield t0(t)):e||(t.Gr.add(2),yield I_(t),t.Jr.set("Unknown"))}),CA.apply(this,arguments)}function T_(n){return n.Xr||(n.Xr=function(e,t,r){const i=qe(e);return i.Or(),new v1(t,i.ir,i.authCredentials,i.appCheckCredentials,i.k,r)}(n.datastore,n.asyncQueue,{Di:T1.bind(null,n),Ni:C1.bind(null,n),br:D1.bind(null,n)}),n.zr.push(function(){var e=(0,fe.Z)(function*(t){t?(n.Xr.wr(),pA(n)?fA(n):n.Jr.set("Unknown")):(yield n.Xr.stop(),uk(n))});return function(t){return e.apply(this,arguments)}}())),n.Xr}function Wh(n){return n.Zr||(n.Zr=function(e,t,r){const i=qe(e);return i.Or(),new w1(t,i.ir,i.authCredentials,i.appCheckCredentials,i.k,r)}(n.datastore,n.asyncQueue,{Di:R1.bind(null,n),Ni:k1.bind(null,n),Nr:x1.bind(null,n),Cr:P1.bind(null,n)}),n.zr.push(function(){var e=(0,fe.Z)(function*(t){t?(n.Zr.wr(),yield b_(n)):(yield n.Zr.stop(),n.Qr.length>0&&(Le("RemoteStore",`Stopping write stream with ${n.Qr.length} pending writes`),n.Qr=[]))});return function(t){return e.apply(this,arguments)}}())),n.Zr}class DA{constructor(e,t,r,i,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=u,this.deferred=new Mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}static createAndSchedule(e,t,r,i,u){const c=Date.now()+r,f=new DA(e,t,c,i,u);return f.start(r),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Re(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function C_(n,e){if(ar("AsyncQueue",`${e}: ${n}`),Ze(n))return new Re(le.UNAVAILABLE,`${e}: ${n}`);throw n}class D_{constructor(e){this.comparator=e?(t,r)=>e(t,r)||st.comparator(t.key,r.key):(t,r)=>st.comparator(t.key,r.key),this.keyedMap=Yb(),this.sortedSet=new Or(this.comparator)}static emptySet(e){return new D_(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof D_)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,u=r.getNext().key;if(!i.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new D_;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class hk{constructor(){this.eo=new Or(st.comparator)}track(e){const t=e.doc.key,r=this.eo.get(t);r?0!==e.type&&3===r.type?this.eo=this.eo.insert(t,e):3===e.type&&1!==r.type?this.eo=this.eo.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.eo=this.eo.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.eo=this.eo.remove(t):1===e.type&&2===r.type?this.eo=this.eo.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):at():this.eo=this.eo.insert(t,e)}no(){const e=[];return this.eo.inorderTraversal((t,r)=>{e.push(r)}),e}}class S_{constructor(e,t,r,i,u,c,f,y){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=u,this.fromCache=c,this.syncStateChanged=f,this.excludesMetadataChanges=y}static fromInitialDocuments(e,t,r,i){const u=[];return t.forEach(c=>{u.push({type:0,doc:c})}),new S_(e,t,D_.emptySet(t),u,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&t_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class M1{constructor(){this.so=void 0,this.listeners=[]}}class N1{constructor(){this.queries=new v_(e=>SS(e),t_),this.onlineState="Unknown",this.io=new Set}}function SA(n,e){return AA.apply(this,arguments)}function AA(){return AA=(0,fe.Z)(function*(n,e){const t=qe(n),r=e.query;let i=!1,u=t.queries.get(r);if(u||(i=!0,u=new M1),i)try{u.so=yield t.onListen(r)}catch(c){const f=C_(c,`Initialization of query '${xw(e.query)}' failed`);return void e.onError(f)}t.queries.set(r,u),u.listeners.push(e),e.ro(t.onlineState),u.so&&e.oo(u.so)&&PA(t)}),AA.apply(this,arguments)}function RA(n,e){return xA.apply(this,arguments)}function xA(){return xA=(0,fe.Z)(function*(n,e){const t=qe(n),r=e.query;let i=!1;const u=t.queries.get(r);if(u){const c=u.listeners.indexOf(e);c>=0&&(u.listeners.splice(c,1),i=0===u.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),xA.apply(this,arguments)}function O1(n,e){const t=qe(n);let r=!1;for(const i of e){const c=t.queries.get(i.query);if(c){for(const f of c.listeners)f.oo(i)&&(r=!0);c.so=i}}r&&PA(t)}function L1(n,e,t){const r=qe(n),i=r.queries.get(e);if(i)for(const u of i.listeners)u.onError(t);r.queries.delete(e)}function PA(n){n.io.forEach(e=>{e.next()})}class kA{constructor(e,t,r){this.query=e,this.co=t,this.ao=!1,this.uo=null,this.onlineState="Unknown",this.options=r||{}}oo(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new S_(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.ao?this.ho(e)&&(this.co.next(e),t=!0):this.lo(e,this.onlineState)&&(this.fo(e),t=!0),this.uo=e,t}onError(e){this.co.error(e)}ro(e){this.onlineState=e;let t=!1;return this.uo&&!this.ao&&this.lo(this.uo,e)&&(this.fo(this.uo),t=!0),t}lo(e,t){return!e.fromCache||!(this.options.wo&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}ho(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.uo&&this.uo.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}fo(e){e=S_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.ao=!0,this.co.next(e)}}class F1{constructor(e,t){this.payload=e,this.byteLength=t}_o(){return"metadata"in this.payload}}class fk{constructor(e){this.k=e}Hn(e){return Ao(this.k,e)}Jn(e){return e.metadata.exists?zw(this.k,e.document,!1):Tn.newNoDocument(this.Hn(e.metadata.name),this.Yn(e.metadata.readTime))}Yn(e){return ci(e)}}class U1{constructor(e,t,r){this.mo=e,this.localStore=t,this.k=r,this.queries=[],this.documents=[],this.progress=pk(e)}yo(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}po(e){const t=new Map,r=new fk(this.k);for(const i of e)if(i.metadata.queries){const u=r.Hn(i.metadata.name);for(const c of i.metadata.queries){const f=(t.get(c)||fn()).add(u);t.set(c,f)}}return t}complete(){var e=this;return(0,fe.Z)(function*(){const t=yield function o1(n,e,t,r){return tA.apply(this,arguments)}(e.localStore,new fk(e.k),e.documents,e.mo.id),r=e.po(e.documents);for(const i of e.queries)yield a1(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",new e1(Object.assign({},e.progress),t)})()}}function pk(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class gk{constructor(e){this.key=e}}class mk{constructor(e){this.key=e}}class _k{constructor(e,t){this.query=e,this.To=t,this.Eo=null,this.current=!1,this.Io=fn(),this.mutatedKeys=fn(),this.Ao=Vb(e),this.Ro=new D_(this.Ao)}get bo(){return this.To}Po(e,t){const r=t?t.vo:new hk,i=t?t.Ro:this.Ro;let u=t?t.mutatedKeys:this.mutatedKeys,c=i,f=!1;const y=Kp(this.query)&&i.size===this.query.limit?i.last():null,I=Yp(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((S,A)=>{const M=i.get(S),V=Bc(this.query,A)?A:null,z=!!M&&this.mutatedKeys.has(M.key),ye=!!V&&(V.hasLocalMutations||this.mutatedKeys.has(V.key)&&V.hasCommittedMutations);let Pe=!1;M&&V?M.data.isEqual(V.data)?z!==ye&&(r.track({type:3,doc:V}),Pe=!0):this.Vo(M,V)||(r.track({type:2,doc:V}),Pe=!0,(y&&this.Ao(V,y)>0||I&&this.Ao(V,I)<0)&&(f=!0)):!M&&V?(r.track({type:0,doc:V}),Pe=!0):M&&!V&&(r.track({type:1,doc:M}),Pe=!0,(y||I)&&(f=!0)),Pe&&(V?(c=c.add(V),u=ye?u.add(S):u.delete(S)):(c=c.delete(S),u=u.delete(S)))}),Kp(this.query)||Yp(this.query))for(;c.size>this.query.limit;){const S=Kp(this.query)?c.last():c.first();c=c.delete(S.key),u=u.delete(S.key),r.track({type:1,doc:S})}return{Ro:c,vo:r,Bn:f,mutatedKeys:u}}Vo(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Ro;this.Ro=e.Ro,this.mutatedKeys=e.mutatedKeys;const u=e.vo.no();u.sort((I,S)=>function(A,M){const V=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at()}};return V(A)-V(M)}(I.type,S.type)||this.Ao(I.doc,S.doc)),this.So(r);const c=t?this.Do():[],f=0===this.Io.size&&this.current?1:0,y=f!==this.Eo;return this.Eo=f,0!==u.length||y?{snapshot:new S_(this.query,e.Ro,i,u,e.mutatedKeys,0===f,y,!1),Co:c}:{Co:c}}ro(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new hk,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}No(e){return!this.To.has(e)&&!!this.Ro.has(e)&&!this.Ro.get(e).hasLocalMutations}So(e){e&&(e.addedDocuments.forEach(t=>this.To=this.To.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.To=this.To.delete(t)),this.current=e.current)}Do(){if(!this.current)return[];const e=this.Io;this.Io=fn(),this.Ro.forEach(r=>{this.No(r.key)&&(this.Io=this.Io.add(r.key))});const t=[];return e.forEach(r=>{this.Io.has(r)||t.push(new mk(r))}),this.Io.forEach(r=>{e.has(r)||t.push(new gk(r))}),t}ko(e){this.To=e.zn,this.Io=fn();const t=this.Po(e.documents);return this.applyChanges(t,!0)}xo(){return S_.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}class B1{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class V1{constructor(e){this.key=e,this.$o=!1}}class j1{constructor(e,t,r,i,u,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=u,this.maxConcurrentLimboResolutions=c,this.Oo={},this.Mo=new v_(f=>SS(f),t_),this.Fo=new Map,this.Lo=new Set,this.Bo=new Or(st.comparator),this.Uo=new Map,this.qo=new rA,this.Ko={},this.jo=new Map,this.Qo=ag.re(),this.onlineState="Unknown",this.Wo=void 0}get isPrimaryClient(){return!0===this.Wo}}function $1(n,e){return MA.apply(this,arguments)}function MA(){return MA=(0,fe.Z)(function*(n,e){const t=nR(n);let r,i;const u=t.Mo.get(e);if(u)r=u.targetId,t.sharedClientState.addLocalQueryTarget(r),i=u.view.xo();else{const c=yield w_(t.localStore,ks(e)),f=t.sharedClientState.addLocalQueryTarget(c.targetId);r=c.targetId,i=yield NA(t,e,r,"current"===f),t.isPrimaryClient&&mT(t.remoteStore,c)}return i}),MA.apply(this,arguments)}function NA(n,e,t,r){return OA.apply(this,arguments)}function OA(){return OA=(0,fe.Z)(function*(n,e,t,r){n.Go=(S,A,M)=>{return(V=(0,fe.Z)(function*(z,ye,Pe,_t){let wt=ye.view.Po(Pe);wt.Bn&&(wt=yield hT(z.localStore,ye.query,!1).then(({documents:un})=>ye.view.Po(un,wt)));const It=_t&&_t.targetChanges.get(ye.targetId),lt=ye.view.applyChanges(wt,z.isPrimaryClient,It);return WA(z,ye.targetId,lt.Co),lt.snapshot}),function(z,ye,Pe,_t){return V.apply(this,arguments)})(n,S,A,M);var V};const i=yield hT(n.localStore,e,!0),u=new _k(e,i.zn),c=u.Po(i.documents),f=Xp.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),y=u.applyChanges(c,n.isPrimaryClient,f);WA(n,t,y.Co);const I=new B1(e,t,u);return n.Mo.set(e,I),n.Fo.has(t)?n.Fo.get(t).push(e):n.Fo.set(t,[e]),y.snapshot}),OA.apply(this,arguments)}function H1(n,e){return LA.apply(this,arguments)}function LA(){return LA=(0,fe.Z)(function*(n,e){const t=qe(n),r=t.Mo.get(e),i=t.Fo.get(r.targetId);if(i.length>1)return t.Fo.set(r.targetId,i.filter(u=>!t_(u,e))),void t.Mo.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield E_(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),n0(t.remoteStore,r.targetId),A_(t,r.targetId)}).catch(ug))):(A_(t,r.targetId),yield E_(t.localStore,r.targetId,!0))}),LA.apply(this,arguments)}function FA(){return FA=(0,fe.Z)(function*(n,e,t){const r=rR(n);try{const i=yield function(u,c){const f=qe(u),y=zr.now(),I=c.reduce((A,M)=>A.add(M.key),fn());let S;return f.persistence.runTransaction("Locally write mutations","readwrite",A=>f.Wn.vn(A,I).next(M=>{S=M;const V=[];for(const z of c){const ye=RS(z,S.get(z.key));null!=ye&&V.push(new mu(z.key,ye,Ob(ye.value.mapValue),Tr.exists(!0)))}return f.An.addMutationBatch(A,y,V,c)})).then(A=>(A.applyToLocalDocumentSet(S),{batchId:A.batchId,changes:S}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(u,c,f){let y=u.Ko[u.currentUser.toKey()];y||(y=new Or(Vt)),y=y.insert(c,f),u.Ko[u.currentUser.toKey()]=y}(r,i.batchId,t),yield Hc(r,i.changes),yield b_(r.remoteStore)}catch(i){const u=C_(i,"Failed to persist write");t.reject(u)}}),FA.apply(this,arguments)}function yk(n,e){return UA.apply(this,arguments)}function UA(){return UA=(0,fe.Z)(function*(n,e){const t=qe(n);try{const r=yield r1(t.localStore,e);e.targetChanges.forEach((i,u)=>{const c=t.Uo.get(u);c&&(Et(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?c.$o=!0:i.modifiedDocuments.size>0?Et(c.$o):i.removedDocuments.size>0&&(Et(c.$o),c.$o=!1))}),yield Hc(t,r,e)}catch(r){yield ug(r)}}),UA.apply(this,arguments)}function vk(n,e,t){const r=qe(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.Mo.forEach((u,c)=>{const f=c.view.ro(e);f.snapshot&&i.push(f.snapshot)}),function(u,c){const f=qe(u);f.onlineState=c;let y=!1;f.queries.forEach((I,S)=>{for(const A of S.listeners)A.ro(c)&&(y=!0)}),y&&PA(f)}(r.eventManager,e),i.length&&r.Oo.br(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function W1(n,e,t){return BA.apply(this,arguments)}function BA(){return BA=(0,fe.Z)(function*(n,e,t){const r=qe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Uo.get(e),u=i&&i.key;if(u){let c=new Or(st.comparator);c=c.insert(u,Tn.newNoDocument(u,Ct.min()));const f=fn().add(u),y=new Jp(Ct.min(),new Map,new dr(Vt),c,f);yield yk(r,y),r.Bo=r.Bo.remove(u),r.Uo.delete(e),GA(r)}else yield E_(r.localStore,e,!1).then(()=>A_(r,e,t)).catch(ug)}),BA.apply(this,arguments)}function G1(n,e){return VA.apply(this,arguments)}function VA(){return VA=(0,fe.Z)(function*(n,e){const t=qe(n),r=e.batch.batchId;try{const i=yield n1(t.localStore,e);qA(t,r,null),HA(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Hc(t,i)}catch(i){yield ug(i)}}),VA.apply(this,arguments)}function Z1(n,e,t){return jA.apply(this,arguments)}function jA(){return jA=(0,fe.Z)(function*(n,e,t){const r=qe(n);try{const i=yield function(u,c){const f=qe(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",y=>{let I;return f.An.lookupMutationBatch(y,c).next(S=>(Et(null!==S),I=S.keys(),f.An.removeMutationBatch(y,S))).next(()=>f.An.performConsistencyCheck(y)).next(()=>f.Wn.vn(y,I))})}(r.localStore,e);qA(r,e,t),HA(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Hc(r,i)}catch(i){yield ug(i)}}),jA.apply(this,arguments)}function $A(){return $A=(0,fe.Z)(function*(n,e){const t=qe(n);qh(t.remoteStore)||Le("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(u){const c=qe(u);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",f=>c.An.getHighestUnacknowledgedBatchId(f))}(t.localStore);if(-1===r)return void e.resolve();const i=t.jo.get(r)||[];i.push(e),t.jo.set(r,i)}catch(r){const i=C_(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),$A.apply(this,arguments)}function HA(n,e){(n.jo.get(e)||[]).forEach(t=>{t.resolve()}),n.jo.delete(e)}function qA(n,e,t){const r=qe(n);let i=r.Ko[r.currentUser.toKey()];if(i){const u=i.get(e);u&&(t?u.reject(t):u.resolve(),i=i.remove(e)),r.Ko[r.currentUser.toKey()]=i}}function A_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Fo.get(e))n.Mo.delete(r),t&&n.Oo.zo(r,t);n.Fo.delete(e),n.isPrimaryClient&&n.qo.us(e).forEach(r=>{n.qo.containsKey(r)||wk(n,r)})}function wk(n,e){n.Lo.delete(e.path.canonicalString());const t=n.Bo.get(e);null!==t&&(n0(n.remoteStore,t),n.Bo=n.Bo.remove(e),n.Uo.delete(t),GA(n))}function WA(n,e,t){for(const r of t)r instanceof gk?(n.qo.addReference(r.key,e),K1(n,r)):r instanceof mk?(Le("SyncEngine","Document no longer in limbo: "+r.key),n.qo.removeReference(r.key,e),n.qo.containsKey(r.key)||wk(n,r.key)):at()}function K1(n,e){const t=e.key,r=t.path.canonicalString();n.Bo.get(t)||n.Lo.has(r)||(Le("SyncEngine","New document in limbo: "+t),n.Lo.add(r),GA(n))}function GA(n){for(;n.Lo.size>0&&n.Bo.size<n.maxConcurrentLimboResolutions;){const e=n.Lo.values().next().value;n.Lo.delete(e);const t=new st(Xt.fromString(e)),r=n.Qo.next();n.Uo.set(r,new V1(t)),n.Bo=n.Bo.insert(t,r),mT(n.remoteStore,new la(ks(yl(t.path)),r,2,xs.I))}}function Hc(n,e,t){return ZA.apply(this,arguments)}function ZA(){return ZA=(0,fe.Z)(function*(n,e,t){const r=qe(n),i=[],u=[],c=[];var f;r.Mo.isEmpty()||(r.Mo.forEach((f,y)=>{c.push(r.Go(y,e,t).then(I=>{if(I){r.isPrimaryClient&&r.sharedClientState.updateQueryState(y.targetId,I.fromCache?"not-current":"current"),i.push(I);const S=QS.$n(y.targetId,I);u.push(S)}}))}),yield Promise.all(c),r.Oo.br(i),yield(f=(0,fe.Z)(function*(y,I){const S=qe(y);try{yield S.persistence.runTransaction("notifyLocalViewChanges","readwrite",A=>N.forEach(I,M=>N.forEach(M.kn,V=>S.persistence.referenceDelegate.addReference(A,M.targetId,V)).next(()=>N.forEach(M.xn,V=>S.persistence.referenceDelegate.removeReference(A,M.targetId,V)))))}catch(A){if(!Ze(A))throw A;Le("LocalStore","Failed to update sequence numbers: "+A)}for(const A of I){const M=A.targetId;if(!A.fromCache){const V=S.qn.get(M),ye=V.withLastLimboFreeSnapshotVersion(V.snapshotVersion);S.qn=S.qn.insert(M,ye)}}}),function(y,I){return f.apply(this,arguments)})(r.localStore,u))}),ZA.apply(this,arguments)}function Y1(n,e){return zA.apply(this,arguments)}function zA(){return zA=(0,fe.Z)(function*(n,e){const t=qe(n);if(!t.currentUser.isEqual(e)){Le("SyncEngine","User change. New user:",e.toKey());const r=yield YP(t.localStore,e);t.currentUser=e,(i=t).jo.forEach(c=>{c.forEach(f=>{f.reject(new Re(le.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.jo.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Hc(t,r.Gn)}var i}),zA.apply(this,arguments)}function Q1(n,e){const t=qe(n),r=t.Uo.get(e);if(r&&r.$o)return fn().add(r.key);{let i=fn();const u=t.Fo.get(e);if(!u)return i;for(const c of u){const f=t.Mo.get(c);i=i.unionWith(f.view.bo)}return i}}function J1(n,e){return KA.apply(this,arguments)}function KA(){return KA=(0,fe.Z)(function*(n,e){const t=qe(n),r=yield hT(t.localStore,e.query,!0),i=e.view.ko(r);return t.isPrimaryClient&&WA(t,e.targetId,i.Co),i}),KA.apply(this,arguments)}function X1(n){return YA.apply(this,arguments)}function YA(){return YA=(0,fe.Z)(function*(n){const e=qe(n);return ek(e.localStore).then(t=>Hc(e,t))}),YA.apply(this,arguments)}function eL(n,e,t,r){return QA.apply(this,arguments)}function QA(){return QA=(0,fe.Z)(function*(n,e,t,r){const i=qe(n),u=yield function(c,f){const y=qe(c),I=qe(y.An);return y.persistence.runTransaction("Lookup mutation documents","readonly",S=>I.Zt(S,f).next(A=>A?y.Wn.vn(S,A):N.resolve(null)))}(i.localStore,e);var f;null!==u?("pending"===t?yield b_(i.remoteStore):"acknowledged"===t||"rejected"===t?(qA(i,e,r||null),HA(i,e),f=e,qe(qe(i.localStore).An).ee(f)):at(),yield Hc(i,u)):Le("SyncEngine","Cannot apply mutation batch with id: "+e)}),QA.apply(this,arguments)}function JA(){return JA=(0,fe.Z)(function*(n,e){const t=qe(n);if(nR(t),rR(t),!0===e&&!0!==t.Wo){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Ek(t,r.toArray());t.Wo=!0,yield TA(t.remoteStore,!0);for(const u of i)mT(t.remoteStore,u)}else if(!1===e&&!1!==t.Wo){const r=[];let i=Promise.resolve();t.Fo.forEach((u,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):i=i.then(()=>(A_(t,c),E_(t.localStore,c,!0))),n0(t.remoteStore,c)}),yield i,yield Ek(t,r),function(u){const c=qe(u);c.Uo.forEach((f,y)=>{n0(c.remoteStore,y)}),c.qo.hs(),c.Uo=new Map,c.Bo=new Or(st.comparator)}(t),t.Wo=!1,yield TA(t.remoteStore,!1)}}),JA.apply(this,arguments)}function Ek(n,e,t){return XA.apply(this,arguments)}function XA(){return XA=(0,fe.Z)(function*(n,e,t){const r=qe(n),i=[],u=[];for(const c of e){let f;const y=r.Fo.get(c);if(y&&0!==y.length){f=yield w_(r.localStore,ks(y[0]));for(const I of y){const S=r.Mo.get(I),A=yield J1(r,S);A.snapshot&&u.push(A.snapshot)}}else{const I=yield XP(r.localStore,c);f=yield w_(r.localStore,I),yield NA(r,Ik(I),c,!1)}i.push(f)}return r.Oo.br(u),i}),XA.apply(this,arguments)}function Ik(n){return Ub(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function nL(n){const e=qe(n);return qe(qe(e.localStore).persistence).Tn()}function rL(n,e,t,r){return eR.apply(this,arguments)}function eR(){return eR=(0,fe.Z)(function*(n,e,t,r){const i=qe(n);if(i.Wo)Le("SyncEngine","Ignoring unexpected query state notification.");else if(i.Fo.has(e))switch(t){case"current":case"not-current":{const u=yield ek(i.localStore),c=Jp.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield Hc(i,u,c);break}case"rejected":yield E_(i.localStore,e,!0),A_(i,e,r);break;default:at()}}),eR.apply(this,arguments)}function iL(n,e,t){return tR.apply(this,arguments)}function tR(){return tR=(0,fe.Z)(function*(n,e,t){const r=nR(n);if(r.Wo){for(const i of e){if(r.Fo.has(i)){Le("SyncEngine","Adding an already active target "+i);continue}const u=yield XP(r.localStore,i),c=yield w_(r.localStore,u);yield NA(r,Ik(u),c.targetId,!1),mT(r.remoteStore,c)}for(const i of t)r.Fo.has(i)&&(yield E_(r.localStore,i,!1).then(()=>{n0(r.remoteStore,i),A_(r,i)}).catch(ug))}}),tR.apply(this,arguments)}function nR(n){const e=qe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=yk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Q1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=W1.bind(null,e),e.Oo.br=O1.bind(null,e.eventManager),e.Oo.zo=L1.bind(null,e.eventManager),e}function rR(n){const e=qe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=G1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Z1.bind(null,e),e}class bk{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,fe.Z)(function*(){t.k=e0(e.databaseInfo.databaseId),t.sharedClientState=t.Jo(e),t.persistence=t.Yo(e),yield t.persistence.start(),t.gcScheduler=t.Xo(e),t.localStore=t.Zo(e)})()}Xo(e){return null}Zo(e){return KP(this.persistence,new zP,e.initialUser,this.k)}Yo(e){return new f1(iA.ks,this.k)}Jo(e){return new rk}terminate(){var e=this;return(0,fe.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Tk extends bk{constructor(e,t,r){super(),this.tc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,fe.Z)(function*(){yield t().call(r,e),yield function s1(n){return eA.apply(this,arguments)}(r.localStore),yield r.tc.initialize(r,e),yield rR(r.tc.syncEngine),yield b_(r.tc.remoteStore),yield r.persistence.sn(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(r.localStore),Promise.resolve()))})()}Zo(e){return KP(this.persistence,new zP,e.initialUser,this.k)}Xo(e){return new zO(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue)}Yo(e){const t=YS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?oo.withCacheSize(this.cacheSizeBytes):oo.DEFAULT;return new KS(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,sk(),gT(),this.k,this.sharedClientState,!!this.forceOwnership)}Jo(e){return new rk}}class oL extends Tk{constructor(e,t){super(e,t,!1),this.tc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,fe.Z)(function*(){yield t().call(r,e);const i=r.tc.syncEngine;r.sharedClientState instanceof uA&&(r.sharedClientState.syncEngine={mi:eL.bind(null,i),gi:rL.bind(null,i),yi:iL.bind(null,i),Tn:nL.bind(null,i),_i:X1.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.sn(function(){var u=(0,fe.Z)(function*(c){yield function tL(n,e){return JA.apply(this,arguments)}(r.tc.syncEngine,c),r.gcScheduler&&(c&&!r.gcScheduler.started?r.gcScheduler.start(r.localStore):c||r.gcScheduler.stop())});return function(c){return u.apply(this,arguments)}}())})()}Jo(e){const t=sk();if(!uA.Pt(t))throw new Re(le.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=YS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new uA(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class iR{initialize(e,t){var r=this;return(0,fe.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>vk(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Y1.bind(null,r.syncEngine),yield TA(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new N1}createDatastore(e){const t=e0(e.databaseInfo.databaseId),r=new y1(e.databaseInfo);return new E1(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,u=f=>vk(this.syncEngine,f,0),c=ik.Pt()?new ik:new g1,new b1(t,r,i,u,c);var t,r,i,u,c}createSyncEngine(e,t){return function(r,i,u,c,f,y,I){const S=new j1(r,i,u,c,f,y);return I&&(S.Wo=!0),S}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,fe.Z)(function*(t){const r=qe(t);Le("RemoteStore","RemoteStore shutting down."),r.Gr.add(5),yield I_(r),r.Hr.shutdown(),r.Jr.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Ck(n,e=10240){let t=0;return{read:()=>(0,fe.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,fe.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class yT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.ec(this.observer.next,e)}error(e){this.observer.error?this.ec(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}nc(){this.muted=!0}ec(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class aL{constructor(e,t){this.sc=e,this.k=t,this.metadata=new Mr,this.buffer=new Uint8Array,this.ic=new TextDecoder("utf-8"),this.rc().then(r=>{r&&r._o()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==r?void 0:r.payload)}`))},r=>this.metadata.reject(r))}close(){return this.sc.cancel()}getMetadata(){var e=this;return(0,fe.Z)(function*(){return e.metadata.promise})()}Ho(){var e=this;return(0,fe.Z)(function*(){return yield e.getMetadata(),e.rc()})()}rc(){var e=this;return(0,fe.Z)(function*(){const t=yield e.oc();if(null===t)return null;const r=e.ic.decode(t),i=Number(r);isNaN(i)&&e.cc(`length string (${r}) is not valid number`);const u=yield e.ac(i);return new F1(JSON.parse(u),t.length+i)})()}uc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}oc(){var e=this;return(0,fe.Z)(function*(){for(;e.uc()<0&&!(yield e.hc()););if(0===e.buffer.length)return null;const t=e.uc();t<0&&e.cc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}ac(e){var t=this;return(0,fe.Z)(function*(){for(;t.buffer.length<e;)(yield t.hc())&&t.cc("Reached the end of bundle when more is expected.");const r=t.ic.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}cc(e){throw this.sc.cancel(),new Error(`Invalid bundle format: ${e}`)}hc(){var e=this;return(0,fe.Z)(function*(){const t=yield e.sc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class uL{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,fe.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Re(le.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,fe.Z)(function*(u,c){const f=qe(u),y=tg(f.k)+"/documents",I={documents:c.map(V=>l_(f.k,V))},S=yield f.ji("BatchGetDocuments",y,I),A=new Map;S.forEach(V=>{const z=function rT(n,e){return"found"in e?function(t,r){Et(!!r.found);const i=Ao(t,r.found.name),u=ci(r.found.updateTime),c=new _i({mapValue:{fields:r.found.fields}});return Tn.newFoundDocument(i,u,c)}(n,e):"missing"in e?function(t,r){Et(!!r.missing),Et(!!r.readTime);const i=Ao(t,r.missing),u=ci(r.readTime);return Tn.newNoDocument(i,u)}(n,e):at()}(f.k,V);A.set(z.key.toString(),z)});const M=[];return c.forEach(V=>{const z=A.get(V.toString());Et(!!z),M.push(z)}),M}),function(u,c){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Uh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,fe.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const u=st.fromPath(i);e.mutations.push(new jc(u,e.precondition(u)))}),yield(r=(0,fe.Z)(function*(i,u){const c=qe(i),f=tg(c.k)+"/documents",y={writes:u.map(I=>c_(c.k,I))};yield c.Bi("Commit",f,y)}),function(i,u){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw at();t=Ct.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Re(le.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?Tr.updateTime(t):Tr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ct.min()))throw new Re(le.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Tr.updateTime(t)}return Tr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class lL{constructor(e,t,r,i){this.asyncQueue=e,this.datastore=t,this.updateFunction=r,this.deferred=i,this.lc=5,this.ur=new lA(this.asyncQueue,"transaction_retry")}run(){this.lc-=1,this.fc()}fc(){var e=this;this.ur.Zi((0,fe.Z)(function*(){const t=new uL(e.datastore),r=e.dc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(u=>{e.wc(u)}))}).catch(i=>{e.wc(i)})}))}dc(e){try{const t=this.updateFunction(e);return!hu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}wc(e){this.lc>0&&this._c(e)?(this.lc-=1,this.asyncQueue.enqueueAndForget(()=>(this.fc(),Promise.resolve()))):this.deferred.reject(e)}_c(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!Vw(t)}return!1}}class cL{constructor(e,t,r,i){var u=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=li.UNAUTHENTICATED,this.clientId=yw.A(),this.authCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var c=(0,fe.Z)(function*(f){Le("FirestoreClient","Received user=",f.uid),yield u.authCredentialListener(f),u.user=f});return function(f){return c.apply(this,arguments)}}()),this.appCheckCredentials.start(r,()=>Promise.resolve())}getConfiguration(){var e=this;return(0,fe.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Re(le.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,fe.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=C_(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Dk(n,e){return sR.apply(this,arguments)}function sR(){return sR=(0,fe.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Le("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,fe.Z)(function*(u){r.isEqual(u)||(yield YP(e.localStore,u),r=u)});return function(u){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),sR.apply(this,arguments)}function Sk(n,e){return oR.apply(this,arguments)}function oR(){return oR=(0,fe.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield aR(n);Le("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>{return(u=(0,fe.Z)(function*(c,f){const y=qe(c);y.asyncQueue.verifyOperationInProgress(),Le("RemoteStore","RemoteStore received new credentials");const I=qh(y);y.Gr.add(3),yield I_(y),I&&y.Jr.set("Unknown"),yield y.remoteSyncer.handleCredentialChange(f),y.Gr.delete(3),yield t0(y)}),function(c,f){return u.apply(this,arguments)})(e.remoteStore,i);var u}),n.onlineComponents=e}),oR.apply(this,arguments)}function aR(n){return uR.apply(this,arguments)}function uR(){return uR=(0,fe.Z)(function*(n){return n.offlineComponents||(Le("FirestoreClient","Using default OfflineComponentProvider"),yield Dk(n,new bk)),n.offlineComponents}),uR.apply(this,arguments)}function vT(n){return lR.apply(this,arguments)}function lR(){return lR=(0,fe.Z)(function*(n){return n.onlineComponents||(Le("FirestoreClient","Using default OnlineComponentProvider"),yield Sk(n,new iR)),n.onlineComponents}),lR.apply(this,arguments)}function Ak(n){return aR(n).then(e=>e.persistence)}function cR(n){return aR(n).then(e=>e.localStore)}function Rk(n){return vT(n).then(e=>e.remoteStore)}function dR(n){return vT(n).then(e=>e.syncEngine)}function R_(n){return hR.apply(this,arguments)}function hR(){return hR=(0,fe.Z)(function*(n){const e=yield vT(n),t=e.eventManager;return t.onListen=$1.bind(null,e.syncEngine),t.onUnlisten=H1.bind(null,e.syncEngine),t}),hR.apply(this,arguments)}function xk(n,e,t={}){const r=new Mr;return n.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return function(i,u,c,f,y){const I=new yT({next:A=>{u.enqueueAndForget(()=>RA(i,S));const M=A.docs.has(c);!M&&A.fromCache?y.reject(new Re(le.UNAVAILABLE,"Failed to get document because the client is offline.")):M&&A.fromCache&&f&&"server"===f.source?y.reject(new Re(le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(A)},error:A=>y.reject(A)}),S=new kA(yl(c.path),I,{includeMetadataChanges:!0,wo:!0});return SA(i,S)}(yield R_(n),n.asyncQueue,e,t,r)})),r.promise}function Pk(n,e,t={}){const r=new Mr;return n.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return function(i,u,c,f,y){const I=new yT({next:A=>{u.enqueueAndForget(()=>RA(i,S)),A.fromCache&&"server"===f.source?y.reject(new Re(le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(A)},error:A=>y.reject(A)}),S=new kA(c,I,{includeMetadataChanges:!0,wo:!0});return SA(i,S)}(yield R_(n),n.asyncQueue,e,t,r)})),r.promise}class vL{constructor(e,t,r,i,u,c,f,y){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=u,this.forceLongPolling=c,this.autoDetectLongPolling=f,this.useFetchStreams=y}}class x_{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof x_&&e.projectId===this.projectId&&e.database===this.database}}const kk=new Map;function fR(n,e,t){if(!t)throw new Re(le.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Mk(n,e,t,r){if(!0===e&&!0===r)throw new Re(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Nk(n){if(!st.isDocumentKey(n))throw new Re(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ok(n){if(st.isDocumentKey(n))throw new Re(le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function wT(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":at()}function Jt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Re(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wT(n);throw new Re(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Lk(n,e){if(e<=0)throw new Re(le.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Fk{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Re(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Re(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Mk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class r0{constructor(e,t,r){this._authCredentials=t,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fk({}),this._settingsFrozen=!1,e instanceof x_?this._databaseId=e:(this._app=e,this._databaseId=function(i){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new Re(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new x_(i.options.projectId)}(e))}get app(){if(!this._app)throw new Re(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Re(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fk(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new gw;switch(t.type){case"gapi":const r=t.client;return Et(!("object"!=typeof r||null===r||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new IS(r,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Re(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=kk.get(e);t&&(Le("ComponentProvider","Removing Datastore"),kk.delete(e),t.terminate())}(this),Promise.resolve()}}class Vn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vn(this.firestore,e,this._key)}}class hs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new hs(this.firestore,e,this._query)}}class Tl extends hs{constructor(e,t,r){super(e,t,yl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vn(this.firestore,null,new st(e))}withConverter(e){return new Tl(this.firestore,e,this._path)}}function Uk(n,e,...t){if(n=(0,O.m9)(n),fR("collection","path",e),n instanceof r0){const r=Xt.fromString(e,...t);return Ok(r),new Tl(n,null,r)}{if(!(n instanceof Vn||n instanceof Tl))throw new Re(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Xt.fromString(e,...t));return Ok(r),new Tl(n.firestore,null,r)}}function ET(n,e,...t){if(n=(0,O.m9)(n),1===arguments.length&&(e=yw.A()),fR("doc","path",e),n instanceof r0){const r=Xt.fromString(e,...t);return Nk(r),new Vn(n,null,new st(r))}{if(!(n instanceof Vn||n instanceof Tl))throw new Re(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Xt.fromString(e,...t));return Nk(r),new Vn(n.firestore,n instanceof Tl?n.converter:null,new st(r))}}function Bk(n,e){return n=(0,O.m9)(n),e=(0,O.m9)(e),(n instanceof Vn||n instanceof Tl)&&(e instanceof Vn||e instanceof Tl)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Vk(n,e){return n=(0,O.m9)(n),e=(0,O.m9)(e),n instanceof hs&&e instanceof hs&&n.firestore===e.firestore&&t_(n._query,e._query)&&n.converter===e.converter}class IL{constructor(){this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new lA(this,"async_queue_retry"),this.bc=()=>{const t=gT();t&&Le("AsyncQueue","Visibility state changed to "+t.visibilityState),this.ur.er()};const e=gT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.bc)}get isShuttingDown(){return this.yc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pc(),this.vc(e)}enterRestrictedMode(e){if(!this.yc){this.yc=!0,this.Ac=e||!1;const t=gT();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.bc)}}enqueue(e){if(this.Pc(),this.yc)return new Promise(()=>{});const t=new Mr;return this.vc(()=>this.yc&&this.Ac?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.gc.push(e),this.Vc()))}Vc(){var e=this;return(0,fe.Z)(function*(){if(0!==e.gc.length){try{yield e.gc[0](),e.gc.shift(),e.ur.reset()}catch(t){if(!Ze(t))throw t;Le("AsyncQueue","Operation failed with retryable error: "+t)}e.gc.length>0&&e.ur.Zi(()=>e.Vc())}})()}vc(e){const t=this.mc.then(()=>(this.Ic=!0,e().catch(r=>{throw this.Ec=r,this.Ic=!1,ar("INTERNAL UNHANDLED ERROR: ",function(u){let c=u.message||"";return u.stack&&(c=u.stack.includes(u.message)?u.stack:u.message+"\n"+u.stack),c}(r)),r}).then(r=>(this.Ic=!1,r))));return this.mc=t,t}enqueueAfterDelay(e,t,r){this.Pc(),this.Rc.indexOf(e)>-1&&(t=0);const i=DA.createAndSchedule(this,e,t,r,u=>this.Sc(u));return this.Tc.push(i),i}Pc(){this.Ec&&at()}verifyOperationInProgress(){}Dc(){var e=this;return(0,fe.Z)(function*(){let t;do{t=e.mc,yield t}while(t!==e.mc)})()}Cc(e){for(const t of this.Tc)if(t.timerId===e)return!0;return!1}Nc(e){return this.Dc().then(()=>{this.Tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Dc()})}kc(e){this.Rc.push(e)}Sc(e){const t=this.Tc.indexOf(e);this.Tc.splice(t,1)}}function pR(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class bL{constructor(){this._progressObserver={},this._taskCompletionResolver=new Mr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class hr extends r0{constructor(e,t,r){super(e,t,r),this.type="firestore",this._queue=new IL,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||jk(this),this._firestoreClient.terminate()}}function di(n){return n._firestoreClient||jk(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function jk(n){var e;const t=n._freezeSettings(),r=(u=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new vL(n._databaseId,u,n._persistenceKey,(f=t).host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,f.useFetchStreams));var u,f;n._firestoreClient=new cL(n._authCredentials,n._appCheckCredentials,n._queue,r)}function $k(n,e,t){const r=new Mr;return n.asyncQueue.enqueue((0,fe.Z)(function*(){try{yield Dk(n,t),yield Sk(n,e),r.resolve()}catch(i){if(!("FirebaseError"===(u=i).name?u.code===le.FAILED_PRECONDITION||u.code===le.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&u instanceof DOMException)||22===u.code||20===u.code||11===u.code))throw i;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),r.reject(i)}var u})).then(()=>r.promise)}function Hk(n){if(n._initialized||n._terminated)throw new Re(le.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class qc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Re(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Cl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Cl(Nr.fromBase64String(e))}catch(t){throw new Re(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Cl(Nr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class lg{constructor(e){this._methodName=e}}class IT{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Re(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Re(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Vt(this._lat,e._lat)||Vt(this._long,e._long)}}const ML=/^__.*__$/;class NL{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new mu(e,this.data,this.fieldMask,t,this.fieldTransforms):new i_(e,this.data,t,this.fieldTransforms)}}class qk{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new mu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Wk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at()}}class bT{constructor(e,t,r,i,u,c){this.settings=e,this.databaseId=t,this.k=r,this.ignoreUndefinedProperties=i,void 0===u&&this.xc(),this.fieldTransforms=u||[],this.fieldMask=c||[]}get path(){return this.settings.path}get $c(){return this.settings.$c}Oc(e){return new bT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mc(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Oc({path:r,Fc:!1});return i.Lc(e),i}Bc(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Oc({path:r,Fc:!1});return i.xc(),i}Uc(e){return this.Oc({path:void 0,Fc:!0})}qc(e){return CT(e,this.settings.methodName,this.settings.Kc||!1,this.path,this.settings.jc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lc(this.path.get(e))}Lc(e){if(0===e.length)throw this.qc("Document fields must not be empty");if(Wk(this.$c)&&ML.test(e))throw this.qc('Document fields cannot begin and end with "__"')}}class OL{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.k=r||e0(e)}Qc(e,t,r,i=!1){return new bT({$c:e,methodName:t,jc:r,path:lr.emptyPath(),Fc:!1,Kc:i},this.databaseId,this.k,this.ignoreUndefinedProperties)}}function cg(n){const e=n._freezeSettings(),t=e0(n._databaseId);return new OL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function TT(n,e,t,r,i,u={}){const c=n.Qc(u.merge||u.mergeFields?2:0,e,t,i);yR("Data must be an object, but it was:",c,r);const f=zk(r,c);let y,I;if(u.merge)y=new kh(c.fieldMask),I=c.fieldTransforms;else if(u.mergeFields){const S=[];for(const A of u.mergeFields){const M=vR(e,A,t);if(!c.contains(M))throw new Re(le.INVALID_ARGUMENT,`Field '${M}' is specified in your field mask but missing from your input data.`);Yk(S,M)||S.push(M)}y=new kh(S),I=c.fieldTransforms.filter(A=>y.covers(A.field))}else y=null,I=c.fieldTransforms;return new NL(new _i(f),y,I)}class s0 extends lg{_toFieldTransform(e){if(2!==e.$c)throw e.qc(1===e.$c?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof s0}}function Gk(n,e,t){return new bT({$c:3,jc:e.settings.jc,methodName:n._methodName,Fc:t},e.databaseId,e.k,e.ignoreUndefinedProperties)}class gR extends lg{_toFieldTransform(e){return new Qp(e.path,new Fh)}isEqual(e){return e instanceof gR}}class LL extends lg{constructor(e,t){super(e),this.Wc=t}_toFieldTransform(e){const t=Gk(this,e,!0),r=this.Wc.map(u=>dg(u,t)),i=new gu(r);return new Qp(e.path,i)}isEqual(e){return this===e}}class FL extends lg{constructor(e,t){super(e),this.Wc=t}_toFieldTransform(e){const t=Gk(this,e,!0),r=this.Wc.map(u=>dg(u,t)),i=new vl(r);return new Qp(e.path,i)}isEqual(e){return this===e}}class UL extends lg{constructor(e,t){super(e),this.Gc=t}_toFieldTransform(e){const t=new Vc(e.k,$b(e.k,this.Gc));return new Qp(e.path,t)}isEqual(e){return this===e}}function mR(n,e,t,r){const i=n.Qc(1,e,t);yR("Data must be an object, but it was:",i,r);const u=[],c=_i.empty();ur(r,(y,I)=>{const S=wR(e,y,t);I=(0,O.m9)(I);const A=i.Bc(S);if(I instanceof s0)u.push(S);else{const M=dg(I,A);null!=M&&(u.push(S),c.set(S,M))}});const f=new kh(u);return new qk(c,f,i.fieldTransforms)}function _R(n,e,t,r,i,u){const c=n.Qc(1,e,t),f=[vR(e,r,t)],y=[i];if(u.length%2!=0)throw new Re(le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let M=0;M<u.length;M+=2)f.push(vR(e,u[M])),y.push(u[M+1]);const I=[],S=_i.empty();for(let M=f.length-1;M>=0;--M)if(!Yk(I,f[M])){const V=f[M];let z=y[M];z=(0,O.m9)(z);const ye=c.Bc(V);if(z instanceof s0)I.push(V);else{const Pe=dg(z,ye);null!=Pe&&(I.push(V),S.set(V,Pe))}}const A=new kh(I);return new qk(S,A,c.fieldTransforms)}function Zk(n,e,t,r=!1){return dg(t,n.Qc(r?4:3,e))}function dg(n,e){if(Kk(n=(0,O.m9)(n)))return yR("Unsupported field value:",e,n),zk(n,e);if(n instanceof lg)return function(t,r){if(!Wk(r.$c))throw r.qc(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.qc(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Fc&&4!==e.$c)throw e.qc("Nested arrays are not supported");return function(t,r){const i=[];let u=0;for(const c of t){let f=dg(c,r.Uc(u));null==f&&(f={nullValue:"NULL_VALUE"}),i.push(f),u++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,O.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return $b(r.k,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=zr.fromDate(t);return{timestampValue:u_(r.k,i)}}if(t instanceof zr){const i=new zr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:u_(r.k,i)}}if(t instanceof IT)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Cl)return{bytesValue:NS(r.k,t._byteString)};if(t instanceof Vn){const i=r.databaseId,u=t.firestore._databaseId;if(!u.isEqual(i))throw r.qc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:eT(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.qc(`Unsupported field value: ${wT(t)}`)}(n,e)}function zk(n,e){const t={};return Lc(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ur(n,(r,i)=>{const u=dg(i,e.Mc(r));null!=u&&(t[r]=u)}),{mapValue:{fields:t}}}function Kk(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof zr||n instanceof IT||n instanceof Cl||n instanceof Vn||n instanceof lg)}function yR(n,e,t){if(!Kk(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=wT(t);throw e.qc("an object"===r?n+" a custom object":n+" "+r)}var r}function vR(n,e,t){if((e=(0,O.m9)(e))instanceof qc)return e._internalPath;if("string"==typeof e)return wR(n,e);throw CT("Field path arguments must be of type string or ",n,!1,void 0,t)}const BL=new RegExp("[~\\*/\\[\\]]");function wR(n,e,t){if(e.search(BL)>=0)throw CT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new qc(...e.split("."))._internalPath}catch(r){throw CT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function CT(n,e,t,r,i){const u=r&&!r.isEmpty(),c=void 0!==i;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let y="";return(u||c)&&(y+=" (found",u&&(y+=` in field ${r}`),c&&(y+=` in document ${i}`),y+=")"),new Re(le.INVALID_ARGUMENT,f+n+y)}function Yk(n,e){return n.some(t=>t.isEqual(e))}class o0{constructor(e,t,r,i,u){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Vn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new VL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(DT("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class VL extends o0{data(){return super.data()}}function DT(n,e){return"string"==typeof e?wR(n,e):e instanceof qc?e._internalPath:e._delegate._internalPath}class hg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Wc extends o0{constructor(e,t,r,i,u,c){super(e,t,r,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new a0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(DT("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class a0 extends Wc{data(e={}){return super.data(e)}}class Gh{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new hg(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new a0(this._firestore,this._userDataWriter,r.key,r,new hg(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Re(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let u=0;return r._snapshot.docChanges.map(c=>({type:"added",doc:new a0(r._firestore,r._userDataWriter,c.doc.key,c.doc,new hg(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:u++}))}{let u=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>i||3!==c.type).map(c=>{const f=new a0(r._firestore,r._userDataWriter,c.doc.key,c.doc,new hg(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let y=-1,I=-1;return 0!==c.type&&(y=u.indexOf(c.doc.key),u=u.delete(c.doc.key)),1!==c.type&&(u=u.add(c.doc),I=u.indexOf(c.doc.key)),{type:jL(c.type),doc:f,oldIndex:y,newIndex:I}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function jL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at()}}function Qk(n,e){return n instanceof Wc&&e instanceof Wc?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Gh&&e instanceof Gh&&n._firestore===e._firestore&&Vk(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function Jk(n){if(Yp(n)&&0===n.explicitOrderBy.length)throw new Re(le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class u0{}function Zh(n,...e){for(const t of e)n=t._apply(n);return n}class $L extends u0{constructor(e,t,r){super(),this.zc=e,this.Hc=t,this.Jc=r,this.type="where"}_apply(e){const t=cg(e.firestore),r=function(i,u,c,f,y,I,S){let A;if(y.isKeyField()){if("array-contains"===I||"array-contains-any"===I)throw new Re(le.INVALID_ARGUMENT,`Invalid Query. You can't perform '${I}' queries on documentId().`);if("in"===I||"not-in"===I){iM(S,I);const V=[];for(const z of S)V.push(rM(f,i,z));A={arrayValue:{values:V}}}else A=rM(f,i,S)}else"in"!==I&&"not-in"!==I&&"array-contains-any"!==I||iM(S,I),A=Zk(c,"where",S,"in"===I||"not-in"===I);const M=Gi.create(y,I,A);return function(V,z){if(z.V()){const Pe=Bb(V);if(null!==Pe&&!Pe.isEqual(z.field))throw new Re(le.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Pe.toString()}' and '${z.field.toString()}'`);const _t=Xm(V);null!==_t&&sM(0,z.field,_t)}const ye=function(Pe,_t){for(const wt of Pe.filters)if(_t.indexOf(wt.op)>=0)return wt.op;return null}(V,function(Pe){switch(Pe){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(z.op));if(null!==ye)throw new Re(le.INVALID_ARGUMENT,ye===z.op?`Invalid query. You cannot use more than one '${z.op.toString()}' filter.`:`Invalid query. You cannot use '${z.op.toString()}' filters with '${ye.toString()}' filters.`)}(i,M),M}(e._query,0,t,e.firestore._databaseId,this.zc,this.Hc,this.Jc);return new hs(e.firestore,e.converter,function(i,u){const c=i.filters.concat([u]);return new fu(i.path,i.collectionGroup,i.explicitOrderBy.slice(),c,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class qL extends u0{constructor(e,t){super(),this.zc=e,this.Yc=t,this.type="orderBy"}_apply(e){const t=function(r,i,u){if(null!==r.startAt)throw new Re(le.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Re(le.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const c=new zp(i,u);return function(f,y){if(null===Xm(f)){const I=Bb(f);null!==I&&sM(0,I,y.field)}}(r,c),c}(e._query,this.zc,this.Yc);return new hs(e.firestore,e.converter,function(r,i){const u=r.explicitOrderBy.concat([i]);return new fu(r.path,r.collectionGroup,u,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class Xk extends u0{constructor(e,t,r){super(),this.type=e,this.Xc=t,this.Zc=r}_apply(e){return new hs(e.firestore,e.converter,DS(e._query,this.Xc,this.Zc))}}class eM extends u0{constructor(e,t,r){super(),this.type=e,this.ta=t,this.ea=r}_apply(e){const t=nM(e,this.type,this.ta,this.ea);return new hs(e.firestore,e.converter,(i=t,new fu((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class tM extends u0{constructor(e,t,r){super(),this.type=e,this.ta=t,this.ea=r}_apply(e){const t=nM(e,this.type,this.ta,this.ea);return new hs(e.firestore,e.converter,(i=t,new fu((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function nM(n,e,t,r){if(t[0]=(0,O.m9)(t[0]),t[0]instanceof o0)return function(i,u,c,f,y){if(!f)throw new Re(le.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const I=[];for(const S of pu(i))if(S.field.isKeyField())I.push(Km(u,f.key));else{const A=f.data.field(S.field);if(Zm(A))throw new Re(le.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+S.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===A){const M=S.field.canonicalString();throw new Re(le.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${M}' (used as the orderBy) does not exist.`)}I.push(A)}return new Jm(I,y)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=cg(n.firestore);return function(u,c,f,y,I,S){const A=u.explicitOrderBy;if(I.length>A.length)throw new Re(le.INVALID_ARGUMENT,`Too many arguments provided to ${y}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const M=[];for(let V=0;V<I.length;V++){const z=I[V];if(A[V].field.isKeyField()){if("string"!=typeof z)throw new Re(le.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${y}(), but got a ${typeof z}`);if(!e_(u)&&-1!==z.indexOf("/"))throw new Re(le.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${y}() must be a plain document ID, but '${z}' contains a slash.`);const ye=u.path.child(Xt.fromString(z));if(!st.isDocumentKey(ye))throw new Re(le.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${y}() must result in a valid document path, but '${ye}' is not because it contains an odd number of segments.`);const Pe=new st(ye);M.push(Km(c,Pe))}else{const ye=Zk(f,y,z);M.push(ye)}}return new Jm(M,S)}(n._query,n.firestore._databaseId,i,e,t,r)}}function rM(n,e,t){if("string"==typeof(t=(0,O.m9)(t))){if(""===t)throw new Re(le.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!e_(e)&&-1!==t.indexOf("/"))throw new Re(le.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Xt.fromString(t));if(!st.isDocumentKey(r))throw new Re(le.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Km(n,new st(r))}if(t instanceof Vn)return Km(n,t._key);throw new Re(le.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wT(t)}.`)}function iM(n,e){if(!Array.isArray(n)||0===n.length)throw new Re(le.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Re(le.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function sM(n,e,t){if(!t.isEqual(e))throw new Re(le.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class ER{convertValue(e,t="none"){switch(_l(e)){case 0:return null;case 1:return e.booleanValue;case 2:return br(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw at()}}convertObject(e,t){const r={};return ur(e.fields,(i,u)=>{r[i]=this.convertValue(u,t)}),r}convertGeoPoint(e){return new IT(br(e.latitude),br(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Iw(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ml(e));default:return null}}convertTimestamp(e){const t=pl(e);return new zr(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Xt.fromString(e);Et(aT(r));const i=new x_(r.get(1),r.get(3)),u=new st(r.popFirst(5));return i.isEqual(t)||ar(`Document ${u} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}function ST(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class JL extends ER{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vn(this.firestore,null,t)}}class oM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=cg(e)}set(e,t,r){this._verifyNotCommitted();const i=zh(e,this._firestore),u=ST(i.converter,t,r),c=TT(this._dataReader,"WriteBatch.set",i._key,u,null!==i.converter,r);return this._mutations.push(c.toMutation(i._key,Tr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const u=zh(e,this._firestore);let c;return c="string"==typeof(t=(0,O.m9)(t))||t instanceof qc?_R(this._dataReader,"WriteBatch.update",u._key,t,r,i):mR(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(c.toMutation(u._key,Tr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=zh(e,this._firestore);return this._mutations=this._mutations.concat(new Uh(t._key,Tr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Re(le.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zh(n,e){if((n=(0,O.m9)(n)).firestore!==e)throw new Re(le.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class fg extends ER{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vn(this.firestore,null,t)}}function aM(n,e,t){n=Jt(n,Vn);const r=Jt(n.firestore,hr),i=ST(n.converter,e,t);return P_(r,[TT(cg(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Tr.none())])}function uM(n,e,t,...r){n=Jt(n,Vn);const i=Jt(n.firestore,hr),u=cg(i);let c;return c="string"==typeof(e=(0,O.m9)(e))||e instanceof qc?_R(u,"updateDoc",n._key,e,t,r):mR(u,"updateDoc",n._key,e),P_(i,[c.toMutation(n._key,Tr.exists(!0))])}function lM(n,...e){var t,r,i;n=(0,O.m9)(n);let u={includeMetadataChanges:!1},c=0;"object"!=typeof e[c]||pR(e[c])||(u=e[c],c++);const f={includeMetadataChanges:u.includeMetadataChanges};if(pR(e[c])){const A=e[c];e[c]=null===(t=A.next)||void 0===t?void 0:t.bind(A),e[c+1]=null===(r=A.error)||void 0===r?void 0:r.bind(A),e[c+2]=null===(i=A.complete)||void 0===i?void 0:i.bind(A)}let y,I,S;if(n instanceof Vn)I=Jt(n.firestore,hr),S=yl(n._key.path),y={next:A=>{e[c]&&e[c](IR(I,n,A))},error:e[c+1],complete:e[c+2]};else{const A=Jt(n,hs);I=Jt(A.firestore,hr),S=A._query;const M=new fg(I);y={next:V=>{e[c]&&e[c](new Gh(I,M,A,V))},error:e[c+1],complete:e[c+2]},Jk(n._query)}return function(A,M,V,z){const ye=new yT(z),Pe=new kA(M,ye,V);return A.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return SA(yield R_(A),Pe)})),()=>{ye.nc(),A.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return RA(yield R_(A),Pe)}))}}(di(I),S,f,y)}function P_(n,e){return function(t,r){const i=new Mr;return t.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return function q1(n,e,t){return FA.apply(this,arguments)}(yield dR(t),r,i)})),i.promise}(di(n),e)}function IR(n,e,t){const r=t.docs.get(e._key),i=new fg(n);return new Wc(n,i,e._key,r,new hg(t.hasPendingWrites,t.fromCache),e.converter)}class uF extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=cg(e)}get(e){const t=zh(e,this._firestore),r=new JL(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return at();const u=i[0];if(u.isFoundDocument())return new o0(this._firestore,r,u.key,u,t.converter);if(u.isNoDocument())return new o0(this._firestore,r,t._key,null,t.converter);throw at()})}set(e,t,r){const i=zh(e,this._firestore),u=ST(i.converter,t,r),c=TT(this._dataReader,"Transaction.set",i._key,u,null!==i.converter,r);return this._transaction.set(i._key,c),this}update(e,t,r,...i){const u=zh(e,this._firestore);let c;return c="string"==typeof(t=(0,O.m9)(t))||t instanceof qc?_R(this._dataReader,"Transaction.update",u._key,t,r,i):mR(this._dataReader,"Transaction.update",u._key,t),this._transaction.update(u._key,c),this}delete(e){const t=zh(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=zh(e,this._firestore),r=new fg(this._firestore);return super.get(e).then(i=>new Wc(this._firestore,r,t._key,i._document,new hg(!1,!1),t.converter))}}function bR(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Re("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function cM(){if("undefined"==typeof Uint8Array)throw new Re("unimplemented","Uint8Arrays are not available in this environment.")}function dM(){if(!function Ew(){return"undefined"!=typeof atob}())throw new Re("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){Rh=ri.SDK_VERSION,(0,ri._registerComponent)(new ia.wA("firestore",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),u=new hr(i,new wS(t.getProvider("auth-internal")),new _w(t.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),u._setSettings(r),u},"PUBLIC")),(0,ri.registerVersion)(xb,"3.4.3",n),(0,ri.registerVersion)(xb,"3.4.3","esm2017")}();class l0{constructor(e){this._delegate=e}static fromBase64String(e){return dM(),new l0(Cl.fromBase64String(e))}static fromUint8Array(e){return cM(),new l0(Cl.fromUint8Array(e))}toBase64(){return dM(),this._delegate.toBase64()}toUint8Array(){return cM(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function TR(n){return function _F(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class yF{enableIndexedDbPersistence(e,t){return function CL(n,e){Hk(n=Jt(n,hr));const t=di(n),r=n._freezeSettings(),i=new iR;return $k(t,i,new Tk(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function DL(n){Hk(n=Jt(n,hr));const e=di(n),t=n._freezeSettings(),r=new iR;return $k(e,r,new oL(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function SL(n){if(n._initialized&&!n._terminated)throw new Re(le.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Mr;return n._queue.enqueueAndForgetEvenWhileRestricted((0,fe.Z)(function*(){try{yield(t=(0,fe.Z)(function*(r){if(!ce.Pt())return Promise.resolve();const i=r+"main";yield ce.delete(i)}),function(r){return t.apply(this,arguments)})(YS(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class hM{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof x_||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ph("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function wL(n,e,t,r={}){var i;const u=(n=Jt(n,r0))._getSettings();if("firestore.googleapis.com"!==u.host&&u.host!==e&&Ph("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},u),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let c,f;if("string"==typeof r.mockUserToken)c=r.mockUserToken,f=li.MOCK_USER;else{c=(0,O.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new Re(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new li(y)}n._authCredentials=new vS(new Gm(c,f))}}(this._delegate,e,t,r)}enableNetwork(){return function RL(n){return function dL(n){return n.asyncQueue.enqueue((0,fe.Z)(function*(){const e=yield Ak(n),t=yield Rk(n);return e.setNetworkEnabled(!0),function(r){const i=qe(r);return i.Gr.delete(0),t0(i)}(t)}))}(di(n=Jt(n,hr)))}(this._delegate)}disableNetwork(){return function xL(n){return function hL(n){return n.asyncQueue.enqueue((0,fe.Z)(function*(){const e=yield Ak(n),t=yield Rk(n);return e.setNetworkEnabled(!1),(r=(0,fe.Z)(function*(i){const u=qe(i);u.Gr.add(0),yield I_(u),u.Jr.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(di(n=Jt(n,hr)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Mk("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function AL(n){return function(e){const t=new Mr;return e.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return function z1(n,e){return $A.apply(this,arguments)}(yield dR(e),t)})),t.promise}(di(n=Jt(n,hr)))}(this._delegate)}onSnapshotsInSync(e){return function aF(n,e){return function gL(n,e){const t=new yT(e);return n.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return r=yield R_(n),i=t,qe(r).io.add(i),void i.next();var r,i})),()=>{t.nc(),n.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return r=yield R_(n),i=t,void qe(r).io.delete(i);var r,i}))}}(di(n=Jt(n,hr)),pR(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Re("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new k_(this,Uk(this._delegate,e))}catch(t){throw Ms(t,"collection()","Firestore.collection()")}}doc(e){try{return new ca(this,ET(this._delegate,e))}catch(t){throw Ms(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ns(this,function EL(n,e){if(n=Jt(n,r0),fR("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Re(le.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new hs(n,null,(t=e,new fu(Xt.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ms(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function lF(n,e){return function mL(n,e){const t=new Mr;return n.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){const r=yield(i=n,vT(i).then(u=>u.datastore));var i;new lL(n.asyncQueue,r,e,t).run()})),t.promise}(di(n=Jt(n,hr)),t=>e(new uF(n,t)))}(this._delegate,t=>e(new fM(this,t)))}batch(){return di(this._delegate),new pM(new oM(this._delegate,e=>P_(this._delegate,e)))}loadBundle(e){return function PL(n,e){const t=di(n=Jt(n,hr)),r=new bL;return function _L(n,e,t,r){const i=function(u,c){let f;return f="string"==typeof u?(new TextEncoder).encode(u):u,y=function(y,I){if(y instanceof Uint8Array)return Ck(y,I);if(y instanceof ArrayBuffer)return Ck(new Uint8Array(y),I);if(y instanceof ReadableStream)return y.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(f),new aL(y,c);var y}(t,e0(e));n.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){!function sL(n,e,t){const r=qe(n);var i;(i=(0,fe.Z)(function*(u,c,f){try{const y=yield c.getMetadata();if(yield function(M,V){const z=qe(M),ye=ci(V.createTime);return z.persistence.runTransaction("hasNewerBundle","readonly",Pe=>z.Ye.getBundleMetadata(Pe,V.id)).then(Pe=>!!Pe&&Pe.createTime.compareTo(ye)>=0)}(u.localStore,y))return yield c.close(),void f._completeWith((M=y,{taskState:"Success",documentsLoaded:M.totalDocuments,bytesLoaded:M.totalBytes,totalDocuments:M.totalDocuments,totalBytes:M.totalBytes}));f._updateProgress(pk(y));const I=new U1(y,u.localStore,c.k);let S=yield c.Ho();for(;S;){const M=yield I.yo(S);M&&f._updateProgress(M),S=yield c.Ho()}const A=yield I.complete();yield Hc(u,A.In,void 0),yield function(M,V){const z=qe(M);return z.persistence.runTransaction("Save bundle","readwrite",ye=>z.Ye.saveBundleMetadata(ye,V))}(u.localStore,y),f._completeWith(A.progress)}catch(y){Ph("SyncEngine",`Loading bundle failed with ${y}`),f._failWith(y)}var M}),function(u,c,f){return i.apply(this,arguments)})(r,e,t).then(()=>{r.sharedClientState.notifyBundleLoaded()})}(yield dR(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function kL(n,e){return function yL(n,e){return n.asyncQueue.enqueue((0,fe.Z)(function*(){return function(t,r){const i=qe(t);return i.persistence.runTransaction("Get named query","readonly",u=>i.Ye.getNamedQuery(u,r))}(yield cR(n),e)}))}(di(n=Jt(n,hr)),e).then(t=>t?new hs(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Ns(this,t):null)}}class AT extends ER{constructor(e){super(),this.firestore=e}convertBytes(e){return new l0(new Cl(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return ca.forKey(t,this.firestore,null)}}class fM{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new AT(e)}get(e){const t=gg(e);return this._delegate.get(t).then(r=>new c0(this._firestore,new Wc(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=gg(e);return r?(bR("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const u=gg(e);return 2===arguments.length?this._delegate.update(u,t):this._delegate.update(u,t,r,...i),this}delete(e){const t=gg(e);return this._delegate.delete(t),this}}class pM{constructor(e){this._delegate=e}set(e,t,r){const i=gg(e);return r?(bR("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const u=gg(e);return 2===arguments.length?this._delegate.update(u,t):this._delegate.update(u,t,r,...i),this}delete(e){const t=gg(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class pg{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new a0(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new d0(this._firestore,r),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=pg.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let u=i.get(t);return u||(u=new pg(e,new AT(e),t),i.set(t,u)),u}}pg.INSTANCES=new WeakMap;class ca{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new AT(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Re("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ca(t,new Vn(t._delegate,r,new st(e)))}static forKey(e,t,r){return new ca(t,new Vn(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new k_(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new k_(this.firestore,Uk(this._delegate,e))}catch(t){throw Ms(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,O.m9)(e))instanceof Vn&&Bk(this._delegate,e)}set(e,t){t=bR("DocumentReference.set",t);try{return t?aM(this._delegate,e,t):aM(this._delegate,e)}catch(r){throw Ms(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?uM(this._delegate,e):uM(this._delegate,e,t,...r)}catch(i){throw Ms(i,"updateDoc()","DocumentReference.update()")}}delete(){return function sF(n){return P_(Jt(n.firestore,hr),[new Uh(n._key,Tr.none())])}(this._delegate)}onSnapshot(...e){const t=gM(e),r=mM(e,i=>new c0(this.firestore,new Wc(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return lM(this._delegate,t,r)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function eF(n){n=Jt(n,Vn);const e=Jt(n.firestore,hr),t=di(e),r=new fg(e);return function fL(n,e){const t=new Mr;return n.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return(r=(0,fe.Z)(function*(i,u,c){try{const f=yield function(y,I){const S=qe(y);return S.persistence.runTransaction("read document","readonly",A=>S.Wn.Rn(A,I))}(i,u);f.isFoundDocument()?c.resolve(f):f.isNoDocument()?c.resolve(null):c.reject(new Re(le.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(f){const y=C_(f,`Failed to get document '${u} from cache`);c.reject(y)}}),function(i,u,c){return r.apply(this,arguments)})(yield cR(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Wc(e,r,n._key,i,new hg(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function tF(n){n=Jt(n,Vn);const e=Jt(n.firestore,hr);return xk(di(e),n._key,{source:"server"}).then(t=>IR(e,n,t))}(this._delegate):function XL(n){n=Jt(n,Vn);const e=Jt(n.firestore,hr);return xk(di(e),n._key).then(t=>IR(e,n,t))}(this._delegate),t.then(r=>new c0(this.firestore,new Wc(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ca(this.firestore,this._delegate.withConverter(e?pg.getInstance(this.firestore,e):null))}}function Ms(n,e,t){return n.message=n.message.replace(e,t),n}function gM(n){for(const e of n)if("object"==typeof e&&!TR(e))return e;return{}}function mM(n,e){var t,r;let i;return i=TR(n[0])?n[0]:TR(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:u=>{i.next&&i.next(e(u))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class c0{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ca(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Qk(this._delegate,e._delegate)}}class d0 extends c0{data(e){const t=this._delegate.data(e);return function yS(n,e){n||at()}(void 0!==t),t}}class Ns{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new AT(e)}where(e,t,r){try{return new Ns(this.firestore,Zh(this._delegate,function HL(n,e,t){const r=e,i=DT("where",n);return new $L(i,r,t)}(e,t,r)))}catch(i){throw Ms(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ns(this.firestore,Zh(this._delegate,function WL(n,e="asc"){const t=e,r=DT("orderBy",n);return new qL(r,t)}(e,t)))}catch(r){throw Ms(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ns(this.firestore,Zh(this._delegate,function GL(n){return Lk("limit",n),new Xk("limit",n,"F")}(e)))}catch(t){throw Ms(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ns(this.firestore,Zh(this._delegate,function ZL(n){return Lk("limitToLast",n),new Xk("limitToLast",n,"L")}(e)))}catch(t){throw Ms(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ns(this.firestore,Zh(this._delegate,function zL(...n){return new eM("startAt",n,!0)}(...e)))}catch(t){throw Ms(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ns(this.firestore,Zh(this._delegate,function KL(...n){return new eM("startAfter",n,!1)}(...e)))}catch(t){throw Ms(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ns(this.firestore,Zh(this._delegate,function YL(...n){return new tM("endBefore",n,!0)}(...e)))}catch(t){throw Ms(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ns(this.firestore,Zh(this._delegate,function QL(...n){return new tM("endAt",n,!1)}(...e)))}catch(t){throw Ms(t,"endAt()","Query.endAt()")}}isEqual(e){return Vk(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function rF(n){n=Jt(n,hs);const e=Jt(n.firestore,hr),t=di(e),r=new fg(e);return function pL(n,e){const t=new Mr;return n.asyncQueue.enqueueAndForget((0,fe.Z)(function*(){return(r=(0,fe.Z)(function*(i,u,c){try{const f=yield hT(i,u,!0),y=new _k(u,f.zn),I=y.Po(f.documents),S=y.applyChanges(I,!1);c.resolve(S.snapshot)}catch(f){const y=C_(f,`Failed to execute query '${u} against cache`);c.reject(y)}}),function(i,u,c){return r.apply(this,arguments)})(yield cR(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Gh(e,r,n,i))}(this._delegate):"server"===(null==e?void 0:e.source)?function iF(n){n=Jt(n,hs);const e=Jt(n.firestore,hr),t=di(e),r=new fg(e);return Pk(t,n._query,{source:"server"}).then(i=>new Gh(e,r,n,i))}(this._delegate):function nF(n){n=Jt(n,hs);const e=Jt(n.firestore,hr),t=di(e),r=new fg(e);return Jk(n._query),Pk(t,n._query).then(i=>new Gh(e,r,n,i))}(this._delegate),t.then(r=>new CR(this.firestore,new Gh(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=gM(e),r=mM(e,i=>new CR(this.firestore,new Gh(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return lM(this._delegate,t,r)}withConverter(e){return new Ns(this.firestore,this._delegate.withConverter(e?pg.getInstance(this.firestore,e):null))}}class wF{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new d0(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class CR{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ns(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new d0(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new wF(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new d0(this._firestore,r))})}isEqual(e){return Qk(this._delegate,e._delegate)}}class k_ extends Ns{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ca(this.firestore,e):null}doc(e){try{return new ca(this.firestore,void 0===e?ET(this._delegate):ET(this._delegate,e))}catch(t){throw Ms(t,"doc()","CollectionReference.doc()")}}add(e){return function oF(n,e){const t=Jt(n.firestore,hr),r=ET(n),i=ST(n.converter,e);return P_(t,[TT(cg(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Tr.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new ca(this.firestore,t))}isEqual(e){return Bk(this._delegate,e._delegate)}withConverter(e){return new k_(this.firestore,this._delegate.withConverter(e?pg.getInstance(this.firestore,e):null))}}function gg(n){return Jt(n,Vn)}class DR{constructor(...e){this._delegate=new qc(...e)}static documentId(){return new DR(lr.keyField().canonicalString())}isEqual(e){return(e=(0,O.m9)(e))instanceof qc&&this._delegate._internalPath.isEqual(e._internalPath)}}class mg{constructor(e){this._delegate=e}static serverTimestamp(){const e=function dF(){return new gR("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new mg(e)}static delete(){const e=function cF(){return new s0("deleteField")}();return e._methodName="FieldValue.delete",new mg(e)}static arrayUnion(...e){const t=function hF(...n){return new LL("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new mg(t)}static arrayRemove(...e){const t=function fF(...n){return new FL("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new mg(t)}static increment(e){const t=function pF(n){return new UL("increment",n)}(e);return t._methodName="FieldValue.increment",new mg(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const EF={Firestore:hM,GeoPoint:IT,Timestamp:zr,Blob:l0,Transaction:fM,WriteBatch:pM,DocumentReference:ca,DocumentSnapshot:c0,Query:Ns,QueryDocumentSnapshot:d0,QuerySnapshot:CR,CollectionReference:k_,FieldPath:DR,FieldValue:mg,setLogLevel:function vF(n){!function _S(n){Do.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function _M(n,e){return function TF(n,e=tl.z){return new sr.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=r&&r()}})}(n,e)}function SR(n,e){return _M(n,e).pipe((0,vt.U)(t=>({payload:t,type:"query"})))}function RT(n,e){return SR(n,e).pipe(Li(void 0),SI(),(0,vt.U)(([t,r])=>{const i=r.payload.docChanges(),u=i.map(c=>({type:c.type,payload:c}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((c,f)=>{const y=i.find(S=>S.doc.ref.isEqual(c.ref)),I=null==t?void 0:t.payload.docs.find(S=>S.ref.isEqual(c.ref));y&&JSON.stringify(y.doc.metadata)===JSON.stringify(c.metadata)||!y&&I&&JSON.stringify(I.metadata)===JSON.stringify(c.metadata)||u.push({type:"modified",payload:{oldIndex:f,newIndex:f,type:"modified",doc:c}})}),u}))}function yM(n,e,t){return RT(n,t).pipe(zs((r,i)=>function DF(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function SF(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return AR(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return AR(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return AR(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(u=>u.payload),e),[]),vv(),(0,vt.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function AR(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function vM(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function bF(n){(function IF(n,e){n.INTERNAL.registerComponent(new ia.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},EF)))})(n,(e,t)=>new hM(e,t,new yF)),n.registerVersion("@firebase/firestore-compat","0.1.12")}($y.Z);class wM{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=RT(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,vt.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Li(void 0),SI(),qr(([r,i])=>i.length>0||!r),(0,vt.U)(([r,i])=>i),Yt.iC)}auditTrail(e){return this.stateChanges(e).pipe(zs((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=vM(e);return yM(this.query,t,this.afs.schedulers.outsideAngular).pipe(Yt.iC)}valueChanges(e={}){return SR(this.query,this.afs.schedulers.outsideAngular).pipe((0,vt.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),Yt.iC)}get(e){return(0,sn.D)(this.query.get(e)).pipe(Yt.iC)}add(e){return this.ref.add(e)}doc(e){return new EM(this.ref.doc(e),this.afs)}}class EM{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:u}=TM(r,t);return new wM(i,u,this.afs)}snapshotChanges(){return function CF(n,e){return _M(n,e).pipe(Li(void 0),SI(),(0,vt.U)(([t,r])=>r.exists?(null==t?void 0:t.exists)?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Yt.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,vt.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,sn.D)(this.ref.get(e)).pipe(Yt.iC)}}class AF{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?RT(this.query,this.afs.schedulers.outsideAngular).pipe((0,vt.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),qr(t=>t.length>0),Yt.iC):RT(this.query,this.afs.schedulers.outsideAngular).pipe(Yt.iC)}auditTrail(e){return this.stateChanges(e).pipe(zs((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=vM(e);return yM(this.query,t,this.afs.schedulers.outsideAngular).pipe(Yt.iC)}valueChanges(e={}){return SR(this.query,this.afs.schedulers.outsideAngular).pipe((0,vt.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),Yt.iC)}get(e){return(0,sn.D)(this.query.get(e)).pipe(Yt.iC)}}const IM=new m.OlP("angularfire2.enableFirestorePersistence"),bM=new m.OlP("angularfire2.firestore.persistenceSettings"),RF=new m.OlP("angularfire2.firestore.settings"),xF=new m.OlP("angularfire2.firestore.use-emulator");function TM(n,e=(t=>t)){return{query:e(n),ref:n}}let PF=(()=>{class n{constructor(t,r,i,u,c,f,y,I,S,A,M,V,z,ye,Pe,_t,wt){this.schedulers=y;const It=(0,Pr.on)(t,f,r),lt=S;A&&Fy(It,f,M,z,ye,Pe,V,_t),[this.firestore,this.persistenceEnabled$]=(0,Pr.cc)(`${It.name}.firestore`,"AngularFirestore",It.name,()=>{const un=f.runOutsideAngular(()=>It.firestore());if(u&&un.settings(u),lt&&un.useEmulator(...lt),i&&!ba(c)){const bi=()=>{try{return(0,sn.D)(un.enablePersistence(I||void 0).then(()=>!0,()=>!1))}catch(sf){return"undefined"!=typeof console&&console.warn(sf),Ke(!1)}};return[un,f.runOutsideAngular(bi)]}return[un,Ke(!1)]},[u,lt,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:u,query:c}=TM(i,r),f=this.schedulers.ngZone.run(()=>u);return new wM(f,c,this)}collectionGroup(t,r){const i=r||(c=>c),u=this.firestore.collectionGroup(t);return new AF(i(u),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new EM(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(Pr.Dh),m.LFG(Pr.xv,8),m.LFG(IM,8),m.LFG(RF,8),m.LFG(m.Lbi),m.LFG(m.R0b),m.LFG(Yt.HU),m.LFG(bM,8),m.LFG(xF,8),m.LFG(dp,8),m.LFG(lm,8),m.LFG(cm,8),m.LFG(dm,8),m.LFG(hm,8),m.LFG(Eo,8),m.LFG(Yd,8),m.LFG(lp,8))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),kF=(()=>{class n{constructor(){Hd.Z.registerVersion("angularfire",Yt.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:IM,useValue:!0},{provide:bM,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({providers:[PF]}),n})();var MF=L(5032);const CM="@firebase/database";let RR="";function SM(n){RR=n}class LF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,O.Pz)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,O.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class FF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,O.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const AM=function(n){try{if("undefined"!=typeof window&&void 0!==window[n]){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new LF(e)}}catch(e){}return new FF},_g=AM("localStorage"),xR=AM("sessionStorage"),M_=new sa.Yd("@firebase/database"),RM=function(){let n=1;return function(){return n++}}(),xM=function(n){const e=(0,O.dS)(n),t=new O.gQ;t.update(e);const r=t.digest();return O.US.encodeByteArray(r)},h0=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=h0.apply(null,r):e+="object"==typeof r?(0,O.Pz)(r):r,e+=" "}return e};let yg=null,PM=!0;const kM=function(n,e){(0,O.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(M_.logLevel=sa.in.VERBOSE,yg=M_.log.bind(M_),e&&xR.set("logging_enabled",!0)):"function"==typeof n?yg=n:(yg=null,xR.remove("logging_enabled"))},Ei=function(...n){if(!0===PM&&(PM=!1,null===yg&&!0===xR.get("logging_enabled")&&kM(!0)),yg){const e=h0.apply(null,n);yg(e)}},f0=function(n){return function(...e){Ei(n,...e)}},PR=function(...n){const e="FIREBASE INTERNAL ERROR: "+h0(...n);M_.error(e)},Dl=function(...n){const e=`FIREBASE FATAL ERROR: ${h0(...n)}`;throw M_.error(e),new Error(e)},Os=function(...n){const e="FIREBASE WARNING: "+h0(...n);M_.warn(e)},xT=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Gc="[MIN_NAME]",Sl="[MAX_NAME]",vg=function(n,e){if(n===e)return 0;if(n===Gc||e===Sl)return-1;if(e===Gc||n===Sl)return 1;{const t=PT(n),r=PT(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},VF=function(n,e){return n===e?0:n<e?-1:1},p0=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,O.Pz)(e))},kR=function(n){if("object"!=typeof n||null===n)return(0,O.Pz)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,O.Pz)(e[r]),t+=":",t+=kR(n[e[r]]);return t+="}",t},MM=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Ii(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const NM=function(n){(0,O.hu)(!xT(n),"Invalid JSON number");const r=1023;let i,u,c,f,y;0===n?(u=0,c=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(f=Math.min(Math.floor(Math.log(n)/Math.LN2),r),u=f+r,c=Math.round(n*Math.pow(2,52-f)-Math.pow(2,52))):(u=0,c=Math.round(n/Math.pow(2,-1074))));const I=[];for(y=52;y;y-=1)I.push(c%2?1:0),c=Math.floor(c/2);for(y=11;y;y-=1)I.push(u%2?1:0),u=Math.floor(u/2);I.push(i?1:0),I.reverse();const S=I.join("");let A="";for(y=0;y<64;y+=8){let M=parseInt(S.substr(y,8),2).toString(16);1===M.length&&(M="0"+M),A+=M}return A.toLowerCase()},qF=new RegExp("^-?(0*)\\d{1,10}$"),OM=-2147483648,MR=2147483647,PT=function(n){if(qF.test(n)){const e=Number(n);if(e>=OM&&e<=MR)return e}return null},N_=function(n){try{n()}catch(e){setTimeout(()=>{throw Os("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},g0=function(n,e){const t=setTimeout(n,e);return"object"==typeof t&&t.unref&&t.unref(),t};class GF{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Os(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class ZF{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Ei("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Os(e)}}let m0=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const VM=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,$M="websocket",HM="long_polling";class OR{constructor(e,t,r,i,u=!1,c="",f=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=u,this.persistenceKey=c,this.includeNamespaceInQueryParams=f,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=_g.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&_g.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function qM(n,e,t){let r;if((0,O.hu)("string"==typeof e,"typeof type must == string"),(0,O.hu)("object"==typeof t,"typeof params must == object"),e===$M)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==HM)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function KF(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Ii(t,(u,c)=>{i.push(u+"="+c)}),r+i.join("&")}class YF{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,O.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,O.p$)(this.counters_)}}const LR={},FR={};function UR(n){const e=n.toString();return LR[e]||(LR[e]=new YF),LR[e]}class JF{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&N_(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class O_{constructor(e,t,r,i,u,c,f){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=u,this.transportSessionId=c,this.lastSessionId=f,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=f0(e),this.stats_=UR(t),this.urlFn=y=>(this.appCheckToken&&(y.ac=this.appCheckToken),qM(t,HM,y))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new JF(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,O.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new BR((...u)=>{const[c,f,y,I,S]=u;if(this.incrementIncomingBytes_(u),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===c)this.id=f,this.password=y;else{if("close"!==c)throw new Error("Unrecognized command received: "+c);f?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(f,()=>{this.onClosed_()})):this.onClosed_()}},(...u)=>{const[c,f]=u;this.incrementIncomingBytes_(u),this.myPacketOrderer.handleResponse(c,f)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&VM.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){O_.forceAllow_=!0}static forceDisallow(){O_.forceDisallow_=!0}static isAvailable(){return!((0,O.Yr)()||!O_.forceAllow_&&(O_.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,O.Pz)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,O.h$)(t),i=MM(r,1840);for(let u=0;u<i.length;u++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[u]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,O.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,O.Pz)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class BR{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,O.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=RM(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=BR.createIFrame_();let u="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(u='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(f){Ei("frame writing exception"),f.stack&&Ei(f.stack),Ei(f)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ei("No IE domain setting required")}catch(t){const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const c=this.pendingSegs.shift();r=r+"&seg"+i+"="+c.seg+"&ts"+i+"="+c.ts+"&d"+i+"="+c.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,O.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Ei("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch(r){}},Math.floor(1))}}let _0=null;"undefined"!=typeof MozWebSocket?_0=MozWebSocket:"undefined"!=typeof WebSocket&&(_0=WebSocket);let y0=(()=>{class n{constructor(t,r,i,u,c,f,y){this.connId=t,this.applicationId=i,this.appCheckToken=u,this.authToken=c,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=f0(this.connId),this.stats_=UR(r),this.connURL=n.connectionURL_(r,f,y,u),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,u){const c={v:"5"};return!(0,O.Yr)()&&"undefined"!=typeof location&&location.hostname&&VM.test(location.hostname)&&(c.r="f"),r&&(c.s=r),i&&(c.ls=i),u&&(c.ac=u),qM(t,$M,c)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,_g.set("previous_websocket_failure",!0);try{if((0,O.Yr)()){const u={headers:{"User-Agent":`Firebase/5/${RR}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(u.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(u.headers["X-Firebase-AppCheck"]=this.appCheckToken);const c=process.env,f=0===this.connURL.indexOf("wss://")?c.HTTPS_PROXY||c.https_proxy:c.HTTP_PROXY||c.http_proxy;f&&(u.proxy={origin:f}),this.mySock=new _0(this.connURL,[],u)}else this.mySock=new _0(this.connURL,[],{headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(i){this.log_("Error instantiating WebSocket.");const u=i.message||i.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const u=i.message||i.data;u&&this.log_(u),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==_0&&!n.forceDisallow_}static previouslyFailed(){return _g.isInMemoryStorage||!0===_g.get("previous_websocket_failure")}markConnectionHealthy(){_g.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,O.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,O.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,O.Pz)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=MM(r,16384);i.length>1&&this.sendString_(String(i.length));for(let u=0;u<i.length;u++)this.sendString_(i[u])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})();class VR{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[O_,y0]}initTransports_(e){const t=y0&&y0.isAvailable();let r=t&&!y0.previouslyFailed();if(e.webSocketOnly&&(t||Os("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[y0];else{const i=this.transports_=[];for(const u of VR.ALL_TRANSPORTS)u&&u.isAvailable()&&i.push(u)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}class rN{constructor(e,t,r,i,u,c,f,y,I,S){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=u,this.onMessage_=c,this.onReady_=f,this.onDisconnect_=y,this.onKill_=I,this.lastSessionId=S,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=f0("c:"+this.id+":"),this.transportManager_=new VR(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=g0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=p0("t",e),r=p0("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=p0("t",e),r=p0("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=p0("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?PR("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):PR("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&Os("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),g0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):g0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(_g.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class iN{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class sN{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,O.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let u=0;u<i.length;u++)if(i[u].callback===t&&(!r||r===i[u].context))return void i.splice(u,1)}validateEventType_(e){(0,O.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class MT extends sN{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!(0,O.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new MT}getInitialEvent(e){return(0,O.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class pn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function an(){return new pn("")}function Ot(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Kh(n){return n.pieces_.length-n.pieceNum_}function Cn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new pn(n.pieces_,e)}function $R(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function v0(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function uN(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new pn(e,0)}function Xn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof pn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new pn(t,0)}function Lt(n){return n.pieceNum_>=n.pieces_.length}function Ls(n,e){const t=Ot(n),r=Ot(e);if(null===t)return e;if(t===r)return Ls(Cn(n),Cn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function wU(n,e){const t=v0(n,0),r=v0(e,0);for(let i=0;i<t.length&&i<r.length;i++){const u=vg(t[i],r[i]);if(0!==u)return u}return t.length===r.length?0:t.length<r.length?-1:1}function HR(n,e){if(Kh(n)!==Kh(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function da(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Kh(n)>Kh(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class EU{constructor(e,t){this.errorPrefix_=t,this.parts_=v0(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,O.ug)(this.parts_[r]);lN(this)}}function lN(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+wg(n))}function wg(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class qR extends sN{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new qR}getInitialEvent(e){return(0,O.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const w0=1e3;let OT,Eg=(()=>{class n extends iN{constructor(t,r,i,u,c,f,y,I){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=u,this.onServerInfoUpdate_=c,this.authTokenProvider_=f,this.appCheckTokenProvider_=y,this.authOverride_=I,this.id=n.nextPersistentConnectionId_++,this.log_=f0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=w0,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,I&&!(0,O.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");qR.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&MT.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const u=++this.requestNumber_,c={r:u,a:t,b:r};this.log_((0,O.Pz)(c)),(0,O.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(c),i&&(this.requestCBHash_[u]=i)}get(t){this.initConnection_();const r=new O.BH,i={p:t._path.toString(),q:t._queryObject},u={action:"g",request:i,onComplete:f=>{const y=f.d;"ok"===f.s?(this.onDataUpdate_(i.p,y,!1,null),r.resolve(y)):r.reject(y)}};this.outstandingGets_.push(u),this.outstandingGetCount_++;const c=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const f=this.outstandingGets_[c];void 0===f||u!==f||(delete this.outstandingGets_[c],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+c+" timed out on connection"),r.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(c),r.promise}listen(t,r,i,u){this.initConnection_();const c=t._queryIdentifier,f=t._path.toString();this.log_("Listen called for "+f+" "+c),this.listens.has(f)||this.listens.set(f,new Map),(0,O.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,O.hu)(!this.listens.get(f).has(c),"listen() called twice for same path/queryId.");const y={onComplete:u,hashFn:r,query:t,tag:i};this.listens.get(f).set(c,y),this.connected_&&this.sendListen_(y)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),u=r._queryIdentifier;this.log_("Listen on "+i+" for "+u);const c={p:i};t.tag&&(c.q=r._queryObject,c.t=t.tag),c.h=t.hashFn(),this.sendRequest("q",c,y=>{const I=y.d,S=y.s;n.warnOnListenWarnings_(I,r),(this.listens.get(i)&&this.listens.get(i).get(u))===t&&(this.log_("listen response",y),"ok"!==S&&this.removeListen_(i,u),t.onComplete&&t.onComplete(S,I))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,O.r3)(t,"w")){const i=(0,O.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const u='".indexOn": "'+r._queryParams.getIndex().toString()+'"',c=r._path.toString();Os(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${u} at ${c} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,O.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,O.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,u=>{const c=u.s,f=u.d||"error";this.authToken_===t&&("ok"===c?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(c,f))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),u=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+u),(0,O.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,u)&&this.connected_&&this.sendUnlisten_(i,u,t._queryObject,r)}sendUnlisten_(t,r,i,u){this.log_("Unlisten on "+t+" for "+r);const c={p:t};u&&(c.q=i,c.t=u),this.sendRequest("n",c)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,u){const c={p:r,d:i};this.log_("onDisconnect "+t,c),this.sendRequest(t,c,f=>{u&&setTimeout(()=>{u(f.s,f.d)},Math.floor(0))})}put(t,r,i,u){this.putInternal("p",t,r,i,u)}merge(t,r,i,u){this.putInternal("m",t,r,i,u)}putInternal(t,r,i,u,c){this.initConnection_();const f={p:r,d:i};void 0!==c&&(f.h=c),this.outstandingPuts_.push({action:t,request:f,onComplete:u}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,u=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,c=>{this.log_(r+" response",c),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),u&&u(c.s,c.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,O.Pz)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):PR("Unrecognized action received from server: "+(0,O.Pz)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,O.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=w0,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=w0,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=w0),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,fe.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),u=t.onRealtimeDisconnect_.bind(t),c=t.id+":"+n.nextConnectionId_++,f=t.lastSessionId;let y=!1,I=null;const S=function(){I?I.close():(y=!0,u())};t.realtime_={close:S,sendRequest:function(V){(0,O.hu)(I,"sendRequest call when we're not connected not allowed."),I.sendRequest(V)}};const M=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[V,z]=yield Promise.all([t.authTokenProvider_.getToken(M),t.appCheckTokenProvider_.getToken(M)]);y?Ei("getToken() completed but was canceled"):(Ei("getToken() completed. Creating connection."),t.authToken_=V&&V.accessToken,t.appCheckToken_=z&&z.token,I=new rN(c,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,u,ye=>{Os(ye+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},f))}catch(V){t.log_("Failed to get token: "+V),y||(t.repoInfo_.nodeAdmin&&Os(V),S())}}})()}interrupt(t){Ei("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ei("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,O.xb)(this.interruptReasons_)&&(this.reconnectDelay_=w0,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(c=>kR(c)).join("$"):"default";const u=this.removeListen_(t,i);u&&u.onComplete&&u.onComplete("permission_denied")}removeListen_(t,r){const i=new pn(t).toString();let u;if(this.listens.has(i)){const c=this.listens.get(i);u=c.get(r),c.delete(r),0===c.size&&this.listens.delete(i)}else u=void 0;return u}onAuthRevoked_(t,r){Ei("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Ei("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,O.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+RR.replace(/\./g,"-")]=1,(0,O.uI)()?t["framework.cordova"]=1:(0,O.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=MT.getInstance().currentlyOnline();return(0,O.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class jt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new jt(e,t)}}class NT{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new jt(Gc,e),i=new jt(Gc,t);return 0!==this.compare(r,i)}minPost(){return jt.MIN}}class hN extends NT{static get __EMPTY_NODE(){return OT}static set __EMPTY_NODE(e){OT=e}compare(e,t){return vg(e.name,t.name)}isDefinedOn(e){throw(0,O.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return jt.MIN}maxPost(){return new jt(Sl,OT)}makePost(e,t){return(0,O.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new jt(e,OT)}toString(){return".key"}}const Al=new hN;class LT{constructor(e,t,r,i,u=null){this.isReverse_=i,this.resultGenerator_=u,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(e=e,c=t?r(e.key,t):1,i&&(c*=-1),c<0)e=this.isReverse_?e.left:e.right;else{if(0===c){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let GR,_u=(()=>{class n{constructor(t,r,i,u,c){this.key=t,this.value=r,this.color=null!=i?i:n.RED,this.left=null!=u?u:ao.EMPTY_NODE,this.right=null!=c?c:ao.EMPTY_NODE}copy(t,r,i,u,c){return new n(null!=t?t:this.key,null!=r?r:this.value,null!=i?i:this.color,null!=u?u:this.left,null!=c?c:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let u=this;const c=i(t,u.key);return u=c<0?u.copy(null,null,null,u.left.insert(t,r,i),null):0===c?u.copy(null,r,null,null,null):u.copy(null,null,null,null,u.right.insert(t,r,i)),u.fixUp_()}removeMin_(){if(this.left.isEmpty())return ao.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,u;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return ao.EMPTY_NODE;u=i.right.min_(),i=i.copy(u.key,u.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class ao{constructor(e,t=ao.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new ao(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,_u.BLACK,null,null))}remove(e){return new ao(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,_u.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new LT(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new LT(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new LT(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new LT(this.root_,null,this.comparator_,!0,e)}}function xU(n,e){return vg(n.name,e.name)}function WR(n,e){return vg(n,e)}ao.EMPTY_NODE=new class RU{copy(e,t,r,i,u){return this}insert(e,t,r){return new _u(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const fN=function(n){return"number"==typeof n?"number:"+NM(n):"string:"+n},pN=function(n){if(n.isLeafNode()){const e=n.val();(0,O.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,O.r3)(e,".sv"),"Priority must be a string or number.")}else(0,O.hu)(n===GR||n.isEmpty(),"priority of unexpected type.");(0,O.hu)(n===GR||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let gN,mN,_N,L_=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,O.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),pN(this.priorityNode_)}static set __childrenNodeConstructor(t){gN=t}static get __childrenNodeConstructor(){return gN}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Lt(t)?this:".priority"===Ot(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=Ot(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,O.hu)(".priority"!==i||1===Kh(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Cn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+fN(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?NM(this.value_):this.value_,this.lazyHash_=xM(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,O.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,u=n.VALUE_TYPE_ORDER.indexOf(r),c=n.VALUE_TYPE_ORDER.indexOf(i);return(0,O.hu)(u>=0,"Unknown leaf type: "+r),(0,O.hu)(c>=0,"Unknown leaf type: "+i),u===c?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:c-u}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Nn=new class NU extends NT{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),u=r.compareTo(i);return 0===u?vg(e.name,t.name):u}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return jt.MIN}maxPost(){return new jt(Sl,new L_("[PRIORITY-POST]",_N))}makePost(e,t){const r=mN(e);return new jt(t,new L_("[PRIORITY-POST]",r))}toString(){return".priority"}},OU=Math.log(2);class LU{constructor(e){this.count=parseInt(Math.log(e+1)/OU,10),this.current_=this.count-1;const i=(u=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const FT=function(n,e,t,r){n.sort(e);const i=function(y,I){const S=I-y;let A,M;if(0===S)return null;if(1===S)return A=n[y],M=t?t(A):A,new _u(M,A.node,_u.BLACK,null,null);{const V=parseInt(S/2,10)+y,z=i(y,V),ye=i(V+1,I);return A=n[V],M=t?t(A):A,new _u(M,A.node,_u.BLACK,z,ye)}},f=function(y){let I=null,S=null,A=n.length;const M=function(z,ye){const Pe=A-z,_t=A;A-=z;const wt=i(Pe+1,_t),It=n[Pe],lt=t?t(It):It;V(new _u(lt,It.node,ye,null,wt))},V=function(z){I?(I.left=z,I=z):(S=z,I=z)};for(let z=0;z<y.count;++z){const ye=y.nextBitIsOne(),Pe=Math.pow(2,y.count-(z+1));ye?M(Pe,_u.BLACK):(M(Pe,_u.BLACK),M(Pe,_u.RED))}return S}(new LU(n.length));return new ao(r||e,f)};let ZR;const F_={};class Zc{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,O.hu)(F_&&Nn,"ChildrenNode.ts has not been loaded"),ZR=ZR||new Zc({".priority":F_},{".priority":Nn}),ZR}get(e){const t=(0,O.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ao?t:null}hasIndex(e){return(0,O.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,O.hu)(e!==Al,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const u=t.getIterator(jt.Wrap);let f,c=u.getNext();for(;c;)i=i||e.isDefinedOn(c.node),r.push(c),c=u.getNext();f=i?FT(r,e.getCompare()):F_;const y=e.toString(),I=Object.assign({},this.indexSet_);I[y]=e;const S=Object.assign({},this.indexes_);return S[y]=f,new Zc(S,I)}addToIndexes(e,t){const r=(0,O.UI)(this.indexes_,(i,u)=>{const c=(0,O.DV)(this.indexSet_,u);if((0,O.hu)(c,"Missing index implementation for "+u),i===F_){if(c.isDefinedOn(e.node)){const f=[],y=t.getIterator(jt.Wrap);let I=y.getNext();for(;I;)I.name!==e.name&&f.push(I),I=y.getNext();return f.push(e),FT(f,c.getCompare())}return F_}{const f=t.get(e.name);let y=i;return f&&(y=y.remove(new jt(e.name,f))),y.insert(e,e.node)}});return new Zc(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,O.UI)(this.indexes_,i=>{if(i===F_)return i;{const u=t.get(e.name);return u?i.remove(new jt(e.name,u)):i}});return new Zc(r,this.indexSet_)}}let E0,kt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&pN(this.priorityNode_),this.children_.isEmpty()&&(0,O.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return E0||(E0=new n(new ao(WR),null,Zc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||E0}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?E0:r}}getChild(t){const r=Ot(t);return null===r?this:this.getImmediateChild(r).getChild(Cn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,O.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new jt(t,r);let u,c;r.isEmpty()?(u=this.children_.remove(t),c=this.indexMap_.removeFromIndexes(i,this.children_)):(u=this.children_.insert(t,r),c=this.indexMap_.addToIndexes(i,this.children_));const f=u.isEmpty()?E0:this.priorityNode_;return new n(u,f,c)}}updateChild(t,r){const i=Ot(t);if(null===i)return r;{(0,O.hu)(".priority"!==Ot(t)||1===Kh(t),".priority must be the last token in a path");const u=this.getImmediateChild(i).updateChild(Cn(t),r);return this.updateImmediateChild(i,u)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,u=0,c=!0;if(this.forEachChild(Nn,(f,y)=>{r[f]=y.val(t),i++,c&&n.INTEGER_REGEXP_.test(f)?u=Math.max(u,Number(f)):c=!1}),!t&&c&&u<2*i){const f=[];for(const y in r)f[y]=r[y];return f}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+fN(this.getPriority().val())+":"),this.forEachChild(Nn,(r,i)=>{const u=i.hash();""!==u&&(t+=":"+r+":"+u)}),this.lazyHash_=""===t?"":xM(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const u=this.resolveIndex_(i);if(u){const c=u.getPredecessorKey(new jt(t,r));return c?c.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new jt(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new jt(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(u=>r(u.name,u.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,u=>u);{const u=this.children_.getIteratorFrom(t.name,jt.Wrap);let c=u.peek();for(;null!=c&&r.compare(c,t)<0;)u.getNext(),c=u.peek();return u}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,u=>u);{const u=this.children_.getReverseIteratorFrom(t.name,jt.Wrap);let c=u.peek();for(;null!=c&&r.compare(c,t)>0;)u.getNext(),c=u.peek();return u}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===I0?-1:0}withIndex(t){if(t===Al||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Al||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(Nn),u=r.getIterator(Nn);let c=i.getNext(),f=u.getNext();for(;c&&f;){if(c.name!==f.name||!c.node.equals(f.node))return!1;c=i.getNext(),f=u.getNext()}return null===c&&null===f}return!1}return!1}}resolveIndex_(t){return t===Al?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const I0=new class FU extends kt{constructor(){super(new ao(WR),kt.EMPTY_NODE,Zc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return kt.EMPTY_NODE}isEmpty(){return!1}};function fr(n,e=null){if(null===n)return kt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,O.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new L_(n,fr(e));if(n instanceof Array){let t=kt.EMPTY_NODE;return Ii(n,(r,i)=>{if((0,O.r3)(n,r)&&"."!==r.substring(0,1)){const u=fr(i);(u.isLeafNode()||!u.isEmpty())&&(t=t.updateImmediateChild(r,u))}}),t.updatePriority(fr(e))}{const t=[];let r=!1;if(Ii(n,(c,f)=>{if("."!==c.substring(0,1)){const y=fr(f);y.isEmpty()||(r=r||!y.getPriority().isEmpty(),t.push(new jt(c,y)))}}),0===t.length)return kt.EMPTY_NODE;const u=FT(t,xU,c=>c.name,WR);if(r){const c=FT(t,Nn.getCompare());return new kt(u,fr(e),new Zc({".priority":c},{".priority":Nn}))}return new kt(u,fr(e),Zc.Default)}}Object.defineProperties(jt,{MIN:{value:new jt(Gc,kt.EMPTY_NODE)},MAX:{value:new jt(Sl,I0)}}),hN.__EMPTY_NODE=kt.EMPTY_NODE,L_.__childrenNodeConstructor=kt,function PU(n){GR=n}(I0),function MU(n){_N=n}(I0),function kU(n){mN=n}(fr);class zR extends NT{constructor(e){super(),this.indexPath_=e,(0,O.hu)(!Lt(e)&&".priority"!==Ot(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),u=r.compareTo(i);return 0===u?vg(e.name,t.name):u}makePost(e,t){const r=fr(e),i=kt.EMPTY_NODE.updateChild(this.indexPath_,r);return new jt(t,i)}maxPost(){const e=kt.EMPTY_NODE.updateChild(this.indexPath_,I0);return new jt(Sl,e)}toString(){return v0(this.indexPath_,0).join("/")}}const KR=new class BU extends NT{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?vg(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return jt.MIN}maxPost(){return jt.MAX}makePost(e,t){const r=fr(e);return new jt(t,r)}toString(){return".value"}},U_="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",VU=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const u=new Array(8);for(i=7;i>=0;i--)u[i]=U_.charAt(t%64),t=Math.floor(t/64);(0,O.hu)(0===t,"Cannot push at time == 0");let c=u.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)c+=U_.charAt(e[i]);return(0,O.hu)(20===c.length,"nextPushId: Length should be 20."),c}}(),wN=function(n){if(n===""+MR)return"-";const e=PT(n);if(null!=e)return""+(e+1);const t=new Array(n.length);for(let c=0;c<t.length;c++)t[c]=n.charAt(c);if(t.length<786)return t.push("-"),t.join("");let r=t.length-1;for(;r>=0&&"z"===t[r];)r--;if(-1===r)return Sl;const u=U_.charAt(U_.indexOf(t[r])+1);return t[r]=u,t.slice(0,r+1).join("")},EN=function(n){if(n===""+OM)return Gc;const e=PT(n);if(null!=e)return""+(e-1);const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=n.charAt(r);return"-"===t[t.length-1]?1===t.length?""+MR:(delete t[t.length-1],t.join("")):(t[t.length-1]=U_.charAt(U_.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function IN(n){return{type:"value",snapshotNode:n}}function B_(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function b0(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function T0(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class QR{constructor(e){this.index_=e}updateChild(e,t,r,i,u,c){(0,O.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const f=e.getImmediateChild(t);return f.getChild(i).equals(r.getChild(i))&&f.isEmpty()===r.isEmpty()||(null!=c&&(r.isEmpty()?e.hasChild(t)?c.trackChildChange(b0(t,f)):(0,O.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):f.isEmpty()?c.trackChildChange(B_(t,r)):c.trackChildChange(T0(t,r,f))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Nn,(i,u)=>{t.hasChild(i)||r.trackChildChange(b0(i,u))}),t.isLeafNode()||t.forEachChild(Nn,(i,u)=>{if(e.hasChild(i)){const c=e.getImmediateChild(i);c.equals(u)||r.trackChildChange(T0(i,u,c))}else r.trackChildChange(B_(i,u))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?kt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class C0{constructor(e){this.indexedFilter_=new QR(e.getIndex()),this.index_=e.getIndex(),this.startPost_=C0.getStartPost_(e),this.endPost_=C0.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,i,u,c){return this.matches(new jt(t,r))||(r=kt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,u,c)}updateFullNode(e,t,r){t.isLeafNode()&&(t=kt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(kt.EMPTY_NODE);const u=this;return t.forEachChild(Nn,(c,f)=>{u.matches(new jt(c,f))||(i=i.updateImmediateChild(c,kt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class $U{constructor(e){this.rangedFilter_=new C0(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,i,u,c){return this.rangedFilter_.matches(new jt(t,r))||(r=kt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,u,c):this.fullLimitUpdateChild_(e,t,r,u,c)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=kt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let u;i=kt.EMPTY_NODE.withIndex(this.index_),u=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;u.hasNext()&&c<this.limit_;){const f=u.getNext();let y;if(y=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),f)<=0:this.index_.compare(f,this.rangedFilter_.getEndPost())<=0,!y)break;i=i.updateImmediateChild(f.name,f.node),c++}}else{let u,c,f,y;if(i=t.withIndex(this.index_),i=i.updatePriority(kt.EMPTY_NODE),this.reverse_){y=i.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();const A=this.index_.getCompare();f=(M,V)=>A(V,M)}else y=i.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),f=this.index_.getCompare();let I=0,S=!1;for(;y.hasNext();){const A=y.getNext();!S&&f(u,A)<=0&&(S=!0),S&&I<this.limit_&&f(A,c)<=0?I++:i=i.updateImmediateChild(A.name,kt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,u){let c;if(this.reverse_){const A=this.index_.getCompare();c=(M,V)=>A(V,M)}else c=this.index_.getCompare();const f=e;(0,O.hu)(f.numChildren()===this.limit_,"");const y=new jt(t,r),I=this.reverse_?f.getFirstChild(this.index_):f.getLastChild(this.index_),S=this.rangedFilter_.matches(y);if(f.hasChild(t)){const A=f.getImmediateChild(t);let M=i.getChildAfterChild(this.index_,I,this.reverse_);for(;null!=M&&(M.name===t||f.hasChild(M.name));)M=i.getChildAfterChild(this.index_,M,this.reverse_);const V=null==M?1:c(M,y);if(S&&!r.isEmpty()&&V>=0)return null!=u&&u.trackChildChange(T0(t,r,A)),f.updateImmediateChild(t,r);{null!=u&&u.trackChildChange(b0(t,A));const ye=f.updateImmediateChild(t,kt.EMPTY_NODE);return null!=M&&this.rangedFilter_.matches(M)?(null!=u&&u.trackChildChange(B_(M.name,M.node)),ye.updateImmediateChild(M.name,M.node)):ye}}return r.isEmpty()?e:S&&c(I,y)>=0?(null!=u&&(u.trackChildChange(b0(I.name,I.node)),u.trackChildChange(B_(t,r))),f.updateImmediateChild(t,r).updateImmediateChild(I.name,kt.EMPTY_NODE)):e}}class UT{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Nn}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,O.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,O.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Gc}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,O.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,O.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Sl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,O.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Nn}copy(){const e=new UT;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function JR(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function XR(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function BT(n,e){const t=n.copy();return t.index_=e,t}function bN(n){const e={};if(n.isDefault())return e;let t;return n.index_===Nn?t="$priority":n.index_===KR?t="$value":n.index_===Al?t="$key":((0,O.hu)(n.index_ instanceof zR,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,O.Pz)(t),n.startSet_&&(e.startAt=(0,O.Pz)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,O.Pz)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,O.Pz)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,O.Pz)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function TN(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Nn&&(e.i=n.index_.toString()),e}class VT extends iN{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=f0("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,O.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const u=e._path.toString();this.log_("Listen called for "+u+" "+e._queryIdentifier);const c=VT.getListenId_(e,r),f={};this.listens_[c]=f;const y=bN(e._queryParams);this.restRequest_(u+".json",y,(I,S)=>{let A=S;if(404===I&&(A=null,I=null),null===I&&this.onDataUpdate_(u,A,!1,r),(0,O.DV)(this.listens_,c)===f){let M;M=I?401===I?"permission_denied":"rest_error:"+I:"ok",i(M,null)}})}unlisten(e,t){const r=VT.getListenId_(e,t);delete this.listens_[r]}get(e){const t=bN(e._queryParams),r=e._path.toString(),i=new O.BH;return this.restRequest_(r+".json",t,(u,c)=>{let f=c;404===u&&(f=null,u=null),null===u?(this.onDataUpdate_(r,f,!1,null),i.resolve(f)):i.reject(new Error(f))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,u])=>{i&&i.accessToken&&(t.auth=i.accessToken),u&&u.token&&(t.ac=u.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,O.xO)(t);this.log_("Sending REST request for "+c);const f=new XMLHttpRequest;f.onreadystatechange=()=>{if(r&&4===f.readyState){this.log_("REST Response for "+c+" received. status:",f.status,"response:",f.responseText);let y=null;if(f.status>=200&&f.status<300){try{y=(0,O.cI)(f.responseText)}catch(I){Os("Failed to parse JSON response for "+c+": "+f.responseText)}r(null,y)}else 401!==f.status&&404!==f.status&&Os("Got unsuccessful REST response for "+c+" Status: "+f.status),r(f.status);r=null}},f.open("GET",c,!0),f.send()})}}class zU{constructor(){this.rootNode_=kt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function jT(){return{value:null,children:new Map}}function V_(n,e,t){if(Lt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=Ot(e);n.children.has(r)||n.children.set(r,jT()),V_(n.children.get(r),e=Cn(e),t)}}function ex(n,e){if(Lt(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Nn,(r,i)=>{V_(n,new pn(r),i)}),ex(n,e)}}if(n.children.size>0){const t=Ot(e);return e=Cn(e),n.children.has(t)&&ex(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function tx(n,e,t){null!==n.value?t(e,n.value):function KU(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{tx(i,new pn(e.toString()+"/"+r),t)})}class YU{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ii(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class XU{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new YU(e);const r=1e4+2e4*Math.random();g0(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Ii(e,(i,u)=>{u>0&&(0,O.r3)(this.statsToReport_,i)&&(t[i]=u,r=!0)}),r&&this.server_.reportStats(t),g0(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var ha=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(ha||(ha={})),ha))();function ix(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class $T{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ha.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Lt(this.path)){if(null!=this.affectedTree.value)return(0,O.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new pn(e));return new $T(an(),t,this.revert)}}return(0,O.hu)(Ot(this.path)===e,"operationForChild called for unrelated child."),new $T(Cn(this.path),this.affectedTree,this.revert)}}class D0{constructor(e,t){this.source=e,this.path=t,this.type=ha.LISTEN_COMPLETE}operationForChild(e){return Lt(this.path)?new D0(this.source,an()):new D0(this.source,Cn(this.path))}}class Ig{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ha.OVERWRITE}operationForChild(e){return Lt(this.path)?new Ig(this.source,an(),this.snap.getImmediateChild(e)):new Ig(this.source,Cn(this.path),this.snap)}}class j_{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ha.MERGE}operationForChild(e){if(Lt(this.path)){const t=this.children.subtree(new pn(e));return t.isEmpty()?null:t.value?new Ig(this.source,an(),t.value):new j_(this.source,an(),t)}return(0,O.hu)(Ot(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new j_(this.source,Cn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Yh{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Lt(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ot(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class e2{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function S0(n,e,t,r,i,u){const c=r.filter(f=>f.type===t);c.sort((f,y)=>function r2(n,e,t){if(null==e.childName||null==t.childName)throw(0,O.g5)("Should only compare child_ events.");const r=new jt(e.childName,e.snapshotNode),i=new jt(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,f,y)),c.forEach(f=>{const y=function n2(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,f,u);i.forEach(I=>{I.respondsTo(f.type)&&e.push(I.createEvent(y,n.query_))})})}function HT(n,e){return{eventCache:n,serverCache:e}}function A0(n,e,t,r){return HT(new Yh(e,t,r),n.serverCache)}function DN(n,e,t,r){return HT(n.eventCache,new Yh(e,t,r))}function qT(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function bg(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let sx;class On{constructor(e,t=(()=>(sx||(sx=new ao(VF)),sx))()){this.value=e,this.children=t}static fromObject(e){let t=new On(null);return Ii(e,(r,i)=>{t=t.set(new pn(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:an(),value:this.value};if(Lt(e))return null;{const r=Ot(e),i=this.children.get(r);if(null!==i){const u=i.findRootMostMatchingPathAndValue(Cn(e),t);return null!=u?{path:Xn(new pn(r),u.path),value:u.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Lt(e))return this;{const t=Ot(e),r=this.children.get(t);return null!==r?r.subtree(Cn(e)):new On(null)}}set(e,t){if(Lt(e))return new On(t,this.children);{const r=Ot(e),u=(this.children.get(r)||new On(null)).set(Cn(e),t),c=this.children.insert(r,u);return new On(this.value,c)}}remove(e){if(Lt(e))return this.children.isEmpty()?new On(null):new On(null,this.children);{const t=Ot(e),r=this.children.get(t);if(r){const i=r.remove(Cn(e));let u;return u=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&u.isEmpty()?new On(null):new On(this.value,u)}return this}}get(e){if(Lt(e))return this.value;{const t=Ot(e),r=this.children.get(t);return r?r.get(Cn(e)):null}}setTree(e,t){if(Lt(e))return t;{const r=Ot(e),u=(this.children.get(r)||new On(null)).setTree(Cn(e),t);let c;return c=u.isEmpty()?this.children.remove(r):this.children.insert(r,u),new On(this.value,c)}}fold(e){return this.fold_(an(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,u)=>{r[i]=u.fold_(Xn(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,an(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(Lt(e))return null;{const u=Ot(e),c=this.children.get(u);return c?c.findOnPath_(Cn(e),Xn(t,u),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,an(),t)}foreachOnPath_(e,t,r){if(Lt(e))return this;{this.value&&r(t,this.value);const i=Ot(e),u=this.children.get(i);return u?u.foreachOnPath_(Cn(e),Xn(t,i),r):new On(null)}}foreach(e){this.foreach_(an(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Xn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class yu{constructor(e){this.writeTree_=e}static empty(){return new yu(new On(null))}}function R0(n,e,t){if(Lt(e))return new yu(new On(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let u=r.value;const c=Ls(i,e);return u=u.updateChild(c,t),new yu(n.writeTree_.set(i,u))}{const i=new On(t),u=n.writeTree_.setTree(e,i);return new yu(u)}}}function ox(n,e,t){let r=n;return Ii(t,(i,u)=>{r=R0(r,Xn(e,i),u)}),r}function SN(n,e){if(Lt(e))return yu.empty();{const t=n.writeTree_.setTree(e,new On(null));return new yu(t)}}function ax(n,e){return null!=Tg(n,e)}function Tg(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Ls(t.path,e)):null}function AN(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Nn,(r,i)=>{e.push(new jt(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new jt(r,i.value))}),e}function Qh(n,e){if(Lt(e))return n;{const t=Tg(n,e);return new yu(null!=t?new On(t):n.writeTree_.subtree(e))}}function ux(n){return n.writeTree_.isEmpty()}function $_(n,e){return RN(an(),n.writeTree_,e)}function RN(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,u)=>{".priority"===i?((0,O.hu)(null!==u.value,"Priority writes must always be leaf nodes"),r=u.value):t=RN(Xn(n,i),u,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Xn(n,".priority"),r)),t}}function WT(n,e){return NN(e,n)}function l2(n,e){if(n.snap)return da(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&da(Xn(n.path,t),e))return!0;return!1}function d2(n){return n.visible}function xN(n,e,t){let r=yu.empty();for(let i=0;i<n.length;++i){const u=n[i];if(e(u)){const c=u.path;let f;if(u.snap)da(t,c)?(f=Ls(t,c),r=R0(r,f,u.snap)):da(c,t)&&(f=Ls(c,t),r=R0(r,an(),u.snap.getChild(f)));else{if(!u.children)throw(0,O.g5)("WriteRecord should have .snap or .children");if(da(t,c))f=Ls(t,c),r=ox(r,f,u.children);else if(da(c,t))if(f=Ls(c,t),Lt(f))r=ox(r,an(),u.children);else{const y=(0,O.DV)(u.children,Ot(f));if(y){const I=y.getChild(Cn(f));r=R0(r,an(),I)}}}}}return r}function PN(n,e,t,r,i){if(r||i){const u=Qh(n.visibleWrites,e);return!i&&ux(u)?t:i||null!=t||ax(u,an())?$_(xN(n.allWrites,function(I){return(I.visible||i)&&(!r||!~r.indexOf(I.writeId))&&(da(I.path,e)||da(e,I.path))},e),t||kt.EMPTY_NODE):null}{const u=Tg(n.visibleWrites,e);if(null!=u)return u;{const c=Qh(n.visibleWrites,e);return ux(c)?t:null!=t||ax(c,an())?$_(c,t||kt.EMPTY_NODE):null}}}function GT(n,e,t,r){return PN(n.writeTree,n.treePath,e,t,r)}function lx(n,e){return function h2(n,e,t){let r=kt.EMPTY_NODE;const i=Tg(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Nn,(u,c)=>{r=r.updateImmediateChild(u,c)}),r;if(t){const u=Qh(n.visibleWrites,e);return t.forEachChild(Nn,(c,f)=>{const y=$_(Qh(u,new pn(c)),f);r=r.updateImmediateChild(c,y)}),AN(u).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}return AN(Qh(n.visibleWrites,e)).forEach(c=>{r=r.updateImmediateChild(c.name,c.node)}),r}(n.writeTree,n.treePath,e)}function kN(n,e,t,r){return function f2(n,e,t,r,i){(0,O.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const u=Xn(e,t);if(ax(n.visibleWrites,u))return null;{const c=Qh(n.visibleWrites,u);return ux(c)?i.getChild(t):$_(c,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function ZT(n,e){return function g2(n,e){return Tg(n.visibleWrites,e)}(n.writeTree,Xn(n.treePath,e))}function cx(n,e,t){return function p2(n,e,t,r){const i=Xn(e,t),u=Tg(n.visibleWrites,i);return null!=u?u:r.isCompleteForChild(t)?$_(Qh(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function MN(n,e){return NN(Xn(n.treePath,e),n.writeTree)}function NN(n,e){return{treePath:n,writeTree:e}}class v2{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,O.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,O.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const u=i.type;if("child_added"===t&&"child_removed"===u)this.changeMap.set(r,T0(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===u)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===u)this.changeMap.set(r,b0(r,i.oldSnap));else if("child_changed"===t&&"child_added"===u)this.changeMap.set(r,B_(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==u)throw(0,O.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,T0(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const ON=new class w2{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class dx{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Yh(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return cx(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:bg(this.viewCache_),u=function y2(n,e,t,r,i,u){return function m2(n,e,t,r,i,u,c){let f;const y=Qh(n.visibleWrites,e),I=Tg(y,an());if(null!=I)f=I;else{if(null==t)return[];f=$_(y,t)}if(f=f.withIndex(c),f.isEmpty()||f.isLeafNode())return[];{const S=[],A=c.getCompare(),M=u?f.getReverseIteratorFrom(r,c):f.getIteratorFrom(r,c);let V=M.getNext();for(;V&&S.length<i;)0!==A(V,r)&&S.push(V),V=M.getNext();return S}}(n.writeTree,n.treePath,e,t,r,i,u)}(this.writes_,i,t,1,r,e);return 0===u.length?null:u[0]}}function LN(n,e,t,r,i,u){const c=e.eventCache;if(null!=ZT(r,t))return e;{let f,y;if(Lt(t))if((0,O.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const I=bg(e),A=lx(r,I instanceof kt?I:kt.EMPTY_NODE);f=n.filter.updateFullNode(e.eventCache.getNode(),A,u)}else{const I=GT(r,bg(e));f=n.filter.updateFullNode(e.eventCache.getNode(),I,u)}else{const I=Ot(t);if(".priority"===I){(0,O.hu)(1===Kh(t),"Can't have a priority with additional path components");const S=c.getNode();y=e.serverCache.getNode();const A=kN(r,t,S,y);f=null!=A?n.filter.updatePriority(S,A):c.getNode()}else{const S=Cn(t);let A;if(c.isCompleteForChild(I)){y=e.serverCache.getNode();const M=kN(r,t,c.getNode(),y);A=null!=M?c.getNode().getImmediateChild(I).updateChild(S,M):c.getNode().getImmediateChild(I)}else A=cx(r,I,e.serverCache);f=null!=A?n.filter.updateChild(c.getNode(),I,A,S,i,u):c.getNode()}}return A0(e,f,c.isFullyInitialized()||Lt(t),n.filter.filtersNodes())}}function zT(n,e,t,r,i,u,c,f){const y=e.serverCache;let I;const S=c?n.filter:n.filter.getIndexedFilter();if(Lt(t))I=S.updateFullNode(y.getNode(),r,null);else if(S.filtersNodes()&&!y.isFiltered()){const V=y.getNode().updateChild(t,r);I=S.updateFullNode(y.getNode(),V,null)}else{const V=Ot(t);if(!y.isCompleteForPath(t)&&Kh(t)>1)return e;const z=Cn(t),Pe=y.getNode().getImmediateChild(V).updateChild(z,r);I=".priority"===V?S.updatePriority(y.getNode(),Pe):S.updateChild(y.getNode(),V,Pe,z,ON,null)}const A=DN(e,I,y.isFullyInitialized()||Lt(t),S.filtersNodes());return LN(n,A,t,i,new dx(i,A,u),f)}function hx(n,e,t,r,i,u,c){const f=e.eventCache;let y,I;const S=new dx(i,e,u);if(Lt(t))I=n.filter.updateFullNode(e.eventCache.getNode(),r,c),y=A0(e,I,!0,n.filter.filtersNodes());else{const A=Ot(t);if(".priority"===A)I=n.filter.updatePriority(e.eventCache.getNode(),r),y=A0(e,I,f.isFullyInitialized(),f.isFiltered());else{const M=Cn(t),V=f.getNode().getImmediateChild(A);let z;if(Lt(M))z=r;else{const ye=S.getCompleteChild(A);z=null!=ye?".priority"===$R(M)&&ye.getChild(uN(M)).isEmpty()?ye:ye.updateChild(M,r):kt.EMPTY_NODE}y=V.equals(z)?e:A0(e,n.filter.updateChild(f.getNode(),A,z,M,S,c),f.isFullyInitialized(),n.filter.filtersNodes())}}return y}function FN(n,e){return n.eventCache.isCompleteForChild(e)}function UN(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function fx(n,e,t,r,i,u,c,f){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let I,y=e;I=Lt(t)?r:new On(null).setTree(t,r);const S=e.serverCache.getNode();return I.children.inorderTraversal((A,M)=>{if(S.hasChild(A)){const z=UN(0,e.serverCache.getNode().getImmediateChild(A),M);y=zT(n,y,new pn(A),z,i,u,c,f)}}),I.children.inorderTraversal((A,M)=>{const V=!e.serverCache.isCompleteForChild(A)&&void 0===M.value;if(!S.hasChild(A)&&!V){const ye=UN(0,e.serverCache.getNode().getImmediateChild(A),M);y=zT(n,y,new pn(A),ye,i,u,c,f)}}),y}class R2{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new QR(r.getIndex()),u=function HU(n){return n.loadsAllData()?new QR(n.getIndex()):n.hasLimit()?new $U(n):new C0(n)}(r);this.processor_=function E2(n){return{filter:n}}(u);const c=t.serverCache,f=t.eventCache,y=i.updateFullNode(kt.EMPTY_NODE,c.getNode(),null),I=u.updateFullNode(kt.EMPTY_NODE,f.getNode(),null),S=new Yh(y,c.isFullyInitialized(),i.filtersNodes()),A=new Yh(I,f.isFullyInitialized(),u.filtersNodes());this.viewCache_=HT(A,S),this.eventGenerator_=new e2(this.query_)}get query(){return this.query_}}function k2(n,e){const t=bg(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Lt(e)&&!t.getImmediateChild(Ot(e)).isEmpty())?t.getChild(e):null}function BN(n){return 0===n.eventRegistrations_.length}function VN(n,e,t){const r=[];if(t){(0,O.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(u=>{const c=u.createCancelEvent(t,i);c&&r.push(c)})}if(e){let i=[];for(let u=0;u<n.eventRegistrations_.length;++u){const c=n.eventRegistrations_[u];if(c.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(u+1));break}}else i.push(c)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function jN(n,e,t,r){e.type===ha.MERGE&&null!==e.source.queryId&&((0,O.hu)(bg(n.viewCache_),"We should always have a full cache before handling merges"),(0,O.hu)(qT(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,u=function b2(n,e,t,r,i){const u=new v2;let c,f;if(t.type===ha.OVERWRITE){const I=t;I.source.fromUser?c=hx(n,e,I.path,I.snap,r,i,u):((0,O.hu)(I.source.fromServer,"Unknown source."),f=I.source.tagged||e.serverCache.isFiltered()&&!Lt(I.path),c=zT(n,e,I.path,I.snap,r,i,f,u))}else if(t.type===ha.MERGE){const I=t;I.source.fromUser?c=function C2(n,e,t,r,i,u,c){let f=e;return r.foreach((y,I)=>{const S=Xn(t,y);FN(e,Ot(S))&&(f=hx(n,f,S,I,i,u,c))}),r.foreach((y,I)=>{const S=Xn(t,y);FN(e,Ot(S))||(f=hx(n,f,S,I,i,u,c))}),f}(n,e,I.path,I.children,r,i,u):((0,O.hu)(I.source.fromServer,"Unknown source."),f=I.source.tagged||e.serverCache.isFiltered(),c=fx(n,e,I.path,I.children,r,i,f,u))}else if(t.type===ha.ACK_USER_WRITE){const I=t;c=I.revert?function A2(n,e,t,r,i,u){let c;if(null!=ZT(r,t))return e;{const f=new dx(r,e,i),y=e.eventCache.getNode();let I;if(Lt(t)||".priority"===Ot(t)){let S;if(e.serverCache.isFullyInitialized())S=GT(r,bg(e));else{const A=e.serverCache.getNode();(0,O.hu)(A instanceof kt,"serverChildren would be complete if leaf node"),S=lx(r,A)}S=S,I=n.filter.updateFullNode(y,S,u)}else{const S=Ot(t);let A=cx(r,S,e.serverCache);null==A&&e.serverCache.isCompleteForChild(S)&&(A=y.getImmediateChild(S)),I=null!=A?n.filter.updateChild(y,S,A,Cn(t),f,u):e.eventCache.getNode().hasChild(S)?n.filter.updateChild(y,S,kt.EMPTY_NODE,Cn(t),f,u):y,I.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=GT(r,bg(e)),c.isLeafNode()&&(I=n.filter.updateFullNode(I,c,u)))}return c=e.serverCache.isFullyInitialized()||null!=ZT(r,an()),A0(e,I,c,n.filter.filtersNodes())}}(n,e,I.path,r,i,u):function D2(n,e,t,r,i,u,c){if(null!=ZT(i,t))return e;const f=e.serverCache.isFiltered(),y=e.serverCache;if(null!=r.value){if(Lt(t)&&y.isFullyInitialized()||y.isCompleteForPath(t))return zT(n,e,t,y.getNode().getChild(t),i,u,f,c);if(Lt(t)){let I=new On(null);return y.getNode().forEachChild(Al,(S,A)=>{I=I.set(new pn(S),A)}),fx(n,e,t,I,i,u,f,c)}return e}{let I=new On(null);return r.foreach((S,A)=>{const M=Xn(t,S);y.isCompleteForPath(M)&&(I=I.set(S,y.getNode().getChild(M)))}),fx(n,e,t,I,i,u,f,c)}}(n,e,I.path,I.affectedTree,r,i,u)}else{if(t.type!==ha.LISTEN_COMPLETE)throw(0,O.g5)("Unknown operation type: "+t.type);c=function S2(n,e,t,r,i){const u=e.serverCache;return LN(n,DN(e,u.getNode(),u.isFullyInitialized()||Lt(t),u.isFiltered()),t,r,ON,i)}(n,e,t.path,r,u)}const y=u.getChanges();return function T2(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),u=qT(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(u)||!r.getNode().getPriority().equals(u.getPriority()))&&t.push(IN(qT(e)))}}(e,c,y),{viewCache:c,changes:y}}(n.processor_,i,e,t,r);return function I2(n,e){(0,O.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,O.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,u.viewCache),(0,O.hu)(u.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=u.viewCache,$N(n,u.changes,u.viewCache.eventCache.getNode(),null)}function $N(n,e,t,r){return function t2(n,e,t,r){const i=[],u=[];return e.forEach(c=>{"child_changed"===c.type&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&u.push(function jU(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(c.childName,c.snapshotNode))}),S0(n,i,"child_removed",e,r,t),S0(n,i,"child_added",e,r,t),S0(n,i,"child_moved",u,r,t),S0(n,i,"child_changed",e,r,t),S0(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let KT,QT;class HN{constructor(){this.views=new Map}}function px(n,e,t,r){const i=e.source.queryId;if(null!==i){const u=n.views.get(i);return(0,O.hu)(null!=u,"SyncTree gave us an op for an invalid query."),jN(u,e,t,r)}{let u=[];for(const c of n.views.values())u=u.concat(jN(c,e,t,r));return u}}function qN(n,e,t,r,i){const c=n.views.get(e._queryIdentifier);if(!c){let f=GT(t,i?r:null),y=!1;f?y=!0:r instanceof kt?(f=lx(t,r),y=!1):(f=kt.EMPTY_NODE,y=!1);const I=HT(new Yh(f,y,!1),new Yh(r,i,!1));return new R2(e,I)}return c}function WN(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Jh(n,e){let t=null;for(const r of n.views.values())t=t||k2(r,e);return t}function GN(n,e){return e._queryParams.loadsAllData()?YT(n):n.views.get(e._queryIdentifier)}function ZN(n,e){return null!=GN(n,e)}function Xh(n){return null!=YT(n)}function YT(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let $2=1;class zN{constructor(e){this.listenProvider_=e,this.syncPointTree_=new On(null),this.pendingWriteTree_=function _2(){return{visibleWrites:yu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function gx(n,e,t,r,i){return function s2(n,e,t,r,i){(0,O.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=R0(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?H_(n,new Ig({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function ef(n,e,t=!1){const r=function a2(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function u2(n,e){const t=n.allWrites.findIndex(f=>f.writeId===e);(0,O.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,u=!1,c=n.allWrites.length-1;for(;i&&c>=0;){const f=n.allWrites[c];f.visible&&(c>=t&&l2(f,r.path)?i=!1:da(r.path,f.path)&&(u=!0)),c--}return!!i&&(u?(function c2(n){n.visibleWrites=xN(n.allWrites,d2,an()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=SN(n.visibleWrites,r.path):Ii(r.children,y=>{n.visibleWrites=SN(n.visibleWrites,Xn(r.path,y))}),!0))}(n.pendingWriteTree_,e)){let u=new On(null);return null!=r.snap?u=u.set(an(),!0):Ii(r.children,c=>{u=u.set(new pn(c),!0)}),H_(n,new $T(r.path,u,t))}return[]}function x0(n,e,t){return H_(n,new Ig({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function mx(n,e,t,r){const i=e._path,u=n.syncPointTree_.get(i);let c=[];if(u&&("default"===e._queryIdentifier||ZN(u,e))){const f=function B2(n,e,t,r){const i=e._queryIdentifier,u=[];let c=[];const f=Xh(n);if("default"===i)for(const[y,I]of n.views.entries())c=c.concat(VN(I,t,r)),BN(I)&&(n.views.delete(y),I.query._queryParams.loadsAllData()||u.push(I.query));else{const y=n.views.get(i);y&&(c=c.concat(VN(y,t,r)),BN(y)&&(n.views.delete(i),y.query._queryParams.loadsAllData()||u.push(y.query)))}return f&&!Xh(n)&&u.push(new(function L2(){return(0,O.hu)(KT,"Reference.ts has not been loaded"),KT}())(e._repo,e._path)),{removed:u,events:c}}(u,e,t,r);(function F2(n){return 0===n.views.size})(u)&&(n.syncPointTree_=n.syncPointTree_.remove(i));const y=f.removed;c=f.events;const I=-1!==y.findIndex(A=>A._queryParams.loadsAllData()),S=n.syncPointTree_.findOnPath(i,(A,M)=>Xh(M));if(I&&!S){const A=n.syncPointTree_.subtree(i);if(!A.isEmpty()){const M=function Y2(n){return n.fold((e,t,r)=>{if(t&&Xh(t))return[YT(t)];{let i=[];return t&&(i=WN(t)),Ii(r,(u,c)=>{i=i.concat(c)}),i}})}(A);for(let V=0;V<M.length;++V){const z=M[V],ye=z.query,Pe=JN(n,z);n.listenProvider_.startListening(P0(ye),XT(n,ye),Pe.hashFn,Pe.onComplete)}}}if(!S&&y.length>0&&!r)if(I){const A=null;n.listenProvider_.stopListening(P0(e),A)}else y.forEach(A=>{const M=n.queryToTagMap.get(eC(A));n.listenProvider_.stopListening(P0(A),M)});!function Q2(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=eC(r),u=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(u)}}}(n,y)}return c}function KN(n,e,t){const r=e._path;let i=null,u=!1;n.syncPointTree_.foreachOnPath(r,(A,M)=>{const V=Ls(A,r);i=i||Jh(M,V),u=u||Xh(M)});let f,c=n.syncPointTree_.get(r);c?(u=u||Xh(c),i=i||Jh(c,an())):(c=new HN,n.syncPointTree_=n.syncPointTree_.set(r,c)),null!=i?f=!0:(f=!1,i=kt.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((M,V)=>{const z=Jh(V,an());z&&(i=i.updateImmediateChild(M,z))}));const y=ZN(c,e);if(!y&&!e._queryParams.loadsAllData()){const A=eC(e);(0,O.hu)(!n.queryToTagMap.has(A),"View does not exist, but we have a tag");const M=function J2(){return $2++}();n.queryToTagMap.set(A,M),n.tagToQueryMap.set(M,A)}let S=function U2(n,e,t,r,i,u){const c=qN(n,e,r,i,u);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),function M2(n,e){n.eventRegistrations_.push(e)}(c,t),function N2(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Nn,(u,c)=>{r.push(B_(u,c))}),t.isFullyInitialized()&&r.push(IN(t.getNode())),$N(n,r,t.getNode(),e)}(c,t)}(c,e,t,WT(n.pendingWriteTree_,r),i,f);if(!y&&!u){const A=GN(c,e);S=S.concat(function X2(n,e,t){const r=e._path,i=XT(n,e),u=JN(n,t),c=n.listenProvider_.startListening(P0(e),i,u.hashFn,u.onComplete),f=n.syncPointTree_.subtree(r);if(i)(0,O.hu)(!Xh(f.value),"If we're adding a query, it shouldn't be shadowed");else{const y=f.fold((I,S,A)=>{if(!Lt(I)&&S&&Xh(S))return[YT(S).query];{let M=[];return S&&(M=M.concat(WN(S).map(V=>V.query))),Ii(A,(V,z)=>{M=M.concat(z)}),M}});for(let I=0;I<y.length;++I){const S=y[I];n.listenProvider_.stopListening(P0(S),XT(n,S))}}return c}(n,e,A))}return S}function JT(n,e,t){const i=n.pendingWriteTree_,u=n.syncPointTree_.findOnPath(e,(c,f)=>{const I=Jh(f,Ls(c,e));if(I)return I});return PN(i,e,u,t,!0)}function H_(n,e){return YN(e,n.syncPointTree_,null,WT(n.pendingWriteTree_,an()))}function YN(n,e,t,r){if(Lt(n.path))return QN(n,e,t,r);{const i=e.get(an());null==t&&null!=i&&(t=Jh(i,an()));let u=[];const c=Ot(n.path),f=n.operationForChild(c),y=e.children.get(c);if(y&&f){const I=t?t.getImmediateChild(c):null,S=MN(r,c);u=u.concat(YN(f,y,I,S))}return i&&(u=u.concat(px(i,n,r,t))),u}}function QN(n,e,t,r){const i=e.get(an());null==t&&null!=i&&(t=Jh(i,an()));let u=[];return e.children.inorderTraversal((c,f)=>{const y=t?t.getImmediateChild(c):null,I=MN(r,c),S=n.operationForChild(c);S&&(u=u.concat(QN(S,f,y,I)))}),i&&(u=u.concat(px(i,n,r,t))),u}function JN(n,e){const t=e.query,r=XT(n,t);return{hashFn:()=>(function x2(n){return n.viewCache_.serverCache.getNode()}(e)||kt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function G2(n,e,t){const r=_x(n,t);if(r){const i=yx(r),u=i.path,c=i.queryId,f=Ls(u,e);return vx(n,u,new D0(ix(c),f))}return[]}(n,t._path,r):function W2(n,e){return H_(n,new D0({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const u=function HF(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return mx(n,t,null,u)}}}}function XT(n,e){const t=eC(e);return n.queryToTagMap.get(t)}function eC(n){return n._path.toString()+"$"+n._queryIdentifier}function _x(n,e){return n.tagToQueryMap.get(e)}function yx(n){const e=n.indexOf("$");return(0,O.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new pn(n.substr(0,e))}}function vx(n,e,t){const r=n.syncPointTree_.get(e);return(0,O.hu)(r,"Missing sync point for query tag that we're tracking"),px(r,t,WT(n.pendingWriteTree_,e),null)}function P0(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function j2(){return(0,O.hu)(QT,"Reference.ts has not been loaded"),QT}())(n._repo,n._path):n}class wx{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new wx(t)}node(){return this.node_}}class Ex{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Xn(this.path_,e);return new Ex(this.syncTree_,t)}node(){return JT(this.syncTree_,this.path_)}}const XN=function(n,e,t){return n&&"object"==typeof n?((0,O.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?tB(n[".sv"],e,t):"object"==typeof n[".sv"]?nB(n[".sv"],e):void(0,O.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},tB=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,O.hu)(!1,"Unexpected server value: "+n)},nB=function(n,e,t){n.hasOwnProperty("increment")||(0,O.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,O.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,O.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const c=i.getValue();return"number"!=typeof c?r:c+r},eO=function(n,e,t,r){return bx(e,new Ex(t,n),r)},Ix=function(n,e,t){return bx(n,new wx(e),t)};function bx(n,e,t){const r=n.getPriority().val(),i=XN(r,e.getImmediateChild(".priority"),t);let u;if(n.isLeafNode()){const c=n,f=XN(c.getValue(),e,t);return f!==c.getValue()||i!==c.getPriority().val()?new L_(f,fr(i)):n}{const c=n;return u=c,i!==c.getPriority().val()&&(u=u.updatePriority(new L_(i))),c.forEachChild(Nn,(f,y)=>{const I=bx(y,e.getImmediateChild(f),t);I!==y&&(u=u.updateImmediateChild(f,I))}),u}}class Tx{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function tC(n,e){let t=e instanceof pn?e:new pn(e),r=n,i=Ot(t);for(;null!==i;){const u=(0,O.DV)(r.node.children,i)||{children:{},childCount:0};r=new Tx(i,r,u),t=Cn(t),i=Ot(t)}return r}function Cg(n){return n.node.value}function Cx(n,e){n.node.value=e,Dx(n)}function tO(n){return n.node.childCount>0}function nC(n,e){Ii(n.node.children,(t,r)=>{e(new Tx(t,n,r))})}function nO(n,e,t,r){t&&!r&&e(n),nC(n,i=>{nO(i,e,!0,r)}),t&&r&&e(n)}function k0(n){return new pn(null===n.parent?n.name:k0(n.parent)+"/"+n.name)}function Dx(n){null!==n.parent&&function sB(n,e,t){const r=function rB(n){return void 0===Cg(n)&&!tO(n)}(t),i=(0,O.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,Dx(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,Dx(n))}(n.parent,n.name,n)}const oB=/[\[\].#$\/\u0000-\u001F\u007F]/,aB=/[\[\].#$\u0000-\u001F\u007F]/,Sx=10485760,rC=function(n){return"string"==typeof n&&0!==n.length&&!oB.test(n)},rO=function(n){return"string"==typeof n&&0!==n.length&&!aB.test(n)},M0=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!xT(n)||n&&"object"==typeof n&&(0,O.r3)(n,".sv")},Rl=function(n,e,t,r){r&&void 0===e||N0((0,O.gK)(n,"value"),e,t)},N0=function(n,e,t){const r=t instanceof pn?new EU(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+wg(r));if("function"==typeof e)throw new Error(n+"contains a function "+wg(r)+" with contents = "+e.toString());if(xT(e))throw new Error(n+"contains "+e.toString()+" "+wg(r));if("string"==typeof e&&e.length>Sx/3&&(0,O.ug)(e)>Sx)throw new Error(n+"contains a string greater than "+Sx+" utf8 bytes "+wg(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,u=!1;if(Ii(e,(c,f)=>{if(".value"===c)i=!0;else if(".priority"!==c&&".sv"!==c&&(u=!0,!rC(c)))throw new Error(n+" contains an invalid key ("+c+") "+wg(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function IU(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,O.ug)(e),lN(n)})(r,c),N0(n,f,r),function bU(n){const e=n.parts_.pop();n.byteLength_-=(0,O.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&u)throw new Error(n+' contains ".value" child '+wg(r)+" in addition to actual children.")}},iO=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,O.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const u=[];Ii(e,(c,f)=>{const y=new pn(c);if(N0(i,f,Xn(t,y)),".priority"===$R(y)&&!M0(f))throw new Error(i+"contains an invalid value for '"+y.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");u.push(y)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const u=v0(r);for(let c=0;c<u.length;c++)if((".priority"!==u[c]||c!==u.length-1)&&!rC(u[c]))throw new Error(n+"contains an invalid key ("+u[c]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(wU);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&da(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,u)},Ax=function(n,e,t){if(!t||void 0!==e){if(xT(e))throw new Error((0,O.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!M0(e))throw new Error((0,O.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},O0=function(n,e,t,r){if(!(r&&void 0===t||rC(t)))throw new Error((0,O.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},L0=function(n,e,t,r){if(!(r&&void 0===t||rO(t)))throw new Error((0,O.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},fa=function(n,e){if(".info"===Ot(e))throw new Error(n+" failed = Can't modify data under /.info/")},sO=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!rC(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),rO(n)}(t))throw new Error((0,O.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class dB{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function iC(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],u=i.getPath();null!==t&&!HR(u,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:u}),t.events.push(i)}t&&n.eventLists_.push(t)}function Rx(n,e,t){iC(n,t),oO(n,r=>HR(r,e))}function pa(n,e,t){iC(n,t),oO(n,r=>da(r,e)||da(e,r))}function oO(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(hB(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function hB(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();yg&&Ei("event: "+t.toString()),N_(r)}}}const aO="repo_interrupt";class pB{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new dB,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=jT(),this.transactionQueueTree_=new Tx,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function uO(n){const t=n.infoData_.getNode(new pn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function F0(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:uO(n)})}function lO(n,e,t,r,i){n.dataUpdateCount++;const u=new pn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(i)if(r){const y=(0,O.UI)(t,I=>fr(I));c=function z2(n,e,t,r){const i=_x(n,r);if(i){const u=yx(i),c=u.path,f=u.queryId,y=Ls(c,e),I=On.fromObject(t);return vx(n,c,new j_(ix(f),y,I))}return[]}(n.serverSyncTree_,u,y,i)}else{const y=fr(t);c=function Z2(n,e,t,r){const i=_x(n,r);if(null!=i){const u=yx(i),c=u.path,f=u.queryId,y=Ls(c,e);return vx(n,c,new Ig(ix(f),y,t))}return[]}(n.serverSyncTree_,u,y,i)}else if(r){const y=(0,O.UI)(t,I=>fr(I));c=function q2(n,e,t){const r=On.fromObject(t);return H_(n,new j_({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,u,y)}else{const y=fr(t);c=x0(n.serverSyncTree_,u,y)}let f=u;c.length>0&&(f=W_(n,u)),pa(n.eventQueue_,f,c)}function cO(n,e){xx(n,"connected",e),!1===e&&function vB(n){q_(n,"onDisconnectEvents");const e=F0(n),t=jT();tx(n.onDisconnect_,an(),(i,u)=>{const c=eO(i,u,n.serverSyncTree_,e);V_(t,i,c)});let r=[];tx(t,an(),(i,u)=>{r=r.concat(x0(n.serverSyncTree_,i,u));const c=Nx(n,i);W_(n,c)}),n.onDisconnect_=jT(),pa(n.eventQueue_,an(),r)}(n)}function xx(n,e,t){const r=new pn("/.info/"+e),i=fr(t);n.infoData_.updateSnapshot(r,i);const u=x0(n.infoSyncTree_,r,i);pa(n.eventQueue_,r,u)}function sC(n){return n.nextWriteId_++}function Px(n,e,t,r,i){q_(n,"set",{path:e.toString(),value:t,priority:r});const u=F0(n),c=fr(t,r),f=JT(n.serverSyncTree_,e),y=Ix(c,f,u),I=sC(n),S=gx(n.serverSyncTree_,e,y,I,!0);iC(n.eventQueue_,S),n.server_.put(e.toString(),c.val(!0),(M,V)=>{const z="ok"===M;z||Os("set at "+e+" failed: "+M);const ye=ef(n.serverSyncTree_,I,!z);pa(n.eventQueue_,e,ye),tf(0,i,M,V)});const A=Nx(n,e);W_(n,A),pa(n.eventQueue_,A,[])}function wB(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&ex(n.onDisconnect_,e),tf(0,t,r,i)})}function dO(n,e,t,r){const i=fr(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(u,c)=>{"ok"===u&&V_(n.onDisconnect_,e,i),tf(0,r,u,c)})}function kx(n,e,t){let r;r=".info"===Ot(e._path)?mx(n.infoSyncTree_,e,t):mx(n.serverSyncTree_,e,t),Rx(n.eventQueue_,e._path,r)}function hO(n){n.persistentConnection_&&n.persistentConnection_.interrupt(aO)}function q_(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Ei(t,...e)}function tf(n,e,t,r){e&&N_(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let u=i;r&&(u+=": "+r);const c=new Error(u);c.code=i,e(c)}})}function Mx(n,e,t){return JT(n.serverSyncTree_,e,t)||kt.EMPTY_NODE}function oC(n,e=n.transactionQueueTree_){if(e||aC(n,e),Cg(e)){const t=pO(n,e);(0,O.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function DB(n,e,t){const r=t.map(I=>I.currentWriteId),i=Mx(n,e,r);let u=i;const c=i.hash();for(let I=0;I<t.length;I++){const S=t[I];(0,O.hu)(0===S.status,"tryToSendTransactionQueue_: items in queue should all be run."),S.status=1,S.retryCount++;const A=Ls(e,S.path);u=u.updateChild(A,S.currentOutputSnapshotRaw)}const f=u.val(!0),y=e;n.server_.put(y.toString(),f,I=>{q_(n,"transaction put response",{path:y.toString(),status:I});let S=[];if("ok"===I){const A=[];for(let M=0;M<t.length;M++)t[M].status=2,S=S.concat(ef(n.serverSyncTree_,t[M].currentWriteId)),t[M].onComplete&&A.push(()=>t[M].onComplete(null,!0,t[M].currentOutputSnapshotResolved)),t[M].unwatcher();aC(n,tC(n.transactionQueueTree_,e)),oC(n,n.transactionQueueTree_),pa(n.eventQueue_,e,S);for(let M=0;M<A.length;M++)N_(A[M])}else{if("datastale"===I)for(let A=0;A<t.length;A++)t[A].status=3===t[A].status?4:0;else{Os("transaction at "+y.toString()+" failed: "+I);for(let A=0;A<t.length;A++)t[A].status=4,t[A].abortReason=I}W_(n,e)}},c)}(n,k0(e),t)}else tO(e)&&nC(e,t=>{oC(n,t)})}function W_(n,e){const t=fO(n,e),r=k0(t);return function SB(n,e,t){if(0===e.length)return;const r=[];let i=[];const c=e.filter(f=>0===f.status).map(f=>f.currentWriteId);for(let f=0;f<e.length;f++){const y=e[f],I=Ls(t,y.path);let A,S=!1;if((0,O.hu)(null!==I,"rerunTransactionsUnderNode_: relativePath should not be null."),4===y.status)S=!0,A=y.abortReason,i=i.concat(ef(n.serverSyncTree_,y.currentWriteId,!0));else if(0===y.status)if(y.retryCount>=25)S=!0,A="maxretry",i=i.concat(ef(n.serverSyncTree_,y.currentWriteId,!0));else{const M=Mx(n,y.path,c);y.currentInputSnapshot=M;const V=e[f].update(M.val());if(void 0!==V){N0("transaction failed: Data returned ",V,y.path);let z=fr(V);"object"==typeof V&&null!=V&&(0,O.r3)(V,".priority")||(z=z.updatePriority(M.getPriority()));const Pe=y.currentWriteId,_t=F0(n),wt=Ix(z,M,_t);y.currentOutputSnapshotRaw=z,y.currentOutputSnapshotResolved=wt,y.currentWriteId=sC(n),c.splice(c.indexOf(Pe),1),i=i.concat(gx(n.serverSyncTree_,y.path,wt,y.currentWriteId,y.applyLocally)),i=i.concat(ef(n.serverSyncTree_,Pe,!0))}else S=!0,A="nodata",i=i.concat(ef(n.serverSyncTree_,y.currentWriteId,!0))}pa(n.eventQueue_,t,i),i=[],S&&(e[f].status=2,setTimeout(e[f].unwatcher,Math.floor(0)),e[f].onComplete&&r.push("nodata"===A?()=>e[f].onComplete(null,!1,e[f].currentInputSnapshot):()=>e[f].onComplete(new Error(A),!1,null)))}aC(n,n.transactionQueueTree_);for(let f=0;f<r.length;f++)N_(r[f]);oC(n,n.transactionQueueTree_)}(n,pO(n,t),r),r}function fO(n,e){let t,r=n.transactionQueueTree_;for(t=Ot(e);null!==t&&void 0===Cg(r);)r=tC(r,t),t=Ot(e=Cn(e));return r}function pO(n,e){const t=[];return gO(n,e,t),t.sort((r,i)=>r.order-i.order),t}function gO(n,e,t){const r=Cg(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);nC(e,i=>{gO(n,i,t)})}function aC(n,e){const t=Cg(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,Cx(e,t.length>0?t:void 0)}nC(e,r=>{aC(n,r)})}function Nx(n,e){const t=k0(fO(n,e)),r=tC(n.transactionQueueTree_,e);return function iB(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{Ox(n,i)}),Ox(n,r),nO(r,i=>{Ox(n,i)}),t}function Ox(n,e){const t=Cg(e);if(t){const r=[];let i=[],u=-1;for(let c=0;c<t.length;c++)3===t[c].status||(1===t[c].status?((0,O.hu)(u===c-1,"All SENT items should be at beginning of queue."),u=c,t[c].status=3,t[c].abortReason="set"):((0,O.hu)(0===t[c].status,"Unexpected transaction status in abort"),t[c].unwatcher(),i=i.concat(ef(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&r.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));-1===u?Cx(e,void 0):t.length=u+1,pa(n.eventQueue_,k0(e),i);for(let c=0;c<r.length;c++)N_(r[c])}}const Lx=function(n,e){const t=xB(n),r=t.namespace;return"firebase.com"===t.domain&&Dl(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Dl("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Os("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new OR(t.host,t.secure,r,e,"ws"===t.scheme||"wss"===t.scheme,"",r!==t.subdomain),path:new pn(t.pathString)}},xB=function(n){let e="",t="",r="",i="",u="",c=!0,f="https",y=443;if("string"==typeof n){let I=n.indexOf("//");I>=0&&(f=n.substring(0,I-1),n=n.substring(I+2));let S=n.indexOf("/");-1===S&&(S=n.length);let A=n.indexOf("?");-1===A&&(A=n.length),e=n.substring(0,Math.min(S,A)),S<A&&(i=function AB(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(u){}e+="/"+i}return e}(n.substring(S,A)));const M=function RB(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Os(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,A)));I=e.indexOf(":"),I>=0?(c="https"===f||"wss"===f,y=parseInt(e.substring(I+1),10)):I=e.length;const V=e.slice(0,I);if("localhost"===V.toLowerCase())t="localhost";else if(V.split(".").length<=2)t=V;else{const z=e.indexOf(".");r=e.substring(0,z).toLowerCase(),t=e.substring(z+1),u=r}"ns"in M&&(u=M.ns)}return{host:e,port:y,domain:t,subdomain:r,secure:c,scheme:f,pathString:i,namespace:u}};class mO{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,O.Pz)(this.snapshot.exportVal())}}class _O{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class yO{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,O.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class vO{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new O.BH;return wB(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){fa("OnDisconnect.remove",this._path);const e=new O.BH;return dO(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){fa("OnDisconnect.set",this._path),Rl("OnDisconnect.set",e,this._path,!1);const t=new O.BH;return dO(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){fa("OnDisconnect.setWithPriority",this._path),Rl("OnDisconnect.setWithPriority",e,this._path,!1),Ax("OnDisconnect.setWithPriority",t,!1);const r=new O.BH;return function EB(n,e,t,r,i){const u=fr(t,r);n.server_.onDisconnectPut(e.toString(),u.val(!0),(c,f)=>{"ok"===c&&V_(n.onDisconnect_,e,u),tf(0,i,c,f)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){fa("OnDisconnect.update",this._path),iO("OnDisconnect.update",e,this._path,!1);const t=new O.BH;return function IB(n,e,t,r){if((0,O.xb)(t))return Ei("onDisconnect().update() called with empty data.  Don't do anything."),void tf(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,u)=>{"ok"===i&&Ii(t,(c,f)=>{const y=fr(f);V_(n.onDisconnect_,Xn(e,c),y)}),tf(0,r,i,u)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class uo{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Lt(this._path)?null:$R(this._path)}get ref(){return new ga(this._repo,this._path)}get _queryIdentifier(){const e=TN(this._queryParams),t=kR(e);return"{}"===t?"default":t}get _queryObject(){return TN(this._queryParams)}isEqual(e){if(!((e=(0,O.m9)(e))instanceof uo))return!1;const t=this._repo===e._repo,r=HR(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function vU(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function uC(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function nf(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Al){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Gc)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Sl)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===Nn){if(null!=e&&!M0(e)||null!=t&&!M0(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,O.hu)(n.getIndex()instanceof zR||n.getIndex()===KR,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function lC(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ga extends uo{constructor(e,t){super(e,t,new UT,!1)}get parent(){const e=uN(this._path);return null===e?null:new ga(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Dg{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new pn(e),r=Sg(this.ref,e);return new Dg(this._node.getChild(t),r,Nn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new Dg(i,Sg(this.ref,r),Nn)))}hasChild(e){const t=new pn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function wO(n,e){return(n=(0,O.m9)(n))._checkNotDeleted("ref"),void 0!==e?Sg(n._root,e):n._root}function EO(n,e){(n=(0,O.m9)(n))._checkNotDeleted("refFromURL");const t=Lx(e,n._repo.repoInfo_.nodeAdmin);sO("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Dl("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),wO(n,t.path.toString())}function Sg(n,e){return null===Ot((n=(0,O.m9)(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),L0("child","path",t,!1)):L0("child","path",e,!1),new ga(n._repo,Xn(n._path,e));var t}function Fx(n,e){n=(0,O.m9)(n),fa("set",n._path),Rl("set",e,n._path,!1);const t=new O.BH;return Px(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function OB(n,e){iO("update",e,n._path,!1);const t=new O.BH;return function yB(n,e,t,r){q_(n,"update",{path:e.toString(),value:t});let i=!0;const u=F0(n),c={};if(Ii(t,(f,y)=>{i=!1,c[f]=eO(Xn(e,f),fr(y),n.serverSyncTree_,u)}),i)Ei("update() called with empty data.  Don't do anything."),tf(0,r,"ok",void 0);else{const f=sC(n),y=function H2(n,e,t,r){!function o2(n,e,t,r){(0,O.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=ox(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=On.fromObject(t);return H_(n,new j_({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,c,f);iC(n.eventQueue_,y),n.server_.merge(e.toString(),t,(I,S)=>{const A="ok"===I;A||Os("update at "+e+" failed: "+I);const M=ef(n.serverSyncTree_,f,!A),V=M.length>0?W_(n,e):e;pa(n.eventQueue_,V,M),tf(0,r,I,S)}),Ii(t,I=>{const S=Nx(n,Xn(e,I));W_(n,S)}),pa(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function LB(n){return function _B(n,e){const t=function K2(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(I,S)=>{const A=Ls(I,t);r=r||Jh(S,A)});let i=n.syncPointTree_.get(t);i?r=r||Jh(i,an()):(i=new HN,n.syncPointTree_=n.syncPointTree_.set(t,i));const u=null!=r,c=u?new Yh(r,!0,!1):null;return function P2(n){return qT(n.viewCache_)}(qN(i,e,WT(n.pendingWriteTree_,e._path),u?c.getNode():kt.EMPTY_NODE,u))}(n.serverSyncTree_,e);return null!=t?Promise.resolve(t):n.server_.get(e).then(r=>{const i=fr(r).withIndex(e._queryParams.getIndex()),u=x0(n.serverSyncTree_,e._path,i);return Rx(n.eventQueue_,e._path,u),Promise.resolve(i)},r=>(q_(n,"get for query "+(0,O.Pz)(e)+" failed: "+r),Promise.reject(new Error(r))))}((n=(0,O.m9)(n))._repo,n).then(e=>new Dg(e,new ga(n._repo,n._path),n._queryParams.getIndex()))}class cC{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new mO("value",this,new Dg(e.snapshotNode,new ga(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new _O(this,e,t):null}matches(e){return e instanceof cC&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class dC{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new _O(this,e,t):null}createEvent(e,t){(0,O.hu)(null!=e.childName,"Child events should have a childName.");const r=Sg(new ga(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new mO(e.type,this,new Dg(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof dC&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function U0(n,e,t,r,i){let u;if("object"==typeof r&&(u=void 0,i=r),"function"==typeof r&&(u=r),i&&i.onlyOnce){const y=t,I=(S,A)=>{kx(n._repo,n,f),y(S,A)};I.userCallback=t.userCallback,I.context=t.context,t=I}const c=new yO(t,u||void 0),f="value"===e?new cC(c):new dC(e,c);return function bB(n,e,t){let r;r=".info"===Ot(e._path)?KN(n.infoSyncTree_,e,t):KN(n.serverSyncTree_,e,t),Rx(n.eventQueue_,e._path,r)}(n._repo,n,f),()=>kx(n._repo,n,f)}function Ux(n,e,t,r){return U0(n,"value",e,t,r)}function IO(n,e,t,r){return U0(n,"child_added",e,t,r)}function bO(n,e,t,r){return U0(n,"child_changed",e,t,r)}function TO(n,e,t,r){return U0(n,"child_moved",e,t,r)}function CO(n,e,t,r){return U0(n,"child_removed",e,t,r)}function DO(n,e,t){let r=null;const i=t?new yO(t):null;"value"===e?r=new cC(i):e&&(r=new dC(e,i)),kx(n._repo,n,r)}class vu{}class SO extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Rl("endAt",this._value,e._path,!0);const t=XR(e._queryParams,this._value,this._key);if(lC(t),nf(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new uo(e._repo,e._path,t,e._orderByCalled)}}class UB extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Rl("endBefore",this._value,e._path,!1);const t=function ZU(n,e,t){let r,i;return n.index_===Al?("string"==typeof e&&(e=EN(e)),i=XR(n,e,t)):(r=null==t?Gc:EN(t),i=XR(n,e,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(lC(t),nf(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new uo(e._repo,e._path,t,e._orderByCalled)}}class AO extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Rl("startAt",this._value,e._path,!0);const t=JR(e._queryParams,this._value,this._key);if(lC(t),nf(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new uo(e._repo,e._path,t,e._orderByCalled)}}class jB extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Rl("startAfter",this._value,e._path,!1);const t=function GU(n,e,t){let r;if(n.index_===Al)"string"==typeof e&&(e=wN(e)),r=JR(n,e,t);else{let i;i=null==t?Sl:wN(t),r=JR(n,e,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(lC(t),nf(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new uo(e._repo,e._path,t,e._orderByCalled)}}class HB extends vu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new uo(e._repo,e._path,function qU(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class WB extends vu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new uo(e._repo,e._path,function WU(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class ZB extends vu{constructor(e){super(),this._path=e}_apply(e){uC(e,"orderByChild");const t=new pn(this._path);if(Lt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new zR(t),i=BT(e._queryParams,r);return nf(i),new uo(e._repo,e._path,i,!0)}}class KB extends vu{_apply(e){uC(e,"orderByKey");const t=BT(e._queryParams,Al);return nf(t),new uo(e._repo,e._path,t,!0)}}class QB extends vu{_apply(e){uC(e,"orderByPriority");const t=BT(e._queryParams,Nn);return nf(t),new uo(e._repo,e._path,t,!0)}}class XB extends vu{_apply(e){uC(e,"orderByValue");const t=BT(e._queryParams,KR);return nf(t),new uo(e._repo,e._path,t,!0)}}class tV extends vu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(Rl("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new SO(this._value,this._key)._apply(new AO(this._value,this._key)._apply(e))}}function wu(n,...e){let t=(0,O.m9)(n);for(const r of e)t=r._apply(t);return t}(function O2(n){(0,O.hu)(!KT,"__referenceConstructor has already been defined"),KT=n})(ga),function V2(n){(0,O.hu)(!QT,"__referenceConstructor has already been defined"),QT=n}(ga);const Bx={};function xO(n,e,t,r,i){let u=r||n.options.databaseURL;void 0===u&&(n.options.projectId||Dl("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ei("Using default host for project ",n.options.projectId),u=`${n.options.projectId}-default-rtdb.firebaseio.com`);let y,I,c=Lx(u,i),f=c.repoInfo;"undefined"!=typeof process&&(I=process.env.FIREBASE_DATABASE_EMULATOR_HOST),I?(y=!0,u=`http://${I}?ns=${f.namespace}`,c=Lx(u,i),f=c.repoInfo):y=!c.repoInfo.secure;const S=i&&y?new m0(m0.OWNER):new ZF(n.name,n.options,e);sO("Invalid Firebase Database URL",c),Lt(c.path)||Dl("Database URL must point to the root of a Firebase Database (not including a child path).");const A=function oV(n,e,t,r){let i=Bx[e.name];i||(i={},Bx[e.name]=i);let u=i[n.toURLString()];return u&&Dl("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),u=new pB(n,false,t,r),i[n.toURLString()]=u,u}(f,n,S,new GF(n.name,t));return new uV(A,n)}class uV{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function gB(n,e,t){if(n.stats_=UR(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new VT(n.repoInfo_,(r,i,u,c)=>{lO(n,r,i,u,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>cO(n,!0),0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,O.Pz)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Eg(n.repoInfo_,e,(r,i,u,c)=>{lO(n,r,i,u,c)},r=>{cO(n,r)},r=>{!function mB(n,e){Ii(e,(t,r)=>{xx(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function QF(n,e){const t=n.toString();return FR[t]||(FR[t]=e()),FR[t]}(n.repoInfo_,()=>new XU(n.stats_,n.server_)),n.infoData_=new zU,n.infoSyncTree_=new zN({startListening:(r,i,u,c)=>{let f=[];const y=n.infoData_.getNode(r._path);return y.isEmpty()||(f=x0(n.infoSyncTree_,r._path,y),setTimeout(()=>{c("ok")},0)),f},stopListening:()=>{}}),xx(n,"connected",!1),n.serverSyncTree_=new zN({startListening:(r,i,u,c)=>(n.server_.listen(r,u,i,(f,y)=>{const I=c(f,y);pa(n.eventQueue_,r._path,I)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ga(this._repo,an())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function sV(n,e){const t=Bx[e];(!t||t[n.key]!==n)&&Dl(`Database ${e}(${n.repoInfo_}) has already been deleted.`),hO(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Dl("Cannot call "+e+" on a deleted database.")}}function hV(n,e){kM(n,e)}const pV={".sv":"timestamp"};class _V{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}Eg.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},Eg.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function fV(n){SM(ri.SDK_VERSION),(0,ri._registerComponent)(new ia.wA("database",(e,{instanceIdentifier:t})=>xO(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,ri.registerVersion)(CM,"0.12.5",n),(0,ri.registerVersion)(CM,"0.12.5","esm2017")}();const EV=new sa.Yd("@firebase/database-compat"),PO=function(n){EV.warn("FIREBASE WARNING: "+n)};class TV{constructor(e){this._delegate=e}cancel(e){(0,O.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,O.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,O.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,O.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,O.Dv)("OnDisconnect.set",1,2,arguments.length),(0,O.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,O.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,O.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),u=>r(u)),i}update(e,t){if((0,O.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let u=0;u<e.length;++u)i[""+u]=e[u];e=i,PO("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,O.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class CV{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,O.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class rf{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,O.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,O.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,O.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,O.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,O.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),L0("DataSnapshot.child","path",e,!1),new rf(this._database,this._delegate.child(e))}hasChild(e){return(0,O.Dv)("DataSnapshot.hasChild",1,1,arguments.length),L0("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,O.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,O.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,O.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new rf(this._database,t)))}hasChildren(){return(0,O.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,O.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,O.Dv)("DataSnapshot.ref",0,0,arguments.length),new xo(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class zi{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var u;(0,O.Dv)("Query.on",2,4,arguments.length),(0,O.Wj)("Query.on","callback",t,!1);const c=zi.getCancelAndContextArgs_("Query.on",r,i),f=(I,S)=>{t.call(c.context,new rf(this.database,I),S)};f.userCallback=t,f.context=c.context;const y=null===(u=c.cancel)||void 0===u?void 0:u.bind(c.context);switch(e){case"value":return Ux(this._delegate,f,y),t;case"child_added":return IO(this._delegate,f,y),t;case"child_removed":return CO(this._delegate,f,y),t;case"child_changed":return bO(this._delegate,f,y),t;case"child_moved":return TO(this._delegate,f,y),t;default:throw new Error((0,O.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,O.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,O.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,O.Wj)("Query.off","callback",t,!0),(0,O.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,DO(this._delegate,e,i)}else DO(this._delegate,e)}get(){return LB(this._delegate).then(e=>new rf(this.database,e))}once(e,t,r,i){(0,O.Dv)("Query.once",1,4,arguments.length),(0,O.Wj)("Query.once","callback",t,!0);const u=zi.getCancelAndContextArgs_("Query.once",r,i),c=new O.BH,f=(I,S)=>{const A=new rf(this.database,I);t&&t.call(u.context,A,S),c.resolve(A)};f.userCallback=t,f.context=u.context;const y=I=>{u.cancel&&u.cancel.call(u.context,I),c.reject(I)};switch(e){case"value":Ux(this._delegate,f,y,{onlyOnce:!0});break;case"child_added":IO(this._delegate,f,y,{onlyOnce:!0});break;case"child_removed":CO(this._delegate,f,y,{onlyOnce:!0});break;case"child_changed":bO(this._delegate,f,y,{onlyOnce:!0});break;case"child_moved":TO(this._delegate,f,y,{onlyOnce:!0});break;default:throw new Error((0,O.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return(0,O.Dv)("Query.limitToFirst",1,1,arguments.length),new zi(this.database,wu(this._delegate,function qB(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new HB(n)}(e)))}limitToLast(e){return(0,O.Dv)("Query.limitToLast",1,1,arguments.length),new zi(this.database,wu(this._delegate,function GB(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new WB(n)}(e)))}orderByChild(e){return(0,O.Dv)("Query.orderByChild",1,1,arguments.length),new zi(this.database,wu(this._delegate,function zB(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return L0("orderByChild","path",n,!1),new ZB(n)}(e)))}orderByKey(){return(0,O.Dv)("Query.orderByKey",0,0,arguments.length),new zi(this.database,wu(this._delegate,function YB(){return new KB}()))}orderByPriority(){return(0,O.Dv)("Query.orderByPriority",0,0,arguments.length),new zi(this.database,wu(this._delegate,function JB(){return new QB}()))}orderByValue(){return(0,O.Dv)("Query.orderByValue",0,0,arguments.length),new zi(this.database,wu(this._delegate,function eV(){return new XB}()))}startAt(e=null,t){return(0,O.Dv)("Query.startAt",0,2,arguments.length),new zi(this.database,wu(this._delegate,function VB(n=null,e){return O0("startAt","key",e,!0),new AO(n,e)}(e,t)))}startAfter(e=null,t){return(0,O.Dv)("Query.startAfter",0,2,arguments.length),new zi(this.database,wu(this._delegate,function $B(n,e){return O0("startAfter","key",e,!0),new jB(n,e)}(e,t)))}endAt(e=null,t){return(0,O.Dv)("Query.endAt",0,2,arguments.length),new zi(this.database,wu(this._delegate,function FB(n,e){return O0("endAt","key",e,!0),new SO(n,e)}(e,t)))}endBefore(e=null,t){return(0,O.Dv)("Query.endBefore",0,2,arguments.length),new zi(this.database,wu(this._delegate,function BB(n,e){return O0("endBefore","key",e,!0),new UB(n,e)}(e,t)))}equalTo(e,t){return(0,O.Dv)("Query.equalTo",1,2,arguments.length),new zi(this.database,wu(this._delegate,function nV(n,e){return O0("equalTo","key",e,!0),new tV(n,e)}(e,t)))}toString(){return(0,O.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,O.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,O.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof zi))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,O.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,O.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,O.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new xo(this.database,new ga(this._delegate._repo,this._delegate._path))}}class xo extends zi{constructor(e,t){super(e,new uo(t._repo,t._path,new UT,!1)),this.database=e,this._delegate=t}getKey(){return(0,O.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,O.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new xo(this.database,Sg(this._delegate,e))}getParent(){(0,O.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new xo(this.database,e):null}getRoot(){return(0,O.Dv)("Reference.root",0,0,arguments.length),new xo(this.database,this._delegate.root)}set(e,t){(0,O.Dv)("Reference.set",1,2,arguments.length),(0,O.Wj)("Reference.set","onComplete",t,!0);const r=Fx(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,O.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let u=0;u<e.length;++u)i[""+u]=e[u];e=i,PO("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}fa("Reference.update",this._delegate._path),(0,O.Wj)("Reference.update","onComplete",t,!0);const r=OB(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,O.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,O.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function NB(n,e,t){if(fa("setWithPriority",n._path),Rl("setWithPriority",e,n._path,!1),Ax("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new O.BH;return Px(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),u=>r(u)),i}remove(e){(0,O.Dv)("Reference.remove",0,1,arguments.length),(0,O.Wj)("Reference.remove","onComplete",e,!0);const t=function kB(n){return fa("remove",n._path),Fx(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,O.Dv)("Reference.transaction",1,3,arguments.length),(0,O.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,O.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,O.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function yV(n,e,t){var r;if(n=(0,O.m9)(n),fa("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=null==t?void 0:t.applyLocally)||void 0===r||r,u=new O.BH,f=Ux(n,()=>{});return function CB(n,e,t,r,i,u){q_(n,"transaction on "+e);const c={path:e,update:t,onComplete:r,status:null,order:RM(),applyLocally:u,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},f=Mx(n,e,void 0);c.currentInputSnapshot=f;const y=c.update(f.val());if(void 0===y)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{N0("transaction failed: Data returned ",y,c.path),c.status=0;const I=tC(n.transactionQueueTree_,e),S=Cg(I)||[];let A;S.push(c),Cx(I,S),"object"==typeof y&&null!==y&&(0,O.r3)(y,".priority")?(A=(0,O.DV)(y,".priority"),(0,O.hu)(M0(A),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):A=(JT(n.serverSyncTree_,e)||kt.EMPTY_NODE).getPriority().val();const M=F0(n),V=fr(y,A),z=Ix(V,f,M);c.currentOutputSnapshotRaw=V,c.currentOutputSnapshotResolved=z,c.currentWriteId=sC(n);const ye=gx(n.serverSyncTree_,e,z,c.currentWriteId,c.applyLocally);pa(n.eventQueue_,e,ye),oC(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(y,I,S)=>{let A=null;y?u.reject(y):(A=new Dg(S,new ga(n._repo,n._path),Nn),u.resolve(new _V(I,A)))},f,i),u.promise}(this._delegate,e,{applyLocally:r}).then(u=>new CV(u.committed,new rf(this.database,u.snapshot)));return t&&i.then(u=>t(null,u.committed,u.snapshot),u=>t(u,!1,null)),i}setPriority(e,t){(0,O.Dv)("Reference.setPriority",1,2,arguments.length),(0,O.Wj)("Reference.setPriority","onComplete",t,!0);const r=function MB(n,e){n=(0,O.m9)(n),fa("setPriority",n._path),Ax("setPriority",e,!1);const t=new O.BH;return Px(n._repo,Xn(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,O.Dv)("Reference.push",0,2,arguments.length),(0,O.Wj)("Reference.push","onComplete",t,!0);const r=function PB(n,e){n=(0,O.m9)(n),fa("push",n._path),Rl("push",e,n._path,!0);const t=uO(n._repo),r=VU(t),i=Sg(n,r),u=Sg(n,r);let c;return c=null!=e?Fx(u,e).then(()=>u):Promise.resolve(u),i.then=c.then.bind(c),i.catch=c.then.bind(c,void 0),i}(this._delegate,e),i=r.then(c=>new xo(this.database,c));t&&i.then(()=>t(null),c=>t(c));const u=new xo(this.database,r);return u.then=i.then.bind(i),u.catch=i.catch.bind(i,void 0),u}onDisconnect(){return fa("Reference.onDisconnect",this._delegate._path),new TV(new vO(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class B0{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete()}}useEmulator(e,t,r={}){!function lV(n,e,t,r={}){(n=(0,O.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Dl("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let u;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Dl('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),u=new m0(m0.OWNER);else if(r.mockUserToken){const c="string"==typeof r.mockUserToken?r.mockUserToken:(0,O.Sg)(r.mockUserToken,n.app.options.projectId);u=new m0(c)}!function iV(n,e,t,r){n.repoInfo_=new OR(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,u)}(this._delegate,e,t,r)}ref(e){if((0,O.Dv)("database.ref",0,1,arguments.length),e instanceof xo){const t=EO(this._delegate,e.toString());return new xo(this,t)}{const t=wO(this._delegate,e);return new xo(this,t)}}refFromURL(e){(0,O.Dv)("database.refFromURL",1,1,arguments.length);const r=EO(this._delegate,e);return new xo(this,r)}goOffline(){return(0,O.Dv)("database.goOffline",0,0,arguments.length),function cV(n){(n=(0,O.m9)(n))._checkNotDeleted("goOffline"),hO(n._repo)}(this._delegate)}goOnline(){return(0,O.Dv)("database.goOnline",0,0,arguments.length),function dV(n){(n=(0,O.m9)(n))._checkNotDeleted("goOnline"),function TB(n){n.persistentConnection_&&n.persistentConnection_.resume(aO)}(n._repo)}(this._delegate)}}B0.ServerValue={TIMESTAMP:function gV(){return pV}(),increment:n=>function mV(n){return{".sv":{increment:n}}}(n)};var SV=Object.freeze({__proto__:null,initStandalone:function DV({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:u=!1}){SM(t);const c=new ia.zt("auth-internal",new ia.H0("database-standalone"));return c.setComponent(new ia.wA("auth-internal",()=>r,"PRIVATE")),{instance:new B0(xO(n,c,void 0,e,u),n),namespace:i}}});const AV=B0.ServerValue;function kO(n){return null==n}function MO(n){return"function"==typeof n.set}function NO(n,e){return MO(e)?e:n.ref(e)}function OO(n,e){if(function xV(n){return"string"==typeof n}(n))return e.stringCase();if(MO(n))return e.firebaseCase();if(function PV(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function V0(n,e,t="on",r=tl.z){return new sr.y(i=>{let u=null;return u=n[t](e,(c,f)=>{r.schedule(()=>{i.next({snapshot:c,prevKey:f})}),"once"===t&&r.schedule(()=>i.complete())},c=>{r.schedule(()=>i.error(c))}),"on"===t?{unsubscribe(){null!=u&&n.off(e,u)}}:{unsubscribe(){}}}).pipe((0,vt.U)(i=>{const{snapshot:u,prevKey:c}=i;let f=null;return u.exists()&&(f=u.key),{type:e,payload:u,prevKey:c,key:f}}),(0,J0.B)())}function LO(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function NV(n,e){const{payload:t,prevKey:r,key:i}=e,u=LO(n,i),c=function MV(n,e){if(kO(e))return 0;{const t=LO(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let f=null;e.payload.forEach(y=>{const I={payload:y,type:"value",prevKey:f,key:y.key};return f=y.key,n=[...n,I],!1})}return n;case"child_added":if(u>-1){const f=n[u-1];(f&&f.key||null)!==r&&(n=n.filter(y=>y.payload.key!==t.key)).splice(c,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(c,0,e)}return n;case"child_removed":return n.filter(f=>f.payload.key!==t.key);case"child_changed":return n.map(f=>f.payload.key===i?e:f);case"child_moved":if(u>-1){const f=n.splice(u,1)[0];return(n=n.slice()).splice(c,0,f),n}return n;default:return n}}function FO(n){return(kO(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function UO(n,e,t){return function kV(n,e,t){return V0(n,"value","once",t).pipe(vn(r=>{const i=[Ke(r)];return e.forEach(u=>i.push(V0(n,u,"on",t))),(0,Y0.T)(...i).pipe(zs(NV,[]))}),vv())}(n,e=FO(e),t)}function BO(n,e,t){const r=(e=FO(e)).map(i=>V0(n,i,"on",t));return(0,Y0.T)(...r)}function VO(n,e){return function(r,i){return OO(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function UV(n){return function(t){return t?OO(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function jO(n,e){return function(){return V0(n,"value","on",e)}}!function RV(n){n.INTERNAL.registerComponent(new ia.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new B0(i,r)},"PUBLIC").setServiceProps({Reference:xo,Query:zi,Database:B0,DataSnapshot:rf,enableLogging:hV,INTERNAL:SV,ServerValue:AV}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.1.5")}($y.Z);const jV=new m.OlP("angularfire2.realtimeDatabaseURL"),$V=new m.OlP("angularfire2.database.use-emulator");let HV=(()=>{class n{constructor(t,r,i,u,c,f,y,I,S,A,M,V,z,ye,Pe){this.schedulers=f;const _t=y,wt=(0,Pr.on)(t,c,r);I&&Fy(wt,c,S,M,V,z,A,ye),this.database=(0,Pr.cc)(`${wt.name}.database.${i}`,"AngularFireDatabase",wt.name,()=>{const It=c.runOutsideAngular(()=>wt.database(i||void 0));return _t&&It.useEmulator(..._t),It},[_t])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>NO(this.database,t));let u=i;return r&&(u=r(i)),function BV(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:VO(r,"update"),set:VO(r,"set"),push:i=>r.push(i),remove:UV(r),snapshotChanges:i=>UO(n,i,t).pipe(Yt.iC),stateChanges:i=>BO(n,i,t).pipe(Yt.iC),auditTrail:i=>function OV(n,e,t){return function FV(n,e,t){return function LV(n,e){return V0(n,"value","on",e).pipe((0,vt.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function NF(...n){const e=(0,Ws.jO)(n);return(0,En.e)((t,r)=>{const i=n.length,u=new Array(i);let c=n.map(()=>!1),f=!1;for(let y=0;y<i;y++)(0,Bn.Xf)(n[y]).subscribe(new dn.Q(r,I=>{u[y]=I,!f&&!c[y]&&(c[y]=!0,(f=c.every(rs.y))&&(c=null))},MF.Z));t.subscribe(new dn.Q(r,y=>{if(f){const I=[y,...u];r.next(e?e(...I):I)}}))})}(e),(0,vt.U)(([i,u])=>{const c=i.lastKeyToLoad,f=u.map(y=>y.key);return{actions:u,lastKeyToLoad:c,loadedKeys:f}}),function OF(n){return(0,En.e)((e,t)=>{let r=!1,i=0;e.subscribe(new dn.Q(t,u=>(r||(r=!n(u,i++)))&&t.next(u)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,vt.U)(i=>i.actions))}(n,BO(n,e).pipe(zs((i,u)=>[...i,u],[])),t)}(n,i,t).pipe(Yt.iC),valueChanges:(i,u)=>UO(n,i,t).pipe((0,vt.U)(f=>f.map(y=>u&&u.idField?Object.assign(Object.assign({},y.payload.val()),{[u.idField]:y.key}):y.payload.val())),Yt.iC)}}(u,this)}object(t){return function VV(n,e){return{query:n,snapshotChanges:()=>jO(n,e.schedulers.outsideAngular)().pipe(Yt.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>jO(n,e.schedulers.outsideAngular)().pipe(Yt.iC,(0,vt.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>NO(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(m.LFG(Pr.Dh),m.LFG(Pr.xv,8),m.LFG(jV,8),m.LFG(m.Lbi),m.LFG(m.R0b),m.LFG(Yt.HU),m.LFG($V,8),m.LFG(dp,8),m.LFG(lm,8),m.LFG(cm,8),m.LFG(dm,8),m.LFG(hm,8),m.LFG(Eo,8),m.LFG(Yd,8),m.LFG(lp,8))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),qV=(()=>{class n{constructor(){Hd.Z.registerVersion("angularfire",Yt.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({providers:[HV]}),n})(),WV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=m.oAB({type:n,bootstrap:[HC]}),n.\u0275inj=m.cJS({providers:[bc,Tc],imports:[[jl,ME,Pr.hO.initializeApp(jy_firebase),kF,uP,DI,qV]]}),n})();(0,m.G48)(),Ra().bootstrapModule(WV).catch(n=>console.error(n))},5867:(rt,Ee,L)=>{"use strict";L.d(Ee,{Mq:()=>m.getApp,C6:()=>m.getApps});var m=L(9681);(0,m.registerVersion)("firebase","9.6.4","app")},127:(rt,Ee,L)=>{"use strict";L.d(Ee,{Z:()=>m.Z});var m=L(3942);m.Z.registerVersion("firebase","9.6.4","app-compat")},5735:(rt,Ee,L)=>{"use strict";L.r(Ee);var m=L(5861),J=L(3942),F=L(2090),oe=L(9681);function ae(_,h){var p={};for(var w in _)Object.prototype.hasOwnProperty.call(_,w)&&h.indexOf(w)<0&&(p[w]=_[w]);if(null!=_&&"function"==typeof Object.getOwnPropertySymbols){var D=0;for(w=Object.getOwnPropertySymbols(_);D<w.length;D++)h.indexOf(w[D])<0&&Object.prototype.propertyIsEnumerable.call(_,w[D])&&(p[w[D]]=_[w[D]])}return p}var Me=L(1877),de=L(4859);const Dr=function Lr(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Zt=function en(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ti=new F.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Dn=new Me.Yd("@firebase/auth");function Ci(_,...h){Dn.logLevel<=Me.in.ERROR&&Dn.error(`Auth (${oe.SDK_VERSION}): ${_}`,...h)}function Ut(_,...h){throw fs(_,...h)}function gn(_,...h){return fs(_,...h)}function lo(_,h,p){const w=Object.assign(Object.assign({},Zt()),{[h]:p});return new F.LL("auth","Firebase",w).create(h,{appName:_.name})}function Kr(_,h,p){if(!(h instanceof p))throw p.name!==h.constructor.name&&Ut(_,"argument-error"),lo(_,"argument-error",`Type of ${h.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function fs(_,...h){if("string"!=typeof _){const p=h[0],w=[...h.slice(1)];return w[0]&&(w[0].appName=_.name),_._errorFactory.create(p,...w)}return Ti.create(_,...h)}function Ae(_,h,...p){if(!_)throw fs(h,...p)}function pr(_){const h="INTERNAL ASSERTION FAILED: "+_;throw Ci(h),new Error(h)}function Xe(_,h){_||pr(h)}const hi=new Map;function Ht(_){Xe(_ instanceof Function,"Expected a class definition");let h=hi.get(_);return h?(Xe(h instanceof _,"Instance stored in cache mismatched with class"),h):(h=new _,hi.set(_,h),h)}function dt(){var _;return"undefined"!=typeof self&&(null===(_=self.location)||void 0===_?void 0:_.href)||""}function tt(){return"http:"===St()||"https:"===St()}function St(){var _;return"undefined"!=typeof self&&(null===(_=self.location)||void 0===_?void 0:_.protocol)||null}class At{constructor(h,p){this.shortDelay=h,this.longDelay=p,Xe(p>h,"Short delay should be less than long delay!"),this.isMobile=(0,F.uI)()||(0,F.b$)()}get(){return function ln(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(tt()||(0,F.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function et(_,h){Xe(_.emulator,"Emulator should always be set here");const{url:p}=_.emulator;return h?`${p}${h.startsWith("/")?h.slice(1):h}`:p}class ut{static initialize(h,p,w){this.fetchImpl=h,p&&(this.headersImpl=p),w&&(this.responseImpl=w)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const xl={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},co=new At(3e4,6e4);function ft(_,h){return _.tenantId&&!h.tenantId?Object.assign(Object.assign({},h),{tenantId:_.tenantId}):h}function mn(_,h,p,w){return Ur.apply(this,arguments)}function Ur(){return(Ur=(0,m.Z)(function*(_,h,p,w,D={}){return ps(_,D,(0,m.Z)(function*(){let x={},$={};w&&("GET"===h?$=w:x={body:JSON.stringify(w)});const ne=(0,F.xO)(Object.assign({key:_.config.apiKey},$)).slice(1),Ne=yield _._getAdditionalHeaders();return Ne["Content-Type"]="application/json",_.languageCode&&(Ne["X-Firebase-Locale"]=_.languageCode),ut.fetch()(ve(_,_.config.apiHost,p,ne),Object.assign({method:h,headers:Ne,referrerPolicy:"no-referrer"},x))}))})).apply(this,arguments)}function ps(_,h,p){return j.apply(this,arguments)}function j(){return(j=(0,m.Z)(function*(_,h,p){_._canInitEmulator=!1;const w=Object.assign(Object.assign({},xl),h);try{const D=new te(_),x=yield Promise.race([p(),D.promise]);D.clearNetworkTimeout();const $=yield x.json();if("needConfirmation"in $)throw $e(_,"account-exists-with-different-credential",$);if(x.ok&&!("errorMessage"in $))return $;{const ne=x.ok?$.errorMessage:$.error.message,[Ne,xe]=ne.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Ne)throw $e(_,"credential-already-in-use",$);if("EMAIL_EXISTS"===Ne)throw $e(_,"email-already-in-use",$);const Qe=w[Ne]||Ne.toLowerCase().replace(/[_\s]+/g,"-");if(xe)throw lo(_,Qe,xe);Ut(_,Qe)}}catch(D){if(D instanceof F.ZR)throw D;Ut(_,"network-request-failed")}})).apply(this,arguments)}function W(_,h,p,w){return G.apply(this,arguments)}function G(){return(G=(0,m.Z)(function*(_,h,p,w,D={}){const x=yield mn(_,h,p,w,D);return"mfaPendingCredential"in x&&Ut(_,"multi-factor-auth-required",{_serverResponse:x}),x})).apply(this,arguments)}function ve(_,h,p,w){const D=`${h}${p}?${w}`;return _.config.emulator?et(_.config,D):`${_.config.apiScheme}://${D}`}class te{constructor(h){this.auth=h,this.timer=null,this.promise=new Promise((p,w)=>{this.timer=setTimeout(()=>w(gn(this.auth,"network-request-failed")),co.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function $e(_,h,p){const w={appName:_.name};p.email&&(w.email=p.email),p.phoneNumber&&(w.phoneNumber=p.phoneNumber);const D=gn(_,h,w);return D.customData._tokenResponse=p,D}function cn(){return(cn=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:delete",h)})).apply(this,arguments)}function Hn(_,h){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:update",h)})).apply(this,arguments)}function Br(_,h){return Mt.apply(this,arguments)}function Mt(){return(Mt=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:lookup",h)})).apply(this,arguments)}function gr(_){if(_)try{const h=new Date(Number(_));if(!isNaN(h.getTime()))return h.toUTCString()}catch(h){}}function Po(){return(Po=(0,m.Z)(function*(_,h=!1){const p=(0,F.m9)(_),w=yield p.getIdToken(h),D=ho(w);Ae(D&&D.exp&&D.auth_time&&D.iat,p.auth,"internal-error");const x="object"==typeof D.firebase?D.firebase:void 0,$=null==x?void 0:x.sign_in_provider;return{claims:D,token:w,authTime:gr(Eu(D.auth_time)),issuedAtTime:gr(Eu(D.iat)),expirationTime:gr(Eu(D.exp)),signInProvider:$||null,signInSecondFactor:(null==x?void 0:x.sign_in_second_factor)||null}})).apply(this,arguments)}function Eu(_){return 1e3*Number(_)}function ho(_){const[h,p,w]=_.split(".");if(void 0===h||void 0===p||void 0===w)return Ci("JWT malformed, contained fewer than 3 sections"),null;try{const D=(0,F.tV)(p);return D?JSON.parse(D):(Ci("Failed to decode base64 JWT payload"),null)}catch(D){return Ci("Caught error parsing JWT payload as JSON",D),null}}function qn(_,h){return Yi.apply(this,arguments)}function Yi(){return(Yi=(0,m.Z)(function*(_,h,p=!1){if(p)return h;try{return yield h}catch(w){throw w instanceof F.ZR&&tr(w)&&_.auth.currentUser===_&&(yield _.auth.signOut()),w}})).apply(this,arguments)}function tr({code:_}){return"auth/user-disabled"===_||"auth/user-token-expired"===_}class Bs{constructor(h){this.user=h,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(h){var p;if(h){const w=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),w}{this.errorBackoff=3e4;const D=(null!==(p=this.user.stsTokenManager.expirationTime)&&void 0!==p?p:0)-Date.now()-3e5;return Math.max(0,D)}}schedule(h=!1){var p=this;if(!this.isRunning)return;const w=this.getInterval(h);this.timerId=setTimeout((0,m.Z)(function*(){yield p.iteration()}),w)}iteration(){var h=this;return(0,m.Z)(function*(){try{yield h.user.getIdToken(!0)}catch(p){return void("auth/network-request-failed"===p.code&&h.schedule(!0))}h.schedule()})()}}class kl{constructor(h,p){this.createdAt=h,this.lastLoginAt=p,this._initializeTime()}_initializeTime(){this.lastSignInTime=gr(this.lastLoginAt),this.creationTime=gr(this.createdAt)}_copy(h){this.createdAt=h.createdAt,this.lastLoginAt=h.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Di(_){return fo.apply(this,arguments)}function fo(){return(fo=(0,m.Z)(function*(_){var h;const p=_.auth,w=yield _.getIdToken(),D=yield qn(_,Br(p,{idToken:w}));Ae(null==D?void 0:D.users.length,p,"internal-error");const x=D.users[0];_._notifyReloadListener(x);const $=(null===(h=x.providerUserInfo)||void 0===h?void 0:h.length)?Yr(x.providerUserInfo):[],ne=ma(_.providerData,$),Qe=!!_.isAnonymous&&!(_.email&&x.passwordHash||(null==ne?void 0:ne.length)),Ye={uid:x.localId,displayName:x.displayName||null,photoURL:x.photoUrl||null,email:x.email||null,emailVerified:x.emailVerified||!1,phoneNumber:x.phoneNumber||null,tenantId:x.tenantId||null,providerData:ne,metadata:new kl(x.createdAt,x.lastLoginAt),isAnonymous:Qe};Object.assign(_,Ye)})).apply(this,arguments)}function Wn(){return(Wn=(0,m.Z)(function*(_){const h=(0,F.m9)(_);yield Di(h),yield h.auth._persistUserIfCurrent(h),h.auth._notifyListenersIfCurrent(h)})).apply(this,arguments)}function ma(_,h){return[..._.filter(w=>!h.some(D=>D.providerId===w.providerId)),...h]}function Yr(_){return _.map(h=>{var{providerId:p}=h,w=ae(h,["providerId"]);return{providerId:p,uid:w.rawId||"",displayName:w.displayName||null,email:w.email||null,phoneNumber:w.phoneNumber||null,photoURL:w.photoUrl||null}})}function Rt(){return(Rt=(0,m.Z)(function*(_,h){const p=yield ps(_,{},(0,m.Z)(function*(){const w=(0,F.xO)({grant_type:"refresh_token",refresh_token:h}).slice(1),{tokenApiHost:D,apiKey:x}=_.config,$=ve(_,D,"/v1/token",`key=${x}`),ne=yield _._getAdditionalHeaders();return ne["Content-Type"]="application/x-www-form-urlencoded",ut.fetch()($,{method:"POST",headers:ne,body:w})}));return{accessToken:p.access_token,expiresIn:p.expires_in,refreshToken:p.refresh_token}})).apply(this,arguments)}class qt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(h){Ae(h.idToken,"internal-error"),Ae(void 0!==h.idToken,"internal-error"),Ae(void 0!==h.refreshToken,"internal-error");const p="expiresIn"in h&&void 0!==h.expiresIn?Number(h.expiresIn):function er(_){const h=ho(_);return Ae(h,"internal-error"),Ae(void 0!==h.exp,"internal-error"),Ae(void 0!==h.iat,"internal-error"),Number(h.exp)-Number(h.iat)}(h.idToken);this.updateTokensAndExpiration(h.idToken,h.refreshToken,p)}getToken(h,p=!1){var w=this;return(0,m.Z)(function*(){return Ae(!w.accessToken||w.refreshToken,h,"user-token-expired"),p||!w.accessToken||w.isExpired?w.refreshToken?(yield w.refresh(h,w.refreshToken),w.accessToken):null:w.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(h,p){var w=this;return(0,m.Z)(function*(){const{accessToken:D,refreshToken:x,expiresIn:$}=yield function He(_,h){return Rt.apply(this,arguments)}(h,p);w.updateTokensAndExpiration(D,x,Number($))})()}updateTokensAndExpiration(h,p,w){this.refreshToken=p||null,this.accessToken=h||null,this.expirationTime=Date.now()+1e3*w}static fromJSON(h,p){const{refreshToken:w,accessToken:D,expirationTime:x}=p,$=new qt;return w&&(Ae("string"==typeof w,"internal-error",{appName:h}),$.refreshToken=w),D&&(Ae("string"==typeof D,"internal-error",{appName:h}),$.accessToken=D),x&&(Ae("number"==typeof x,"internal-error",{appName:h}),$.expirationTime=x),$}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(h){this.accessToken=h.accessToken,this.refreshToken=h.refreshToken,this.expirationTime=h.expirationTime}_clone(){return Object.assign(new qt,this.toJSON())}_performRefresh(){return pr("not implemented")}}function An(_,h){Ae("string"==typeof _||void 0===_,"internal-error",{appName:h})}class Sr{constructor(h){var{uid:p,auth:w,stsTokenManager:D}=h,x=ae(h,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Bs(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=p,this.auth=w,this.stsTokenManager=D,this.accessToken=D.accessToken,this.displayName=x.displayName||null,this.email=x.email||null,this.emailVerified=x.emailVerified||!1,this.phoneNumber=x.phoneNumber||null,this.photoURL=x.photoURL||null,this.isAnonymous=x.isAnonymous||!1,this.tenantId=x.tenantId||null,this.metadata=new kl(x.createdAt||void 0,x.lastLoginAt||void 0)}getIdToken(h){var p=this;return(0,m.Z)(function*(){const w=yield qn(p,p.stsTokenManager.getToken(p.auth,h));return Ae(w,p.auth,"internal-error"),p.accessToken!==w&&(p.accessToken=w,yield p.auth._persistUserIfCurrent(p),p.auth._notifyListenersIfCurrent(p)),w})()}getIdTokenResult(h){return function Pl(_){return Po.apply(this,arguments)}(this,h)}reload(){return function po(_){return Wn.apply(this,arguments)}(this)}_assign(h){this!==h&&(Ae(this.uid===h.uid,this.auth,"internal-error"),this.displayName=h.displayName,this.photoURL=h.photoURL,this.email=h.email,this.emailVerified=h.emailVerified,this.phoneNumber=h.phoneNumber,this.isAnonymous=h.isAnonymous,this.tenantId=h.tenantId,this.providerData=h.providerData.map(p=>Object.assign({},p)),this.metadata._copy(h.metadata),this.stsTokenManager._assign(h.stsTokenManager))}_clone(h){return new Sr(Object.assign(Object.assign({},this),{auth:h,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(h){Ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=h,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(h){this.reloadListener?this.reloadListener(h):this.reloadUserInfo=h}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(h,p=!1){var w=this;return(0,m.Z)(function*(){let D=!1;h.idToken&&h.idToken!==w.stsTokenManager.accessToken&&(w.stsTokenManager.updateFromServerResponse(h),D=!0),p&&(yield Di(w)),yield w.auth._persistUserIfCurrent(w),D&&w.auth._notifyListenersIfCurrent(w)})()}delete(){var h=this;return(0,m.Z)(function*(){const p=yield h.getIdToken();return yield qn(h,function yt(_,h){return cn.apply(this,arguments)}(h.auth,{idToken:p})),h.stsTokenManager.clearRefreshToken(),h.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(h=>Object.assign({},h)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(h,p){var w,D,x,$,ne,Ne,xe,Qe;const Ye=null!==(w=p.displayName)&&void 0!==w?w:void 0,Tt=null!==(D=p.email)&&void 0!==D?D:void 0,Qn=null!==(x=p.phoneNumber)&&void 0!==x?x:void 0,na=null!==($=p.photoURL)&&void 0!==$?$:void 0,ru=null!==(ne=p.tenantId)&&void 0!==ne?ne:void 0,Vd=null!==(Ne=p._redirectEventId)&&void 0!==Ne?Ne:void 0,Qf=null!==(xe=p.createdAt)&&void 0!==xe?xe:void 0,Jf=null!==(Qe=p.lastLoginAt)&&void 0!==Qe?Qe:void 0,{uid:jd,emailVerified:vc,isAnonymous:Xf,providerData:Ju,stsTokenManager:wc}=p;Ae(jd&&wc,h,"internal-error");const $d=qt.fromJSON(this.name,wc);Ae("string"==typeof jd,h,"internal-error"),An(Ye,h.name),An(Tt,h.name),Ae("boolean"==typeof vc,h,"internal-error"),Ae("boolean"==typeof Xf,h,"internal-error"),An(Qn,h.name),An(na,h.name),An(ru,h.name),An(Vd,h.name),An(Qf,h.name),An(Jf,h.name);const Ec=new Sr({uid:jd,auth:h,email:Tt,emailVerified:vc,displayName:Ye,isAnonymous:Xf,photoURL:na,phoneNumber:Qn,tenantId:ru,stsTokenManager:$d,createdAt:Qf,lastLoginAt:Jf});return Ju&&Array.isArray(Ju)&&(Ec.providerData=Ju.map(Xg=>Object.assign({},Xg))),Vd&&(Ec._redirectEventId=Vd),Ec}static _fromIdTokenResponse(h,p,w=!1){return(0,m.Z)(function*(){const D=new qt;D.updateFromServerResponse(p);const x=new Sr({uid:p.localId,auth:h,stsTokenManager:D,isAnonymous:w});return yield Di(x),x})()}}const Vr=(()=>{class _{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,m.Z)(function*(){return!0})()}_set(p,w){var D=this;return(0,m.Z)(function*(){D.storage[p]=w})()}_get(p){var w=this;return(0,m.Z)(function*(){const D=w.storage[p];return void 0===D?null:D})()}_remove(p){var w=this;return(0,m.Z)(function*(){delete w.storage[p]})()}_addListener(p,w){}_removeListener(p,w){}}return _.type="NONE",_})();function $t(_,h,p){return`firebase:${_}:${h}:${p}`}class Si{constructor(h,p,w){this.persistence=h,this.auth=p,this.userKey=w;const{config:D,name:x}=this.auth;this.fullUserKey=$t(this.userKey,D.apiKey,x),this.fullPersistenceKey=$t("persistence",D.apiKey,x),this.boundEventHandler=p._onStorageEvent.bind(p),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(h){return this.persistence._set(this.fullUserKey,h.toJSON())}getCurrentUser(){var h=this;return(0,m.Z)(function*(){const p=yield h.persistence._get(h.fullUserKey);return p?Sr._fromJSON(h.auth,p):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(h){var p=this;return(0,m.Z)(function*(){if(p.persistence===h)return;const w=yield p.getCurrentUser();return yield p.removeCurrentUser(),p.persistence=h,w?p.setCurrentUser(w):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(h,p,w="authUser"){return(0,m.Z)(function*(){if(!p.length)return new Si(Ht(Vr),h,w);const D=(yield Promise.all(p.map(function(){var xe=(0,m.Z)(function*(Qe){if(yield Qe._isAvailable())return Qe});return function(Qe){return xe.apply(this,arguments)}}()))).filter(xe=>xe);let x=D[0]||Ht(Vr);const $=$t(w,h.config.apiKey,h.name);let ne=null;for(const xe of p)try{const Qe=yield xe._get($);if(Qe){const Ye=Sr._fromJSON(h,Qe);xe!==x&&(ne=Ye),x=xe;break}}catch(Qe){}const Ne=D.filter(xe=>xe._shouldAllowMigration);return x._shouldAllowMigration&&Ne.length?(x=Ne[0],ne&&(yield x._set($,ne.toJSON())),yield Promise.all(p.map(function(){var xe=(0,m.Z)(function*(Qe){if(Qe!==x)try{yield Qe._remove($)}catch(Ye){}});return function(Qe){return xe.apply(this,arguments)}}())),new Si(x,h,w)):new Si(x,h,w)})()}}function Rn(_){const h=_.toLowerCase();if(h.includes("opera/")||h.includes("opr/")||h.includes("opios/"))return"Opera";if(_a(h))return"IEMobile";if(h.includes("msie")||h.includes("trident/"))return"IE";if(h.includes("edge/"))return"Edge";if(bt(h))return"Firefox";if(h.includes("silk/"))return"Silk";if(nr(h))return"Blackberry";if(Mo(h))return"Webos";if(ko(h))return"Safari";if((h.includes("chrome/")||go(h))&&!h.includes("edge/"))return"Chrome";if(Qi(h))return"Android";{const w=_.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==w?void 0:w.length))return w[1]}return"Other"}function bt(_=(0,F.z$)()){return/firefox\//i.test(_)}function ko(_=(0,F.z$)()){const h=_.toLowerCase();return h.includes("safari/")&&!h.includes("chrome/")&&!h.includes("crios/")&&!h.includes("android")}function go(_=(0,F.z$)()){return/crios\//i.test(_)}function _a(_=(0,F.z$)()){return/iemobile/i.test(_)}function Qi(_=(0,F.z$)()){return/android/i.test(_)}function nr(_=(0,F.z$)()){return/blackberry/i.test(_)}function Mo(_=(0,F.z$)()){return/webos/i.test(_)}function Ji(_=(0,F.z$)()){return/iphone|ipad|ipod/i.test(_)}function No(_=(0,F.z$)()){return Ji(_)||Qi(_)||Mo(_)||nr(_)||/windows phone/i.test(_)||_a(_)}function Ri(_,h=[]){let p;switch(_){case"Browser":p=Rn((0,F.z$)());break;case"Worker":p=`${Rn((0,F.z$)())}-${_}`;break;default:p=_}const w=h.length?h.join(","):"FirebaseCore-web";return`${p}/JsCore/${oe.SDK_VERSION}/${w}`}class Kc{constructor(h,p){this.app=h,this.config=p,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gs(this),this.idTokenSubscription=new gs(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ti,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=h.name,this.clientVersion=p.sdkClientVersion}_initializeWithPersistence(h,p){var w=this;return p&&(this._popupRedirectResolver=Ht(p)),this._initializationPromise=this.queue((0,m.Z)(function*(){var D,x;if(!w._deleted&&(w.persistenceManager=yield Si.create(w,h),!w._deleted)){if(null===(D=w._popupRedirectResolver)||void 0===D?void 0:D._shouldInitProactively)try{yield w._popupRedirectResolver._initialize(w)}catch($){}yield w.initializeCurrentUser(p),w.lastNotifiedUid=(null===(x=w.currentUser)||void 0===x?void 0:x.uid)||null,!w._deleted&&(w._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var h=this;return(0,m.Z)(function*(){if(h._deleted)return;const p=yield h.assertedPersistence.getCurrentUser();if(h.currentUser||p){if(h.currentUser&&p&&h.currentUser.uid===p.uid)return h._currentUser._assign(p),void(yield h.currentUser.getIdToken());yield h._updateCurrentUser(p)}})()}initializeCurrentUser(h){var p=this;return(0,m.Z)(function*(){var w;let D=yield p.assertedPersistence.getCurrentUser();if(h&&p.config.authDomain){yield p.getOrInitRedirectPersistenceManager();const x=null===(w=p.redirectUser)||void 0===w?void 0:w._redirectEventId,$=null==D?void 0:D._redirectEventId,ne=yield p.tryRedirectSignIn(h);(!x||x===$)&&(null==ne?void 0:ne.user)&&(D=ne.user)}return D?D._redirectEventId?(Ae(p._popupRedirectResolver,p,"argument-error"),yield p.getOrInitRedirectPersistenceManager(),p.redirectUser&&p.redirectUser._redirectEventId===D._redirectEventId?p.directlySetCurrentUser(D):p.reloadAndSetCurrentUserOrClear(D)):p.reloadAndSetCurrentUserOrClear(D):p.directlySetCurrentUser(null)})()}tryRedirectSignIn(h){var p=this;return(0,m.Z)(function*(){let w=null;try{w=yield p._popupRedirectResolver._completeRedirectFn(p,h,!0)}catch(D){yield p._setRedirectUser(null)}return w})()}reloadAndSetCurrentUserOrClear(h){var p=this;return(0,m.Z)(function*(){try{yield Di(h)}catch(w){if("auth/network-request-failed"!==w.code)return p.directlySetCurrentUser(null)}return p.directlySetCurrentUser(h)})()}useDeviceLanguage(){this.languageCode=function Fr(){if("undefined"==typeof navigator)return null;const _=navigator;return _.languages&&_.languages[0]||_.language||null}()}_delete(){var h=this;return(0,m.Z)(function*(){h._deleted=!0})()}updateCurrentUser(h){var p=this;return(0,m.Z)(function*(){const w=h?(0,F.m9)(h):null;return w&&Ae(w.auth.config.apiKey===p.config.apiKey,p,"invalid-user-token"),p._updateCurrentUser(w&&w._clone(p))})()}_updateCurrentUser(h){var p=this;return(0,m.Z)(function*(){if(!p._deleted)return h&&Ae(p.tenantId===h.tenantId,p,"tenant-id-mismatch"),p.queue((0,m.Z)(function*(){yield p.directlySetCurrentUser(h),p.notifyAuthListeners()}))})()}signOut(){var h=this;return(0,m.Z)(function*(){return(h.redirectPersistenceManager||h._popupRedirectResolver)&&(yield h._setRedirectUser(null)),h._updateCurrentUser(null)})()}setPersistence(h){var p=this;return this.queue((0,m.Z)(function*(){yield p.assertedPersistence.setPersistence(Ht(h))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(h){this._errorFactory=new F.LL("auth","Firebase",h())}onAuthStateChanged(h,p,w){return this.registerStateListener(this.authStateSubscription,h,p,w)}onIdTokenChanged(h,p,w){return this.registerStateListener(this.idTokenSubscription,h,p,w)}toJSON(){var h;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(h=this._currentUser)||void 0===h?void 0:h.toJSON()}}_setRedirectUser(h,p){var w=this;return(0,m.Z)(function*(){const D=yield w.getOrInitRedirectPersistenceManager(p);return null===h?D.removeCurrentUser():D.setCurrentUser(h)})()}getOrInitRedirectPersistenceManager(h){var p=this;return(0,m.Z)(function*(){if(!p.redirectPersistenceManager){const w=h&&Ht(h)||p._popupRedirectResolver;Ae(w,p,"argument-error"),p.redirectPersistenceManager=yield Si.create(p,[Ht(w._redirectPersistence)],"redirectUser"),p.redirectUser=yield p.redirectPersistenceManager.getCurrentUser()}return p.redirectPersistenceManager})()}_redirectUserForId(h){var p=this;return(0,m.Z)(function*(){var w,D;return p._isInitialized&&(yield p.queue((0,m.Z)(function*(){}))),(null===(w=p._currentUser)||void 0===w?void 0:w._redirectEventId)===h?p._currentUser:(null===(D=p.redirectUser)||void 0===D?void 0:D._redirectEventId)===h?p.redirectUser:null})()}_persistUserIfCurrent(h){var p=this;return(0,m.Z)(function*(){if(h===p.currentUser)return p.queue((0,m.Z)(function*(){return p.directlySetCurrentUser(h)}))})()}_notifyListenersIfCurrent(h){h===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var h,p;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const w=null!==(p=null===(h=this.currentUser)||void 0===h?void 0:h.uid)&&void 0!==p?p:null;this.lastNotifiedUid!==w&&(this.lastNotifiedUid=w,this.authStateSubscription.next(this.currentUser))}registerStateListener(h,p,w,D){if(this._deleted)return()=>{};const x="function"==typeof p?p:p.next.bind(p),$=this._isInitialized?Promise.resolve():this._initializationPromise;return Ae($,this,"internal-error"),$.then(()=>x(this.currentUser)),"function"==typeof p?h.addObserver(p,w,D):h.addObserver(p)}directlySetCurrentUser(h){var p=this;return(0,m.Z)(function*(){p.currentUser&&p.currentUser!==h&&(p._currentUser._stopProactiveRefresh(),h&&p.isProactiveRefreshEnabled&&h._startProactiveRefresh()),p.currentUser=h,h?yield p.assertedPersistence.setCurrentUser(h):yield p.assertedPersistence.removeCurrentUser()})()}queue(h){return this.operations=this.operations.then(h,h),this.operations}get assertedPersistence(){return Ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(h){!h||this.frameworks.includes(h)||(this.frameworks.push(h),this.frameworks.sort(),this.clientVersion=Ri(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var h=this;return(0,m.Z)(function*(){const p={"X-Client-Version":h.clientVersion};return h.app.options.appId&&(p["X-Firebase-gmpid"]=h.app.options.appId),p})()}}function Ln(_){return(0,F.m9)(_)}class gs{constructor(h){this.auth=h,this.observer=null,this.addObserver=(0,F.ne)(p=>this.observer=p)}get next(){return Ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Yc(_){const h=_.indexOf(":");return h<0?"":_.substr(0,h+1)}function af(_){if(!_)return null;const h=Number(_);return isNaN(h)?null:h}class ya{constructor(h,p){this.providerId=h,this.signInMethod=p}toJSON(){return pr("not implemented")}_getIdTokenResponse(h){return pr("not implemented")}_linkToIdToken(h,p){return pr("not implemented")}_getReauthenticationResolver(h){return pr("not implemented")}}function uf(_,h){return Qc.apply(this,arguments)}function Qc(){return(Qc=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:resetPassword",ft(_,h))})).apply(this,arguments)}function lf(_,h){return Ml.apply(this,arguments)}function Ml(){return(Ml=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:update",h)})).apply(this,arguments)}function Rg(_,h){return va.apply(this,arguments)}function va(){return(va=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:update",ft(_,h))})).apply(this,arguments)}function Jc(){return(Jc=(0,m.Z)(function*(_,h){return W(_,"POST","/v1/accounts:signInWithPassword",ft(_,h))})).apply(this,arguments)}function Nl(_,h){return Xc.apply(this,arguments)}function Xc(){return(Xc=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:sendOobCode",ft(_,h))})).apply(this,arguments)}function xg(_,h){return ed.apply(this,arguments)}function ed(){return(ed=(0,m.Z)(function*(_,h){return Nl(_,h)})).apply(this,arguments)}function Pg(_,h){return Ol.apply(this,arguments)}function Ol(){return(Ol=(0,m.Z)(function*(_,h){return Nl(_,h)})).apply(this,arguments)}function wa(_,h){return td.apply(this,arguments)}function td(){return(td=(0,m.Z)(function*(_,h){return Nl(_,h)})).apply(this,arguments)}function Ll(_,h){return nd.apply(this,arguments)}function nd(){return(nd=(0,m.Z)(function*(_,h){return Nl(_,h)})).apply(this,arguments)}function Iu(){return(Iu=(0,m.Z)(function*(_,h){return W(_,"POST","/v1/accounts:signInWithEmailLink",ft(_,h))})).apply(this,arguments)}function _o(){return(_o=(0,m.Z)(function*(_,h){return W(_,"POST","/v1/accounts:signInWithEmailLink",ft(_,h))})).apply(this,arguments)}class Ia extends ya{constructor(h,p,w,D=null){super("password",w),this._email=h,this._password=p,this._tenantId=D}static _fromEmailAndPassword(h,p){return new Ia(h,p,"password")}static _fromEmailAndCode(h,p,w=null){return new Ia(h,p,"emailLink",w)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(h){const p="string"==typeof h?JSON.parse(h):h;if((null==p?void 0:p.email)&&(null==p?void 0:p.password)){if("password"===p.signInMethod)return this._fromEmailAndPassword(p.email,p.password);if("emailLink"===p.signInMethod)return this._fromEmailAndCode(p.email,p.password,p.tenantId)}return null}_getIdTokenResponse(h){var p=this;return(0,m.Z)(function*(){switch(p.signInMethod){case"password":return function Oo(_,h){return Jc.apply(this,arguments)}(h,{returnSecureToken:!0,email:p._email,password:p._password});case"emailLink":return function mo(_,h){return Iu.apply(this,arguments)}(h,{email:p._email,oobCode:p._password});default:Ut(h,"internal-error")}})()}_linkToIdToken(h,p){var w=this;return(0,m.Z)(function*(){switch(w.signInMethod){case"password":return lf(h,{idToken:p,returnSecureToken:!0,email:w._email,password:w._password});case"emailLink":return function Ea(_,h){return _o.apply(this,arguments)}(h,{idToken:p,email:w._email,oobCode:w._password});default:Ut(h,"internal-error")}})()}_getReauthenticationResolver(h){return this._getIdTokenResponse(h)}}function Vs(_,h){return bu.apply(this,arguments)}function bu(){return(bu=(0,m.Z)(function*(_,h){return W(_,"POST","/v1/accounts:signInWithIdp",ft(_,h))})).apply(this,arguments)}class Ar extends ya{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(h){const p=new Ar(h.providerId,h.signInMethod);return h.idToken||h.accessToken?(h.idToken&&(p.idToken=h.idToken),h.accessToken&&(p.accessToken=h.accessToken),h.nonce&&!h.pendingToken&&(p.nonce=h.nonce),h.pendingToken&&(p.pendingToken=h.pendingToken)):h.oauthToken&&h.oauthTokenSecret?(p.accessToken=h.oauthToken,p.secret=h.oauthTokenSecret):Ut("argument-error"),p}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(h){const p="string"==typeof h?JSON.parse(h):h,{providerId:w,signInMethod:D}=p,x=ae(p,["providerId","signInMethod"]);if(!w||!D)return null;const $=new Ar(w,D);return $.idToken=x.idToken||void 0,$.accessToken=x.accessToken||void 0,$.secret=x.secret,$.nonce=x.nonce,$.pendingToken=x.pendingToken||null,$}_getIdTokenResponse(h){return Vs(h,this.buildRequest())}_linkToIdToken(h,p){const w=this.buildRequest();return w.idToken=p,Vs(h,w)}_getReauthenticationResolver(h){const p=this.buildRequest();return p.autoCreate=!1,Vs(h,p)}buildRequest(){const h={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)h.pendingToken=this.pendingToken;else{const p={};this.idToken&&(p.id_token=this.idToken),this.accessToken&&(p.access_token=this.accessToken),this.secret&&(p.oauth_token_secret=this.secret),p.providerId=this.providerId,this.nonce&&!this.pendingToken&&(p.nonce=this.nonce),h.postBody=(0,F.xO)(p)}return h}}function Pi(_,h){return Fl.apply(this,arguments)}function Fl(){return(Fl=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:sendVerificationCode",ft(_,h))})).apply(this,arguments)}function ba(){return(ba=(0,m.Z)(function*(_,h){return W(_,"POST","/v1/accounts:signInWithPhoneNumber",ft(_,h))})).apply(this,arguments)}function Tu(){return(Tu=(0,m.Z)(function*(_,h){const p=yield W(_,"POST","/v1/accounts:signInWithPhoneNumber",ft(_,h));if(p.temporaryProof)throw $e(_,"account-exists-with-different-credential",p);return p})).apply(this,arguments)}const sd={USER_NOT_FOUND:"user-not-found"};function od(){return(od=(0,m.Z)(function*(_,h){return W(_,"POST","/v1/accounts:signInWithPhoneNumber",ft(_,Object.assign(Object.assign({},h),{operation:"REAUTH"})),sd)})).apply(this,arguments)}class zt extends ya{constructor(h){super("phone","phone"),this.params=h}static _fromVerification(h,p){return new zt({verificationId:h,verificationCode:p})}static _fromTokenResponse(h,p){return new zt({phoneNumber:h,temporaryProof:p})}_getIdTokenResponse(h){return function Qr(_,h){return ba.apply(this,arguments)}(h,this._makeVerificationRequest())}_linkToIdToken(h,p){return function id(_,h){return Tu.apply(this,arguments)}(h,Object.assign({idToken:p},this._makeVerificationRequest()))}_getReauthenticationResolver(h){return function Ul(_,h){return od.apply(this,arguments)}(h,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:h,phoneNumber:p,verificationId:w,verificationCode:D}=this.params;return h&&p?{temporaryProof:h,phoneNumber:p}:{sessionInfo:w,code:D}}toJSON(){const h={providerId:this.providerId};return this.params.phoneNumber&&(h.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(h.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(h.verificationCode=this.params.verificationCode),this.params.verificationId&&(h.verificationId=this.params.verificationId),h}static fromJSON(h){"string"==typeof h&&(h=JSON.parse(h));const{verificationId:p,verificationCode:w,phoneNumber:D,temporaryProof:x}=h;return w||p||D||x?new zt({verificationId:p,verificationCode:w,phoneNumber:D,temporaryProof:x}):null}}class nn{constructor(h){var p,w,D,x,$,ne;const Ne=(0,F.zd)((0,F.pd)(h)),xe=null!==(p=Ne.apiKey)&&void 0!==p?p:null,Qe=null!==(w=Ne.oobCode)&&void 0!==w?w:null,Ye=function js(_){switch(_){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(D=Ne.mode)&&void 0!==D?D:null);Ae(xe&&Qe&&Ye,"argument-error"),this.apiKey=xe,this.operation=Ye,this.code=Qe,this.continueUrl=null!==(x=Ne.continueUrl)&&void 0!==x?x:null,this.languageCode=null!==($=Ne.languageCode)&&void 0!==$?$:null,this.tenantId=null!==(ne=Ne.tenantId)&&void 0!==ne?ne:null}static parseLink(h){const p=function ad(_){const h=(0,F.zd)((0,F.pd)(_)).link,p=h?(0,F.zd)((0,F.pd)(h)).deep_link_id:null,w=(0,F.zd)((0,F.pd)(_)).deep_link_id;return(w?(0,F.zd)((0,F.pd)(w)).link:null)||w||p||h||_}(h);try{return new nn(p)}catch(w){return null}}}let Lo=(()=>{class _{constructor(){this.providerId=_.PROVIDER_ID}static credential(p,w){return Ia._fromEmailAndPassword(p,w)}static credentialWithLink(p,w){const D=nn.parseLink(w);return Ae(D,"argument-error"),Ia._fromEmailAndCode(p,D.code,D.tenantId)}}return _.PROVIDER_ID="password",_.EMAIL_PASSWORD_SIGN_IN_METHOD="password",_.EMAIL_LINK_SIGN_IN_METHOD="emailLink",_})();class Zn{constructor(h){this.providerId=h,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(h){this.defaultLanguageCode=h}setCustomParameters(h){return this.customParameters=h,this}getCustomParameters(){return this.customParameters}}class Fn extends Zn{constructor(){super(...arguments),this.scopes=[]}addScope(h){return this.scopes.includes(h)||this.scopes.push(h),this}getScopes(){return[...this.scopes]}}class ms extends Fn{static credentialFromJSON(h){const p="string"==typeof h?JSON.parse(h):h;return Ae("providerId"in p&&"signInMethod"in p,"argument-error"),Ar._fromParams(p)}credential(h){return this._credential(Object.assign(Object.assign({},h),{nonce:h.rawNonce}))}_credential(h){return Ae(h.idToken||h.accessToken,"argument-error"),Ar._fromParams(Object.assign(Object.assign({},h),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(h){return ms.oauthCredentialFromTaggedObject(h)}static credentialFromError(h){return ms.oauthCredentialFromTaggedObject(h.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthIdToken:p,oauthAccessToken:w,oauthTokenSecret:D,pendingToken:x,nonce:$,providerId:ne}=h;if(!w&&!D&&!p&&!x||!ne)return null;try{return new ms(ne)._credential({idToken:p,accessToken:w,nonce:$,pendingToken:x})}catch(Ne){return null}}}let Fo=(()=>{class _ extends Fn{constructor(){super("facebook.com")}static credential(p){return Ar._fromParams({providerId:_.PROVIDER_ID,signInMethod:_.FACEBOOK_SIGN_IN_METHOD,accessToken:p})}static credentialFromResult(p){return _.credentialFromTaggedObject(p)}static credentialFromError(p){return _.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p||!("oauthAccessToken"in p)||!p.oauthAccessToken)return null;try{return _.credential(p.oauthAccessToken)}catch(w){return null}}}return _.FACEBOOK_SIGN_IN_METHOD="facebook.com",_.PROVIDER_ID="facebook.com",_})(),es=(()=>{class _ extends Fn{constructor(){super("google.com"),this.addScope("profile")}static credential(p,w){return Ar._fromParams({providerId:_.PROVIDER_ID,signInMethod:_.GOOGLE_SIGN_IN_METHOD,idToken:p,accessToken:w})}static credentialFromResult(p){return _.credentialFromTaggedObject(p)}static credentialFromError(p){return _.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthIdToken:w,oauthAccessToken:D}=p;if(!w&&!D)return null;try{return _.credential(w,D)}catch(x){return null}}}return _.GOOGLE_SIGN_IN_METHOD="google.com",_.PROVIDER_ID="google.com",_})(),$r=(()=>{class _ extends Fn{constructor(){super("github.com")}static credential(p){return Ar._fromParams({providerId:_.PROVIDER_ID,signInMethod:_.GITHUB_SIGN_IN_METHOD,accessToken:p})}static credentialFromResult(p){return _.credentialFromTaggedObject(p)}static credentialFromError(p){return _.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p||!("oauthAccessToken"in p)||!p.oauthAccessToken)return null;try{return _.credential(p.oauthAccessToken)}catch(w){return null}}}return _.GITHUB_SIGN_IN_METHOD="github.com",_.PROVIDER_ID="github.com",_})();class ts extends ya{constructor(h,p){super(h,h),this.pendingToken=p}_getIdTokenResponse(h){return Vs(h,this.buildRequest())}_linkToIdToken(h,p){const w=this.buildRequest();return w.idToken=p,Vs(h,w)}_getReauthenticationResolver(h){const p=this.buildRequest();return p.autoCreate=!1,Vs(h,p)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(h){const p="string"==typeof h?JSON.parse(h):h,{providerId:w,signInMethod:D,pendingToken:x}=p;return w&&D&&x&&w===D?new ts(w,x):null}static _create(h,p){return new ts(h,p)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Hr extends Zn{constructor(h){Ae(h.startsWith("saml."),"argument-error"),super(h)}static credentialFromResult(h){return Hr.samlCredentialFromTaggedObject(h)}static credentialFromError(h){return Hr.samlCredentialFromTaggedObject(h.customData||{})}static credentialFromJSON(h){const p=ts.fromJSON(h);return Ae(p,"argument-error"),p}static samlCredentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{pendingToken:p,providerId:w}=h;if(!p||!w)return null;try{return ts._create(w,p)}catch(D){return null}}}let $s=(()=>{class _ extends Fn{constructor(){super("twitter.com")}static credential(p,w){return Ar._fromParams({providerId:_.PROVIDER_ID,signInMethod:_.TWITTER_SIGN_IN_METHOD,oauthToken:p,oauthTokenSecret:w})}static credentialFromResult(p){return _.credentialFromTaggedObject(p)}static credentialFromError(p){return _.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthAccessToken:w,oauthTokenSecret:D}=p;if(!w||!D)return null;try{return _.credential(w,D)}catch(x){return null}}}return _.TWITTER_SIGN_IN_METHOD="twitter.com",_.PROVIDER_ID="twitter.com",_})();function Uo(_,h){return pt.apply(this,arguments)}function pt(){return(pt=(0,m.Z)(function*(_,h){return W(_,"POST","/v1/accounts:signUp",ft(_,h))})).apply(this,arguments)}class rr{constructor(h){this.user=h.user,this.providerId=h.providerId,this._tokenResponse=h._tokenResponse,this.operationType=h.operationType}static _fromIdTokenResponse(h,p,w,D=!1){return(0,m.Z)(function*(){const x=yield Sr._fromIdTokenResponse(h,w,D),$=Ta(w);return new rr({user:x,providerId:$,_tokenResponse:w,operationType:p})})()}static _forOperation(h,p,w){return(0,m.Z)(function*(){yield h._updateTokensIfNecessary(w,!0);const D=Ta(w);return new rr({user:h,providerId:D,_tokenResponse:w,operationType:p})})()}}function Ta(_){return _.providerId?_.providerId:"phoneNumber"in _?"phone":null}function Bo(){return(Bo=(0,m.Z)(function*(_){var h;const p=Ln(_);if(yield p._initializationPromise,null===(h=p.currentUser)||void 0===h?void 0:h.isAnonymous)return new rr({user:p.currentUser,providerId:null,operationType:"signIn"});const w=yield Uo(p,{returnSecureToken:!0}),D=yield rr._fromIdTokenResponse(p,"signIn",w,!0);return yield p._updateCurrentUser(D.user),D})).apply(this,arguments)}class Vo extends F.ZR{constructor(h,p,w,D){var x;super(p.code,p.message),this.operationType=w,this.user=D,Object.setPrototypeOf(this,Vo.prototype),this.customData={appName:h.name,tenantId:null!==(x=h.tenantId)&&void 0!==x?x:void 0,_serverResponse:p.customData._serverResponse,operationType:w}}static _fromErrorAndOperation(h,p,w,D){return new Vo(h,p,w,D)}}function Vl(_,h,p,w){return("reauthenticate"===h?p._getReauthenticationResolver(_):p._getIdTokenResponse(_)).catch(x=>{throw"auth/multi-factor-auth-required"===x.code?Vo._fromErrorAndOperation(_,x,h,w):x})}function Cu(_){return new Set(_.map(({providerId:h})=>h).filter(h=>!!h))}function Pt(){return(Pt=(0,m.Z)(function*(_,h){const p=(0,F.m9)(_);yield yo(!0,p,h);const{providerUserInfo:w}=yield Hn(p.auth,{idToken:yield p.getIdToken(),deleteProvider:[h]}),D=Cu(w||[]);return p.providerData=p.providerData.filter(x=>D.has(x.providerId)),D.has("phone")||(p.phoneNumber=null),yield p.auth._persistUserIfCurrent(p),p})).apply(this,arguments)}function Du(_,h){return rn.apply(this,arguments)}function rn(){return(rn=(0,m.Z)(function*(_,h,p=!1){const w=yield qn(_,h._linkToIdToken(_.auth,yield _.getIdToken()),p);return rr._forOperation(_,"link",w)})).apply(this,arguments)}function yo(_,h,p){return Hs.apply(this,arguments)}function Hs(){return(Hs=(0,m.Z)(function*(_,h,p){yield Di(h);const D=!1===_?"provider-already-linked":"no-such-provider";Ae(Cu(h.providerData).has(p)===_,h.auth,D)})).apply(this,arguments)}function Jr(_,h){return _s.apply(this,arguments)}function _s(){return(_s=(0,m.Z)(function*(_,h,p=!1){const{auth:w}=_,D="reauthenticate";try{const x=yield qn(_,Vl(w,D,h,_),p);Ae(x.idToken,w,"internal-error");const $=ho(x.idToken);Ae($,w,"internal-error");const{sub:ne}=$;return Ae(_.uid===ne,w,"user-mismatch"),rr._forOperation(_,D,x)}catch(x){throw"auth/user-not-found"===(null==x?void 0:x.code)&&Ut(w,"user-mismatch"),x}})).apply(this,arguments)}function Su(_,h){return Au.apply(this,arguments)}function Au(){return(Au=(0,m.Z)(function*(_,h,p=!1){const w="signIn",D=yield Vl(_,w,h),x=yield rr._fromIdTokenResponse(_,w,D);return p||(yield _._updateCurrentUser(x.user)),x})).apply(this,arguments)}function Ru(_,h){return jo.apply(this,arguments)}function jo(){return(jo=(0,m.Z)(function*(_,h){return Su(Ln(_),h)})).apply(this,arguments)}function Da(_,h){return Kn.apply(this,arguments)}function Kn(){return(Kn=(0,m.Z)(function*(_,h){const p=(0,F.m9)(_);return yield yo(!1,p,h.providerId),Du(p,h)})).apply(this,arguments)}function ki(_,h){return xu.apply(this,arguments)}function xu(){return(xu=(0,m.Z)(function*(_,h){return Jr((0,F.m9)(_),h)})).apply(this,arguments)}function ys(_,h){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,m.Z)(function*(_,h){return W(_,"POST","/v1/accounts:signInWithCustomToken",ft(_,h))})).apply(this,arguments)}function $o(){return($o=(0,m.Z)(function*(_,h){const p=Ln(_),w=yield ys(p,{token:h,returnSecureToken:!0}),D=yield rr._fromIdTokenResponse(p,"signIn",w);return yield p._updateCurrentUser(D.user),D})).apply(this,arguments)}class Pu{constructor(h,p){this.factorId=h,this.uid=p.mfaEnrollmentId,this.enrollmentTime=new Date(p.enrolledAt).toUTCString(),this.displayName=p.displayName}static _fromServerResponse(h,p){return"phoneInfo"in p?Sa._fromServerResponse(h,p):Ut(h,"internal-error")}}class Sa extends Pu{constructor(h){super("phone",h),this.phoneNumber=h.phoneInfo}static _fromServerResponse(h,p){return new Sa(p)}}function Ho(_,h,p){var w;Ae((null===(w=p.url)||void 0===w?void 0:w.length)>0,_,"invalid-continue-uri"),Ae(void 0===p.dynamicLinkDomain||p.dynamicLinkDomain.length>0,_,"invalid-dynamic-link-domain"),h.continueUrl=p.url,h.dynamicLinkDomain=p.dynamicLinkDomain,h.canHandleCodeInApp=p.handleCodeInApp,p.iOS&&(Ae(p.iOS.bundleId.length>0,_,"missing-ios-bundle-id"),h.iOSBundleId=p.iOS.bundleId),p.android&&(Ae(p.android.packageName.length>0,_,"missing-android-pkg-name"),h.androidInstallApp=p.android.installApp,h.androidMinimumVersionCode=p.android.minimumVersion,h.androidPackageName=p.android.packageName)}function Ra(){return(Ra=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_),D={requestType:"PASSWORD_RESET",email:h};p&&Ho(w,D,p),yield Pg(w,D)})).apply(this,arguments)}function jl(){return(jl=(0,m.Z)(function*(_,h,p){yield uf((0,F.m9)(_),{oobCode:h,newPassword:p})})).apply(this,arguments)}function qo(){return(qo=(0,m.Z)(function*(_,h){yield Rg((0,F.m9)(_),{oobCode:h})})).apply(this,arguments)}function ld(_,h){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,m.Z)(function*(_,h){const p=(0,F.m9)(_),w=yield uf(p,{oobCode:h}),D=w.requestType;switch(Ae(D,p,"internal-error"),D){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ae(w.newEmail,p,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ae(w.mfaInfo,p,"internal-error");default:Ae(w.email,p,"internal-error")}let x=null;return w.mfaInfo&&(x=Pu._fromServerResponse(Ln(p),w.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===w.requestType?w.newEmail:w.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===w.requestType?w.email:w.newEmail)||null,multiFactorInfo:x},operation:D}})).apply(this,arguments)}function ka(){return(ka=(0,m.Z)(function*(_,h){const{data:p}=yield ld((0,F.m9)(_),h);return p.email})).apply(this,arguments)}function cd(){return(cd=(0,m.Z)(function*(_,h,p){const w=Ln(_),D=yield Uo(w,{returnSecureToken:!0,email:h,password:p}),x=yield rr._fromIdTokenResponse(w,"signIn",D);return yield w._updateCurrentUser(x.user),x})).apply(this,arguments)}function Un(){return(Un=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_),D={requestType:"EMAIL_SIGNIN",email:h};Ae(p.handleCodeInApp,w,"argument-error"),p&&Ho(w,D,p),yield wa(w,D)})).apply(this,arguments)}function Ma(){return(Ma=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_),D=Lo.credentialWithLink(h,p||dt());return Ae(D._tenantId===(w.tenantId||null),w,"tenant-id-mismatch"),Ru(w,D)})).apply(this,arguments)}function df(_,h){return hf.apply(this,arguments)}function hf(){return(hf=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:createAuthUri",ft(_,h))})).apply(this,arguments)}function ff(){return(ff=(0,m.Z)(function*(_,h){const w={identifier:h,continueUri:tt()?dt():"http://localhost"},{signinMethods:D}=yield df((0,F.m9)(_),w);return D||[]})).apply(this,arguments)}function qs(){return(qs=(0,m.Z)(function*(_,h){const p=(0,F.m9)(_),D={requestType:"VERIFY_EMAIL",idToken:yield _.getIdToken()};h&&Ho(p.auth,D,h);const{email:x}=yield xg(p.auth,D);x!==_.email&&(yield _.reload())})).apply(this,arguments)}function Nu(){return(Nu=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_),x={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield _.getIdToken(),newEmail:h};p&&Ho(w.auth,x,p);const{email:$}=yield Ll(w.auth,x);$!==_.email&&(yield _.reload())})).apply(this,arguments)}function pf(_,h){return hd.apply(this,arguments)}function hd(){return(hd=(0,m.Z)(function*(_,h){return mn(_,"POST","/v1/accounts:update",h)})).apply(this,arguments)}function yn(){return(yn=(0,m.Z)(function*(_,{displayName:h,photoURL:p}){if(void 0===h&&void 0===p)return;const w=(0,F.m9)(_),x={idToken:yield w.getIdToken(),displayName:h,photoUrl:p,returnSecureToken:!0},$=yield qn(w,pf(w.auth,x));w.displayName=$.displayName||null,w.photoURL=$.photoUrl||null;const ne=w.providerData.find(({providerId:Ne})=>"password"===Ne);ne&&(ne.displayName=w.displayName,ne.photoURL=w.photoURL),yield w._updateTokensIfNecessary($)})).apply(this,arguments)}function Na(_,h,p){return Ou.apply(this,arguments)}function Ou(){return(Ou=(0,m.Z)(function*(_,h,p){const{auth:w}=_,x={idToken:yield _.getIdToken(),returnSecureToken:!0};h&&(x.email=h),p&&(x.password=p);const $=yield qn(_,lf(w,x));yield _._updateTokensIfNecessary($,!0)})).apply(this,arguments)}class Oa{constructor(h,p,w={}){this.isNewUser=h,this.providerId=p,this.profile=w}}class pd extends Oa{constructor(h,p,w,D){super(h,p,w),this.username=D}}class Ng extends Oa{constructor(h,p){super(h,"facebook.com",p)}}class Gl extends pd{constructor(h,p){super(h,"github.com",p,"string"==typeof(null==p?void 0:p.login)?null==p?void 0:p.login:null)}}class sn extends Oa{constructor(h,p){super(h,"google.com",p)}}class Ws extends pd{constructor(h,p,w){super(h,"twitter.com",p,w)}}function Ke(_){const{user:h,_tokenResponse:p}=_;return h.isAnonymous&&!p?{providerId:null,isNewUser:!1,profile:null}:function fd(_){var h,p;if(!_)return null;const{providerId:w}=_,D=_.rawUserInfo?JSON.parse(_.rawUserInfo):{},x=_.isNewUser||"identitytoolkit#SignupNewUserResponse"===_.kind;if(!w&&(null==_?void 0:_.idToken)){const $=null===(p=null===(h=ho(_.idToken))||void 0===h?void 0:h.firebase)||void 0===p?void 0:p.sign_in_provider;if($)return new Oa(x,"anonymous"!==$&&"custom"!==$?$:null)}if(!w)return null;switch(w){case"facebook.com":return new Ng(x,D);case"github.com":return new Gl(x,D);case"google.com":return new sn(x,D);case"twitter.com":return new Ws(x,D,_.screenName||null);case"custom":case"anonymous":return new Oa(x,null);default:return new Oa(x,w,D)}}(p)}class ns{constructor(h,p){this.type=h,this.credential=p}static _fromIdtoken(h){return new ns("enroll",h)}static _fromMfaPendingCredential(h){return new ns("signin",h)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(h){var p,w;if(null==h?void 0:h.multiFactorSession){if(null===(p=h.multiFactorSession)||void 0===p?void 0:p.pendingCredential)return ns._fromMfaPendingCredential(h.multiFactorSession.pendingCredential);if(null===(w=h.multiFactorSession)||void 0===w?void 0:w.idToken)return ns._fromIdtoken(h.multiFactorSession.idToken)}return null}}class rs{constructor(h,p,w){this.session=h,this.hints=p,this.signInResolver=w}static _fromError(h,p){const w=Ln(h),D=p.customData._serverResponse,x=(D.mfaInfo||[]).map(ne=>Pu._fromServerResponse(w,ne));Ae(D.mfaPendingCredential,w,"internal-error");const $=ns._fromMfaPendingCredential(D.mfaPendingCredential);return new rs($,x,function(){var ne=(0,m.Z)(function*(Ne){const xe=yield Ne._process(w,$);delete D.mfaInfo,delete D.mfaPendingCredential;const Qe=Object.assign(Object.assign({},D),{idToken:xe.idToken,refreshToken:xe.refreshToken});switch(p.operationType){case"signIn":const Ye=yield rr._fromIdTokenResponse(w,p.operationType,Qe);return yield w._updateCurrentUser(Ye.user),Ye;case"reauthenticate":return Ae(p.user,w,"internal-error"),rr._forOperation(p.user,p.operationType,Qe);default:Ut(w,"internal-error")}});return function(Ne){return ne.apply(this,arguments)}}())}resolveSignIn(h){var p=this;return(0,m.Z)(function*(){return p.signInResolver(h)})()}}function _f(_,h){return mn(_,"POST","/v2/accounts/mfaEnrollment:start",ft(_,h))}class Ba{constructor(h){this.user=h,this.enrolledFactors=[],h._onReload(p=>{p.mfaInfo&&(this.enrolledFactors=p.mfaInfo.map(w=>Pu._fromServerResponse(h.auth,w)))})}static _fromUser(h){return new Ba(h)}getSession(){var h=this;return(0,m.Z)(function*(){return ns._fromIdtoken(yield h.user.getIdToken())})()}enroll(h,p){var w=this;return(0,m.Z)(function*(){const D=h,x=yield w.getSession(),$=yield qn(w.user,D._process(w.user.auth,x,p));return yield w.user._updateTokensIfNecessary($),w.user.reload()})()}unenroll(h){var p=this;return(0,m.Z)(function*(){const w="string"==typeof h?h:h.uid,D=yield p.user.getIdToken(),x=yield qn(p.user,function Zl(_,h){return mn(_,"POST","/v2/accounts/mfaEnrollment:withdraw",ft(_,h))}(p.user.auth,{idToken:D,mfaEnrollmentId:w}));p.enrolledFactors=p.enrolledFactors.filter(({uid:$})=>$!==w),yield p.user._updateTokensIfNecessary(x);try{yield p.user.reload()}catch($){if("auth/user-token-expired"!==$.code)throw $}})()}}const dn=new WeakMap,Wo="__sak";class zl{constructor(h,p){this.storageRetriever=h,this.type=p}_isAvailable(){try{return this.storage?(this.storage.setItem(Wo,"1"),this.storage.removeItem(Wo),Promise.resolve(!0)):Promise.resolve(!1)}catch(h){return Promise.resolve(!1)}}_set(h,p){return this.storage.setItem(h,JSON.stringify(p)),Promise.resolve()}_get(h){const p=this.storage.getItem(h);return Promise.resolve(p?JSON.parse(p):null)}_remove(h){return this.storage.removeItem(h),Promise.resolve()}get storage(){return this.storageRetriever()}}const Va=(()=>{class _ extends zl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(p,w)=>this.onStorageEvent(p,w),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Oi(){const _=(0,F.z$)();return ko(_)||Ji(_)}()&&function Ai(){try{return!(!window||window===window.top)}catch(_){return!1}}(),this.fallbackToPolling=No(),this._shouldAllowMigration=!0}forAllChangedKeys(p){for(const w of Object.keys(this.listeners)){const D=this.storage.getItem(w),x=this.localCache[w];D!==x&&p(w,x,D)}}onStorageEvent(p,w=!1){if(!p.key)return void this.forAllChangedKeys((ne,Ne,xe)=>{this.notifyListeners(ne,xe)});const D=p.key;if(w?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const ne=this.storage.getItem(D);if(p.newValue!==ne)null!==p.newValue?this.storage.setItem(D,p.newValue):this.storage.removeItem(D);else if(this.localCache[D]===p.newValue&&!w)return}const x=()=>{const ne=this.storage.getItem(D);!w&&this.localCache[D]===ne||this.notifyListeners(D,ne)},$=this.storage.getItem(D);!function zc(){return(0,F.w1)()&&10===document.documentMode}()||$===p.newValue||p.newValue===p.oldValue?x():setTimeout(x,10)}notifyListeners(p,w){this.localCache[p]=w;const D=this.listeners[p];if(D)for(const x of Array.from(D))x(w&&JSON.parse(w))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((p,w,D)=>{this.onStorageEvent(new StorageEvent("storage",{key:p,oldValue:w,newValue:D}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(p,w){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[p]||(this.listeners[p]=new Set,this.localCache[p]=this.storage.getItem(p)),this.listeners[p].add(w)}_removeListener(p,w){this.listeners[p]&&(this.listeners[p].delete(w),0===this.listeners[p].size&&delete this.listeners[p]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(p,w){var D=()=>super._set,x=this;return(0,m.Z)(function*(){yield D().call(x,p,w),x.localCache[p]=JSON.stringify(w)})()}_get(p){var w=()=>super._get,D=this;return(0,m.Z)(function*(){const x=yield w().call(D,p);return D.localCache[p]=JSON.stringify(x),x})()}_remove(p){var w=()=>super._remove,D=this;return(0,m.Z)(function*(){yield w().call(D,p),delete D.localCache[p]})()}}return _.type="LOCAL",_})(),Bn=(()=>{class _ extends zl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(p,w){}_removeListener(p,w){}}return _.type="SESSION",_})();let Ko=(()=>{class _{constructor(p){this.eventTarget=p,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(p){const w=this.receivers.find(x=>x.isListeningto(p));if(w)return w;const D=new _(p);return this.receivers.push(D),D}isListeningto(p){return this.eventTarget===p}handleEvent(p){var w=this;return(0,m.Z)(function*(){const D=p,{eventId:x,eventType:$,data:ne}=D.data,Ne=w.handlersMap[$];if(!(null==Ne?void 0:Ne.size))return;D.ports[0].postMessage({status:"ack",eventId:x,eventType:$});const xe=Array.from(Ne).map(function(){var Ye=(0,m.Z)(function*(Tt){return Tt(D.origin,ne)});return function(Tt){return Ye.apply(this,arguments)}}()),Qe=yield function Fu(_){return Promise.all(_.map(function(){var h=(0,m.Z)(function*(p){try{return{fulfilled:!0,value:yield p}}catch(w){return{fulfilled:!1,reason:w}}});return function(p){return h.apply(this,arguments)}}()))}(xe);D.ports[0].postMessage({status:"done",eventId:x,eventType:$,response:Qe})})()}_subscribe(p,w){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[p]||(this.handlersMap[p]=new Set),this.handlersMap[p].add(w)}_unsubscribe(p,w){this.handlersMap[p]&&w&&this.handlersMap[p].delete(w),(!w||0===this.handlersMap[p].size)&&delete this.handlersMap[p],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return _.receivers=[],_})();function vo(_="",h=10){let p="";for(let w=0;w<h;w++)p+=Math.floor(10*Math.random());return _+p}class En{constructor(h){this.target=h,this.handlers=new Set}removeMessageHandler(h){h.messageChannel&&(h.messageChannel.port1.removeEventListener("message",h.onMessage),h.messageChannel.port1.close()),this.handlers.delete(h)}_send(h,p,w=50){var D=this;return(0,m.Z)(function*(){const x="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!x)throw new Error("connection_unavailable");let $,ne;return new Promise((Ne,xe)=>{const Qe=vo("",20);x.port1.start();const Ye=setTimeout(()=>{xe(new Error("unsupported_event"))},w);ne={messageChannel:x,onMessage(Tt){const Qn=Tt;if(Qn.data.eventId===Qe)switch(Qn.data.status){case"ack":clearTimeout(Ye),$=setTimeout(()=>{xe(new Error("timeout"))},3e3);break;case"done":clearTimeout($),Ne(Qn.data.response);break;default:clearTimeout(Ye),clearTimeout($),xe(new Error("invalid_response"))}}},D.handlers.add(ne),x.port1.addEventListener("message",ne.onMessage),D.target.postMessage({eventType:h,eventId:Qe,data:p},[x.port2])}).finally(()=>{ne&&D.removeMessageHandler(ne)})})()}}function xn(){return window}function vn(){return void 0!==xn().WorkerGlobalScope&&"function"==typeof xn().importScripts}function Li(){return(Li=(0,m.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(_){return null}})).apply(this,arguments)}const qr="firebaseLocalStorageDb",Pn="firebaseLocalStorage",_d="fbase_key";class Wt{constructor(h){this.request=h}toPromise(){return new Promise((h,p)=>{this.request.addEventListener("success",()=>{h(this.request.result)}),this.request.addEventListener("error",()=>{p(this.request.error)})})}}function Yo(_,h){return _.transaction([Pn],h?"readwrite":"readonly").objectStore(Pn)}function yf(){const _=indexedDB.open(qr,1);return new Promise((h,p)=>{_.addEventListener("error",()=>{p(_.error)}),_.addEventListener("upgradeneeded",()=>{const w=_.result;try{w.createObjectStore(Pn,{keyPath:_d})}catch(D){p(D)}}),_.addEventListener("success",(0,m.Z)(function*(){const w=_.result;w.objectStoreNames.contains(Pn)?h(w):(w.close(),yield function Yl(){const _=indexedDB.deleteDatabase(qr);return new Wt(_).toPromise()}(),h(yield yf()))}))})}function vf(_,h,p){return wf.apply(this,arguments)}function wf(){return(wf=(0,m.Z)(function*(_,h,p){const w=Yo(_,!0).put({[_d]:h,value:p});return new Wt(w).toPromise()})).apply(this,arguments)}function Wr(){return(Wr=(0,m.Z)(function*(_,h){const p=Yo(_,!1).get(h),w=yield new Wt(p).toPromise();return void 0===w?null:w.value})).apply(this,arguments)}function wo(_,h){const p=Yo(_,!0).delete(h);return new Wt(p).toPromise()}const Fi=(()=>{class _{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var p=this;return(0,m.Z)(function*(){return p.db||(p.db=yield yf()),p.db})()}_withRetries(p){var w=this;return(0,m.Z)(function*(){let D=0;for(;;)try{const x=yield w._openDb();return yield p(x)}catch(x){if(D++>3)throw x;w.db&&(w.db.close(),w.db=void 0)}})()}initializeServiceWorkerMessaging(){var p=this;return(0,m.Z)(function*(){return vn()?p.initializeReceiver():p.initializeSender()})()}initializeReceiver(){var p=this;return(0,m.Z)(function*(){p.receiver=Ko._getInstance(function zs(){return vn()?self:null}()),p.receiver._subscribe("keyChanged",function(){var w=(0,m.Z)(function*(D,x){return{keyProcessed:(yield p._poll()).includes(x.key)}});return function(D,x){return w.apply(this,arguments)}}()),p.receiver._subscribe("ping",function(){var w=(0,m.Z)(function*(D,x){return["keyChanged"]});return function(D,x){return w.apply(this,arguments)}}())})()}initializeSender(){var p=this;return(0,m.Z)(function*(){var w,D;if(p.activeServiceWorker=yield function is(){return Li.apply(this,arguments)}(),!p.activeServiceWorker)return;p.sender=new En(p.activeServiceWorker);const x=yield p.sender._send("ping",{},800);!x||(null===(w=x[0])||void 0===w?void 0:w.fulfilled)&&(null===(D=x[0])||void 0===D?void 0:D.value.includes("keyChanged"))&&(p.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(p){var w=this;return(0,m.Z)(function*(){if(w.sender&&w.activeServiceWorker&&function Zs(){var _;return(null===(_=null==navigator?void 0:navigator.serviceWorker)||void 0===_?void 0:_.controller)||null}()===w.activeServiceWorker)try{yield w.sender._send("keyChanged",{key:p},w.serviceWorkerReceiverAvailable?800:50)}catch(D){}})()}_isAvailable(){return(0,m.Z)(function*(){try{if(!indexedDB)return!1;const p=yield yf();return yield vf(p,Wo,"1"),yield wo(p,Wo),!0}catch(p){}return!1})()}_withPendingWrite(p){var w=this;return(0,m.Z)(function*(){w.pendingWrites++;try{yield p()}finally{w.pendingWrites--}})()}_set(p,w){var D=this;return(0,m.Z)(function*(){return D._withPendingWrite((0,m.Z)(function*(){return yield D._withRetries(x=>vf(x,p,w)),D.localCache[p]=w,D.notifyServiceWorker(p)}))})()}_get(p){var w=this;return(0,m.Z)(function*(){const D=yield w._withRetries(x=>function $a(_,h){return Wr.apply(this,arguments)}(x,p));return w.localCache[p]=D,D})()}_remove(p){var w=this;return(0,m.Z)(function*(){return w._withPendingWrite((0,m.Z)(function*(){return yield w._withRetries(D=>wo(D,p)),delete w.localCache[p],w.notifyServiceWorker(p)}))})()}_poll(){var p=this;return(0,m.Z)(function*(){const w=yield p._withRetries($=>{const ne=Yo($,!1).getAll();return new Wt(ne).toPromise()});if(!w)return[];if(0!==p.pendingWrites)return[];const D=[],x=new Set;for(const{fbase_key:$,value:ne}of w)x.add($),JSON.stringify(p.localCache[$])!==JSON.stringify(ne)&&(p.notifyListeners($,ne),D.push($));for(const $ of Object.keys(p.localCache))p.localCache[$]&&!x.has($)&&(p.notifyListeners($,null),D.push($));return D})()}notifyListeners(p,w){this.localCache[p]=w;const D=this.listeners[p];if(D)for(const x of Array.from(D))x(w)}startPolling(){var p=this;this.stopPolling(),this.pollTimer=setInterval((0,m.Z)(function*(){return p._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(p,w){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[p]||(this.listeners[p]=new Set,this._get(p)),this.listeners[p].add(w)}_removeListener(p,w){this.listeners[p]&&(this.listeners[p].delete(w),0===this.listeners[p].size&&delete this.listeners[p]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return _.type="LOCAL",_})();function Og(_,h){return mn(_,"POST","/v2/accounts/mfaSignIn:start",ft(_,h))}function Ui(){return(Ui=(0,m.Z)(function*(_){return(yield mn(_,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ha(_){return new Promise((h,p)=>{const w=document.createElement("script");w.setAttribute("src",_),w.onload=h,w.onerror=D=>{const x=gn("internal-error");x.customData=D,p(x)},w.type="text/javascript",w.charset="UTF-8",function yd(){var _,h;return null!==(h=null===(_=document.getElementsByTagName("head"))||void 0===_?void 0:_[0])&&void 0!==h?h:document}().appendChild(w)})}function Ks(_){return`__${_}${Math.floor(1e6*Math.random())}`}const qa=1e12;class vd{constructor(h){this.auth=h,this.counter=qa,this._widgets=new Map}render(h,p){const w=this.counter;return this._widgets.set(w,new bf(h,this.auth.name,p||{})),this.counter++,w}reset(h){var p;const w=h||qa;null===(p=this._widgets.get(w))||void 0===p||p.delete(),this._widgets.delete(w)}getResponse(h){var p;return(null===(p=this._widgets.get(h||qa))||void 0===p?void 0:p.getResponse())||""}execute(h){var p=this;return(0,m.Z)(function*(){var w;return null===(w=p._widgets.get(h||qa))||void 0===w||w.execute(),""})()}}class bf{constructor(h,p,w){this.params=w,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const D="string"==typeof h?document.getElementById(h):h;Ae(D,"argument-error",{appName:p}),this.container=D,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Wa(_){const h=[],p="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let w=0;w<_;w++)h.push(p.charAt(Math.floor(Math.random()*p.length)));return h.join("")}(50);const{callback:h,"expired-callback":p}=this.params;if(h)try{h(this.responseToken)}catch(w){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,p)try{p()}catch(w){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const ct=Ks("rcb"),Ga=new At(3e4,6e4);class Lg{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!xn().grecaptcha}load(h,p=""){return Ae(function Jl(_){return _.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(_)}(p),h,"argument-error"),this.shouldResolveImmediately(p)?Promise.resolve(xn().grecaptcha):new Promise((w,D)=>{const x=xn().setTimeout(()=>{D(gn(h,"network-request-failed"))},Ga.get());xn()[ct]=()=>{xn().clearTimeout(x),delete xn()[ct];const ne=xn().grecaptcha;if(!ne)return void D(gn(h,"internal-error"));const Ne=ne.render;ne.render=(xe,Qe)=>{const Ye=Ne(xe,Qe);return this.counter++,Ye},this.hostLanguage=p,w(ne)},Ha(`https://www.google.com/recaptcha/api.js??${(0,F.xO)({onload:ct,render:"explicit",hl:p})}`).catch(()=>{clearTimeout(x),D(gn(h,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(h){return!!xn().grecaptcha&&(h===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Fg{load(h){return(0,m.Z)(function*(){return new vd(h)})()}clearedOneInstance(){}}const wd="recaptcha",Tf={theme:"light",type:"image"};class Rr{constructor(h,p=Object.assign({},Tf),w){this.parameters=p,this.type=wd,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ln(w),this.isInvisible="invisible"===this.parameters.size,Ae("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const D="string"==typeof h?document.getElementById(h):h;Ae(D,this.auth,"argument-error"),this.container=D,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Fg:new Lg,this.validateStartingState()}verify(){var h=this;return(0,m.Z)(function*(){h.assertNotDestroyed();const p=yield h.render(),w=h.getAssertedRecaptcha();return w.getResponse(p)||new Promise(x=>{const $=ne=>{!ne||(h.tokenChangeListeners.delete($),x(ne))};h.tokenChangeListeners.add($),h.isInvisible&&w.execute(p)})})()}render(){try{this.assertNotDestroyed()}catch(h){return Promise.reject(h)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(h=>{throw this.renderPromise=null,h})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(h=>{this.container.removeChild(h)})}validateStartingState(){Ae(!this.parameters.sitekey,this.auth,"argument-error"),Ae(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ae("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(h){return p=>{if(this.tokenChangeListeners.forEach(w=>w(p)),"function"==typeof h)h(p);else if("string"==typeof h){const w=xn()[h];"function"==typeof w&&w(p)}}}assertNotDestroyed(){Ae(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var h=this;return(0,m.Z)(function*(){if(yield h.init(),!h.widgetId){let p=h.container;if(!h.isInvisible){const w=document.createElement("div");p.appendChild(w),p=w}h.widgetId=h.getAssertedRecaptcha().render(p,h.parameters)}return h.widgetId})()}init(){var h=this;return(0,m.Z)(function*(){Ae(tt()&&!vn(),h.auth,"internal-error"),yield function Xl(){let _=null;return new Promise(h=>{"complete"!==document.readyState?(_=()=>h(),window.addEventListener("load",_)):h()}).catch(h=>{throw _&&window.removeEventListener("load",_),h})}(),h.recaptcha=yield h._recaptchaLoader.load(h.auth,h.auth.languageCode||void 0);const p=yield function fi(_){return Ui.apply(this,arguments)}(h.auth);Ae(p,h.auth,"internal-error"),h.parameters.sitekey=p})()}getAssertedRecaptcha(){return Ae(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Za{constructor(h,p){this.verificationId=h,this.onConfirmation=p}confirm(h){const p=zt._fromVerification(this.verificationId,h);return this.onConfirmation(p)}}function Bi(){return(Bi=(0,m.Z)(function*(_,h,p){const w=Ln(_),D=yield Jo(w,h,(0,F.m9)(p));return new Za(D,x=>Ru(w,x))})).apply(this,arguments)}function wn(){return(wn=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_);yield yo(!1,w,"phone");const D=yield Jo(w.auth,h,(0,F.m9)(p));return new Za(D,x=>Da(w,x))})).apply(this,arguments)}function za(){return(za=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_),D=yield Jo(w.auth,h,(0,F.m9)(p));return new Za(D,x=>ki(w,x))})).apply(this,arguments)}function Jo(_,h,p){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,m.Z)(function*(_,h,p){var w;const D=yield p.verify();try{let x;if(Ae("string"==typeof D,_,"argument-error"),Ae(p.type===wd,_,"argument-error"),x="string"==typeof h?{phoneNumber:h}:h,"session"in x){const $=x.session;if("phoneNumber"in x)return Ae("enroll"===$.type,_,"internal-error"),(yield _f(_,{idToken:$.credential,phoneEnrollmentInfo:{phoneNumber:x.phoneNumber,recaptchaToken:D}})).phoneSessionInfo.sessionInfo;{Ae("signin"===$.type,_,"internal-error");const ne=(null===(w=x.multiFactorHint)||void 0===w?void 0:w.uid)||x.multiFactorUid;return Ae(ne,_,"missing-multi-factor-info"),(yield Og(_,{mfaPendingCredential:$.credential,mfaEnrollmentId:ne,phoneSignInInfo:{recaptchaToken:D}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:$}=yield Pi(_,{phoneNumber:x.phoneNumber,recaptchaToken:D});return $}}finally{p._reset()}})).apply(this,arguments)}function Vu(){return(Vu=(0,m.Z)(function*(_,h){yield Du((0,F.m9)(_),h)})).apply(this,arguments)}let T=(()=>{class _{constructor(p){this.providerId=_.PROVIDER_ID,this.auth=Ln(p)}verifyPhoneNumber(p,w){return Jo(this.auth,p,(0,F.m9)(w))}static credential(p,w){return zt._fromVerification(p,w)}static credentialFromResult(p){return _.credentialFromTaggedObject(p)}static credentialFromError(p){return _.credentialFromTaggedObject(p.customData||{})}static credentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{phoneNumber:w,temporaryProof:D}=p;return w&&D?zt._fromTokenResponse(w,D):null}}return _.PROVIDER_ID="phone",_.PHONE_SIGN_IN_METHOD="phone",_})();function C(_,h){return h?Ht(h):(Ae(_._popupRedirectResolver,_,"argument-error"),_._popupRedirectResolver)}class k extends ya{constructor(h){super("custom","custom"),this.params=h}_getIdTokenResponse(h){return Vs(h,this._buildIdpRequest())}_linkToIdToken(h,p){return Vs(h,this._buildIdpRequest(p))}_getReauthenticationResolver(h){return Vs(h,this._buildIdpRequest())}_buildIdpRequest(h){const p={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return h&&(p.idToken=h),p}}function B(_){return Su(_.auth,new k(_),_.bypassAuthState)}function Z(_){const{auth:h,user:p}=_;return Ae(p,h,"internal-error"),Jr(p,new k(_),_.bypassAuthState)}function Q(_){return Se.apply(this,arguments)}function Se(){return(Se=(0,m.Z)(function*(_){const{auth:h,user:p}=_;return Ae(p,h,"internal-error"),Du(p,new k(_),_.bypassAuthState)})).apply(this,arguments)}class ze{constructor(h,p,w,D,x=!1){this.auth=h,this.resolver=w,this.user=D,this.bypassAuthState=x,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(p)?p:[p]}execute(){var h=this;return new Promise(function(){var p=(0,m.Z)(function*(w,D){h.pendingPromise={resolve:w,reject:D};try{h.eventManager=yield h.resolver._initialize(h.auth),yield h.onExecution(),h.eventManager.registerConsumer(h)}catch(x){h.reject(x)}});return function(w,D){return p.apply(this,arguments)}}())}onAuthEvent(h){var p=this;return(0,m.Z)(function*(){const{urlResponse:w,sessionId:D,postBody:x,tenantId:$,error:ne,type:Ne}=h;if(ne)return void p.reject(ne);const xe={auth:p.auth,requestUri:w,sessionId:D,tenantId:$||void 0,postBody:x||void 0,user:p.user,bypassAuthState:p.bypassAuthState};try{p.resolve(yield p.getIdpTask(Ne)(xe))}catch(Qe){p.reject(Qe)}})()}onError(h){this.reject(h)}getIdpTask(h){switch(h){case"signInViaPopup":case"signInViaRedirect":return B;case"linkViaPopup":case"linkViaRedirect":return Q;case"reauthViaPopup":case"reauthViaRedirect":return Z;default:Ut(this.auth,"internal-error")}}resolve(h){Xe(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(h),this.unregisterAndCleanUp()}reject(h){Xe(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(h),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const je=new At(2e3,1e4);function Kt(){return(Kt=(0,m.Z)(function*(_,h,p){const w=Ln(_);Kr(_,h,Zn);const D=C(w,p);return new ji(w,"signInViaPopup",h,D).executeNotNull()})).apply(this,arguments)}function Yn(){return(Yn=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_);Kr(w.auth,h,Zn);const D=C(w.auth,p);return new ji(w.auth,"reauthViaPopup",h,D,w).executeNotNull()})).apply(this,arguments)}function Vi(){return(Vi=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_);Kr(w.auth,h,Zn);const D=C(w.auth,p);return new ji(w.auth,"linkViaPopup",h,D,w).executeNotNull()})).apply(this,arguments)}let ji=(()=>{class _ extends ze{constructor(p,w,D,x,$){super(p,w,x,$),this.provider=D,this.authWindow=null,this.pollId=null,_.currentPopupAction&&_.currentPopupAction.cancel(),_.currentPopupAction=this}executeNotNull(){var p=this;return(0,m.Z)(function*(){const w=yield p.execute();return Ae(w,p.auth,"internal-error"),w})()}onExecution(){var p=this;return(0,m.Z)(function*(){Xe(1===p.filter.length,"Popup operations only handle one event");const w=vo();p.authWindow=yield p.resolver._openPopup(p.auth,p.provider,p.filter[0],w),p.authWindow.associatedEvent=w,p.resolver._originValidation(p.auth).catch(D=>{p.reject(D)}),p.resolver._isIframeWebStorageSupported(p.auth,D=>{D||p.reject(gn(p.auth,"web-storage-unsupported"))}),p.pollUserCancellation()})()}get eventId(){var p;return(null===(p=this.authWindow)||void 0===p?void 0:p.associatedEvent)||null}cancel(){this.reject(gn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_.currentPopupAction=null}pollUserCancellation(){const p=()=>{var w,D;this.pollId=(null===(D=null===(w=this.authWindow)||void 0===w?void 0:w.window)||void 0===D?void 0:D.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(gn(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(p,je.get())};p()}}return _.currentPopupAction=null,_})();const $i=new Map;class ss extends ze{constructor(h,p,w=!1){super(h,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],p,void 0,w),this.eventId=null}execute(){var h=()=>super.execute,p=this;return(0,m.Z)(function*(){let w=$i.get(p.auth._key());if(!w){try{const x=(yield function Qs(_,h){return tc.apply(this,arguments)}(p.resolver,p.auth))?yield h().call(p):null;w=()=>Promise.resolve(x)}catch(D){w=()=>Promise.reject(D)}$i.set(p.auth._key(),w)}return p.bypassAuthState||$i.set(p.auth._key(),()=>Promise.resolve(null)),w()})()}onAuthEvent(h){var p=()=>super.onAuthEvent,w=this;return(0,m.Z)(function*(){if("signInViaRedirect"===h.type)return p().call(w,h);if("unknown"!==h.type){if(h.eventId){const D=yield w.auth._redirectUserForId(h.eventId);if(D)return w.user=D,p().call(w,h);w.resolve(null)}}else w.resolve(null)})()}onExecution(){return(0,m.Z)(function*(){})()}cleanUp(){}}function tc(){return(tc=(0,m.Z)(function*(_,h){const p=nc(h),w=$u(_);if(!(yield w._isAvailable()))return!1;const D="true"===(yield w._get(p));return yield w._remove(p),D})).apply(this,arguments)}function Ed(_,h){return Df.apply(this,arguments)}function Df(){return(Df=(0,m.Z)(function*(_,h){return $u(_)._set(nc(h),"true")})).apply(this,arguments)}function $u(_){return Ht(_._redirectPersistence)}function nc(_){return $t("pendingRedirect",_.config.apiKey,_.name)}function Sf(){return(Sf=(0,m.Z)(function*(_,h,p){const w=Ln(_);Kr(_,h,Zn);const D=C(w,p);return yield Ed(D,w),D._openRedirect(w,h,"signInViaRedirect")})).apply(this,arguments)}function Id(){return(Id=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_);Kr(w.auth,h,Zn);const D=C(w.auth,p);yield Ed(D,w.auth);const x=yield os(w);return D._openRedirect(w.auth,h,"reauthViaRedirect",x)})).apply(this,arguments)}function Hi(){return(Hi=(0,m.Z)(function*(_,h,p){const w=(0,F.m9)(_);Kr(w.auth,h,Zn);const D=C(w.auth,p);yield yo(!1,w,h.providerId),yield Ed(D,w.auth);const x=yield os(w);return D._openRedirect(w.auth,h,"linkViaRedirect",x)})).apply(this,arguments)}function bd(){return(bd=(0,m.Z)(function*(_,h){return yield Ln(_)._initializationPromise,rc(_,h,!1)})).apply(this,arguments)}function rc(_,h){return Bg.apply(this,arguments)}function Bg(){return(Bg=(0,m.Z)(function*(_,h,p=!1){const w=Ln(_),D=C(w,h),$=yield new ss(w,D,p).execute();return $&&!p&&(delete $.user._redirectEventId,yield w._persistUserIfCurrent($.user),yield w._setRedirectUser(null,h)),$})).apply(this,arguments)}function os(_){return qu.apply(this,arguments)}function qu(){return(qu=(0,m.Z)(function*(_){const h=vo(`${_.uid}:::`);return _._redirectEventId=h,yield _.auth._setRedirectUser(_),yield _.auth._persistUserIfCurrent(_),h})).apply(this,arguments)}class Wu{constructor(h){this.auth=h,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(h){this.consumers.add(h),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,h)&&(this.sendToConsumer(this.queuedRedirectEvent,h),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(h){this.consumers.delete(h)}onEvent(h){if(this.hasEventBeenHandled(h))return!1;let p=!1;return this.consumers.forEach(w=>{this.isEventForConsumer(h,w)&&(p=!0,this.sendToConsumer(h,w),this.saveEventToCache(h))}),this.hasHandledPotentialRedirect||!function jg(_){switch(_.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ic(_);default:return!1}}(h)||(this.hasHandledPotentialRedirect=!0,p||(this.queuedRedirectEvent=h,p=!0)),p}sendToConsumer(h,p){var w;if(h.error&&!ic(h)){const D=(null===(w=h.error.code)||void 0===w?void 0:w.split("auth/")[1])||"internal-error";p.onError(gn(this.auth,D))}else p.onAuthEvent(h)}isEventForConsumer(h,p){const w=null===p.eventId||!!h.eventId&&h.eventId===p.eventId;return p.filter.includes(h.type)&&w}hasEventBeenHandled(h){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Td(h))}saveEventToCache(h){this.cachedEventUids.add(Td(h)),this.lastProcessedEventTime=Date.now()}}function Td(_){return[_.type,_.eventId,_.sessionId,_.tenantId].filter(h=>h).join("-")}function ic({type:_,error:h}){return"unknown"===_&&"auth/no-auth-event"===(null==h?void 0:h.code)}function Cd(_){return sc.apply(this,arguments)}function sc(){return(sc=(0,m.Z)(function*(_,h={}){return mn(_,"GET","/v1/projects",h)})).apply(this,arguments)}const Z_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oc=/^https?/;function Ka(){return(Ka=(0,m.Z)(function*(_){if(_.config.emulator)return;const{authorizedDomains:h}=yield Cd(_);for(const p of h)try{if(z_(p))return}catch(w){}Ut(_,"unauthorized-domain")})).apply(this,arguments)}function z_(_){const h=dt(),{protocol:p,hostname:w}=new URL(h);if(_.startsWith("chrome-extension://")){const $=new URL(_);return""===$.hostname&&""===w?"chrome-extension:"===p&&_.replace("chrome-extension://","")===h.replace("chrome-extension://",""):"chrome-extension:"===p&&$.hostname===w}if(!oc.test(p))return!1;if(Z_.test(_))return w===_;const D=_.replace(/\./g,"\\.");return new RegExp("^(.+\\."+D+"|"+D+")$","i").test(w)}const Rf=new At(3e4,6e4);function ac(){const _=xn().___jsl;if(null==_?void 0:_.H)for(const h of Object.keys(_.H))if(_.H[h].r=_.H[h].r||[],_.H[h].L=_.H[h].L||[],_.H[h].r=[..._.H[h].L],_.CP)for(let p=0;p<_.CP.length;p++)_.CP[p]=null}let Dd=null;function K_(_){return Dd=Dd||function $g(_){return new Promise((h,p)=>{var w,D,x;function $(){ac(),gapi.load("gapi.iframes",{callback:()=>{h(gapi.iframes.getContext())},ontimeout:()=>{ac(),p(gn(_,"network-request-failed"))},timeout:Rf.get()})}if(null===(D=null===(w=xn().gapi)||void 0===w?void 0:w.iframes)||void 0===D?void 0:D.Iframe)h(gapi.iframes.getContext());else{if(!(null===(x=xn().gapi)||void 0===x?void 0:x.load)){const ne=Ks("iframefcb");return xn()[ne]=()=>{gapi.load?$():p(gn(_,"network-request-failed"))},Ha(`https://apis.google.com/js/api.js?onload=${ne}`).catch(Ne=>p(Ne))}$()}}).catch(h=>{throw Dd=null,h})}(_),Dd}const Hg=new At(5e3,15e3),Q_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},J_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function X_(_){const h=_.config;Ae(h.authDomain,_,"auth-domain-config-required");const p=h.emulator?et(h,"emulator/auth/iframe"):`https://${_.config.authDomain}/__/auth/iframe`,w={apiKey:h.apiKey,appName:_.name,v:oe.SDK_VERSION},D=J_.get(_.config.apiHost);D&&(w.eid=D);const x=_._getFrameworks();return x.length&&(w.fw=x.join(",")),`${p}?${(0,F.xO)(w).slice(1)}`}function Gu(){return Gu=(0,m.Z)(function*(_){const h=yield K_(_),p=xn().gapi;return Ae(p,_,"internal-error"),h.open({where:document.body,url:X_(_),messageHandlersFilter:p.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Q_,dontclear:!0},w=>new Promise(function(){var D=(0,m.Z)(function*(x,$){yield w.restyle({setHideOnLeave:!1});const ne=gn(_,"network-request-failed"),Ne=xn().setTimeout(()=>{$(ne)},Hg.get());function xe(){xn().clearTimeout(Ne),x(w)}w.ping(xe).then(xe,()=>{$(ne)})});return function(x,$){return D.apply(this,arguments)}}()))}),Gu.apply(this,arguments)}const Ad={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class kf{constructor(h){this.window=h,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(h){}}}function Is(_,h,p,w,D,x){Ae(_.config.authDomain,_,"auth-domain-config-required"),Ae(_.config.apiKey,_,"invalid-api-key");const $={apiKey:_.config.apiKey,appName:_.name,authType:p,redirectUrl:w,v:oe.SDK_VERSION,eventId:D};if(h instanceof Zn){h.setDefaultLanguage(_.languageCode),$.providerId=h.providerId||"",(0,F.xb)(h.getCustomParameters())||($.customParameters=JSON.stringify(h.getCustomParameters()));for(const[Ne,xe]of Object.entries(x||{}))$[Ne]=xe}if(h instanceof Fn){const Ne=h.getScopes().filter(xe=>""!==xe);Ne.length>0&&($.scopes=Ne.join(","))}_.tenantId&&($.tid=_.tenantId);const ne=$;for(const Ne of Object.keys(ne))void 0===ne[Ne]&&delete ne[Ne];return`${function Nf({config:_}){return _.emulator?et(_,"emulator/auth/handler"):`https://${_.authDomain}/__/auth/handler`}(_)}?${(0,F.xO)(ne).slice(1)}`}const Gg="webStorageSupport";class Qa extends class uc{constructor(h){this.factorId=h}_process(h,p,w){switch(p.type){case"enroll":return this._finalizeEnroll(h,p.credential,w);case"signin":return this._finalizeSignIn(h,p.credential);default:return pr("unexpected MultiFactorSessionType")}}}{constructor(h){super("phone"),this.credential=h}static _fromCredential(h){return new Qa(h)}_finalizeEnroll(h,p,w){return function Ua(_,h){return mn(_,"POST","/v2/accounts/mfaEnrollment:finalize",ft(_,h))}(h,{idToken:p,displayName:w,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(h,p){return function Ef(_,h){return mn(_,"POST","/v2/accounts/mfaSignIn:finalize",ft(_,h))}(h,{mfaPendingCredential:p,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let ey=(()=>{class _{constructor(){}static assertion(p){return Qa._fromCredential(p)}}return _.FACTOR_ID="phone",_})();var zu="@firebase/auth";class Rd{constructor(h){this.auth=h,this.internalListeners=new Map}getUid(){var h;return this.assertAuthConfigured(),(null===(h=this.auth.currentUser)||void 0===h?void 0:h.uid)||null}getToken(h){var p=this;return(0,m.Z)(function*(){return p.assertAuthConfigured(),yield p.auth._initializationPromise,p.auth.currentUser?{accessToken:yield p.auth.currentUser.getIdToken(h)}:null})()}addAuthTokenListener(h){if(this.assertAuthConfigured(),this.internalListeners.has(h))return;const p=this.auth.onIdTokenChanged(w=>{var D;h((null===(D=w)||void 0===D?void 0:D.stsTokenManager.accessToken)||null)});this.internalListeners.set(h,p),this.updateProactiveRefresh()}removeAuthTokenListener(h){this.assertAuthConfigured();const p=this.internalListeners.get(h);!p||(this.internalListeners.delete(h),p(),this.updateProactiveRefresh())}assertAuthConfigured(){Ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function hn(){return window}function Ku(){return(Ku=(0,m.Z)(function*(_,h,p){var w;const{BuildInfo:D}=hn();Xe(h.sessionId,"AuthEvent did not contain a session ID");const x=yield Z0(h.sessionId),$={};return Ji()?$.ibi=D.packageName:Qi()?$.apn=D.packageName:Ut(_,"operation-not-supported-in-this-environment"),D.displayName&&($.appDisplayName=D.displayName),$.sessionId=x,Is(_,p,h.type,void 0,null!==(w=h.eventId)&&void 0!==w?w:void 0,$)})).apply(this,arguments)}function Yu(){return(Yu=(0,m.Z)(function*(_){const{BuildInfo:h}=hn(),p={};Ji()?p.iosBundleId=h.packageName:Qi()?p.androidPackageName=h.packageName:Ut(_,"operation-not-supported-in-this-environment"),yield Cd(_,p)})).apply(this,arguments)}function Uf(){return(Uf=(0,m.Z)(function*(_,h,p){const{cordova:w}=hn();let D=()=>{};try{yield new Promise((x,$)=>{let ne=null;function Ne(){var Ye;x();const Tt=null===(Ye=w.plugins.browsertab)||void 0===Ye?void 0:Ye.close;"function"==typeof Tt&&Tt(),"function"==typeof(null==p?void 0:p.close)&&p.close()}function xe(){ne||(ne=window.setTimeout(()=>{$(gn(_,"redirect-cancelled-by-user"))},2e3))}function Qe(){"visible"===(null==document?void 0:document.visibilityState)&&xe()}h.addPassiveListener(Ne),document.addEventListener("resume",xe,!1),Qi()&&document.addEventListener("visibilitychange",Qe,!1),D=()=>{h.removePassiveListener(Ne),document.removeEventListener("resume",xe,!1),document.removeEventListener("visibilitychange",Qe,!1),ne&&window.clearTimeout(ne)}})}finally{D()}})).apply(this,arguments)}function Z0(_){return cc.apply(this,arguments)}function cc(){return(cc=(0,m.Z)(function*(_){const h=Qu(_),p=yield crypto.subtle.digest("SHA-256",h);return Array.from(new Uint8Array(p)).map(D=>D.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function Qu(_){if(Xe(/[0-9a-zA-Z]+/.test(_),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(_);const h=new ArrayBuffer(_.length),p=new Uint8Array(h);for(let w=0;w<_.length;w++)p[w]=_.charCodeAt(w);return p}!function xd(_){(0,oe._registerComponent)(new de.wA("auth",(h,{options:p})=>{const w=h.getProvider("app").getImmediate(),{apiKey:D,authDomain:x}=w.options;return($=>{Ae(D&&!D.includes(":"),"invalid-api-key",{appName:$.name}),Ae(!(null==x?void 0:x.includes(":")),"argument-error",{appName:$.name});const ne={apiKey:D,authDomain:x,clientPlatform:_,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ri(_)},Ne=new Kc($,ne);return function Fs(_,h){const p=(null==h?void 0:h.persistence)||[],w=(Array.isArray(p)?p:[p]).map(Ht);(null==h?void 0:h.errorMap)&&_._updateErrorMap(h.errorMap),_._initializeWithPersistence(w,null==h?void 0:h.popupRedirectResolver)}(Ne,p),Ne})(w)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((h,p,w)=>{h.getProvider("auth-internal").initialize()})),(0,oe._registerComponent)(new de.wA("auth-internal",h=>{const p=Ln(h.getProvider("auth").getImmediate());return new Rd(p)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,oe.registerVersion)(zu,"0.19.6",function Zg(_){switch(_){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(_)),(0,oe.registerVersion)(zu,"0.19.6","esm2017")}("Browser");class Ja extends Wu{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(h=>{this.resolveInialized=h})}addPassiveListener(h){this.passiveListeners.add(h)}removePassiveListener(h){this.passiveListeners.delete(h)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(h){return this.resolveInialized(),this.passiveListeners.forEach(p=>p(h)),super.onEvent(h)}initialized(){var h=this;return(0,m.Z)(function*(){yield h.initPromise})()}}function _r(_){return Xa.apply(this,arguments)}function Xa(){return(Xa=(0,m.Z)(function*(_){const h=yield jf()._get(kd(_));return h&&(yield jf()._remove(kd(_))),h})).apply(this,arguments)}function ry(){const _=[],h="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let p=0;p<20;p++){const w=Math.floor(Math.random()*h.length);_.push(h.charAt(w))}return _.join("")}function jf(){return Ht(Va)}function kd(_){return $t("authEvent",_.config.apiKey,_.name)}function hc(_){if(!(null==_?void 0:_.includes("?")))return{};const[h,...p]=_.split("?");return(0,F.zd)(p.join("?"))}function eu(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:gn("no-auth-event")}}function ea(){var _;return(null===(_=null==self?void 0:self.location)||void 0===_?void 0:_.protocol)||null}function Kg(_=(0,F.z$)()){return!("file:"!==ea()&&"ionic:"!==ea()||!_.toLowerCase().match(/iphone|ipad|ipod|android/))}function qf(){try{const _=self.localStorage,h=vo();if(_)return _.setItem(h,"1"),_.removeItem(h),!function dy(_=(0,F.z$)()){return function ly(){return(0,F.w1)()&&11===(null==document?void 0:document.documentMode)}()||function cy(_=(0,F.z$)()){return/Edge\/\d+/.test(_)}(_)}()||(0,F.hl)()}catch(_){return Wf()&&(0,F.hl)()}return!1}function Wf(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function Gf(){return(function gc(){return"http:"===ea()||"https:"===ea()}()||(0,F.ru)()||Kg())&&!function uy(){return(0,F.b$)()||(0,F.UG)()}()&&qf()&&!Wf()}function Zf(){return Kg()&&"undefined"!=typeof document}function Md(){return(Md=(0,m.Z)(function*(){return!!Zf()&&new Promise(_=>{const h=setTimeout(()=>{_(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(h),_(!0)})})})).apply(this,arguments)}const qi={LOCAL:"local",NONE:"none",SESSION:"session"},mc=Ae,Yg="persistence";function bs(_){return zf.apply(this,arguments)}function zf(){return(zf=(0,m.Z)(function*(_){yield _._initializationPromise;const h=Nd(),p=$t(Yg,_.config.apiKey,_.name);(null==h?void 0:h.sessionStorage)&&h.sessionStorage.setItem(p,_._getPersistence())})).apply(this,arguments)}function Nd(){return"undefined"!=typeof window?window:null}const py=Ae;class xr{constructor(){this.browserResolver=Ht(class W0{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Bn,this._completeRedirectFn=rc}_openPopup(h,p,w,D){var x=this;return(0,m.Z)(function*(){var $;Xe(null===($=x.eventManagers[h._key()])||void 0===$?void 0:$.manager,"_initialize() not called before _openPopup()");const ne=Is(h,p,w,dt(),D);return function q0(_,h,p,w=500,D=600){const x=Math.max((window.screen.availHeight-D)/2,0).toString(),$=Math.max((window.screen.availWidth-w)/2,0).toString();let ne="";const Ne=Object.assign(Object.assign({},Ad),{width:w.toString(),height:D.toString(),top:x,left:$}),xe=(0,F.z$)().toLowerCase();p&&(ne=go(xe)?"_blank":p),bt(xe)&&(h=h||"http://localhost",Ne.scrollbars="yes");const Qe=Object.entries(Ne).reduce((Tt,[Qn,na])=>`${Tt}${Qn}=${na},`,"");if(function tn(_=(0,F.z$)()){var h;return Ji(_)&&!!(null===(h=window.navigator)||void 0===h?void 0:h.standalone)}(xe)&&"_self"!==ne)return function Wg(_,h){const p=document.createElement("a");p.href=_,p.target=h;const w=document.createEvent("MouseEvent");w.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),p.dispatchEvent(w)}(h||"",ne),new kf(null);const Ye=window.open(h||"",ne,Qe);Ae(Ye,_,"popup-blocked");try{Ye.focus()}catch(Tt){}return new kf(Ye)}(h,ne,vo())})()}_openRedirect(h,p,w,D){var x=this;return(0,m.Z)(function*(){return yield x._originValidation(h),function ja(_){xn().location.href=_}(Is(h,p,w,dt(),D)),new Promise(()=>{})})()}_initialize(h){const p=h._key();if(this.eventManagers[p]){const{manager:D,promise:x}=this.eventManagers[p];return D?Promise.resolve(D):(Xe(x,"If manager is not set, promise should be"),x)}const w=this.initAndGetManager(h);return this.eventManagers[p]={promise:w},w.catch(()=>{delete this.eventManagers[p]}),w}initAndGetManager(h){var p=this;return(0,m.Z)(function*(){const w=yield function Sd(_){return Gu.apply(this,arguments)}(h),D=new Wu(h);return w.register("authEvent",x=>(Ae(null==x?void 0:x.authEvent,h,"invalid-auth-event"),{status:D.onEvent(x.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),p.eventManagers[h._key()]={manager:D},p.iframes[h._key()]=w,D})()}_isIframeWebStorageSupported(h,p){this.iframes[h._key()].send(Gg,{type:Gg},D=>{var x;const $=null===(x=null==D?void 0:D[0])||void 0===x?void 0:x[Gg];void 0!==$&&p(!!$),Ut(h,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(h){const p=h._key();return this.originValidationPromises[p]||(this.originValidationPromises[p]=function Xo(_){return Ka.apply(this,arguments)}(h)),this.originValidationPromises[p]}get _shouldInitProactively(){return No()||ko()||Ji()}}),this.cordovaResolver=Ht(class iy{constructor(){this._redirectPersistence=Bn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=rc}_initialize(h){var p=this;return(0,m.Z)(function*(){const w=h._key();let D=p.eventManagers.get(w);return D||(D=new Ja(h),p.eventManagers.set(w,D),p.attachCallbackListeners(h,D)),D})()}_openPopup(h){Ut(h,"operation-not-supported-in-this-environment")}_openRedirect(h,p,w,D){var x=this;return(0,m.Z)(function*(){!function ny(_){var h,p,w,D,x,$,ne,Ne,xe,Qe;const Ye=hn();Ae("function"==typeof(null===(h=null==Ye?void 0:Ye.universalLinks)||void 0===h?void 0:h.subscribe),_,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Ae(void 0!==(null===(p=null==Ye?void 0:Ye.BuildInfo)||void 0===p?void 0:p.packageName),_,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Ae("function"==typeof(null===(x=null===(D=null===(w=null==Ye?void 0:Ye.cordova)||void 0===w?void 0:w.plugins)||void 0===D?void 0:D.browsertab)||void 0===x?void 0:x.openUrl),_,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ae("function"==typeof(null===(Ne=null===(ne=null===($=null==Ye?void 0:Ye.cordova)||void 0===$?void 0:$.plugins)||void 0===ne?void 0:ne.browsertab)||void 0===Ne?void 0:Ne.isAvailable),_,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ae("function"==typeof(null===(Qe=null===(xe=null==Ye?void 0:Ye.cordova)||void 0===xe?void 0:xe.InAppBrowser)||void 0===Qe?void 0:Qe.open),_,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(h);const $=yield x._initialize(h);yield $.initialized(),$.resetRedirect(),function ju(){$i.clear()}(),yield x._originValidation(h);const ne=function Bf(_,h,p=null){return{type:h,eventId:p,urlResponse:null,sessionId:ry(),postBody:null,tenantId:_.tenantId,error:gn(_,"no-auth-event")}}(h,w,D);yield function dc(_,h){return jf()._set(kd(_),h)}(h,ne);const Ne=yield function as(_,h,p){return Ku.apply(this,arguments)}(h,ne,p),xe=yield function Pd(_){const{cordova:h}=hn();return new Promise(p=>{h.plugins.browsertab.isAvailable(w=>{let D=null;w?h.plugins.browsertab.openUrl(_):D=h.InAppBrowser.open(_,function jr(_=(0,F.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(_)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(_)}()?"_blank":"_system","location=yes"),p(D)})})}(Ne);return function ty(_,h,p){return Uf.apply(this,arguments)}(h,$,xe)})()}_isIframeWebStorageSupported(h,p){throw new Error("Method not implemented.")}_originValidation(h){const p=h._key();return this.originValidationPromises[p]||(this.originValidationPromises[p]=function Ff(_){return Yu.apply(this,arguments)}(h)),this.originValidationPromises[p]}attachCallbackListeners(h,p){const{universalLinks:w,handleOpenURL:D,BuildInfo:x}=hn(),$=setTimeout((0,m.Z)(function*(){yield _r(h),p.onEvent(eu())}),500),ne=function(){var Qe=(0,m.Z)(function*(Ye){clearTimeout($);const Tt=yield _r(h);let Qn=null;Tt&&(null==Ye?void 0:Ye.url)&&(Qn=function Vf(_,h){var p,w;const D=function zg(_){const h=hc(_),p=h.link?decodeURIComponent(h.link):void 0,w=hc(p).link,D=h.deep_link_id?decodeURIComponent(h.deep_link_id):void 0;return hc(D).link||D||w||p||_}(h);if(D.includes("/__/auth/callback")){const x=hc(D),$=x.firebaseError?function $f(_){try{return JSON.parse(_)}catch(h){return null}}(decodeURIComponent(x.firebaseError)):null,ne=null===(w=null===(p=null==$?void 0:$.code)||void 0===p?void 0:p.split("auth/"))||void 0===w?void 0:w[1],Ne=ne?gn(ne):null;return Ne?{type:_.type,eventId:_.eventId,tenantId:_.tenantId,error:Ne,urlResponse:null,sessionId:null,postBody:null}:{type:_.type,eventId:_.eventId,tenantId:_.tenantId,sessionId:_.sessionId,urlResponse:D,postBody:null}}return null}(Tt,Ye.url)),p.onEvent(Qn||eu())});return function(Tt){return Qe.apply(this,arguments)}}();void 0!==w&&"function"==typeof w.subscribe&&w.subscribe(null,ne);const Ne=D,xe=`${x.packageName.toLowerCase()}://`;hn().handleOpenURL=function(){var Qe=(0,m.Z)(function*(Ye){if(Ye.toLowerCase().startsWith(xe)&&ne({url:Ye}),"function"==typeof Ne)try{Ne(Ye)}catch(Tt){console.error(Tt)}});return function(Ye){return Qe.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Bn,this._completeRedirectFn=rc}_initialize(h){var p=this;return(0,m.Z)(function*(){return yield p.selectUnderlyingResolver(),p.assertedUnderlyingResolver._initialize(h)})()}_openPopup(h,p,w,D){var x=this;return(0,m.Z)(function*(){return yield x.selectUnderlyingResolver(),x.assertedUnderlyingResolver._openPopup(h,p,w,D)})()}_openRedirect(h,p,w,D){var x=this;return(0,m.Z)(function*(){return yield x.selectUnderlyingResolver(),x.assertedUnderlyingResolver._openRedirect(h,p,w,D)})()}_isIframeWebStorageSupported(h,p){this.assertedUnderlyingResolver._isIframeWebStorageSupported(h,p)}_originValidation(h){return this.assertedUnderlyingResolver._originValidation(h)}get _shouldInitProactively(){return Zf()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return py(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var h=this;return(0,m.Z)(function*(){if(h.underlyingResolver)return;const p=yield function hy(){return Md.apply(this,arguments)}();h.underlyingResolver=p?h.cordovaResolver:h.browserResolver})()}}function Od(_){return _.unwrap()}function gy(_){return ta(_)}function ta(_){const{_tokenResponse:h}=_ instanceof F.ZR?_.customData:_;if(!h)return null;if(!(_ instanceof F.ZR)&&"temporaryProof"in h&&"phoneNumber"in h)return T.credentialFromResult(_);const p=h.providerId;if(!p||"password"===p)return null;let w;switch(p){case"google.com":w=es;break;case"facebook.com":w=Fo;break;case"github.com":w=$r;break;case"twitter.com":w=$s;break;default:const{oauthIdToken:D,oauthAccessToken:x,oauthTokenSecret:$,pendingToken:ne,nonce:Ne}=h;return x||$||D||ne?ne?p.startsWith("saml.")?ts._create(p,ne):Ar._fromParams({providerId:p,signInMethod:p,pendingToken:ne,idToken:D,accessToken:x}):new ms(p).credential({idToken:D,accessToken:x,rawNonce:Ne}):null}return _ instanceof F.ZR?w.credentialFromError(_):w.credentialFromResult(_)}function ti(_,h){return h.catch(p=>{throw p instanceof F.ZR&&function Qg(_,h){var p;const w=null===(p=h.customData)||void 0===p?void 0:p._tokenResponse;if("auth/multi-factor-auth-required"===h.code)h.resolver=new yc(_,function vt(_,h){var p;const w=(0,F.m9)(_),D=h;return Ae(h.customData.operationType,w,"argument-error"),Ae(null===(p=D.customData._serverResponse)||void 0===p?void 0:p.mfaPendingCredential,w,"argument-error"),rs._fromError(w,D)}(_,h));else if(w){const D=ta(h),x=h;D&&(x.credential=D,x.tenantId=w.tenantId||void 0,x.email=w.email||void 0,x.phoneNumber=w.phoneNumber||void 0)}}(_,p),p}).then(p=>{const D=p.user;return{operationType:p.operationType,credential:gy(p),additionalUserInfo:Ke(p),user:Ts.getOrCreate(D)}})}function Ld(_,h){return _c.apply(this,arguments)}function _c(){return(_c=(0,m.Z)(function*(_,h){const p=yield h;return{verificationId:p.verificationId,confirm:w=>ti(_,p.confirm(w))}})).apply(this,arguments)}class yc{constructor(h,p){this.resolver=p,this.auth=function Kf(_){return _.wrapped()}(h)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(h){return ti(Od(this.auth),this.resolver.resolveSignIn(h))}}class Ts{constructor(h){this._delegate=h,this.multiFactor=function Lu(_){const h=(0,F.m9)(_);return dn.has(h)||dn.set(h,Ba._fromUser(h)),dn.get(h)}(h)}static getOrCreate(h){return Ts.USER_MAP.has(h)||Ts.USER_MAP.set(h,new Ts(h)),Ts.USER_MAP.get(h)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(h){return this._delegate.getIdTokenResult(h)}getIdToken(h){return this._delegate.getIdToken(h)}linkAndRetrieveDataWithCredential(h){return this.linkWithCredential(h)}linkWithCredential(h){var p=this;return(0,m.Z)(function*(){return ti(p.auth,Da(p._delegate,h))})()}linkWithPhoneNumber(h,p){var w=this;return(0,m.Z)(function*(){return Ld(w.auth,function mr(_,h,p){return wn.apply(this,arguments)}(w._delegate,h,p))})()}linkWithPopup(h){var p=this;return(0,m.Z)(function*(){return ti(p.auth,function on(_,h,p){return Vi.apply(this,arguments)}(p._delegate,h,xr))})()}linkWithRedirect(h){var p=this;return(0,m.Z)(function*(){return yield bs(Ln(p.auth)),function Af(_,h,p){return function Hu(_,h,p){return Hi.apply(this,arguments)}(_,h,p)}(p._delegate,h,xr)})()}reauthenticateAndRetrieveDataWithCredential(h){return this.reauthenticateWithCredential(h)}reauthenticateWithCredential(h){var p=this;return(0,m.Z)(function*(){return ti(p.auth,ki(p._delegate,h))})()}reauthenticateWithPhoneNumber(h,p){return Ld(this.auth,function ec(_,h,p){return za.apply(this,arguments)}(this._delegate,h,p))}reauthenticateWithPopup(h){return ti(this.auth,function Gr(_,h,p){return Yn.apply(this,arguments)}(this._delegate,h,xr))}reauthenticateWithRedirect(h){var p=this;return(0,m.Z)(function*(){return yield bs(Ln(p.auth)),function H0(_,h,p){return function G_(_,h,p){return Id.apply(this,arguments)}(_,h,p)}(p._delegate,h,xr)})()}sendEmailVerification(h){return function Wl(_,h){return qs.apply(this,arguments)}(this._delegate,h)}unlink(h){var p=this;return(0,m.Z)(function*(){return yield function De(_,h){return Pt.apply(this,arguments)}(p._delegate,h),p})()}updateEmail(h){return function gf(_,h){return Na((0,F.m9)(_),h,null)}(this._delegate,h)}updatePassword(h){return function Mg(_,h){return Na((0,F.m9)(_),null,h)}(this._delegate,h)}updatePhoneNumber(h){return function Cf(_,h){return Vu.apply(this,arguments)}(this._delegate,h)}updateProfile(h){return function vs(_,h){return yn.apply(this,arguments)}(this._delegate,h)}verifyBeforeUpdateEmail(h,p){return function Mu(_,h,p){return Nu.apply(this,arguments)}(this._delegate,h,p)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Ts.USER_MAP=new WeakMap;const Fd=Ae;let nu=(()=>{class _{constructor(p,w){if(this.app=p,w.isInitialized())return this._delegate=w.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:D}=p.options;Fd(D,"invalid-api-key",{appName:p.name}),Fd(D,"invalid-api-key",{appName:p.name});const x="undefined"!=typeof window?xr:void 0;this._delegate=w.initialize({options:{persistence:Jg(D,p.name),popupRedirectResolver:x}}),this._delegate._updateErrorMap(Dr),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Ts.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(p){this._delegate.languageCode=p}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(p){this._delegate.tenantId=p}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(p,w){!function Xi(_,h,p){const w=Ln(_);Ae(w._canInitEmulator,w,"emulator-config-failed"),Ae(/^https?:\/\//.test(h),w,"invalid-emulator-scheme");const D=!!(null==p?void 0:p.disableWarnings),x=Yc(h),{host:$,port:ne}=function Ag(_){const h=Yc(_),p=/(\/\/)?([^?#/]+)/.exec(_.substr(h.length));if(!p)return{host:"",port:null};const w=p[2].split("@").pop()||"",D=/^(\[[^\]]+\])(:|$)/.exec(w);if(D){const x=D[1];return{host:x,port:af(w.substr(x.length+1))}}{const[x,$]=w.split(":");return{host:x,port:af($)}}}(h);w.config.emulator={url:`${x}//${$}${null===ne?"":`:${ne}`}/`},w.settings.appVerificationDisabledForTesting=!0,w.emulatorConfig=Object.freeze({host:$,port:ne,protocol:x.replace(":",""),options:Object.freeze({disableWarnings:D})}),D||function xi(){function _(){const h=document.createElement("p"),p=h.style;h.innerText="Running in emulator mode. Do not use with production credentials.",p.position="fixed",p.width="100%",p.backgroundColor="#ffffff",p.border=".1em solid #000000",p.color="#b50000",p.bottom="0px",p.left="0px",p.margin="0px",p.zIndex="10000",p.textAlign="center",h.classList.add("firebase-emulator-warning"),document.body.appendChild(h)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",_):_())}()}(this._delegate,p,w)}applyActionCode(p){return function $l(_,h){return qo.apply(this,arguments)}(this._delegate,p)}checkActionCode(p){return ld(this._delegate,p)}confirmPasswordReset(p,w){return function xa(_,h,p){return jl.apply(this,arguments)}(this._delegate,p,w)}createUserWithEmailAndPassword(p,w){var D=this;return(0,m.Z)(function*(){return ti(D._delegate,function ku(_,h,p){return cd.apply(this,arguments)}(D._delegate,p,w))})()}fetchProvidersForEmail(p){return this.fetchSignInMethodsForEmail(p)}fetchSignInMethodsForEmail(p){return function dd(_,h){return ff.apply(this,arguments)}(this._delegate,p)}isSignInWithEmailLink(p){return function _n(_,h){const p=nn.parseLink(h);return"EMAIL_SIGNIN"===(null==p?void 0:p.operation)}(0,p)}getRedirectResult(){var p=this;return(0,m.Z)(function*(){Fd(Gf(),p._delegate,"operation-not-supported-in-this-environment");const w=yield function Es(_,h){return bd.apply(this,arguments)}(p._delegate,xr);return w?ti(p._delegate,Promise.resolve(w)):{credential:null,user:null}})()}addFrameworkForLogging(p){!function oy(_,h){Ln(_)._logFramework(h)}(this._delegate,p)}onAuthStateChanged(p,w,D){const{next:x,error:$,complete:ne}=Ud(p,w,D);return this._delegate.onAuthStateChanged(x,$,ne)}onIdTokenChanged(p,w,D){const{next:x,error:$,complete:ne}=Ud(p,w,D);return this._delegate.onIdTokenChanged(x,$,ne)}sendSignInLinkToEmail(p,w){return function ir(_,h,p){return Un.apply(this,arguments)}(this._delegate,p,w)}sendPasswordResetEmail(p,w){return function Aa(_,h,p){return Ra.apply(this,arguments)}(this._delegate,p,w||void 0)}setPersistence(p){var w=this;return(0,m.Z)(function*(){let D;switch(function tu(_,h){mc(Object.values(qi).includes(h),_,"invalid-persistence-type"),(0,F.b$)()?mc(h!==qi.SESSION,_,"unsupported-persistence-type"):(0,F.UG)()?mc(h===qi.NONE,_,"unsupported-persistence-type"):Wf()?mc(h===qi.NONE||h===qi.LOCAL&&(0,F.hl)(),_,"unsupported-persistence-type"):mc(h===qi.NONE||qf(),_,"unsupported-persistence-type")}(w._delegate,p),p){case qi.SESSION:D=Bn;break;case qi.LOCAL:D=(yield Ht(Fi)._isAvailable())?Fi:Va;break;case qi.NONE:D=Vr;break;default:return Ut("argument-error",{appName:w._delegate.name})}return w._delegate.setPersistence(D)})()}signInAndRetrieveDataWithCredential(p){return this.signInWithCredential(p)}signInAnonymously(){return ti(this._delegate,function Ca(_){return Bo.apply(this,arguments)}(this._delegate))}signInWithCredential(p){return ti(this._delegate,Ru(this._delegate,p))}signInWithCustomToken(p){return ti(this._delegate,function ud(_,h){return $o.apply(this,arguments)}(this._delegate,p))}signInWithEmailAndPassword(p,w){return ti(this._delegate,function kg(_,h,p){return Ru((0,F.m9)(_),Lo.credential(h,p))}(this._delegate,p,w))}signInWithEmailLink(p,w){return ti(this._delegate,function ql(_,h,p){return Ma.apply(this,arguments)}(this._delegate,p,w))}signInWithPhoneNumber(p,w){return Ld(this._delegate,function Uu(_,h,p){return Bi.apply(this,arguments)}(this._delegate,p,w))}signInWithPopup(p){var w=this;return(0,m.Z)(function*(){return Fd(Gf(),w._delegate,"operation-not-supported-in-this-environment"),ti(w._delegate,function Bt(_,h,p){return Kt.apply(this,arguments)}(w._delegate,p,xr))})()}signInWithRedirect(p){var w=this;return(0,m.Z)(function*(){return Fd(Gf(),w._delegate,"operation-not-supported-in-this-environment"),yield bs(w._delegate),function $0(_,h,p){return function Ug(_,h,p){return Sf.apply(this,arguments)}(_,h,p)}(w._delegate,p,xr)})()}updateCurrentUser(p){return this._delegate.updateCurrentUser(p)}verifyPasswordResetCode(p){return function Hl(_,h){return ka.apply(this,arguments)}(this._delegate,p)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return _.Persistence=qi,_})();function Ud(_,h,p){let w=_;"function"!=typeof _&&({next:w,error:h,complete:p}=_);const D=w;return{next:$=>D($&&Ts.getOrCreate($)),error:h,complete:p}}function Jg(_,h){const p=function fy(_,h){const p=Nd();if(!(null==p?void 0:p.sessionStorage))return[];const w=$t(Yg,_,h);switch(p.sessionStorage.getItem(w)){case qi.NONE:return[Vr];case qi.LOCAL:return[Fi,Bn];case qi.SESSION:return[Bn];default:return[]}}(_,h);if("undefined"!=typeof self&&!p.includes(Fi)&&p.push(Fi),"undefined"!=typeof window)for(const w of[Va,Bn])p.includes(w)||p.push(w);return p.includes(Vr)||p.push(Vr),p}class Bd{constructor(){this.providerId="phone",this._delegate=new T(Od(J.Z.auth()))}static credential(h,p){return T.credential(h,p)}verifyPhoneNumber(h,p){return this._delegate.verifyPhoneNumber(h,p)}unwrap(){return this._delegate}}Bd.PHONE_SIGN_IN_METHOD=T.PHONE_SIGN_IN_METHOD,Bd.PROVIDER_ID=T.PROVIDER_ID;const Yf=Ae;class my{constructor(h,p,w=J.Z.app()){var D;Yf(null===(D=w.options)||void 0===D?void 0:D.apiKey,"invalid-api-key",{appName:w.name}),this._delegate=new Rr(h,p,w.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function _y(_){_.INTERNAL.registerComponent(new de.wA("auth-compat",h=>{const p=h.getProvider("app-compat").getImmediate(),w=h.getProvider("auth");return new nu(p,w)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Lo,FacebookAuthProvider:Fo,GithubAuthProvider:$r,GoogleAuthProvider:es,OAuthProvider:ms,SAMLAuthProvider:Hr,PhoneAuthProvider:Bd,PhoneMultiFactorGenerator:ey,RecaptchaVerifier:my,TwitterAuthProvider:$s,Auth:nu,AuthCredential:ya,Error:F.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),_.registerVersion("@firebase/auth-compat","0.2.6")}(J.Z)},2940:function(rt,Ee){!function(L){"use strict";function m(K){return Array.prototype.slice.call(K)}function J(K){return new Promise(function(re,ge){K.onsuccess=function(){re(K.result)},K.onerror=function(){ge(K.error)}})}function F(K,re,ge){var be,me=new Promise(function(Ve,Te){J(be=K[re].apply(K,ge)).then(Ve,Te)});return me.request=be,me}function oe(K,re,ge){var be=F(K,re,ge);return be.then(function(me){if(me)return new H(me,be.request)})}function ie(K,re,ge){ge.forEach(function(be){Object.defineProperty(K.prototype,be,{get:function(){return this[re][be]},set:function(me){this[re][be]=me}})})}function he(K,re,ge,be){be.forEach(function(me){me in ge.prototype&&(K.prototype[me]=function(){return F(this[re],me,arguments)})})}function se(K,re,ge,be){be.forEach(function(me){me in ge.prototype&&(K.prototype[me]=function(){return this[re][me].apply(this[re],arguments)})})}function ae(K,re,ge,be){be.forEach(function(me){me in ge.prototype&&(K.prototype[me]=function(){return oe(this[re],me,arguments)})})}function ue(K){this._index=K}function H(K,re){this._cursor=K,this._request=re}function q(K){this._store=K}function ee(K){this._tx=K,this.complete=new Promise(function(re,ge){K.oncomplete=function(){re()},K.onerror=function(){ge(K.error)},K.onabort=function(){ge(K.error)}})}function Be(K,re,ge){this._db=K,this.oldVersion=re,this.transaction=new ee(ge)}function Ie(K){this._db=K}ie(ue,"_index",["name","keyPath","multiEntry","unique"]),he(ue,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),ae(ue,"_index",IDBIndex,["openCursor","openKeyCursor"]),ie(H,"_cursor",["direction","key","primaryKey","value"]),he(H,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(K){K in IDBCursor.prototype&&(H.prototype[K]=function(){var re=this,ge=arguments;return Promise.resolve().then(function(){return re._cursor[K].apply(re._cursor,ge),J(re._request).then(function(be){if(be)return new H(be,re._request)})})})}),q.prototype.createIndex=function(){return new ue(this._store.createIndex.apply(this._store,arguments))},q.prototype.index=function(){return new ue(this._store.index.apply(this._store,arguments))},ie(q,"_store",["name","keyPath","indexNames","autoIncrement"]),he(q,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),ae(q,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),se(q,"_store",IDBObjectStore,["deleteIndex"]),ee.prototype.objectStore=function(){return new q(this._tx.objectStore.apply(this._tx,arguments))},ie(ee,"_tx",["objectStoreNames","mode"]),se(ee,"_tx",IDBTransaction,["abort"]),Be.prototype.createObjectStore=function(){return new q(this._db.createObjectStore.apply(this._db,arguments))},ie(Be,"_db",["name","version","objectStoreNames"]),se(Be,"_db",IDBDatabase,["deleteObjectStore","close"]),Ie.prototype.transaction=function(){return new ee(this._db.transaction.apply(this._db,arguments))},ie(Ie,"_db",["name","version","objectStoreNames"]),se(Ie,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(K){[q,ue].forEach(function(re){K in re.prototype&&(re.prototype[K.replace("open","iterate")]=function(){var ge=m(arguments),be=ge[ge.length-1],me=this._store||this._index,Ve=me[K].apply(me,ge.slice(0,-1));Ve.onsuccess=function(){be(Ve.result)}})})}),[ue,q].forEach(function(K){K.prototype.getAll||(K.prototype.getAll=function(re,ge){var be=this,me=[];return new Promise(function(Ve){be.iterateCursor(re,function(Te){Te?(me.push(Te.value),void 0===ge||me.length!=ge?Te.continue():Ve(me)):Ve(me)})})})}),L.openDb=function ke(K,re,ge){var be=F(indexedDB,"open",[K,re]),me=be.request;return me&&(me.onupgradeneeded=function(Ve){ge&&ge(new Be(me.result,Ve.oldVersion,me.transaction))}),be.then(function(Ve){return new Ie(Ve)})},L.deleteDb=function Fe(K){return F(indexedDB,"deleteDatabase",[K])},Object.defineProperty(L,"__esModule",{value:!0})}(Ee)},8306:(rt,Ee,L)=>{"use strict";L.d(Ee,{y:()=>H});var m=L(930),J=L(727),F=L(8822),oe=L(4671);var se=L(2416),ae=L(576),ue=L(2806);let H=(()=>{class Ie{constructor(Fe){Fe&&(this._subscribe=Fe)}lift(Fe){const K=new Ie;return K.source=this,K.operator=Fe,K}subscribe(Fe,K,re){const ge=function Be(Ie){return Ie&&Ie instanceof m.Lv||function ee(Ie){return Ie&&(0,ae.m)(Ie.next)&&(0,ae.m)(Ie.error)&&(0,ae.m)(Ie.complete)}(Ie)&&(0,J.Nn)(Ie)}(Fe)?Fe:new m.Hp(Fe,K,re);return(0,ue.x)(()=>{const{operator:be,source:me}=this;ge.add(be?be.call(ge,me):me?this._subscribe(ge):this._trySubscribe(ge))}),ge}_trySubscribe(Fe){try{return this._subscribe(Fe)}catch(K){Fe.error(K)}}forEach(Fe,K){return new(K=q(K))((re,ge)=>{let be;be=this.subscribe(me=>{try{Fe(me)}catch(Ve){ge(Ve),null==be||be.unsubscribe()}},ge,re)})}_subscribe(Fe){var K;return null===(K=this.source)||void 0===K?void 0:K.subscribe(Fe)}[F.L](){return this}pipe(...Fe){return function he(Ie){return 0===Ie.length?oe.y:1===Ie.length?Ie[0]:function(Fe){return Ie.reduce((K,re)=>re(K),Fe)}}(Fe)(this)}toPromise(Fe){return new(Fe=q(Fe))((K,re)=>{let ge;this.subscribe(be=>ge=be,be=>re(be),()=>K(ge))})}}return Ie.create=ke=>new Ie(ke),Ie})();function q(Ie){var ke;return null!==(ke=null!=Ie?Ie:se.v.Promise)&&void 0!==ke?ke:Promise}},7579:(rt,Ee,L)=>{"use strict";L.d(Ee,{x:()=>se});var m=L(8306),J=L(727);const oe=(0,L(3888).d)(ue=>function(){ue(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ie=L(8737),he=L(2806);let se=(()=>{class ue extends m.y{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(q){const ee=new ae(this,this);return ee.operator=q,ee}_throwIfClosed(){if(this.closed)throw new oe}next(q){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){const ee=this.observers.slice();for(const Be of ee)Be.next(q)}})}error(q){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=q;const{observers:ee}=this;for(;ee.length;)ee.shift().error(q)}})}complete(){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:q}=this;for(;q.length;)q.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var q;return(null===(q=this.observers)||void 0===q?void 0:q.length)>0}_trySubscribe(q){return this._throwIfClosed(),super._trySubscribe(q)}_subscribe(q){return this._throwIfClosed(),this._checkFinalizedStatuses(q),this._innerSubscribe(q)}_innerSubscribe(q){const{hasError:ee,isStopped:Be,observers:Ie}=this;return ee||Be?J.Lc:(Ie.push(q),new J.w0(()=>(0,ie.P)(Ie,q)))}_checkFinalizedStatuses(q){const{hasError:ee,thrownError:Be,isStopped:Ie}=this;ee?q.error(Be):Ie&&q.complete()}asObservable(){const q=new m.y;return q.source=this,q}}return ue.create=(H,q)=>new ae(H,q),ue})();class ae extends se{constructor(H,q){super(),this.destination=H,this.source=q}next(H){var q,ee;null===(ee=null===(q=this.destination)||void 0===q?void 0:q.next)||void 0===ee||ee.call(q,H)}error(H){var q,ee;null===(ee=null===(q=this.destination)||void 0===q?void 0:q.error)||void 0===ee||ee.call(q,H)}complete(){var H,q;null===(q=null===(H=this.destination)||void 0===H?void 0:H.complete)||void 0===q||q.call(H)}_subscribe(H){var q,ee;return null!==(ee=null===(q=this.source)||void 0===q?void 0:q.subscribe(H))&&void 0!==ee?ee:J.Lc}}},930:(rt,Ee,L)=>{"use strict";L.d(Ee,{Hp:()=>Be,Lv:()=>ee});var m=L(576),J=L(727),F=L(2416),oe=L(7849),ie=L(5032);const he=ue("C",void 0,void 0);function ue(re,ge,be){return{kind:re,value:ge,error:be}}var H=L(3410),q=L(2806);class ee extends J.w0{constructor(ge){super(),this.isStopped=!1,ge?(this.destination=ge,(0,J.Nn)(ge)&&ge.add(this)):this.destination=K}static create(ge,be,me){return new Be(ge,be,me)}next(ge){this.isStopped?Fe(function ae(re){return ue("N",re,void 0)}(ge),this):this._next(ge)}error(ge){this.isStopped?Fe(function se(re){return ue("E",void 0,re)}(ge),this):(this.isStopped=!0,this._error(ge))}complete(){this.isStopped?Fe(he,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ge){this.destination.next(ge)}_error(ge){try{this.destination.error(ge)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Be extends ee{constructor(ge,be,me){let Ve;if(super(),(0,m.m)(ge))Ve=ge;else if(ge){let Te;({next:Ve,error:be,complete:me}=ge),this&&F.v.useDeprecatedNextContext?(Te=Object.create(ge),Te.unsubscribe=()=>this.unsubscribe()):Te=ge,Ve=null==Ve?void 0:Ve.bind(Te),be=null==be?void 0:be.bind(Te),me=null==me?void 0:me.bind(Te)}this.destination={next:Ve?Ie(Ve):ie.Z,error:Ie(null!=be?be:ke),complete:me?Ie(me):ie.Z}}}function Ie(re,ge){return(...be)=>{try{re(...be)}catch(me){F.v.useDeprecatedSynchronousErrorHandling?(0,q.O)(me):(0,oe.h)(me)}}}function ke(re){throw re}function Fe(re,ge){const{onStoppedNotification:be}=F.v;be&&H.z.setTimeout(()=>be(re,ge))}const K={closed:!0,next:ie.Z,error:ke,complete:ie.Z}},727:(rt,Ee,L)=>{"use strict";L.d(Ee,{Lc:()=>he,w0:()=>ie,Nn:()=>se});var m=L(576);const F=(0,L(3888).d)(ue=>function(q){ue(this),this.message=q?`${q.length} errors occurred during unsubscription:\n${q.map((ee,Be)=>`${Be+1}) ${ee.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=q});var oe=L(8737);class ie{constructor(H){this.initialTeardown=H,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let H;if(!this.closed){this.closed=!0;const{_parentage:q}=this;if(q)if(this._parentage=null,Array.isArray(q))for(const Ie of q)Ie.remove(this);else q.remove(this);const{initialTeardown:ee}=this;if((0,m.m)(ee))try{ee()}catch(Ie){H=Ie instanceof F?Ie.errors:[Ie]}const{_teardowns:Be}=this;if(Be){this._teardowns=null;for(const Ie of Be)try{ae(Ie)}catch(ke){H=null!=H?H:[],ke instanceof F?H=[...H,...ke.errors]:H.push(ke)}}if(H)throw new F(H)}}add(H){var q;if(H&&H!==this)if(this.closed)ae(H);else{if(H instanceof ie){if(H.closed||H._hasParent(this))return;H._addParent(this)}(this._teardowns=null!==(q=this._teardowns)&&void 0!==q?q:[]).push(H)}}_hasParent(H){const{_parentage:q}=this;return q===H||Array.isArray(q)&&q.includes(H)}_addParent(H){const{_parentage:q}=this;this._parentage=Array.isArray(q)?(q.push(H),q):q?[q,H]:H}_removeParent(H){const{_parentage:q}=this;q===H?this._parentage=null:Array.isArray(q)&&(0,oe.P)(q,H)}remove(H){const{_teardowns:q}=this;q&&(0,oe.P)(q,H),H instanceof ie&&H._removeParent(this)}}ie.EMPTY=(()=>{const ue=new ie;return ue.closed=!0,ue})();const he=ie.EMPTY;function se(ue){return ue instanceof ie||ue&&"closed"in ue&&(0,m.m)(ue.remove)&&(0,m.m)(ue.add)&&(0,m.m)(ue.unsubscribe)}function ae(ue){(0,m.m)(ue)?ue():ue.unsubscribe()}},2416:(rt,Ee,L)=>{"use strict";L.d(Ee,{v:()=>m});const m={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(rt,Ee,L)=>{"use strict";L.d(Ee,{E:()=>J});const J=new(L(8306).y)(ie=>ie.complete())},8996:(rt,Ee,L)=>{"use strict";L.d(Ee,{D:()=>Ve});var m=L(8421),J=L(5363),F=L(9468),he=L(8306),ae=L(2202),ue=L(576),H=L(9672);function ee(Te,Je){if(!Te)throw new Error("Iterable cannot be null");return new he.y(Ge=>{(0,H.f)(Ge,Je,()=>{const ht=Te[Symbol.asyncIterator]();(0,H.f)(Ge,Je,()=>{ht.next().then(X=>{X.done?Ge.complete():Ge.next(X.value)})},0,!0)})})}var Be=L(3670),Ie=L(8239),ke=L(1144),Fe=L(6495),K=L(2206),re=L(4532),ge=L(3260);function Ve(Te,Je){return Je?function me(Te,Je){if(null!=Te){if((0,Be.c)(Te))return function oe(Te,Je){return(0,m.Xf)(Te).pipe((0,F.R)(Je),(0,J.Q)(Je))}(Te,Je);if((0,ke.z)(Te))return function se(Te,Je){return new he.y(Ge=>{let ht=0;return Je.schedule(function(){ht===Te.length?Ge.complete():(Ge.next(Te[ht++]),Ge.closed||this.schedule())})})}(Te,Je);if((0,Ie.t)(Te))return function ie(Te,Je){return(0,m.Xf)(Te).pipe((0,F.R)(Je),(0,J.Q)(Je))}(Te,Je);if((0,K.D)(Te))return ee(Te,Je);if((0,Fe.T)(Te))return function q(Te,Je){return new he.y(Ge=>{let ht;return(0,H.f)(Ge,Je,()=>{ht=Te[ae.h](),(0,H.f)(Ge,Je,()=>{let X,pe;try{({value:X,done:pe}=ht.next())}catch(_e){return void Ge.error(_e)}pe?Ge.complete():Ge.next(X)},0,!0)}),()=>(0,ue.m)(null==ht?void 0:ht.return)&&ht.return()})}(Te,Je);if((0,ge.L)(Te))return function be(Te,Je){return ee((0,ge.Q)(Te),Je)}(Te,Je)}throw(0,re.z)(Te)}(Te,Je):(0,m.Xf)(Te)}},8421:(rt,Ee,L)=>{"use strict";L.d(Ee,{Xf:()=>Be});var m=L(5987),J=L(1144),F=L(8239),oe=L(8306),ie=L(3670),he=L(2206),se=L(4532),ae=L(6495),ue=L(3260),H=L(576),q=L(7849),ee=L(8822);function Be(me){if(me instanceof oe.y)return me;if(null!=me){if((0,ie.c)(me))return function Ie(me){return new oe.y(Ve=>{const Te=me[ee.L]();if((0,H.m)(Te.subscribe))return Te.subscribe(Ve);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(me);if((0,J.z)(me))return function ke(me){return new oe.y(Ve=>{for(let Te=0;Te<me.length&&!Ve.closed;Te++)Ve.next(me[Te]);Ve.complete()})}(me);if((0,F.t)(me))return function Fe(me){return new oe.y(Ve=>{me.then(Te=>{Ve.closed||(Ve.next(Te),Ve.complete())},Te=>Ve.error(Te)).then(null,q.h)})}(me);if((0,he.D)(me))return re(me);if((0,ae.T)(me))return function K(me){return new oe.y(Ve=>{for(const Te of me)if(Ve.next(Te),Ve.closed)return;Ve.complete()})}(me);if((0,ue.L)(me))return function ge(me){return re((0,ue.Q)(me))}(me)}throw(0,se.z)(me)}function re(me){return new oe.y(Ve=>{(function be(me,Ve){var Te,Je,Ge,ht;return(0,m.mG)(this,void 0,void 0,function*(){try{for(Te=(0,m.KL)(me);!(Je=yield Te.next()).done;)if(Ve.next(Je.value),Ve.closed)return}catch(X){Ge={error:X}}finally{try{Je&&!Je.done&&(ht=Te.return)&&(yield ht.call(Te))}finally{if(Ge)throw Ge.error}}Ve.complete()})})(me,Ve).catch(Te=>Ve.error(Te))})}},6451:(rt,Ee,L)=>{"use strict";L.d(Ee,{T:()=>he});var m=L(8189),J=L(8421),F=L(515),oe=L(7669),ie=L(8996);function he(...se){const ae=(0,oe.yG)(se),ue=(0,oe._6)(se,1/0),H=se;return H.length?1===H.length?(0,J.Xf)(H[0]):(0,m.J)(ue)((0,ie.D)(H,ae)):F.E}},5403:(rt,Ee,L)=>{"use strict";L.d(Ee,{Q:()=>J});var m=L(930);class J extends m.Lv{constructor(oe,ie,he,se,ae){super(oe),this.onFinalize=ae,this._next=ie?function(ue){try{ie(ue)}catch(H){oe.error(H)}}:super._next,this._error=se?function(ue){try{se(ue)}catch(H){oe.error(H)}finally{this.unsubscribe()}}:super._error,this._complete=he?function(){try{he()}catch(ue){oe.error(ue)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var oe;const{closed:ie}=this;super.unsubscribe(),!ie&&(null===(oe=this.onFinalize)||void 0===oe||oe.call(this))}}},4004:(rt,Ee,L)=>{"use strict";L.d(Ee,{U:()=>F});var m=L(4482),J=L(5403);function F(oe,ie){return(0,m.e)((he,se)=>{let ae=0;he.subscribe(new J.Q(se,ue=>{se.next(oe.call(ie,ue,ae++))}))})}},8189:(rt,Ee,L)=>{"use strict";L.d(Ee,{J:()=>F});var m=L(5577),J=L(4671);function F(oe=1/0){return(0,m.z)(J.y,oe)}},5577:(rt,Ee,L)=>{"use strict";L.d(Ee,{z:()=>ae});var m=L(4004),J=L(8421),F=L(4482),oe=L(9672),ie=L(5403),se=L(576);function ae(ue,H,q=1/0){return(0,se.m)(H)?ae((ee,Be)=>(0,m.U)((Ie,ke)=>H(ee,Ie,Be,ke))((0,J.Xf)(ue(ee,Be))),q):("number"==typeof H&&(q=H),(0,F.e)((ee,Be)=>function he(ue,H,q,ee,Be,Ie,ke,Fe){const K=[];let re=0,ge=0,be=!1;const me=()=>{be&&!K.length&&!re&&H.complete()},Ve=Je=>re<ee?Te(Je):K.push(Je),Te=Je=>{Ie&&H.next(Je),re++;let Ge=!1;(0,J.Xf)(q(Je,ge++)).subscribe(new ie.Q(H,ht=>{null==Be||Be(ht),Ie?Ve(ht):H.next(ht)},()=>{Ge=!0},void 0,()=>{if(Ge)try{for(re--;K.length&&re<ee;){const ht=K.shift();ke?(0,oe.f)(H,ke,()=>Te(ht)):Te(ht)}me()}catch(ht){H.error(ht)}}))};return ue.subscribe(new ie.Q(H,Ve,()=>{be=!0,me()})),()=>{null==Fe||Fe()}}(ee,Be,ue,q)))}},5363:(rt,Ee,L)=>{"use strict";L.d(Ee,{Q:()=>oe});var m=L(9672),J=L(4482),F=L(5403);function oe(ie,he=0){return(0,J.e)((se,ae)=>{se.subscribe(new F.Q(ae,ue=>(0,m.f)(ae,ie,()=>ae.next(ue),he),()=>(0,m.f)(ae,ie,()=>ae.complete(),he),ue=>(0,m.f)(ae,ie,()=>ae.error(ue),he)))})}},3099:(rt,Ee,L)=>{"use strict";L.d(Ee,{B:()=>he});var m=L(8996),J=L(5698),F=L(7579),oe=L(930),ie=L(4482);function he(ae={}){const{connector:ue=(()=>new F.x),resetOnError:H=!0,resetOnComplete:q=!0,resetOnRefCountZero:ee=!0}=ae;return Be=>{let Ie=null,ke=null,Fe=null,K=0,re=!1,ge=!1;const be=()=>{null==ke||ke.unsubscribe(),ke=null},me=()=>{be(),Ie=Fe=null,re=ge=!1},Ve=()=>{const Te=Ie;me(),null==Te||Te.unsubscribe()};return(0,ie.e)((Te,Je)=>{K++,!ge&&!re&&be();const Ge=Fe=null!=Fe?Fe:ue();Je.add(()=>{K--,0===K&&!ge&&!re&&(ke=se(Ve,ee))}),Ge.subscribe(Je),Ie||(Ie=new oe.Hp({next:ht=>Ge.next(ht),error:ht=>{ge=!0,be(),ke=se(me,H,ht),Ge.error(ht)},complete:()=>{re=!0,be(),ke=se(me,q),Ge.complete()}}),(0,m.D)(Te).subscribe(Ie))})(Be)}}function se(ae,ue,...H){return!0===ue?(ae(),null):!1===ue?null:ue(...H).pipe((0,J.q)(1)).subscribe(()=>ae())}},9468:(rt,Ee,L)=>{"use strict";L.d(Ee,{R:()=>J});var m=L(4482);function J(F,oe=0){return(0,m.e)((ie,he)=>{he.add(F.schedule(()=>ie.subscribe(he),oe))})}},5698:(rt,Ee,L)=>{"use strict";L.d(Ee,{q:()=>oe});var m=L(515),J=L(4482),F=L(5403);function oe(ie){return ie<=0?()=>m.E:(0,J.e)((he,se)=>{let ae=0;he.subscribe(new F.Q(se,ue=>{++ae<=ie&&(se.next(ue),ie<=ae&&se.complete())}))})}},8505:(rt,Ee,L)=>{"use strict";L.d(Ee,{b:()=>ie});var m=L(576),J=L(4482),F=L(5403),oe=L(4671);function ie(he,se,ae){const ue=(0,m.m)(he)||se||ae?{next:he,error:se,complete:ae}:he;return ue?(0,J.e)((H,q)=>{var ee;null===(ee=ue.subscribe)||void 0===ee||ee.call(ue);let Be=!0;H.subscribe(new F.Q(q,Ie=>{var ke;null===(ke=ue.next)||void 0===ke||ke.call(ue,Ie),q.next(Ie)},()=>{var Ie;Be=!1,null===(Ie=ue.complete)||void 0===Ie||Ie.call(ue),q.complete()},Ie=>{var ke;Be=!1,null===(ke=ue.error)||void 0===ke||ke.call(ue,Ie),q.error(Ie)},()=>{var Ie,ke;Be&&(null===(Ie=ue.unsubscribe)||void 0===Ie||Ie.call(ue)),null===(ke=ue.finalize)||void 0===ke||ke.call(ue)}))}):oe.y}},4408:(rt,Ee,L)=>{"use strict";L.d(Ee,{o:()=>ie});var m=L(727);class J extends m.w0{constructor(se,ae){super()}schedule(se,ae=0){return this}}const F={setInterval(...he){const{delegate:se}=F;return((null==se?void 0:se.setInterval)||setInterval)(...he)},clearInterval(he){const{delegate:se}=F;return((null==se?void 0:se.clearInterval)||clearInterval)(he)},delegate:void 0};var oe=L(8737);class ie extends J{constructor(se,ae){super(se,ae),this.scheduler=se,this.work=ae,this.pending=!1}schedule(se,ae=0){if(this.closed)return this;this.state=se;const ue=this.id,H=this.scheduler;return null!=ue&&(this.id=this.recycleAsyncId(H,ue,ae)),this.pending=!0,this.delay=ae,this.id=this.id||this.requestAsyncId(H,this.id,ae),this}requestAsyncId(se,ae,ue=0){return F.setInterval(se.flush.bind(se,this),ue)}recycleAsyncId(se,ae,ue=0){if(null!=ue&&this.delay===ue&&!1===this.pending)return ae;F.clearInterval(ae)}execute(se,ae){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ue=this._execute(se,ae);if(ue)return ue;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(se,ae){let H,ue=!1;try{this.work(se)}catch(q){ue=!0,H=q||new Error("Scheduled action threw falsy error")}if(ue)return this.unsubscribe(),H}unsubscribe(){if(!this.closed){const{id:se,scheduler:ae}=this,{actions:ue}=ae;this.work=this.state=this.scheduler=null,this.pending=!1,(0,oe.P)(ue,this),null!=se&&(this.id=this.recycleAsyncId(ae,se,null)),this.delay=null,super.unsubscribe()}}}},7565:(rt,Ee,L)=>{"use strict";L.d(Ee,{v:()=>F});var m=L(6063);class J{constructor(ie,he=J.now){this.schedulerActionCtor=ie,this.now=he}schedule(ie,he=0,se){return new this.schedulerActionCtor(this,ie).schedule(se,he)}}J.now=m.l.now;class F extends J{constructor(ie,he=J.now){super(ie,he),this.actions=[],this._active=!1,this._scheduled=void 0}flush(ie){const{actions:he}=this;if(this._active)return void he.push(ie);let se;this._active=!0;do{if(se=ie.execute(ie.state,ie.delay))break}while(ie=he.shift());if(this._active=!1,se){for(;ie=he.shift();)ie.unsubscribe();throw se}}}},4986:(rt,Ee,L)=>{"use strict";L.d(Ee,{z:()=>F});var m=L(4408);const F=new(L(7565).v)(m.o)},6063:(rt,Ee,L)=>{"use strict";L.d(Ee,{l:()=>m});const m={now:()=>(m.delegate||Date).now(),delegate:void 0}},3410:(rt,Ee,L)=>{"use strict";L.d(Ee,{z:()=>m});const m={setTimeout(...J){const{delegate:F}=m;return((null==F?void 0:F.setTimeout)||setTimeout)(...J)},clearTimeout(J){const{delegate:F}=m;return((null==F?void 0:F.clearTimeout)||clearTimeout)(J)},delegate:void 0}},2202:(rt,Ee,L)=>{"use strict";L.d(Ee,{h:()=>J});const J=function m(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(rt,Ee,L)=>{"use strict";L.d(Ee,{L:()=>m});const m="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(rt,Ee,L)=>{"use strict";L.d(Ee,{_6:()=>he,jO:()=>oe,yG:()=>ie});var m=L(576);function F(se){return se[se.length-1]}function oe(se){return(0,m.m)(F(se))?se.pop():void 0}function ie(se){return function J(se){return se&&(0,m.m)(se.schedule)}(F(se))?se.pop():void 0}function he(se,ae){return"number"==typeof F(se)?se.pop():ae}},8737:(rt,Ee,L)=>{"use strict";function m(J,F){if(J){const oe=J.indexOf(F);0<=oe&&J.splice(oe,1)}}L.d(Ee,{P:()=>m})},3888:(rt,Ee,L)=>{"use strict";function m(J){const oe=J(ie=>{Error.call(ie),ie.stack=(new Error).stack});return oe.prototype=Object.create(Error.prototype),oe.prototype.constructor=oe,oe}L.d(Ee,{d:()=>m})},2806:(rt,Ee,L)=>{"use strict";L.d(Ee,{x:()=>F,O:()=>oe});var m=L(2416);let J=null;function F(ie){if(m.v.useDeprecatedSynchronousErrorHandling){const he=!J;if(he&&(J={errorThrown:!1,error:null}),ie(),he){const{errorThrown:se,error:ae}=J;if(J=null,se)throw ae}}else ie()}function oe(ie){m.v.useDeprecatedSynchronousErrorHandling&&J&&(J.errorThrown=!0,J.error=ie)}},9672:(rt,Ee,L)=>{"use strict";function m(J,F,oe,ie=0,he=!1){const se=F.schedule(function(){oe(),he?J.add(this.schedule(null,ie)):this.unsubscribe()},ie);if(J.add(se),!he)return se}L.d(Ee,{f:()=>m})},4671:(rt,Ee,L)=>{"use strict";function m(J){return J}L.d(Ee,{y:()=>m})},1144:(rt,Ee,L)=>{"use strict";L.d(Ee,{z:()=>m});const m=J=>J&&"number"==typeof J.length&&"function"!=typeof J},2206:(rt,Ee,L)=>{"use strict";L.d(Ee,{D:()=>J});var m=L(576);function J(F){return Symbol.asyncIterator&&(0,m.m)(null==F?void 0:F[Symbol.asyncIterator])}},576:(rt,Ee,L)=>{"use strict";function m(J){return"function"==typeof J}L.d(Ee,{m:()=>m})},3670:(rt,Ee,L)=>{"use strict";L.d(Ee,{c:()=>F});var m=L(8822),J=L(576);function F(oe){return(0,J.m)(oe[m.L])}},6495:(rt,Ee,L)=>{"use strict";L.d(Ee,{T:()=>F});var m=L(2202),J=L(576);function F(oe){return(0,J.m)(null==oe?void 0:oe[m.h])}},8239:(rt,Ee,L)=>{"use strict";L.d(Ee,{t:()=>J});var m=L(576);function J(F){return(0,m.m)(null==F?void 0:F.then)}},3260:(rt,Ee,L)=>{"use strict";L.d(Ee,{Q:()=>F,L:()=>oe});var m=L(5987),J=L(576);function F(ie){return(0,m.FC)(this,arguments,function*(){const se=ie.getReader();try{for(;;){const{value:ae,done:ue}=yield(0,m.qq)(se.read());if(ue)return yield(0,m.qq)(void 0);yield yield(0,m.qq)(ae)}}finally{se.releaseLock()}})}function oe(ie){return(0,J.m)(null==ie?void 0:ie.getReader)}},4482:(rt,Ee,L)=>{"use strict";L.d(Ee,{A:()=>J,e:()=>F});var m=L(576);function J(oe){return(0,m.m)(null==oe?void 0:oe.lift)}function F(oe){return ie=>{if(J(ie))return ie.lift(function(he){try{return oe(he,this)}catch(se){this.error(se)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(rt,Ee,L)=>{"use strict";function m(){}L.d(Ee,{Z:()=>m})},7849:(rt,Ee,L)=>{"use strict";L.d(Ee,{h:()=>F});var m=L(2416),J=L(3410);function F(oe){J.z.setTimeout(()=>{const{onUnhandledError:ie}=m.v;if(!ie)throw oe;ie(oe)})}},4532:(rt,Ee,L)=>{"use strict";function m(J){return new TypeError(`You provided ${null!==J&&"object"==typeof J?"an invalid object":`'${J}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}L.d(Ee,{z:()=>m})},5987:(rt,Ee,L)=>{"use strict";function ae(X,pe,_e,we){return new(_e||(_e=Promise))(function(de,Dt){function Ft(nt){try{ot(we.next(nt))}catch(Lr){Dt(Lr)}}function jn(nt){try{ot(we.throw(nt))}catch(Lr){Dt(Lr)}}function ot(nt){nt.done?de(nt.value):function Me(de){return de instanceof _e?de:new _e(function(Dt){Dt(de)})}(nt.value).then(Ft,jn)}ot((we=we.apply(X,pe||[])).next())})}function K(X){return this instanceof K?(this.v=X,this):new K(X)}function re(X,pe,_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Me,we=_e.apply(X,pe||[]),de=[];return Me={},Dt("next"),Dt("throw"),Dt("return"),Me[Symbol.asyncIterator]=function(){return this},Me;function Dt(en){we[en]&&(Me[en]=function(Dr){return new Promise(function(Zt,Ti){de.push([en,Dr,Zt,Ti])>1||Ft(en,Dr)})})}function Ft(en,Dr){try{!function jn(en){en.value instanceof K?Promise.resolve(en.value.v).then(ot,nt):Lr(de[0][2],en)}(we[en](Dr))}catch(Zt){Lr(de[0][3],Zt)}}function ot(en){Ft("next",en)}function nt(en){Ft("throw",en)}function Lr(en,Dr){en(Dr),de.shift(),de.length&&Ft(de[0][0],de[0][1])}}function be(X){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _e,pe=X[Symbol.asyncIterator];return pe?pe.call(X):(X=function ee(X){var pe="function"==typeof Symbol&&Symbol.iterator,_e=pe&&X[pe],we=0;if(_e)return _e.call(X);if(X&&"number"==typeof X.length)return{next:function(){return X&&we>=X.length&&(X=void 0),{value:X&&X[we++],done:!X}}};throw new TypeError(pe?"Object is not iterable.":"Symbol.iterator is not defined.")}(X),_e={},we("next"),we("throw"),we("return"),_e[Symbol.asyncIterator]=function(){return this},_e);function we(de){_e[de]=X[de]&&function(Dt){return new Promise(function(Ft,jn){!function Me(de,Dt,Ft,jn){Promise.resolve(jn).then(function(ot){de({value:ot,done:Ft})},Dt)}(Ft,jn,(Dt=X[de](Dt)).done,Dt.value)})}}}L.d(Ee,{mG:()=>ae,qq:()=>K,FC:()=>re,KL:()=>be})},5e3:(rt,Ee,L)=>{"use strict";L.d(Ee,{deG:()=>Yo,tb:()=>Xm,AFp:()=>Rw,ip1:()=>Aw,CZH:()=>Uc,hGG:()=>Ro,z2F:()=>jc,sBO:()=>xS,Sil:()=>Bc,_Vd:()=>Pc,EJc:()=>ks,SBq:()=>Ih,qLn:()=>gc,vpe:()=>Co,tBr:()=>Yn,XFs:()=>Xe,OlP:()=>Wt,zs3:()=>us,ZZ4:()=>d_,aQg:()=>ng,soG:()=>pu,YKP:()=>ow,h0i:()=>cs,PXZ:()=>Lw,R0b:()=>yi,FiY:()=>on,Lbi:()=>Yp,g9A:()=>Kp,Qsj:()=>oS,FYo:()=>_b,JOm:()=>xr,tp0:()=>ji,Rgc:()=>$p,dDg:()=>Vc,q4F:()=>iw,GfV:()=>jm,s_b:()=>xh,ifc:()=>At,eFA:()=>Fw,G48:()=>s_,X6Q:()=>Or,_c5:()=>BS,VLi:()=>Qp,c2e:()=>e_,zSh:()=>Uy,wAp:()=>mt,vHH:()=>ke,cg1:()=>Am,kL8:()=>qI,dqk:()=>ft,sIi:()=>gp,CqO:()=>wD,QGY:()=>wm,F4k:()=>pv,RDi:()=>sd,AaK:()=>ae,TTD:()=>Ea,xp6:()=>tE,uIk:()=>Yy,Suo:()=>Pb,Xpm:()=>Hn,lG2:()=>Eu,Yz7:()=>Zt,cJS:()=>Ki,oAB:()=>Us,Yjl:()=>ho,Y36:()=>ah,_UZ:()=>uI,qZA:()=>cv,TgZ:()=>vm,EpF:()=>fv,LFG:()=>Z,$8M:()=>vn,$Z:()=>aI,NdJ:()=>cI,CRH:()=>yw,oxw:()=>fI,ALo:()=>jp,lcZ:()=>fw,Q6J:()=>uv,iGM:()=>bS,MAs:()=>yp,CHM:()=>Du,LSH:()=>Ku,YNc:()=>To,W1O:()=>ww,_uU:()=>PI,hij:()=>lh});var m=L(7579),J=L(727),F=L(8306),oe=L(6451),ie=L(3099);function he(s){for(let o in s)if(s[o]===he)return o;throw Error("Could not find renamed property on target object.")}function ae(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(ae).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const a=o.indexOf("\n");return-1===a?o:o.substring(0,a)}function ue(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const H=he({__forward_ref__:he});function q(s){return s.__forward_ref__=q,s.toString=function(){return ae(this())},s}function ee(s){return function Be(s){return"function"==typeof s&&s.hasOwnProperty(H)&&s.__forward_ref__===q}(s)?s():s}class ke extends Error{constructor(o,a){super(function Fe(s,o){return`NG0${Math.abs(s)}${o?": "+o:""}`}(o,a)),this.code=o}}function K(s){return"string"==typeof s?s:null==s?"":String(s)}function re(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():K(s)}function Ve(s,o){const a=o?` in ${o}`:"";throw new ke(-201,`No provider for ${re(s)} found${a}`)}function ot(s,o){null==s&&function nt(s,o,a,l){throw new Error(`ASSERTION ERROR: ${s}`+(null==l?"":` [Expected=> ${a} ${l} ${o} <=Actual]`))}(o,s,null,"!=")}function Zt(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Ki(s){return{providers:s.providers||[],imports:s.imports||[]}}function Dn(s){return Ci(s,Kr)||Ci(s,Ae)}function Ci(s,o){return s.hasOwnProperty(o)?s[o]:null}function lo(s){return s&&(s.hasOwnProperty(fs)||s.hasOwnProperty(pr))?s[fs]:null}const Kr=he({\u0275prov:he}),fs=he({\u0275inj:he}),Ae=he({ngInjectableDef:he}),pr=he({ngInjectorDef:he});var Xe=(()=>((Xe=Xe||{})[Xe.Default=0]="Default",Xe[Xe.Host=1]="Host",Xe[Xe.Self=2]="Self",Xe[Xe.SkipSelf=4]="SkipSelf",Xe[Xe.Optional=8]="Optional",Xe))();let hi;function $n(s){const o=hi;return hi=s,o}function Fs(s,o,a){const l=Dn(s);return l&&"root"==l.providedIn?void 0===l.value?l.value=l.factory():l.value:a&Xe.Optional?null:void 0!==o?o:void Ve(ae(s),"Injector")}function tt(s){return{toString:s}.toString()}var St=(()=>((St=St||{})[St.OnPush=0]="OnPush",St[St.Default=1]="Default",St))(),At=(()=>{return(s=At||(At={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",At;var s})();const et="undefined"!=typeof globalThis&&globalThis,ut="undefined"!=typeof window&&window,xl="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ft=et||"undefined"!=typeof global&&global||ut||xl,ps={},j=[],W=he({\u0275cmp:he}),G=he({\u0275dir:he}),ve=he({\u0275pipe:he}),te=he({\u0275mod:he}),$e=he({\u0275fac:he}),yt=he({__NG_ELEMENT_ID__:he});let cn=0;function Hn(s){return tt(()=>{const a={},l={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:a,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===St.OnPush,directiveDefs:null,pipeDefs:null,selectors:s.selectors||j,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||At.Emulated,id:"c",styles:s.styles||j,_:null,setInput:null,schemas:s.schemas||null,tView:null},d=s.directives,g=s.features,v=s.pipes;return l.id+=cn++,l.inputs=Po(s.inputs,a),l.outputs=Po(s.outputs),g&&g.forEach(E=>E(l)),l.directiveDefs=d?()=>("function"==typeof d?d():d).map(Br):null,l.pipeDefs=v?()=>("function"==typeof v?v():v).map(Mt):null,l})}function Br(s){return er(s)||function qn(s){return s[G]||null}(s)}function Mt(s){return function Yi(s){return s[ve]||null}(s)}const gr={};function Us(s){return tt(()=>{const o={type:s.type,bootstrap:s.bootstrap||j,declarations:s.declarations||j,imports:s.imports||j,exports:s.exports||j,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null};return null!=s.id&&(gr[s.id]=s.type),o})}function Po(s,o){if(null==s)return ps;const a={};for(const l in s)if(s.hasOwnProperty(l)){let d=s[l],g=d;Array.isArray(d)&&(g=d[1],d=d[0]),a[d]=l,o&&(o[d]=g)}return a}const Eu=Hn;function ho(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,onDestroy:s.type.prototype.ngOnDestroy||null}}function er(s){return s[W]||null}function tr(s,o){const a=s[te]||null;if(!a&&!0===o)throw new Error(`Type ${ae(s)} does not have '\u0275mod' property.`);return a}function Ai(s){return Array.isArray(s)&&"object"==typeof s[1]}function Ri(s){return Array.isArray(s)&&!0===s[1]}function Kc(s){return 0!=(8&s.flags)}function Ln(s){return 2==(2&s.flags)}function gs(s){return 1==(1&s.flags)}function Xi(s){return null!==s.template}function Yc(s){return 0!=(512&s[2])}function mo(s,o){return s.hasOwnProperty($e)?s[$e]:null}class Iu{constructor(o,a,l){this.previousValue=o,this.currentValue=a,this.firstChange=l}isFirstChange(){return this.firstChange}}function Ea(){return _o}function _o(s){return s.type.prototype.ngOnChanges&&(s.setInput=Vs),Ia}function Ia(){const s=rd(this),o=null==s?void 0:s.current;if(o){const a=s.previous;if(a===ps)s.previous=o;else for(let l in o)a[l]=o[l];s.current=null,this.ngOnChanges(o)}}function Vs(s,o,a,l){const d=rd(s)||function Ar(s,o){return s[bu]=o}(s,{previous:ps,current:null}),g=d.current||(d.current={}),v=d.previous,E=this.declaredInputs[a],b=v[E];g[E]=new Iu(b&&b.currentValue,o,v===ps),s[l]=o}Ea.ngInherit=!0;const bu="__ngSimpleChanges__";function rd(s){return s[bu]||null}let Tu;function sd(s){Tu=s}function zt(s){return!!s.listen}const js={createRenderer:(s,o)=>function Ul(){return void 0!==Tu?Tu:"undefined"!=typeof document?document:void 0}()};function nn(s){for(;Array.isArray(s);)s=s[0];return s}function Fn(s,o){return nn(o[s.index])}function Fo(s,o){return s.data[o]}function es(s,o){return s[o]}function $r(s,o){const a=o[s];return Ai(a)?a:a[0]}function zn(s){return 4==(4&s[2])}function ts(s){return 128==(128&s[2])}function Hr(s,o){return null==o?null:s[o]}function $s(s){s[18]=0}function Uo(s,o){s[5]+=o;let a=s,l=s[3];for(;null!==l&&(1===o&&1===a[5]||-1===o&&0===a[5]);)l[5]+=o,a=l,l=l[3]}const pt={lFrame:Pa(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Vo(){return pt.bindingsEnabled}function De(){return pt.lFrame.lView}function Pt(){return pt.lFrame.tView}function Du(s){return pt.lFrame.contextLView=s,s[8]}function rn(){let s=yo();for(;null!==s&&64===s.type;)s=s.parent;return s}function yo(){return pt.lFrame.currentTNode}function Jr(s,o){const a=pt.lFrame;a.currentTNode=s,a.isParent=o}function _s(){return pt.lFrame.isParent}function jo(){return pt.isInCheckNoChangesMode}function Da(s){pt.isInCheckNoChangesMode=s}function ys(){return pt.lFrame.bindingIndex++}function Pu(s,o){const a=pt.lFrame;a.bindingIndex=a.bindingRootIndex=s,Ho(o)}function Ho(s){pt.lFrame.currentDirectiveIndex=s}function Ra(){return pt.lFrame.currentQueryIndex}function xa(s){pt.lFrame.currentQueryIndex=s}function jl(s){const o=s[1];return 2===o.type?o.declTNode:1===o.type?s[6]:null}function $l(s,o,a){if(a&Xe.SkipSelf){let d=o,g=s;for(;!(d=d.parent,null!==d||a&Xe.Host||(d=jl(g),null===d||(g=g[15],10&d.type))););if(null===d)return!1;o=d,s=g}const l=pt.lFrame=ld();return l.currentTNode=o,l.lView=s,!0}function qo(s){const o=ld(),a=s[1];pt.lFrame=o,o.currentTNode=a.firstChild,o.lView=s,o.tView=a,o.contextLView=s,o.bindingIndex=a.bindingStartIndex,o.inI18n=!1}function ld(){const s=pt.lFrame,o=null===s?null:s.child;return null===o?Pa(s):o}function Pa(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function Hl(){const s=pt.lFrame;return pt.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const ka=Hl;function ku(){const s=Hl();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function ir(){return pt.lFrame.selectedIndex}function Un(s){pt.lFrame.selectedIndex=s}function _n(){const s=pt.lFrame;return Fo(s.tView,s.selectedIndex)}function Wl(s,o){for(let a=o.directiveStart,l=o.directiveEnd;a<l;a++){const g=s.data[a].type.prototype,{ngAfterContentInit:v,ngAfterContentChecked:E,ngAfterViewInit:b,ngAfterViewChecked:R,ngOnDestroy:P}=g;v&&(s.contentHooks||(s.contentHooks=[])).push(-a,v),E&&((s.contentHooks||(s.contentHooks=[])).push(a,E),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(a,E)),b&&(s.viewHooks||(s.viewHooks=[])).push(-a,b),R&&((s.viewHooks||(s.viewHooks=[])).push(a,R),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(a,R)),null!=P&&(s.destroyHooks||(s.destroyHooks=[])).push(a,P)}}function qs(s,o,a){pf(s,o,3,a)}function Mu(s,o,a,l){(3&s[2])===a&&pf(s,o,a,l)}function Nu(s,o){let a=s[2];(3&a)===o&&(a&=2047,a+=1,s[2]=a)}function pf(s,o,a,l){const g=null!=l?l:-1,v=o.length-1;let E=0;for(let b=void 0!==l?65535&s[18]:0;b<v;b++)if("number"==typeof o[b+1]){if(E=o[b],null!=l&&E>=l)break}else o[b]<0&&(s[18]+=65536),(E<g||-1==g)&&(hd(s,a,o,b),s[18]=(4294901760&s[18])+b+2),b++}function hd(s,o,a,l){const d=a[l]<0,g=a[l+1],E=s[d?-a[l]:a[l]];if(d){if(s[2]>>11<s[18]>>16&&(3&s[2])===o){s[2]+=2048;try{g.call(E)}finally{}}}else try{g.call(E)}finally{}}class yn{constructor(o,a,l){this.factory=o,this.resolving=!1,this.canSeeViewProviders=a,this.injectImpl=l}}function Gl(s,o,a){const l=zt(s);let d=0;for(;d<a.length;){const g=a[d];if("number"==typeof g){if(0!==g)break;d++;const v=a[d++],E=a[d++],b=a[d++];l?s.setAttribute(o,E,b,v):o.setAttributeNS(v,E,b)}else{const v=g,E=a[++d];Ws(v)?l&&s.setProperty(o,v,E):l?s.setAttribute(o,v,E):o.setAttribute(v,E),d++}}return d}function sn(s){return 3===s||4===s||6===s}function Ws(s){return 64===s.charCodeAt(0)}function Ke(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let a=-1;for(let l=0;l<o.length;l++){const d=o[l];"number"==typeof d?a=d:0===a||Gs(s,a,d,null,-1===a||2===a?o[++l]:null)}}return s}function Gs(s,o,a,l,d){let g=0,v=s.length;if(-1===o)v=-1;else for(;g<s.length;){const E=s[g++];if("number"==typeof E){if(E===o){v=-1;break}if(E>o){v=g-1;break}}}for(;g<s.length;){const E=s[g];if("number"==typeof E)break;if(E===a){if(null===l)return void(null!==d&&(s[g+1]=d));if(l===s[g+1])return void(s[g+2]=d)}g++,null!==l&&g++,null!==d&&g++}-1!==v&&(s.splice(v,0,o),g=v+1),s.splice(g++,0,a),null!==l&&s.splice(g++,0,l),null!==d&&s.splice(g++,0,d)}function Ni(s){return-1!==s}function sr(s){return 32767&s}function La(s,o){let a=function mf(s){return s>>16}(s),l=o;for(;a>0;)l=l[15],a--;return l}let gd=!0;function Fa(s){const o=gd;return gd=s,o}let vt=0;function Ua(s,o){const a=Ba(s,o);if(-1!==a)return a;const l=o[1];l.firstCreatePass&&(s.injectorIndex=o.length,Zl(l.data,s),Zl(o,null),Zl(l.blueprint,null));const d=dn(s,o),g=s.injectorIndex;if(Ni(d)){const v=sr(d),E=La(d,o),b=E[1].data;for(let R=0;R<8;R++)o[g+R]=E[v+R]|b[v+R]}return o[g+8]=d,g}function Zl(s,o){s.push(0,0,0,0,0,0,0,0,o)}function Ba(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function dn(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let a=0,l=null,d=o;for(;null!==d;){const g=d[1],v=g.type;if(l=2===v?g.declTNode:1===v?d[6]:null,null===l)return-1;if(a++,d=d[15],-1!==l.injectorIndex)return l.injectorIndex|a<<16}return-1}function Lu(s,o,a){!function _f(s,o,a){let l;"string"==typeof a?l=a.charCodeAt(0)||0:a.hasOwnProperty(yt)&&(l=a[yt]),null==l&&(l=a[yt]=vt++);const d=255&l;o.data[s+(d>>5)]|=1<<d}(s,o,a)}function zl(s,o,a){if(a&Xe.Optional)return s;Ve(o,"NodeInjector")}function Oi(s,o,a,l){if(a&Xe.Optional&&void 0===l&&(l=null),0==(a&(Xe.Self|Xe.Host))){const d=s[9],g=$n(void 0);try{return d?d.get(o,l,a&Xe.Optional):Fs(o,l,a&Xe.Optional)}finally{$n(g)}}return zl(l,o,a)}function Kl(s,o,a,l=Xe.Default,d){if(null!==s){const g=function Fu(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(yt)?s[yt]:void 0;return"number"==typeof o?o>=0?255&o:Zo:o}(a);if("function"==typeof g){if(!$l(o,s,l))return l&Xe.Host?zl(d,a,l):Oi(o,a,l,d);try{const v=g(l);if(null!=v||l&Xe.Optional)return v;Ve(a)}finally{ka()}}else if("number"==typeof g){let v=null,E=Ba(s,o),b=-1,R=l&Xe.Host?o[16][6]:null;for((-1===E||l&Xe.SkipSelf)&&(b=-1===E?dn(s,o):o[E+8],-1!==b&&vo(l,!1)?(v=o[1],E=sr(b),o=La(b,o)):E=-1);-1!==E;){const P=o[1];if(Ko(g,E,P.data)){const U=Va(E,o,a,v,l,R);if(U!==Go)return U}b=o[E+8],-1!==b&&vo(l,o[1].data[E+8]===R)&&Ko(g,E,o)?(v=P,E=sr(b),o=La(b,o)):E=-1}}}return Oi(o,a,l,d)}const Go={};function Zo(){return new En(rn(),De())}function Va(s,o,a,l,d,g){const v=o[1],E=v.data[s+8],P=zo(E,v,a,null==l?Ln(E)&&gd:l!=v&&0!=(3&E.type),d&Xe.Host&&g===E);return null!==P?Bn(o,v,P,E):Go}function zo(s,o,a,l,d){const g=s.providerIndexes,v=o.data,E=1048575&g,b=s.directiveStart,P=g>>20,N=d?E+P:s.directiveEnd;for(let Y=l?E:E+P;Y<N;Y++){const ce=v[Y];if(Y<b&&a===ce||Y>=b&&ce.type===a)return Y}if(d){const Y=v[b];if(Y&&Xi(Y)&&Y.type===a)return b}return null}function Bn(s,o,a,l){let d=s[a];const g=o.data;if(function gf(s){return s instanceof yn}(d)){const v=d;v.resolving&&function ge(s,o){const a=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new ke(-200,`Circular dependency in DI detected for ${s}${a}`)}(re(g[a]));const E=Fa(v.canSeeViewProviders);v.resolving=!0;const b=v.injectImpl?$n(v.injectImpl):null;$l(s,l,Xe.Default);try{d=s[a]=v.factory(void 0,g,s,l),o.firstCreatePass&&a>=l.directiveStart&&function ff(s,o,a){const{ngOnChanges:l,ngOnInit:d,ngDoCheck:g}=o.type.prototype;if(l){const v=_o(o);(a.preOrderHooks||(a.preOrderHooks=[])).push(s,v),(a.preOrderCheckHooks||(a.preOrderCheckHooks=[])).push(s,v)}d&&(a.preOrderHooks||(a.preOrderHooks=[])).push(0-s,d),g&&((a.preOrderHooks||(a.preOrderHooks=[])).push(s,g),(a.preOrderCheckHooks||(a.preOrderCheckHooks=[])).push(s,g))}(a,g[a],o)}finally{null!==b&&$n(b),Fa(E),v.resolving=!1,ka()}}return d}function Ko(s,o,a){return!!(a[o+(s>>5)]&1<<s)}function vo(s,o){return!(s&Xe.Self||s&Xe.Host&&o)}class En{constructor(o,a){this._tNode=o,this._lView=a}get(o,a,l){return Kl(this._tNode,this._lView,o,l,a)}}function vn(s){return function Wo(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const a=s.attrs;if(a){const l=a.length;let d=0;for(;d<l;){const g=a[d];if(sn(g))break;if(0===g)d+=2;else if("number"==typeof g)for(d++;d<l&&"string"==typeof a[d];)d++;else{if(g===o)return a[d+1];d+=2}}}return null}(rn(),s)}const Li="__parameters__";function Xr(s,o,a){return tt(()=>{const l=function qr(s){return function(...a){if(s){const l=s(...a);for(const d in l)this[d]=l[d]}}}(o);function d(...g){if(this instanceof d)return l.apply(this,g),this;const v=new d(...g);return E.annotation=v,E;function E(b,R,P){const U=b.hasOwnProperty(Li)?b[Li]:Object.defineProperty(b,Li,{value:[]})[Li];for(;U.length<=P;)U.push(null);return(U[P]=U[P]||[]).push(v),b}}return a&&(d.prototype=Object.create(a.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}class Wt{constructor(o,a){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof a?this.__NG_ELEMENT_ID__=a:void 0!==a&&(this.\u0275prov=Zt({token:this,providedIn:a.providedIn||"root",factory:a.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Yo=new Wt("AnalyzeForEntryComponents");function fi(s,o){void 0===o&&(o=s);for(let a=0;a<s.length;a++){let l=s[a];Array.isArray(l)?(o===s&&(o=s.slice(0,a)),fi(l,o)):o!==s&&o.push(l)}return o}function Ui(s,o){s.forEach(a=>Array.isArray(a)?Ui(a,o):o(a))}function yd(s,o,a){o>=s.length?s.push(a):s.splice(o,0,a)}function Ha(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}const wn={},ec="__NG_DI_FLAG__",za="ngTempTokenPath",Bu=/\n/gm,Vu="__source",T=he({provide:String,useValue:he});let C;function k(s){const o=C;return C=s,o}function B(s,o=Xe.Default){if(void 0===C)throw new ke(203,"");return null===C?Fs(s,void 0,o):C.get(s,o&Xe.Optional?null:void 0,o)}function Z(s,o=Xe.Default){return(function Ht(){return hi}()||B)(ee(s),o)}function ze(s){const o=[];for(let a=0;a<s.length;a++){const l=ee(s[a]);if(Array.isArray(l)){if(0===l.length)throw new ke(900,"");let d,g=Xe.Default;for(let v=0;v<l.length;v++){const E=l[v],b=Bt(E);"number"==typeof b?-1===b?d=E.token:g|=b:d=E}o.push(Z(d,g))}else o.push(Z(l))}return o}function je(s,o){return s[ec]=o,s.prototype[ec]=o,s}function Bt(s){return s[ec]}const Yn=je(Xr("Inject",s=>({token:s})),-1),on=je(Xr("Optional"),8),ji=je(Xr("SkipSelf"),4);class ic{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}const J_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Sd=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var hn=(()=>((hn=hn||{})[hn.NONE=0]="NONE",hn[hn.HTML=1]="HTML",hn[hn.STYLE=2]="STYLE",hn[hn.SCRIPT=3]="SCRIPT",hn[hn.URL=4]="URL",hn[hn.RESOURCE_URL=5]="RESOURCE_URL",hn))();function Ku(s){const o=function Qu(){const s=De();return s&&s[12]}();return o?o.sanitize(hn.URL,s)||"":function Ka(s,o){const a=function z_(s){return s instanceof ic&&s.getTypeName()||null}(s);if(null!=a&&a!==o){if("ResourceURL"===a&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${a} (see https://g.co/ng/security#xss)`)}return a===o}(s,"URL")?function Xo(s){return s instanceof ic?s.changingThisBreaksApplicationSecurity:s}(s):function Gu(s){return(s=String(s)).match(J_)||s.match(Sd)?s:"unsafe:"+s}(K(s))}const dc="__ngContext__";function _r(s,o){s[dc]=o}function Vf(s){const o=function Xa(s){return s[dc]||null}(s);return o?Array.isArray(o)?o:o.lView:null}function Hf(s){return s.ngOriginalError}function ea(s,...o){s.error(...o)}class gc{constructor(){this._console=console}handleError(o){const a=this._findOriginalError(o),l=function ay(s){return s&&s.ngErrorLogger||ea}(o);l(this._console,"ERROR",o),a&&l(this._console,"ORIGINAL ERROR",a)}_findOriginalError(o){let a=o&&Hf(o);for(;a&&Hf(a);)a=Hf(a);return a||null}}const Md=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ft))();function bs(s){return s instanceof Function?s():s}var xr=(()=>((xr=xr||{})[xr.Important=1]="Important",xr[xr.DashCase=2]="DashCase",xr))();function Kf(s,o){return undefined(s,o)}function ta(s){const o=s[3];return Ri(o)?o[3]:o}function _c(s){return Ts(s[13])}function yc(s){return Ts(s[4])}function Ts(s){for(;null!==s&&!Ri(s);)s=s[4];return s}function nu(s,o,a,l,d){if(null!=l){let g,v=!1;Ri(l)?g=l:Ai(l)&&(v=!0,l=l[0]);const E=nn(l);0===s&&null!==a?null==d?Tt(o,a,E):Ye(o,a,E,d||null,!0):1===s&&null!==a?Ye(o,a,E,d||null,!0):2===s?function Xg(s,o,a){const l=ru(s,o);l&&function na(s,o,a,l){zt(s)?s.removeChild(o,a,l):o.removeChild(a)}(s,l,o,a)}(o,E,v):3===s&&o.destroyNode(E),null!=g&&function hC(s,o,a,l,d){const g=a[7];g!==nn(a)&&nu(o,s,l,g,d);for(let E=10;E<a.length;E++){const b=a[E];ep(b[1],b,s,o,l,g)}}(o,s,g,a,d)}}function Yf(s,o,a){return zt(s)?s.createElement(o,a):null===a?s.createElement(o):s.createElementNS(a,o)}function w(s,o){const a=s[9],l=a.indexOf(o),d=o[3];1024&o[2]&&(o[2]&=-1025,Uo(d,-1)),a.splice(l,1)}function D(s,o){if(s.length<=10)return;const a=10+o,l=s[a];if(l){const d=l[17];null!==d&&d!==s&&w(d,l),o>0&&(s[a-1][4]=l[4]);const g=Ha(s,10+o);!function my(s,o){ep(s,o,o[11],2,null,null),o[0]=null,o[6]=null}(l[1],l);const v=g[19];null!==v&&v.detachView(g[1]),l[3]=null,l[4]=null,l[2]&=-129}return l}function x(s,o){if(!(256&o[2])){const a=o[11];zt(a)&&a.destroyNode&&ep(s,o,a,3,null,null),function _(s){let o=s[13];if(!o)return $(s[1],s);for(;o;){let a=null;if(Ai(o))a=o[13];else{const l=o[10];l&&(a=l)}if(!a){for(;o&&!o[4]&&o!==s;)Ai(o)&&$(o[1],o),o=o[3];null===o&&(o=s),Ai(o)&&$(o[1],o),a=o&&o[4]}o=a}}(o)}}function $(s,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function Ne(s,o){let a;if(null!=s&&null!=(a=s.destroyHooks))for(let l=0;l<a.length;l+=2){const d=o[a[l]];if(!(d instanceof yn)){const g=a[l+1];if(Array.isArray(g))for(let v=0;v<g.length;v+=2){const E=d[g[v]],b=g[v+1];try{b.call(E)}finally{}}else try{g.call(d)}finally{}}}}(s,o),function ne(s,o){const a=s.cleanup,l=o[7];let d=-1;if(null!==a)for(let g=0;g<a.length-1;g+=2)if("string"==typeof a[g]){const v=a[g+1],E="function"==typeof v?v(o):nn(o[v]),b=l[d=a[g+2]],R=a[g+3];"boolean"==typeof R?E.removeEventListener(a[g],b,R):R>=0?l[d=R]():l[d=-R].unsubscribe(),g+=2}else{const v=l[d=a[g+1]];a[g].call(v)}if(null!==l){for(let g=d+1;g<l.length;g++)l[g]();o[7]=null}}(s,o),1===o[1].type&&zt(o[11])&&o[11].destroy();const a=o[17];if(null!==a&&Ri(o[3])){a!==o[3]&&w(a,o);const l=o[19];null!==l&&l.detachView(s)}}}function xe(s,o,a){return function Qe(s,o,a){let l=o;for(;null!==l&&40&l.type;)l=(o=l).parent;if(null===l)return a[0];if(2&l.flags){const d=s.data[l.directiveStart].encapsulation;if(d===At.None||d===At.Emulated)return null}return Fn(l,a)}(s,o.parent,a)}function Ye(s,o,a,l,d){zt(s)?s.insertBefore(o,a,l,d):o.insertBefore(a,l,d)}function Tt(s,o,a){zt(s)?s.appendChild(o,a):o.appendChild(a)}function Qn(s,o,a,l,d){null!==l?Ye(s,o,a,l,d):Tt(s,o,a)}function ru(s,o){return zt(s)?s.parentNode(o):o.parentNode}let jd=function Jf(s,o,a){return 40&s.type?Fn(s,a):null};function Ju(s,o,a,l){const d=xe(s,l,o),g=o[11],E=function Qf(s,o,a){return jd(s,o,a)}(l.parent||o[6],l,o);if(null!=d)if(Array.isArray(a))for(let b=0;b<a.length;b++)Qn(g,d,a[b],E,!1);else Qn(g,d,a,E,!1)}function wc(s,o){if(null!==o){const a=o.type;if(3&a)return Fn(o,s);if(4&a)return Ec(-1,s[o.index]);if(8&a){const l=o.child;if(null!==l)return wc(s,l);{const d=s[o.index];return Ri(d)?Ec(-1,d):nn(d)}}if(32&a)return Kf(o,s)()||nn(s[o.index]);{const l=$d(s,o);return null!==l?Array.isArray(l)?l[0]:wc(ta(s[16]),l):wc(s,o.next)}}return null}function $d(s,o){return null!==o?s[16][6].projection[o.projection]:null}function Ec(s,o){const a=10+s+1;if(a<o.length){const l=o[a],d=l[1].firstChild;if(null!==d)return wc(l,d)}return o[7]}function em(s,o,a,l,d,g,v){for(;null!=a;){const E=l[a.index],b=a.type;if(v&&0===o&&(E&&_r(nn(E),l),a.flags|=4),64!=(64&a.flags))if(8&b)em(s,o,a.child,l,d,g,!1),nu(o,s,d,E,g);else if(32&b){const R=Kf(a,l);let P;for(;P=R();)nu(o,s,d,P,g);nu(o,s,d,E,g)}else 16&b?z0(s,o,l,a,d,g):nu(o,s,d,E,g);a=v?a.projectionNext:a.next}}function ep(s,o,a,l,d,g){em(a,l,s.firstChild,o,d,g,!1)}function z0(s,o,a,l,d,g){const v=a[16],b=v[6].projection[l.projection];if(Array.isArray(b))for(let R=0;R<b.length;R++)nu(o,s,d,b[R],g);else em(s,o,b,v[3],d,g,!0)}function K0(s,o,a){zt(s)?s.setAttribute(o,"style",a):o.style.cssText=a}function yy(s,o,a){zt(s)?""===a?s.removeAttribute(o,"class"):s.setAttribute(o,"class",a):o.className=a}function Hd(s,o,a){let l=s.length;for(;;){const d=s.indexOf(o,a);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const g=o.length;if(d+g===l||s.charCodeAt(d+g)<=32)return d}a=d+1}}const tp="ng-template";function pC(s,o,a){let l=0;for(;l<s.length;){let d=s[l++];if(a&&"class"===d){if(d=s[l],-1!==Hd(d.toLowerCase(),o,0))return!0}else if(1===d){for(;l<s.length&&"string"==typeof(d=s[l++]);)if(d.toLowerCase()===o)return!0;return!1}}return!1}function Q0(s){return 4===s.type&&s.value!==tp}function J0(s,o,a){return o===(4!==s.type||a?s.value:tp)}function X0(s,o,a){let l=4;const d=s.attrs||[],g=function eE(s){for(let o=0;o<s.length;o++)if(sn(s[o]))return o;return s.length}(d);let v=!1;for(let E=0;E<o.length;E++){const b=o[E];if("number"!=typeof b){if(!v)if(4&l){if(l=2|1&l,""!==b&&!J0(s,b,a)||""===b&&1===o.length){if(Xs(l))return!1;v=!0}}else{const R=8&l?b:o[++E];if(8&l&&null!==s.attrs){if(!pC(s.attrs,R,a)){if(Xs(l))return!1;v=!0}continue}const U=vy(8&l?"class":b,d,Q0(s),a);if(-1===U){if(Xs(l))return!1;v=!0;continue}if(""!==R){let N;N=U>g?"":d[U+1].toLowerCase();const Y=8&l?N:null;if(Y&&-1!==Hd(Y,R,0)||2&l&&R!==N){if(Xs(l))return!1;v=!0}}}}else{if(!v&&!Xs(l)&&!Xs(b))return!1;if(v&&Xs(b))continue;v=!1,l=b|1&l}}return Xs(l)||v}function Xs(s){return 0==(1&s)}function vy(s,o,a,l){if(null===o)return-1;let d=0;if(l||!a){let g=!1;for(;d<o.length;){const v=o[d];if(v===s)return d;if(3===v||6===v)g=!0;else{if(1===v||2===v){let E=o[++d];for(;"string"==typeof E;)E=o[++d];continue}if(4===v)break;if(0===v){d+=4;continue}}d+=g?1:2}return-1}return function tm(s,o){let a=s.indexOf(4);if(a>-1)for(a++;a<s.length;){const l=s[a];if("number"==typeof l)return-1;if(l===o)return a;a++}return-1}(o,s)}function Yt(s,o,a=!1){for(let l=0;l<o.length;l++)if(X0(s,o[l],a))return!0;return!1}function mC(s,o){return s?":not("+o.trim()+")":o}function _C(s){let o=s[0],a=1,l=2,d="",g=!1;for(;a<s.length;){let v=s[a];if("string"==typeof v)if(2&l){const E=s[++a];d+="["+v+(E.length>0?'="'+E+'"':"")+"]"}else 8&l?d+="."+v:4&l&&(d+=" "+v);else""!==d&&!Xs(v)&&(o+=mC(g,d),d=""),l=v,g=g||!Xs(l);a++}return""!==d&&(o+=mC(g,d)),o}const xt={};function tE(s){nE(Pt(),De(),ir()+s,jo())}function nE(s,o,a,l){if(!l)if(3==(3&o[2])){const g=s.preOrderCheckHooks;null!==g&&qs(o,g,a)}else{const g=s.preOrderHooks;null!==g&&Mu(o,g,0,a)}Un(a)}function qd(s,o){const a=s.contentQueries;if(null!==a)for(let l=0;l<a.length;l+=2){const d=a[l],g=a[l+1];if(-1!==g){const v=s.data[g];xa(d),v.contentQueries(2,o[g],g)}}}function Wd(s,o,a,l,d,g,v,E,b,R){const P=o.blueprint.slice();return P[0]=d,P[2]=140|l,$s(P),P[3]=P[15]=s,P[8]=a,P[10]=v||s&&s[10],P[11]=E||s&&s[11],P[12]=b||s&&s[12]||null,P[9]=R||s&&s[9]||null,P[6]=g,P[16]=2==o.type?s[16]:P,P}function Gd(s,o,a,l,d){let g=s.data[o];if(null===g)g=function ip(s,o,a,l,d){const g=yo(),v=_s(),b=s.data[o]=function AC(s,o,a,l,d,g){return{type:a,index:l,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:g,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,v?g:g&&g.parent,a,o,l,d);return null===s.firstChild&&(s.firstChild=b),null!==g&&(v?null==g.child&&null!==b.parent&&(g.child=b):null===g.next&&(g.next=b)),b}(s,o,a,l,d),function ud(){return pt.lFrame.inI18n}()&&(g.flags|=64);else if(64&g.type){g.type=a,g.value=l,g.attrs=d;const v=function Hs(){const s=pt.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();g.injectorIndex=null===v?-1:v.injectorIndex}return Jr(g,!0),g}function Ic(s,o,a,l){if(0===a)return-1;const d=o.length;for(let g=0;g<a;g++)o.push(l),s.blueprint.push(l),s.data.push(null);return d}function Zd(s,o,a){qo(o);try{const l=s.viewQuery;null!==l&&RE(1,l,a);const d=s.template;null!==d&&hE(s,o,d,1,a),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&qd(s,o),s.staticViewQueries&&RE(2,s.viewQuery,a);const g=s.components;null!==g&&function xy(s,o){for(let a=0;a<o.length;a++)iP(s,o[a])}(o,g)}catch(l){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),l}finally{o[2]&=-5,ku()}}function el(s,o,a,l){const d=o[2];if(256==(256&d))return;qo(o);const g=jo();try{$s(o),function xu(s){return pt.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==a&&hE(s,o,a,2,l);const v=3==(3&d);if(!g)if(v){const R=s.preOrderCheckHooks;null!==R&&qs(o,R,null)}else{const R=s.preOrderHooks;null!==R&&Mu(o,R,0,null),Nu(o,0)}if(function lp(s){for(let o=_c(s);null!==o;o=yc(o)){if(!o[2])continue;const a=o[9];for(let l=0;l<a.length;l++){const d=a[l],g=d[3];0==(1024&d[2])&&Uo(g,1),d[2]|=1024}}}(o),function Ny(s){for(let o=_c(s);null!==o;o=yc(o))for(let a=10;a<o.length;a++){const l=o[a],d=l[1];ts(l)&&el(d,l,d.template,l[8])}}(o),null!==s.contentQueries&&qd(s,o),!g)if(v){const R=s.contentCheckHooks;null!==R&&qs(o,R)}else{const R=s.contentHooks;null!==R&&Mu(o,R,1),Nu(o,1)}!function dE(s,o){const a=s.hostBindingOpCodes;if(null!==a)try{for(let l=0;l<a.length;l++){const d=a[l];if(d<0)Un(~d);else{const g=d,v=a[++l],E=a[++l];Pu(v,g),E(2,o[g])}}}finally{Un(-1)}}(s,o);const E=s.components;null!==E&&function CC(s,o){for(let a=0;a<o.length;a++)rP(s,o[a])}(o,E);const b=s.viewQuery;if(null!==b&&RE(2,b,l),!g)if(v){const R=s.viewCheckHooks;null!==R&&qs(o,R)}else{const R=s.viewHooks;null!==R&&Mu(o,R,2),Nu(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),g||(o[2]&=-73),1024&o[2]&&(o[2]&=-1025,Uo(o[3],-1))}finally{ku()}}function DC(s,o,a,l){const d=o[10],g=!jo(),v=zn(o);try{g&&!v&&d.begin&&d.begin(),v&&Zd(s,o,l),el(s,o,a,l)}finally{g&&!v&&d.end&&d.end()}}function hE(s,o,a,l,d){const g=ir(),v=2&l;try{Un(-1),v&&o.length>20&&nE(s,o,20,jo()),a(l,d)}finally{Un(g)}}function zd(s,o,a){!Vo()||(function OC(s,o,a,l){const d=a.directiveStart,g=a.directiveEnd;s.firstCreatePass||Ua(a,o),_r(l,o);const v=a.initialInputs;for(let E=d;E<g;E++){const b=s.data[E],R=Xi(b);R&&tP(o,a,b);const P=Bn(o,s,E,a);_r(P,o),null!==v&&FC(0,E-d,P,b,0,v),R&&($r(a.index,o)[8]=P)}}(s,o,a,Fn(a,o)),128==(128&a.flags)&&function wE(s,o,a){const l=a.directiveStart,d=a.directiveEnd,v=a.index,E=function Sa(){return pt.lFrame.currentDirectiveIndex}();try{Un(v);for(let b=l;b<d;b++){const R=s.data[b],P=o[b];Ho(b),(null!==R.hostBindings||0!==R.hostVars||null!==R.hostAttrs)&&Py(R,P)}}finally{Un(-1),Ho(E)}}(s,o,a))}function sp(s,o,a=Fn){const l=o.localNames;if(null!==l){let d=o.index+1;for(let g=0;g<l.length;g+=2){const v=l[g+1],E=-1===v?a(o,s):s[v];s[d++]=E}}}function um(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=Kd(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function Kd(s,o,a,l,d,g,v,E,b,R){const P=20+l,U=P+d,N=function pE(s,o){const a=[];for(let l=0;l<o;l++)a.push(l<s?null:xt);return a}(P,U),Y="function"==typeof R?R():R;return N[1]={type:s,blueprint:N,template:a,queries:null,viewQuery:E,declTNode:o,data:N.slice().fill(null,P),bindingStartIndex:P,expandoStartIndex:U,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof g?g():g,pipeRegistry:"function"==typeof v?v():v,firstChild:null,schemas:b,consts:Y,incompleteFirstPass:!1}}function mE(s,o,a,l){const d=xE(o);null===a?d.push(l):(d.push(a),s.firstCreatePass&&lm(s).push(l,d.length-1))}function _E(s,o,a){for(let l in s)if(s.hasOwnProperty(l)){const d=s[l];(a=null===a?{}:a).hasOwnProperty(l)?a[l].push(o,d):a[l]=[o,d]}return a}function up(s,o,a,l){let d=!1;if(Vo()){const g=function EE(s,o,a){const l=s.directiveRegistry;let d=null;if(l)for(let g=0;g<l.length;g++){const v=l[g];Yt(a,v.selectors,!1)&&(d||(d=[]),Lu(Ua(a,o),s,v.type),Xi(v)?(ky(s,a),d.unshift(v)):d.push(v))}return d}(s,o,a),v=null===l?null:{"":-1};if(null!==g){d=!0,bE(a,s.data.length,g.length);for(let P=0;P<g.length;P++){const U=g[P];U.providersResolver&&U.providersResolver(U)}let E=!1,b=!1,R=Ic(s,o,g.length,null);for(let P=0;P<g.length;P++){const U=g[P];a.mergedAttrs=Ke(a.mergedAttrs,U.hostAttrs),LC(s,a,o,R,U),eP(R,U,v),null!==U.contentQueries&&(a.flags|=8),(null!==U.hostBindings||null!==U.hostAttrs||0!==U.hostVars)&&(a.flags|=128);const N=U.type.prototype;!E&&(N.ngOnChanges||N.ngOnInit||N.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(a.index),E=!0),!b&&(N.ngOnChanges||N.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(a.index),b=!0),R++}!function RC(s,o){const l=o.directiveEnd,d=s.data,g=o.attrs,v=[];let E=null,b=null;for(let R=o.directiveStart;R<l;R++){const P=d[R],U=P.inputs,N=null===g||Q0(o)?null:CE(U,g);v.push(N),E=_E(U,R,E),b=_E(P.outputs,R,b)}null!==E&&(E.hasOwnProperty("class")&&(o.flags|=16),E.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=v,o.inputs=E,o.outputs=b}(s,a)}v&&function IE(s,o,a){if(o){const l=s.localNames=[];for(let d=0;d<o.length;d+=2){const g=a[o[d+1]];if(null==g)throw new ke(-301,`Export of name '${o[d+1]}' not found!`);l.push(o[d],g)}}}(a,l,v)}return a.mergedAttrs=Ke(a.mergedAttrs,a.attrs),d}function vE(s,o,a,l,d,g){const v=g.hostBindings;if(v){let E=s.hostBindingOpCodes;null===E&&(E=s.hostBindingOpCodes=[]);const b=~o.index;(function NC(s){let o=s.length;for(;o>0;){const a=s[--o];if("number"==typeof a&&a<0)return a}return 0})(E)!=b&&E.push(b),E.push(l,d,v)}}function Py(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function ky(s,o){o.flags|=2,(s.components||(s.components=[])).push(o.index)}function eP(s,o,a){if(a){if(o.exportAs)for(let l=0;l<o.exportAs.length;l++)a[o.exportAs[l]]=s;Xi(o)&&(a[""]=s)}}function bE(s,o,a){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+a,s.providerIndexes=o}function LC(s,o,a,l,d){s.data[l]=d;const g=d.factory||(d.factory=mo(d.type)),v=new yn(g,Xi(d),null);s.blueprint[l]=v,a[l]=v,vE(s,o,0,l,Ic(s,a,d.hostVars,xt),d)}function tP(s,o,a){const l=Fn(o,s),d=um(a),g=s[10],v=Oy(s,Wd(s,d,null,a.onPush?64:16,l,o,g,g.createRenderer(l,a),null,null));s[o.index]=v}function to(s,o,a,l,d,g){const v=Fn(s,o);!function TE(s,o,a,l,d,g,v){if(null==g)zt(s)?s.removeAttribute(o,d,a):o.removeAttribute(d);else{const E=null==v?K(g):v(g,l||"",d);zt(s)?s.setAttribute(o,d,E,a):a?o.setAttributeNS(a,d,E):o.setAttribute(d,E)}}(o[11],v,g,s.value,a,l,d)}function FC(s,o,a,l,d,g){const v=g[o];if(null!==v){const E=l.setInput;for(let b=0;b<v.length;){const R=v[b++],P=v[b++],U=v[b++];null!==E?l.setInput(a,U,R,P):a[P]=U}}}function CE(s,o){let a=null,l=0;for(;l<o.length;){const d=o[l];if(0!==d)if(5!==d){if("number"==typeof d)break;s.hasOwnProperty(d)&&(null===a&&(a=[]),a.push(d,s[d],o[l+1])),l+=2}else l+=2;else l+=4}return a}function My(s,o,a,l){return new Array(s,!0,!1,o,null,0,l,a,null,null)}function rP(s,o){const a=$r(o,s);if(ts(a)){const l=a[1];80&a[2]?el(l,a,l.template,a[8]):a[5]>0&&cp(a)}}function cp(s){for(let l=_c(s);null!==l;l=yc(l))for(let d=10;d<l.length;d++){const g=l[d];if(1024&g[2]){const v=g[1];el(v,g,v.template,g[8])}else g[5]>0&&cp(g)}const a=s[1].components;if(null!==a)for(let l=0;l<a.length;l++){const d=$r(a[l],s);ts(d)&&d[5]>0&&cp(d)}}function iP(s,o){const a=$r(o,s),l=a[1];(function UC(s,o){for(let a=o.length;a<s.blueprint.length;a++)o.push(s.blueprint[a])})(l,a),Zd(l,a,a[8])}function Oy(s,o){return s[13]?s[14][4]=o:s[13]=o,s[14]=o,o}function Ly(s){for(;s;){s[2]|=64;const o=ta(s);if(Yc(s)&&!o)return s;s=o}return null}function SE(s,o,a){const l=o[10];l.begin&&l.begin();try{el(s,o,s.template,a)}catch(d){throw dm(o,d),d}finally{l.end&&l.end()}}function AE(s){!function DE(s){for(let o=0;o<s.components.length;o++){const a=s.components[o],l=Vf(a),d=l[1];DC(d,l,d.template,a)}}(s[8])}function RE(s,o,a){xa(0),o(s,a)}const aP=(()=>Promise.resolve(null))();function xE(s){return s[7]||(s[7]=[])}function lm(s){return s.cleanup||(s.cleanup=[])}function dm(s,o){const a=s[9],l=a?a.get(gc,null):null;l&&l.handleError(o)}function hm(s,o,a,l,d){for(let g=0;g<a.length;){const v=a[g++],E=a[g++],b=o[v],R=s.data[v];null!==R.setInput?R.setInput(b,d,l,E):b[E]=d}}function Eo(s,o,a){const l=function Zn(s,o){return nn(o[s])}(o,s);!function Jg(s,o,a){zt(s)?s.setValue(o,a):o.textContent=a}(s[11],l,a)}function Yd(s,o,a){let l=a?s.styles:null,d=a?s.classes:null,g=0;if(null!==o)for(let v=0;v<o.length;v++){const E=o[v];"number"==typeof E?g=E:1==g?d=ue(d,E):2==g&&(l=ue(l,E+": "+o[++v]+";"))}a?s.styles=l:s.stylesWithoutHost=l,a?s.classes=d:s.classesWithoutHost=d}const bc=new Wt("INJECTOR",-1);class PE{get(o,a=wn){if(a===wn){const l=new Error(`NullInjectorError: No provider for ${ae(o)}!`);throw l.name="NullInjectorError",l}return a}}const Uy=new Wt("Set Injector scope."),hp={},VC={};let By;function Tc(){return void 0===By&&(By=new PE),By}function kE(s,o=null,a=null,l){const d=ME(s,o,a,l);return d._resolveInjectorDefTypes(),d}function ME(s,o=null,a=null,l){return new jC(s,a,o||Tc(),l)}class jC{constructor(o,a,l,d=null){this.parent=l,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const g=[];a&&Ui(a,E=>this.processProvider(E,o,a)),Ui([o],E=>this.processInjectorType(E,[],g)),this.records.set(bc,tl(void 0,this));const v=this.records.get(Uy);this.scope=null!=v?v.value:null,this.source=d||("object"==typeof o?null:ae(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,a=wn,l=Xe.Default){this.assertNotDestroyed();const d=k(this),g=$n(void 0);try{if(!(l&Xe.SkipSelf)){let E=this.records.get(o);if(void 0===E){const b=function Hy(s){return"function"==typeof s||"object"==typeof s&&s instanceof Wt}(o)&&Dn(o);E=b&&this.injectableDefInScope(b)?tl(Vy(o),hp):null,this.records.set(o,E)}if(null!=E)return this.hydrate(o,E)}return(l&Xe.Self?Tc():this.parent).get(o,a=l&Xe.Optional&&a===wn?null:a)}catch(v){if("NullInjectorError"===v.name){if((v[za]=v[za]||[]).unshift(ae(o)),d)throw v;return function Kt(s,o,a,l){const d=s[za];throw o[Vu]&&d.unshift(o[Vu]),s.message=function Gr(s,o,a,l=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.substr(2):s;let d=ae(o);if(Array.isArray(o))d=o.map(ae).join(" -> ");else if("object"==typeof o){let g=[];for(let v in o)if(o.hasOwnProperty(v)){let E=o[v];g.push(v+":"+("string"==typeof E?JSON.stringify(E):ae(E)))}d=`{${g.join(", ")}}`}return`${a}${l?"("+l+")":""}[${d}]: ${s.replace(Bu,"\n  ")}`}("\n"+s.message,d,a,l),s.ngTokenPath=d,s[za]=null,s}(v,o,"R3InjectorError",this.source)}throw v}finally{$n(g),k(d)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((l,d)=>o.push(ae(d))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ke(205,"")}processInjectorType(o,a,l){if(!(o=ee(o)))return!1;let d=lo(o);const g=null==d&&o.ngModule||void 0,v=void 0===g?o:g,E=-1!==l.indexOf(v);if(void 0!==g&&(d=lo(g)),null==d)return!1;if(null!=d.imports&&!E){let P;l.push(v);try{Ui(d.imports,U=>{this.processInjectorType(U,a,l)&&(void 0===P&&(P=[]),P.push(U))})}finally{}if(void 0!==P)for(let U=0;U<P.length;U++){const{ngModule:N,providers:Y}=P[U];Ui(Y,ce=>this.processProvider(ce,N,Y||j))}}this.injectorDefTypes.add(v);const b=mo(v)||(()=>new v);this.records.set(v,tl(b,hp));const R=d.providers;if(null!=R&&!E){const P=o;Ui(R,U=>this.processProvider(U,P,R))}return void 0!==g&&void 0!==o.providers}processProvider(o,a,l){let d=Cc(o=ee(o))?o:ee(o&&o.provide);const g=function HC(s,o,a){return NE(s)?tl(void 0,s.useValue):tl(function jy(s,o,a){let l;if(Cc(s)){const d=ee(s);return mo(d)||Vy(d)}if(NE(s))l=()=>ee(s.useValue);else if(function OE(s){return!(!s||!s.useFactory)}(s))l=()=>s.useFactory(...ze(s.deps||[]));else if(function $y(s){return!(!s||!s.useExisting)}(s))l=()=>Z(ee(s.useExisting));else{const d=ee(s&&(s.useClass||s.provide));if(!function WC(s){return!!s.deps}(s))return mo(d)||Vy(d);l=()=>new d(...ze(s.deps))}return l}(s),hp)}(o);if(Cc(o)||!0!==o.multi)this.records.get(d);else{let v=this.records.get(d);v||(v=tl(void 0,hp,!0),v.factory=()=>ze(v.multi),this.records.set(d,v)),d=o,v.multi.push(o)}this.records.set(d,g)}hydrate(o,a){return a.value===hp&&(a.value=VC,a.value=a.factory()),"object"==typeof a.value&&a.value&&function Jn(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(a.value)&&this.onDestroy.add(a.value),a.value}injectableDefInScope(o){if(!o.providedIn)return!1;const a=ee(o.providedIn);return"string"==typeof a?"any"===a||a===this.scope:this.injectorDefTypes.has(a)}}function Vy(s){const o=Dn(s),a=null!==o?o.factory:mo(s);if(null!==a)return a;if(s instanceof Wt)throw new ke(204,"");if(s instanceof Function)return function $C(s){const o=s.length;if(o>0)throw function Ks(s,o){const a=[];for(let l=0;l<s;l++)a.push(o);return a}(o,"?"),new ke(204,"");const a=function Ut(s){const o=s&&(s[Kr]||s[Ae]);if(o){const a=function gn(s){if(s.hasOwnProperty("name"))return s.name;const o=(""+s).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(s);return console.warn(`DEPRECATED: DI is instantiating a token "${a}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${a}" class.`),o}return null}(s);return null!==a?()=>a.factory(s):()=>new s}(s);throw new ke(204,"")}function tl(s,o,a=!1){return{factory:s,value:o,multi:a?[]:void 0}}function NE(s){return null!==s&&"object"==typeof s&&T in s}function Cc(s){return"function"==typeof s}let us=(()=>{class s{static create(a,l){var d;if(Array.isArray(a))return kE({name:""},l,a,"");{const g=null!==(d=a.name)&&void 0!==d?d:"";return kE({name:g},a.parent,a.providers,g)}}}return s.THROW_IF_NOT_FOUND=wn,s.NULL=new PE,s.\u0275prov=Zt({token:s,providedIn:"any",factory:()=>Z(bc)}),s.__NG_ELEMENT_ID__=-1,s})();function Gy(s,o){Wl(Vf(s)[1],rn())}let pm=null;function Jd(){if(!pm){const s=ft.Symbol;if(s&&s.iterator)pm=s.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let a=0;a<o.length;++a){const l=o[a];"entries"!==l&&"size"!==l&&Map.prototype[l]===Map.prototype.entries&&(pm=l)}}}return pm}function gp(s){return!!mp(s)&&(Array.isArray(s)||!(s instanceof Map)&&Jd()in s)}function mp(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function si(s,o,a){return!Object.is(s[o],a)&&(s[o]=a,!0)}function Yy(s,o,a,l){const d=De();return si(d,ys(),o)&&(Pt(),to(_n(),d,s,o,a,l)),Yy}function To(s,o,a,l,d,g,v,E){const b=De(),R=Pt(),P=s+20,U=R.firstCreatePass?function sD(s,o,a,l,d,g,v,E,b){const R=o.consts,P=Gd(o,s,4,v||null,Hr(R,E));up(o,a,P,Hr(R,b)),Wl(o,P);const U=P.tViews=Kd(2,P,l,d,g,o.directiveRegistry,o.pipeRegistry,null,o.schemas,R);return null!==o.queries&&(o.queries.template(o,P),U.queries=o.queries.embeddedTView(P)),P}(P,R,b,o,a,l,d,g,v):R.data[P];Jr(U,!1);const N=b[11].createComment("");Ju(R,b,N,U),_r(N,b),Oy(b,b[P]=My(N,b,N,U)),gs(U)&&zd(R,b,U),null!=v&&sp(b,U,E)}function yp(s){return es(function Ru(){return pt.lFrame.contextLView}(),20+s)}function ah(s,o=Xe.Default){const a=De();return null===a?Z(s,o):Kl(rn(),a,ee(s),o)}function aI(){throw new Error("invalid")}function uv(s,o,a){const l=De();return si(l,ys(),o)&&function Ds(s,o,a,l,d,g,v,E){const b=Fn(o,a);let P,R=o.inputs;!E&&null!=R&&(P=R[l])?(hm(s,a,P,l,d),Ln(o)&&function PC(s,o){const a=$r(o,s);16&a[2]||(a[2]|=64)}(a,o.index)):3&o.type&&(l=function xC(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(l),d=null!=v?v(d,o.value||"",l):d,zt(g)?g.setProperty(b,l,d):Ws(l)||(b.setProperty?b.setProperty(l,d):b[l]=d))}(Pt(),_n(),l,s,o,l[11],a,!1),uv}function lv(s,o,a,l,d){const v=d?"class":"style";hm(s,a,o.inputs[v],v,l)}function vm(s,o,a,l){const d=De(),g=Pt(),v=20+s,E=d[11],b=d[v]=Yf(E,o,function dd(){return pt.lFrame.currentNamespace}()),R=g.firstCreatePass?function _D(s,o,a,l,d,g,v){const E=o.consts,R=Gd(o,s,2,d,Hr(E,g));return up(o,a,R,Hr(E,v)),null!==R.attrs&&Yd(R,R.attrs,!1),null!==R.mergedAttrs&&Yd(R,R.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,R),R}(v,g,d,0,o,a,l):g.data[v];Jr(R,!0);const P=R.mergedAttrs;null!==P&&Gl(E,b,P);const U=R.classes;null!==U&&yy(E,b,U);const N=R.styles;null!==N&&K0(E,b,N),64!=(64&R.flags)&&Ju(g,d,b,R),0===function Ta(){return pt.lFrame.elementDepthCount}()&&_r(b,d),function Ca(){pt.lFrame.elementDepthCount++}(),gs(R)&&(zd(g,d,R),function fE(s,o,a){if(Kc(o)){const d=o.directiveEnd;for(let g=o.directiveStart;g<d;g++){const v=s.data[g];v.contentQueries&&v.contentQueries(1,a[g],g)}}}(g,R,d)),null!==l&&sp(d,R)}function cv(){let s=rn();_s()?function Su(){pt.lFrame.isParent=!1}():(s=s.parent,Jr(s,!1));const o=s;!function Bo(){pt.lFrame.elementDepthCount--}();const a=Pt();a.firstCreatePass&&(Wl(a,s),Kc(s)&&a.queries.elementEnd(s)),null!=o.classesWithoutHost&&function fd(s){return 0!=(16&s.flags)}(o)&&lv(a,o,De(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function Oa(s){return 0!=(32&s.flags)}(o)&&lv(a,o,De(),o.stylesWithoutHost,!1)}function uI(s,o,a,l){vm(s,o,a,l),cv()}function fv(){return De()}function wm(s){return!!s&&"function"==typeof s.then}function pv(s){return!!s&&"function"==typeof s.subscribe}const wD=pv;function cI(s,o,a,l){const d=De(),g=Pt(),v=rn();return function dI(s,o,a,l,d,g,v,E){const b=gs(l),P=s.firstCreatePass&&lm(s),U=o[8],N=xE(o);let Y=!0;if(3&l.type||E){const Ue=Fn(l,o),Ze=E?E(Ue):Ue,Ce=N.length,it=E?Nt=>E(nn(Nt[l.index])):l.index;if(zt(a)){let Nt=null;if(!E&&b&&(Nt=function ID(s,o,a,l){const d=s.cleanup;if(null!=d)for(let g=0;g<d.length-1;g+=2){const v=d[g];if(v===a&&d[g+1]===l){const E=o[7],b=d[g+2];return E.length>b?E[b]:null}"string"==typeof v&&(g+=2)}return null}(s,o,d,l.index)),null!==Nt)(Nt.__ngLastListenerFn__||Nt).__ngNextListenerFn__=g,Nt.__ngLastListenerFn__=g,Y=!1;else{g=gv(l,o,U,g,!1);const Qt=a.listen(Ze,d,g);N.push(g,Qt),P&&P.push(d,it,Ce,Ce+1)}}else g=gv(l,o,U,g,!0),Ze.addEventListener(d,g,v),N.push(g),P&&P.push(d,it,Ce,v)}else g=gv(l,o,U,g,!1);const ce=l.outputs;let Oe;if(Y&&null!==ce&&(Oe=ce[d])){const Ue=Oe.length;if(Ue)for(let Ze=0;Ze<Ue;Ze+=2){const ds=o[Oe[Ze]][Oe[Ze+1]].subscribe(g),Cr=N.length;N.push(g,ds),P&&P.push(d,l.index,Cr,-(Cr+1))}}}(g,d,d[11],v,s,o,!!a,l),cI}function hI(s,o,a,l){try{return!1!==a(l)}catch(d){return dm(s,d),!1}}function gv(s,o,a,l,d){return function g(v){if(v===Function)return l;const E=2&s.flags?$r(s.index,o):o;0==(32&o[2])&&Ly(E);let b=hI(o,0,l,v),R=g.__ngNextListenerFn__;for(;R;)b=hI(o,0,R,v)&&b,R=R.__ngNextListenerFn__;return d&&!1===b&&(v.preventDefault(),v.returnValue=!1),b}}function fI(s=1){return function cd(s){return(pt.lFrame.contextLView=function kg(s,o){for(;s>0;)o=o[15],s--;return o}(s,pt.lFrame.contextLView))[8]}(s)}function PI(s,o=""){const a=De(),l=Pt(),d=s+20,g=l.firstCreatePass?Gd(l,d,1,o,null):l.data[d],v=a[d]=function Ud(s,o){return zt(s)?s.createText(o):s.createTextNode(o)}(a[11],o);Ju(l,a,v,g),Jr(g,!1)}function lh(s,o,a){const l=De(),d=function il(s,o,a,l){return si(s,ys(),a)?o+K(a)+l:xt}(l,s,o,a);return d!==xt&&Eo(l,ir(),d),lh}const ua=void 0;var Nv=["en",[["a","p"],["AM","PM"],ua],[["AM","PM"],ua,ua],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ua,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ua,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ua,"{1} 'at' {0}",ua],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Mv(s){const a=Math.floor(Math.abs(s)),l=s.toString().replace(/^[^.]*\.?/,"").length;return 1===a&&0===l?1:5}];let al={};function Am(s){const o=function WI(s){return s.toLowerCase().replace(/_/g,"-")}(s);let a=Ov(o);if(a)return a;const l=o.split("-")[0];if(a=Ov(l),a)return a;if("en"===l)return Nv;throw new Error(`Missing locale data for the locale "${s}".`)}function qI(s){return Am(s)[mt.PluralCase]}function Ov(s){return s in al||(al[s]=ft.ng&&ft.ng.common&&ft.ng.common.locales&&ft.ng.common.locales[s]),al[s]}var mt=(()=>((mt=mt||{})[mt.LocaleId=0]="LocaleId",mt[mt.DayPeriodsFormat=1]="DayPeriodsFormat",mt[mt.DayPeriodsStandalone=2]="DayPeriodsStandalone",mt[mt.DaysFormat=3]="DaysFormat",mt[mt.DaysStandalone=4]="DaysStandalone",mt[mt.MonthsFormat=5]="MonthsFormat",mt[mt.MonthsStandalone=6]="MonthsStandalone",mt[mt.Eras=7]="Eras",mt[mt.FirstDayOfWeek=8]="FirstDayOfWeek",mt[mt.WeekendRange=9]="WeekendRange",mt[mt.DateFormat=10]="DateFormat",mt[mt.TimeFormat=11]="TimeFormat",mt[mt.DateTimeFormat=12]="DateTimeFormat",mt[mt.NumberSymbols=13]="NumberSymbols",mt[mt.NumberFormats=14]="NumberFormats",mt[mt.CurrencyCode=15]="CurrencyCode",mt[mt.CurrencySymbol=16]="CurrencySymbol",mt[mt.CurrencyName=17]="CurrencyName",mt[mt.Currencies=18]="Currencies",mt[mt.Directionality=19]="Directionality",mt[mt.PluralCase=20]="PluralCase",mt[mt.ExtraData=21]="ExtraData",mt))();const fh="en-US";let ZI=fh;class fb{}class mb{resolveComponentFactory(o){throw function pb(s){const o=Error(`No component factory found for ${ae(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let Pc=(()=>{class s{}return s.NULL=new mb,s})();function nw(){return kc(rn(),De())}function kc(s,o){return new Ih(Fn(s,o))}let Ih=(()=>{class s{constructor(a){this.nativeElement=a}}return s.__NG_ELEMENT_ID__=nw,s})();function rw(s){return s instanceof Ih?s.nativeElement:s}class _b{}let oS=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function Fp(){const s=De(),a=$r(rn().index,s);return function Bm(s){return s[11]}(Ai(a)?a:s)}(),s})(),Vm=(()=>{class s{}return s.\u0275prov=Zt({token:s,providedIn:"root",factory:()=>null}),s})();class jm{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const iw=new jm("13.1.3"),Mc={};function hl(s,o,a,l,d=!1){for(;null!==a;){const g=o[a.index];if(null!==g&&l.push(nn(g)),Ri(g))for(let E=10;E<g.length;E++){const b=g[E],R=b[1].firstChild;null!==R&&hl(b[1],b,R,l)}const v=a.type;if(8&v)hl(s,o,a.child,l);else if(32&v){const E=Kf(a,o);let b;for(;b=E();)l.push(b)}else if(16&v){const E=$d(o,a);if(Array.isArray(E))l.push(...E);else{const b=ta(o[16]);hl(b[1],b,E,l,!0)}}a=d?a.projectionNext:a.next}return l}class Up{constructor(o,a){this._lView=o,this._cdRefInjectingView=a,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,a=o[1];return hl(a,o,a.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Ri(o)){const a=o[8],l=a?a.indexOf(this):-1;l>-1&&(D(o,l),Ha(a,l))}this._attachedToViewContainer=!1}x(this._lView[1],this._lView)}onDestroy(o){mE(this._lView[1],this._lView,null,o)}markForCheck(){Ly(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){SE(this._lView[1],this._lView,this.context)}checkNoChanges(){!function sP(s,o,a){Da(!0);try{SE(s,o,a)}finally{Da(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new ke(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function _y(s,o){ep(s,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new ke(902,"");this._appRef=o}}class Ir extends Up{constructor(o){super(o),this._view=o}detectChanges(){AE(this._view)}checkNoChanges(){!function oP(s){Da(!0);try{AE(s)}finally{Da(!1)}}(this._view)}get context(){return null}}class sw extends Pc{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const a=er(o);return new $m(a,this.ngModule)}}function yb(s){const o=[];for(let a in s)s.hasOwnProperty(a)&&o.push({propName:s[a],templateName:a});return o}const uS=new Wt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Md});class $m extends fb{constructor(o,a){super(),this.componentDef=o,this.ngModule=a,this.componentType=o.type,this.selector=function wy(s){return s.map(_C).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!a}get inputs(){return yb(this.componentDef.inputs)}get outputs(){return yb(this.componentDef.outputs)}create(o,a,l,d){const g=(d=d||this.ngModule)?function lS(s,o){return{get:(a,l,d)=>{const g=s.get(a,Mc,d);return g!==Mc||l===Mc?g:o.get(a,l,d)}}}(o,d.injector):o,v=g.get(_b,js),E=g.get(Vm,null),b=v.createRenderer(null,this.componentDef),R=this.componentDef.selectors[0][0]||"div",P=l?function op(s,o,a){if(zt(s))return s.selectRootElement(o,a===At.ShadowDom);let l="string"==typeof o?s.querySelector(o):o;return l.textContent="",l}(b,l,this.componentDef.encapsulation):Yf(v.createRenderer(null,this.componentDef),R,function aS(s){const o=s.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":"math"===o?"http://www.w3.org/1998/MathML/":null}(R)),U=this.componentDef.onPush?576:528,N=function Wy(s,o){return{components:[],scheduler:s||Md,clean:aP,playerHandler:o||null,flags:0}}(),Y=Kd(0,null,null,1,0,null,null,null,null,null),ce=Wd(null,Y,N,U,null,null,v,b,E,g);let Oe,Ue;qo(ce);try{const Ze=function qE(s,o,a,l,d,g){const v=a[1];a[20]=s;const b=Gd(v,20,2,"#host",null),R=b.mergedAttrs=o.hostAttrs;null!==R&&(Yd(b,R,!0),null!==s&&(Gl(d,s,R),null!==b.classes&&yy(d,s,b.classes),null!==b.styles&&K0(d,s,b.styles)));const P=l.createRenderer(s,o),U=Wd(a,um(o),null,o.onPush?64:16,a[20],b,l,P,g||null,null);return v.firstCreatePass&&(Lu(Ua(b,a),v,o.type),ky(v,b),bE(b,a.length,1)),Oy(a,U),a[20]=U}(P,this.componentDef,ce,v,b);if(P)if(l)Gl(b,P,["ng-version",iw.full]);else{const{attrs:Ce,classes:it}=function $x(s){const o=[],a=[];let l=1,d=2;for(;l<s.length;){let g=s[l];if("string"==typeof g)2===d?""!==g&&o.push(g,s[++l]):8===d&&a.push(g);else{if(!Xs(d))break;d=g}l++}return{attrs:o,classes:a}}(this.componentDef.selectors[0]);Ce&&Gl(b,P,Ce),it&&it.length>0&&yy(b,P,it.join(" "))}if(Ue=Fo(Y,20),void 0!==a){const Ce=Ue.projection=[];for(let it=0;it<this.ngContentSelectors.length;it++){const Nt=a[it];Ce.push(null!=Nt?Array.from(Nt):null)}}Oe=function pp(s,o,a,l,d){const g=a[1],v=function yE(s,o,a){const l=rn();s.firstCreatePass&&(a.providersResolver&&a.providersResolver(a),LC(s,l,o,Ic(s,o,1,null),a));const d=Bn(o,s,l.directiveStart,l);_r(d,o);const g=Fn(l,o);return g&&_r(g,o),d}(g,a,o);if(l.components.push(v),s[8]=v,d&&d.forEach(b=>b(v,o)),o.contentQueries){const b=rn();o.contentQueries(1,v,b.directiveStart)}const E=rn();return!g.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(Un(E.index),vE(a[1],E,0,E.directiveStart,E.directiveEnd,o),Py(o,v)),v}(Ze,this.componentDef,ce,N,[Gy]),Zd(Y,ce,null)}finally{ku()}return new Hm(this.componentType,Oe,kc(Ue,ce),ce,Ue)}}class Hm extends class iS{}{constructor(o,a,l,d,g){super(),this.location=l,this._rootLView=d,this._tNode=g,this.instance=a,this.hostView=this.changeDetectorRef=new Ir(d),this.componentType=o}get injector(){return new En(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}class cs{}class ow{}const bh=new Map;class qm extends cs{constructor(o,a){super(),this._parent=a,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new sw(this);const l=tr(o);this._bootstrapComponents=bs(l.bootstrap),this._r3Injector=ME(o,a,[{provide:cs,useValue:this},{provide:Pc,useValue:this.componentFactoryResolver}],ae(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,a=us.THROW_IF_NOT_FOUND,l=Xe.Default){return o===us||o===cs||o===bc?this:this._r3Injector.get(o,a,l)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(a=>a()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class Ch extends ow{constructor(o){super(),this.moduleType=o,null!==tr(o)&&function Ib(s){const o=new Set;!function a(l){const d=tr(l,!0),g=d.id;null!==g&&(function Th(s,o,a){if(o&&o!==a)throw new Error(`Duplicate module registered for ${s} - ${ae(o)} vs ${ae(o.name)}`)}(g,bh.get(g),l),bh.set(g,l));const v=bs(d.imports);for(const E of v)o.has(E)||(o.add(E),a(E))}(s)}(o)}create(o){return new qm(this.moduleType,o)}}function fl(s,o,a,l,d,g){const v=o+a;return si(s,v,d)?function bo(s,o,a){return s[o]=a}(s,v+1,g?l.call(g,d):l(d)):function Dh(s,o){const a=s[o];return a===xt?void 0:a}(s,v+1)}function jp(s,o){const a=Pt();let l;const d=s+20;a.firstCreatePass?(l=function Rs(s,o){if(o)for(let a=o.length-1;a>=0;a--){const l=o[a];if(s===l.name)return l}}(o,a.pipeRegistry),a.data[d]=l,l.onDestroy&&(a.destroyHooks||(a.destroyHooks=[])).push(d,l.onDestroy)):l=a.data[d];const g=l.factory||(l.factory=mo(l.type)),v=$n(ah);try{const E=Fa(!1),b=g();return Fa(E),function aa(s,o,a,l){a>=s.data.length&&(s.data[a]=null,s.blueprint[a]=null),o[a]=l}(a,De(),d,b),b}finally{$n(v)}}function fw(s,o,a){const l=s+20,d=De(),g=es(d,l);return function Nc(s,o){return s[1].data[o].pure}(d,l)?fl(d,function Kn(){const s=pt.lFrame;let o=s.bindingRootIndex;return-1===o&&(o=s.bindingRootIndex=s.tView.bindingStartIndex),o}(),o,g.transform,a,g):g.transform(a)}function pw(s){return o=>{setTimeout(s,void 0,o)}}const Co=class gS extends m.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,a,l){var d,g,v;let E=o,b=a||(()=>null),R=l;if(o&&"object"==typeof o){const U=o;E=null===(d=U.next)||void 0===d?void 0:d.bind(U),b=null===(g=U.error)||void 0===g?void 0:g.bind(U),R=null===(v=U.complete)||void 0===v?void 0:v.bind(U)}this.__isAsync&&(b=pw(b),E&&(E=pw(E)),R&&(R=pw(R)));const P=super.subscribe({next:E,error:b,complete:R});return o instanceof J.w0&&o.add(P),P}};function mS(){return this._results[Jd()]()}class Ah{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const a=Jd(),l=Ah.prototype;l[a]||(l[a]=mS)}get changes(){return this._changes||(this._changes=new Co)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,a){return this._results.reduce(o,a)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,a){const l=this;l.dirty=!1;const d=fi(o);(this._changesDetected=!function Ef(s,o,a){if(s.length!==o.length)return!1;for(let l=0;l<s.length;l++){let d=s[l],g=o[l];if(a&&(d=a(d),g=a(g)),g!==d)return!1}return!0}(l._results,d,a))&&(l._results=d,l.length=d.length,l.last=d[this.length-1],l.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let $p=(()=>{class s{}return s.__NG_ELEMENT_ID__=Rh,s})();const xb=$p,li=class extends xb{constructor(o,a,l){super(),this._declarationLView=o,this._declarationTContainer=a,this.elementRef=l}createEmbeddedView(o){const a=this._declarationTContainer.tViews,l=Wd(this._declarationLView,a,o,16,null,a.declTNode,null,null,null,null);l[17]=this._declarationLView[this._declarationTContainer.index];const g=this._declarationLView[19];return null!==g&&(l[19]=g.createEmbeddedView(a)),Zd(a,l,o),new Up(l)}};function Rh(){return Do(rn(),De())}function Do(s,o){return 4&s.type?new li(o,s,kc(s,o)):null}let xh=(()=>{class s{}return s.__NG_ELEMENT_ID__=_S,s})();function _S(){return at(rn(),De())}const Le=xh,ar=class extends Le{constructor(o,a,l){super(),this._lContainer=o,this._hostTNode=a,this._hostLView=l}get element(){return kc(this._hostTNode,this._hostLView)}get injector(){return new En(this._hostTNode,this._hostLView)}get parentInjector(){const o=dn(this._hostTNode,this._hostLView);if(Ni(o)){const a=La(o,this._hostLView),l=sr(o);return new En(a[1].data[l+8],a)}return new En(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const a=Ph(this._lContainer);return null!==a&&a[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,a,l){const d=o.createEmbeddedView(a||{});return this.insert(d,l),d}createComponent(o,a,l,d,g){const v=o&&!function Fi(s){return"function"==typeof s}(o);let E;if(v)E=a;else{const U=a||{};E=U.index,l=U.injector,d=U.projectableNodes,g=U.ngModuleRef}const b=v?o:new $m(er(o)),R=l||this.parentInjector;if(!g&&null==b.ngModule&&R){const U=R.get(cs,null);U&&(g=U)}const P=b.create(R,d,void 0,g);return this.insert(P.hostView,E),P}insert(o,a){const l=o._lView,d=l[1];if(function Bl(s){return Ri(s[3])}(l)){const P=this.indexOf(o);if(-1!==P)this.detach(P);else{const U=l[3],N=new ar(U,U[6],U[3]);N.detach(N.indexOf(o))}}const g=this._adjustIndex(a),v=this._lContainer;!function h(s,o,a,l){const d=10+l,g=a.length;l>0&&(a[d-1][4]=o),l<g-10?(o[4]=a[d],yd(a,10+l,o)):(a.push(o),o[4]=null),o[3]=a;const v=o[17];null!==v&&a!==v&&function p(s,o){const a=s[9];o[16]!==o[3][3][16]&&(s[2]=!0),null===a?s[9]=[o]:a.push(o)}(v,o);const E=o[19];null!==E&&E.insertView(s),o[2]|=128}(d,l,v,g);const E=Ec(g,v),b=l[11],R=ru(b,v[7]);return null!==R&&function ni(s,o,a,l,d,g){l[0]=d,l[6]=o,ep(s,l,a,1,d,g)}(d,v[6],b,l,R,E),o.attachToViewContainerRef(),yd(Hp(v),g,o),o}move(o,a){return this.insert(o,a)}indexOf(o){const a=Ph(this._lContainer);return null!==a?a.indexOf(o):-1}remove(o){const a=this._adjustIndex(o,-1),l=D(this._lContainer,a);l&&(Ha(Hp(this._lContainer),a),x(l[1],l))}detach(o){const a=this._adjustIndex(o,-1),l=D(this._lContainer,a);return l&&null!=Ha(Hp(this._lContainer),a)?new Up(l):null}_adjustIndex(o,a=0){return null==o?this.length+a:o}};function Ph(s){return s[8]}function Hp(s){return s[8]||(s[8]=[])}function at(s,o){let a;const l=o[s.index];if(Ri(l))a=l;else{let d;if(8&s.type)d=nn(l);else{const g=o[11];d=g.createComment("");const v=Fn(s,o);Ye(g,ru(g,v),d,function Vd(s,o){return zt(s)?s.nextSibling(o):o.nextSibling}(g,v),!1)}o[s.index]=a=My(l,o,d,s),Oy(o,a)}return new ar(a,s,o)}class le{constructor(o){this.queryList=o,this.matches=null}clone(){return new le(this.queryList)}setDirty(){this.queryList.setDirty()}}class Re{constructor(o=[]){this.queries=o}createEmbeddedView(o){const a=o.queries;if(null!==a){const l=null!==o.contentQueries?o.contentQueries[0]:a.length,d=[];for(let g=0;g<l;g++){const v=a.getByIndex(g);d.push(this.queries[v.indexInDeclarationView].clone())}return new Re(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let a=0;a<this.queries.length;a++)null!==Ct(o,a).matches&&this.queries[a].setDirty()}}class Mr{constructor(o,a,l=null){this.predicate=o,this.flags=a,this.read=l}}class Gm{constructor(o=[]){this.queries=o}elementStart(o,a){for(let l=0;l<this.queries.length;l++)this.queries[l].elementStart(o,a)}elementEnd(o){for(let a=0;a<this.queries.length;a++)this.queries[a].elementEnd(o)}embeddedTView(o){let a=null;for(let l=0;l<this.length;l++){const d=null!==a?a.length:0,g=this.getByIndex(l).embeddedTView(o,d);g&&(g.indexInDeclarationView=l,null!==a?a.push(g):a=[g])}return null!==a?new Gm(a):null}template(o,a){for(let l=0;l<this.queries.length;l++)this.queries[l].template(o,a)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class gw{constructor(o,a=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=a}elementStart(o,a){this.isApplyingToNode(a)&&this.matchTNode(o,a)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,a){this.elementStart(o,a)}embeddedTView(o,a){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,a),new gw(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const a=this._declarationNodeIndex;let l=o.parent;for(;null!==l&&8&l.type&&l.index!==a;)l=l.parent;return a===(null!==l?l.index:-1)}return this._appliesToNextNode}matchTNode(o,a){const l=this.metadata.predicate;if(Array.isArray(l))for(let d=0;d<l.length;d++){const g=l[d];this.matchTNodeWithReadOption(o,a,vS(a,g)),this.matchTNodeWithReadOption(o,a,zo(a,o,g,!1,!1))}else l===$p?4&a.type&&this.matchTNodeWithReadOption(o,a,-1):this.matchTNodeWithReadOption(o,a,zo(a,o,l,!1,!1))}matchTNodeWithReadOption(o,a,l){if(null!==l){const d=this.metadata.read;if(null!==d)if(d===Ih||d===xh||d===$p&&4&a.type)this.addMatch(a.index,-2);else{const g=zo(a,o,d,!1,!1);null!==g&&this.addMatch(a.index,g)}else this.addMatch(a.index,l)}}addMatch(o,a){null===this.matches?this.matches=[o,a]:this.matches.push(o,a)}}function vS(s,o){const a=s.localNames;if(null!==a)for(let l=0;l<a.length;l+=2)if(a[l]===o)return a[l+1];return null}function ES(s,o,a,l){return-1===a?function wS(s,o){return 11&s.type?kc(s,o):4&s.type?Do(s,o):null}(o,s):-2===a?function IS(s,o,a){return a===Ih?kc(o,s):a===$p?Do(o,s):a===xh?at(o,s):void 0}(s,o,l):Bn(s,s[1],a,o)}function mw(s,o,a,l){const d=o[19].queries[l];if(null===d.matches){const g=s.data,v=a.matches,E=[];for(let b=0;b<v.length;b+=2){const R=v[b];E.push(R<0?null:ES(o,g[R],v[b+1],a.metadata.read))}d.matches=E}return d.matches}function _w(s,o,a,l){const d=s.queries.getByIndex(a),g=d.matches;if(null!==g){const v=mw(s,o,d,a);for(let E=0;E<g.length;E+=2){const b=g[E];if(b>0)l.push(v[E/2]);else{const R=g[E+1],P=o[-b];for(let U=10;U<P.length;U++){const N=P[U];N[17]===N[3]&&_w(N[1],N,R,l)}if(null!==P[9]){const U=P[9];for(let N=0;N<U.length;N++){const Y=U[N];_w(Y[1],Y,R,l)}}}}}return l}function bS(s){const o=De(),a=Pt(),l=Ra();xa(l+1);const d=Ct(a,l);if(s.dirty&&zn(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const g=d.crossesNgTemplate?_w(a,o,l,[]):mw(a,o,d,l);s.reset(g,rw),s.notifyOnChanges()}return!0}return!1}function Pb(s,o,a,l){const d=Pt();if(d.firstCreatePass){const g=rn();(function vw(s,o,a){null===s.queries&&(s.queries=new Gm),s.queries.track(new gw(o,a))})(d,new Mr(o,a,l),g.index),function zr(s,o){const a=s.contentQueries||(s.contentQueries=[]);o!==(a.length?a[a.length-1]:-1)&&a.push(s.queries.length-1,o)}(d,s),2==(2&a)&&(d.staticContentQueries=!0)}!function Oc(s,o,a){const l=new Ah(4==(4&a));mE(s,o,l,l.destroy),null===o[19]&&(o[19]=new Re),o[19].queries.push(new le(l))}(d,De(),a)}function yw(){return function Vt(s,o){return s[19].queries[o].queryList}(De(),Ra())}function Ct(s,o){return s.queries.getByIndex(o)}function ww(s,o){return Do(s,o)}function Fc(...s){}const Aw=new Wt("Application Initializer");let Uc=(()=>{class s{constructor(a){this.appInits=a,this.resolve=Fc,this.reject=Fc,this.initialized=!1,this.done=!1,this.donePromise=new Promise((l,d)=>{this.resolve=l,this.reject=d})}runInitializers(){if(this.initialized)return;const a=[],l=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const g=this.appInits[d]();if(wm(g))a.push(g);else if(wD(g)){const v=new Promise((E,b)=>{g.subscribe({complete:E,error:b})});a.push(v)}}Promise.all(a).then(()=>{l()}).catch(d=>{this.reject(d)}),0===a.length&&l(),this.initialized=!0}}return s.\u0275fac=function(a){return new(a||s)(Z(Aw,8))},s.\u0275prov=Zt({token:s,factory:s.\u0275fac}),s})();const Rw=new Wt("AppId"),Ub={provide:Rw,useFactory:function fu(){return`${yl()}${yl()}${yl()}`},deps:[]};function yl(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Kp=new Wt("Platform Initializer"),Yp=new Wt("Platform ID"),Xm=new Wt("appBootstrapListener");let e_=(()=>{class s{log(a){console.log(a)}warn(a){console.warn(a)}}return s.\u0275fac=function(a){return new(a||s)},s.\u0275prov=Zt({token:s,factory:s.\u0275fac}),s})();const pu=new Wt("LocaleId"),ks=new Wt("DefaultCurrencyCode");class xw{constructor(o,a){this.ngModuleFactory=o,this.componentFactories=a}}let Bc=(()=>{class s{compileModuleSync(a){return new Ch(a)}compileModuleAsync(a){return Promise.resolve(this.compileModuleSync(a))}compileModuleAndAllComponentsSync(a){const l=this.compileModuleSync(a),g=bs(tr(a).declarations).reduce((v,E)=>{const b=er(E);return b&&v.push(new $m(b)),v},[]);return new xw(l,g)}compileModuleAndAllComponentsAsync(a){return Promise.resolve(this.compileModuleAndAllComponentsSync(a))}clearCache(){}clearCacheFor(a){}getModuleId(a){}}return s.\u0275fac=function(a){return new(a||s)},s.\u0275prov=Zt({token:s,factory:s.\u0275fac}),s})();const jb=(()=>Promise.resolve(0))();function n_(s){"undefined"==typeof Zone?jb.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class yi{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:a=!1,shouldCoalesceRunChangeDetection:l=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Co(!1),this.onMicrotaskEmpty=new Co(!1),this.onStable=new Co(!1),this.onError=new Co(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!l&&a,d.shouldCoalesceRunChangeDetection=l,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function $b(){let s=ft.requestAnimationFrame,o=ft.cancelAnimationFrame;if("undefined"!=typeof Zone&&s&&o){const a=s[Zone.__symbol__("OriginalDelegate")];a&&(s=a);const l=o[Zone.__symbol__("OriginalDelegate")];l&&(o=l)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Fh(s){const o=()=>{!function Hb(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(ft,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,gu(s),s.isCheckStableRunning=!0,Pw(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),gu(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(a,l,d,g,v,E)=>{try{return kw(s),a.invokeTask(d,g,v,E)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===g.type||s.shouldCoalesceRunChangeDetection)&&o(),vl(s)}},onInvoke:(a,l,d,g,v,E,b)=>{try{return kw(s),a.invoke(d,g,v,E,b)}finally{s.shouldCoalesceRunChangeDetection&&o(),vl(s)}},onHasTask:(a,l,d,g)=>{a.hasTask(d,g),l===d&&("microTask"==g.change?(s._hasPendingMicrotasks=g.microTask,gu(s),Pw(s)):"macroTask"==g.change&&(s.hasPendingMacrotasks=g.macroTask))},onHandleError:(a,l,d,g)=>(a.handleError(d,g),s.runOutsideAngular(()=>s.onError.emit(g)),!1)})}(d)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!yi.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(yi.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,a,l){return this._inner.run(o,a,l)}runTask(o,a,l,d){const g=this._inner,v=g.scheduleEventTask("NgZoneEvent: "+d,o,AS,Fc,Fc);try{return g.runTask(v,a,l)}finally{g.cancelTask(v)}}runGuarded(o,a,l){return this._inner.runGuarded(o,a,l)}runOutsideAngular(o){return this._outer.run(o)}}const AS={};function Pw(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function gu(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function kw(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function vl(s){s._nesting--,Pw(s)}class qb{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Co,this.onMicrotaskEmpty=new Co,this.onStable=new Co,this.onError=new Co}run(o,a,l){return o.apply(a,l)}runGuarded(o,a,l){return o.apply(a,l)}runOutsideAngular(o){return o()}runTask(o,a,l,d){return o.apply(a,l)}}let Vc=(()=>{class s{constructor(a){this._ngZone=a,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),a.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{yi.assertNotInAngularZone(),n_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())n_(()=>{for(;0!==this._callbacks.length;){let a=this._callbacks.pop();clearTimeout(a.timeoutId),a.doneCb(this._didWork)}this._didWork=!1});else{let a=this.getPendingTasks();this._callbacks=this._callbacks.filter(l=>!l.updateCb||!l.updateCb(a)||(clearTimeout(l.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(a=>({source:a.source,creationLocation:a.creationLocation,data:a.data})):[]}addCallback(a,l,d){let g=-1;l&&l>0&&(g=setTimeout(()=>{this._callbacks=this._callbacks.filter(v=>v.timeoutId!==g),a(this._didWork,this.getPendingTasks())},l)),this._callbacks.push({doneCb:a,timeoutId:g,updateCb:d})}whenStable(a,l,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(a,l,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(a,l,d){return[]}}return s.\u0275fac=function(a){return new(a||s)(Z(yi))},s.\u0275prov=Zt({token:s,factory:s.\u0275fac}),s})(),Mw=(()=>{class s{constructor(){this._applications=new Map,Nw.addToWindow(this)}registerApplication(a,l){this._applications.set(a,l)}unregisterApplication(a){this._applications.delete(a)}unregisterAllApplications(){this._applications.clear()}getTestability(a){return this._applications.get(a)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(a,l=!0){return Nw.findTestabilityInTree(this,a,l)}}return s.\u0275fac=function(a){return new(a||s)},s.\u0275prov=Zt({token:s,factory:s.\u0275fac}),s})();class Wb{addToWindow(o){}findTestabilityInTree(o,a,l){return null}}function Qp(s){Nw=s}let So,Nw=new Wb;const Gb=new Wt("AllowMultipleToken");class Lw{constructor(o,a){this.name=o,this.token=a}}function Fw(s,o,a=[]){const l=`Platform: ${o}`,d=new Wt(l);return(g=[])=>{let v=mu();if(!v||v.injector.get(Gb,!1))if(s)s(a.concat(g).concat({provide:d,useValue:!0}));else{const E=a.concat(g).concat({provide:d,useValue:!0},{provide:Uy,useValue:"platform"});!function RS(s){if(So&&!So.destroyed&&!So.injector.get(Gb,!1))throw new ke(400,"");So=s.get(Uw);const o=s.get(Kp,null);o&&o.forEach(a=>a())}(us.create({providers:E,name:l}))}return function Zb(s){const o=mu();if(!o)throw new ke(401,"");return o}()}}function mu(){return So&&!So.destroyed?So:null}let Uw=(()=>{class s{constructor(a){this._injector=a,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(a,l){const E=function zb(s,o){let a;return a="noop"===s?new qb:("zone.js"===s?void 0:s)||new yi({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==o?void 0:o.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==o?void 0:o.ngZoneRunCoalescing)}),a}(l?l.ngZone:void 0,{ngZoneEventCoalescing:l&&l.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:l&&l.ngZoneRunCoalescing||!1}),b=[{provide:yi,useValue:E}];return E.run(()=>{const R=us.create({providers:b,parent:this.injector,name:a.moduleType.name}),P=a.create(R),U=P.injector.get(gc,null);if(!U)throw new ke(402,"");return E.runOutsideAngular(()=>{const N=E.onError.subscribe({next:Y=>{U.handleError(Y)}});P.onDestroy(()=>{Bw(this._modules,P),N.unsubscribe()})}),function Kb(s,o,a){try{const l=a();return wm(l)?l.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):l}catch(l){throw o.runOutsideAngular(()=>s.handleError(l)),l}}(U,E,()=>{const N=P.injector.get(Uc);return N.runInitializers(),N.donePromise.then(()=>(function WD(s){ot(s,"Expected localeId to be defined"),"string"==typeof s&&(ZI=s.toLowerCase().replace(/_/g,"-"))}(P.injector.get(pu,fh)||fh),this._moduleDoBootstrap(P),P))})})}bootstrapModule(a,l=[]){const d=Uh({},l);return function Tr(s,o,a){const l=new Ch(a);return Promise.resolve(l)}(0,0,a).then(g=>this.bootstrapModuleFactory(g,d))}_moduleDoBootstrap(a){const l=a.injector.get(jc);if(a._bootstrapComponents.length>0)a._bootstrapComponents.forEach(d=>l.bootstrap(d));else{if(!a.instance.ngDoBootstrap)throw new ke(403,"");a.instance.ngDoBootstrap(l)}this._modules.push(a)}onDestroy(a){this._destroyListeners.push(a)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ke(404,"");this._modules.slice().forEach(a=>a.destroy()),this._destroyListeners.forEach(a=>a()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(a){return new(a||s)(Z(us))},s.\u0275prov=Zt({token:s,factory:s.\u0275fac}),s})();function Uh(s,o){return Array.isArray(o)?o.reduce(Uh,s):Object.assign(Object.assign({},s),o)}let jc=(()=>{class s{constructor(a,l,d,g,v){this._zone=a,this._injector=l,this._exceptionHandler=d,this._componentFactoryResolver=g,this._initStatus=v,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const E=new F.y(R=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{R.next(this._stable),R.complete()})}),b=new F.y(R=>{let P;this._zone.runOutsideAngular(()=>{P=this._zone.onStable.subscribe(()=>{yi.assertNotInAngularZone(),n_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,R.next(!0))})})});const U=this._zone.onUnstable.subscribe(()=>{yi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{R.next(!1)}))});return()=>{P.unsubscribe(),U.unsubscribe()}});this.isStable=(0,oe.T)(E,b.pipe((0,ie.B)()))}bootstrap(a,l){if(!this._initStatus.done)throw new ke(405,"");let d;d=a instanceof fb?a:this._componentFactoryResolver.resolveComponentFactory(a),this.componentTypes.push(d.componentType);const g=function r_(s){return s.isBoundToModule}(d)?void 0:this._injector.get(cs),E=d.create(us.NULL,[],l||d.selector,g),b=E.location.nativeElement,R=E.injector.get(Vc,null),P=R&&E.injector.get(Mw);return R&&P&&P.registerApplication(b,R),E.onDestroy(()=>{this.detachView(E.hostView),Bw(this.components,E),P&&P.unregisterApplication(b)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new ke(101,"");try{this._runningTick=!0;for(let a of this._views)a.detectChanges()}catch(a){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(a))}finally{this._runningTick=!1}}attachView(a){const l=a;this._views.push(l),l.attachToAppRef(this)}detachView(a){const l=a;Bw(this._views,l),l.detachFromAppRef()}_loadComponent(a){this.attachView(a.hostView),this.tick(),this.components.push(a),this._injector.get(Xm,[]).concat(this._bootstrapListeners).forEach(d=>d(a))}ngOnDestroy(){this._views.slice().forEach(a=>a.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return s.\u0275fac=function(a){return new(a||s)(Z(yi),Z(us),Z(gc),Z(Pc),Z(Uc))},s.\u0275prov=Zt({token:s,factory:s.\u0275fac}),s})();function Bw(s,o){const a=s.indexOf(o);a>-1&&s.splice(a,1)}let Vw=!0,jw=!1;function Or(){return jw=!0,Vw}function s_(){if(jw)throw new Error("Cannot enable prod mode after platform setup.");Vw=!1}let xS=(()=>{class s{}return s.__NG_ELEMENT_ID__=io,s})();function io(s){return function PS(s,o,a){if(Ln(s)&&!a){const l=$r(s.index,o);return new Up(l,l)}return 47&s.type?new Up(o[16],o):null}(rn(),De(),16==(16&s))}class Ao{constructor(){}supports(o){return gp(o)}create(o){return new tT(o)}}const Gw=(s,o)=>o;class tT{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||Gw}forEachItem(o){let a;for(a=this._itHead;null!==a;a=a._next)o(a)}forEachOperation(o){let a=this._itHead,l=this._removalsHead,d=0,g=null;for(;a||l;){const v=!l||a&&a.currentIndex<zw(l,d,g)?a:l,E=zw(v,d,g),b=v.currentIndex;if(v===l)d--,l=l._nextRemoved;else if(a=a._next,null==v.previousIndex)d++;else{g||(g=[]);const R=E-d,P=b-d;if(R!=P){for(let N=0;N<R;N++){const Y=N<g.length?g[N]:g[N]=0,ce=Y+N;P<=ce&&ce<R&&(g[N]=Y+1)}g[v.previousIndex]=P-R}}E!==b&&o(v,E,b)}}forEachPreviousItem(o){let a;for(a=this._previousItHead;null!==a;a=a._nextPrevious)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachMovedItem(o){let a;for(a=this._movesHead;null!==a;a=a._nextMoved)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}forEachIdentityChange(o){let a;for(a=this._identityChangesHead;null!==a;a=a._nextIdentityChange)o(a)}diff(o){if(null==o&&(o=[]),!gp(o))throw new ke(900,"");return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,g,v,a=this._itHead,l=!1;if(Array.isArray(o)){this.length=o.length;for(let E=0;E<this.length;E++)g=o[E],v=this._trackByFn(E,g),null!==a&&Object.is(a.trackById,v)?(l&&(a=this._verifyReinsertion(a,g,v,E)),Object.is(a.item,g)||this._addIdentityChange(a,g)):(a=this._mismatch(a,g,v,E),l=!0),a=a._next}else d=0,function Ky(s,o){if(Array.isArray(s))for(let a=0;a<s.length;a++)o(s[a]);else{const a=s[Jd()]();let l;for(;!(l=a.next()).done;)o(l.value)}}(o,E=>{v=this._trackByFn(d,E),null!==a&&Object.is(a.trackById,v)?(l&&(a=this._verifyReinsertion(a,E,v,d)),Object.is(a.item,E)||this._addIdentityChange(a,E)):(a=this._mismatch(a,E,v,d),l=!0),a=a._next,d++}),this.length=d;return this._truncate(a),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,a,l,d){let g;return null===o?g=this._itTail:(g=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._reinsertAfter(o,g,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(l,d))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._moveAfter(o,g,d)):o=this._addAfter(new tg(a,l),g,d),o}_verifyReinsertion(o,a,l,d){let g=null===this._unlinkedRecords?null:this._unlinkedRecords.get(l,null);return null!==g?o=this._reinsertAfter(g,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const a=o._next;this._addToRemovals(this._unlink(o)),o=a}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,a,l){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,g=o._nextRemoved;return null===d?this._removalsHead=g:d._nextRemoved=g,null===g?this._removalsTail=d:g._prevRemoved=d,this._insertAfter(o,a,l),this._addToMoves(o,l),o}_moveAfter(o,a,l){return this._unlink(o),this._insertAfter(o,a,l),this._addToMoves(o,l),o}_addAfter(o,a,l){return this._insertAfter(o,a,l),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,a,l){const d=null===a?this._itHead:a._next;return o._next=d,o._prev=a,null===d?this._itTail=o:d._prev=o,null===a?this._itHead=o:a._next=o,null===this._linkedRecords&&(this._linkedRecords=new Zw),this._linkedRecords.put(o),o.currentIndex=l,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const a=o._prev,l=o._next;return null===a?this._itHead=l:a._next=l,null===l?this._itTail=a:l._prev=a,o}_addToMoves(o,a){return o.previousIndex===a||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Zw),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,a){return o.item=a,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class tg{constructor(o,a){this.item=o,this.trackById=a,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class nT{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,a){let l;for(l=this._head;null!==l;l=l._nextDup)if((null===a||a<=l.currentIndex)&&Object.is(l.trackById,o))return l;return null}remove(o){const a=o._prevDup,l=o._nextDup;return null===a?this._head=l:a._nextDup=l,null===l?this._tail=a:l._prevDup=a,null===this._head}}class Zw{constructor(){this.map=new Map}put(o){const a=o.trackById;let l=this.map.get(a);l||(l=new nT,this.map.set(a,l)),l.add(o)}get(o,a){const d=this.map.get(o);return d?d.get(o,a):null}remove(o){const a=o.trackById;return this.map.get(a).remove(o)&&this.map.delete(a),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function zw(s,o,a){const l=s.previousIndex;if(null===l)return l;let d=0;return a&&l<a.length&&(d=a[l]),l+o+d}class rT{constructor(){}supports(o){return o instanceof Map||mp(o)}create(){return new LS}}class LS{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let a;for(a=this._mapHead;null!==a;a=a._next)o(a)}forEachPreviousItem(o){let a;for(a=this._previousMapHead;null!==a;a=a._nextPrevious)o(a)}forEachChangedItem(o){let a;for(a=this._changesHead;null!==a;a=a._nextChanged)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}diff(o){if(o){if(!(o instanceof Map||mp(o)))throw new ke(900,"")}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let a=this._mapHead;if(this._appendAfter=null,this._forEach(o,(l,d)=>{if(a&&a.key===d)this._maybeAddToChanges(a,l),this._appendAfter=a,a=a._next;else{const g=this._getOrCreateRecordForKey(d,l);a=this._insertBeforeOrAppend(a,g)}}),a){a._prev&&(a._prev._next=null),this._removalsHead=a;for(let l=a;null!==l;l=l._nextRemoved)l===this._mapHead&&(this._mapHead=null),this._records.delete(l.key),l._nextRemoved=l._next,l.previousValue=l.currentValue,l.currentValue=null,l._prev=null,l._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,a){if(o){const l=o._prev;return a._next=o,a._prev=l,o._prev=a,l&&(l._next=a),o===this._mapHead&&(this._mapHead=a),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=a,a._prev=this._appendAfter):this._mapHead=a,this._appendAfter=a,null}_getOrCreateRecordForKey(o,a){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,a);const g=d._prev,v=d._next;return g&&(g._next=v),v&&(v._prev=g),d._next=null,d._prev=null,d}const l=new c_(o);return this._records.set(o,l),l.currentValue=a,this._addToAdditions(l),l}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,a){Object.is(a,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=a,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,a){o instanceof Map?o.forEach(a):Object.keys(o).forEach(l=>a(o[l],l))}}class c_{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Kw(){return new d_([new Ao])}let d_=(()=>{class s{constructor(a){this.factories=a}static create(a,l){if(null!=l){const d=l.factories.slice();a=a.concat(d)}return new s(a)}static extend(a){return{provide:s,useFactory:l=>s.create(a,l||Kw()),deps:[[s,new ji,new on]]}}find(a){const l=this.factories.find(d=>d.supports(a));if(null!=l)return l;throw new ke(901,"")}}return s.\u0275prov=Zt({token:s,providedIn:"root",factory:Kw}),s})();function Yw(){return new ng([new rT])}let ng=(()=>{class s{constructor(a){this.factories=a}static create(a,l){if(l){const d=l.factories.slice();a=a.concat(d)}return new s(a)}static extend(a){return{provide:s,useFactory:l=>s.create(a,l||Yw()),deps:[[s,new ji,new on]]}}find(a){const l=this.factories.find(g=>g.supports(a));if(l)return l;throw new ke(901,"")}}return s.\u0275prov=Zt({token:s,providedIn:"root",factory:Yw}),s})();const US=[new rT],sT=new d_([new Ao]),oT=new ng(US),BS=Fw(null,"core",[{provide:Yp,useValue:"unknown"},{provide:Uw,deps:[us]},{provide:Mw,deps:[]},{provide:e_,deps:[]}]),$S=[{provide:jc,useClass:jc,deps:[yi,us,gc,Pc,Uc]},{provide:uS,deps:[yi],useFactory:function aT(s){let o=[];return s.onStable.subscribe(()=>{for(;o.length;)o.pop()()}),function(a){o.push(a)}}},{provide:Uc,useClass:Uc,deps:[[new on,Aw]]},{provide:Bc,useClass:Bc,deps:[]},Ub,{provide:d_,useFactory:function Bh(){return sT},deps:[]},{provide:ng,useFactory:function Vh(){return oT},deps:[]},{provide:pu,useFactory:function VS(s){return s||function jS(){return"undefined"!=typeof $localize&&$localize.locale||fh}()},deps:[[new Yn(pu),new on,new ji]]},{provide:ks,useValue:"USD"}];let Ro=(()=>{class s{constructor(a){}}return s.\u0275fac=function(a){return new(a||s)(Z(jc))},s.\u0275mod=Us({type:s}),s.\u0275inj=Ki({providers:$S}),s})()},3942:(rt,Ee,L)=>{"use strict";L.d(Ee,{Z:()=>ke});var m=L(2090),J=L(4859),F=L(9681),oe=L(1877);class ie{constructor(K,re){this._delegate=K,this.firebase=re,(0,F._addComponent)(K,new J.wA("app-compat",()=>this,"PUBLIC")),this.container=K.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(K){this._delegate.automaticDataCollectionEnabled=K}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(K=>{this._delegate.checkDestroyed(),K()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,F.deleteApp)(this._delegate)))}_getService(K,re=F._DEFAULT_ENTRY_NAME){var ge;this._delegate.checkDestroyed();const be=this._delegate.container.getProvider(K);return!be.isInitialized()&&"EXPLICIT"===(null===(ge=be.getComponent())||void 0===ge?void 0:ge.instantiationMode)&&be.initialize(),be.getImmediate({identifier:re})}_removeServiceInstance(K,re=F._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(K).clearInstance(re)}_addComponent(K){(0,F._addComponent)(this._delegate,K)}_addOrOverwriteComponent(K){(0,F._addOrOverwriteComponent)(this._delegate,K)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const se=new m.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),H=function ue(){const Fe=function ae(Fe){const K={},re={__esModule:!0,initializeApp:function me(Ge,ht={}){const X=F.initializeApp(Ge,ht);if((0,m.r3)(K,X.name))return K[X.name];const pe=new Fe(X,re);return K[X.name]=pe,pe},app:be,registerVersion:F.registerVersion,setLogLevel:F.setLogLevel,onLog:F.onLog,apps:null,SDK_VERSION:F.SDK_VERSION,INTERNAL:{registerComponent:function Te(Ge){const ht=Ge.name,X=ht.replace("-compat","");if(F._registerComponent(Ge)&&"PUBLIC"===Ge.type){const pe=(_e=be())=>{if("function"!=typeof _e[X])throw se.create("invalid-app-argument",{appName:ht});return _e[X]()};void 0!==Ge.serviceProps&&(0,m.ZB)(pe,Ge.serviceProps),re[X]=pe,Fe.prototype[X]=function(..._e){return this._getService.bind(this,ht).apply(this,Ge.multipleInstances?_e:[])}}return"PUBLIC"===Ge.type?re[X]:null},removeApp:function ge(Ge){delete K[Ge]},useAsService:function Je(Ge,ht){return"serverAuth"===ht?null:ht},modularAPIs:F}};function be(Ge){if(!(0,m.r3)(K,Ge=Ge||F._DEFAULT_ENTRY_NAME))throw se.create("no-app",{appName:Ge});return K[Ge]}return re.default=re,Object.defineProperty(re,"apps",{get:function Ve(){return Object.keys(K).map(Ge=>K[Ge])}}),be.App=Fe,re}(ie);return Fe.INTERNAL=Object.assign(Object.assign({},Fe.INTERNAL),{createFirebaseNamespace:ue,extendNamespace:function K(re){(0,m.ZB)(Fe,re)},createSubscribe:m.ne,ErrorFactory:m.LL,deepExtend:m.ZB}),Fe}(),q=new oe.Yd("@firebase/app-compat");if((0,m.jU)()&&void 0!==self.firebase){q.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Fe=self.firebase.SDK_VERSION;Fe&&Fe.indexOf("LITE")>=0&&q.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const ke=H;!function Ie(Fe){(0,F.registerVersion)("@firebase/app-compat","0.1.15",Fe)}()},9681:(rt,Ee,L)=>{"use strict";L.r(Ee),L.d(Ee,{FirebaseError:()=>oe.ZR,SDK_VERSION:()=>lo,_DEFAULT_ENTRY_NAME:()=>jn,_addComponent:()=>en,_addOrOverwriteComponent:()=>Dr,_apps:()=>nt,_clearComponents:()=>Dn,_components:()=>Lr,_getProvider:()=>Ti,_registerComponent:()=>Zt,_removeServiceInstance:()=>Ki,deleteApp:()=>pr,getApp:()=>fs,getApps:()=>Ae,initializeApp:()=>Kr,onLog:()=>Ht,registerVersion:()=>hi,setLogLevel:()=>$n});var m=L(5861),J=L(4859),F=L(1877),oe=L(2090);class ie{constructor(tt){this.container=tt}getPlatformInfoString(){return this.container.getProviders().map(St=>{if(function he(dt){const tt=dt.getComponent();return"VERSION"===(null==tt?void 0:tt.type)}(St)){const ln=St.getImmediate();return`${ln.library}/${ln.version}`}return null}).filter(St=>St).join(" ")}}const se="@firebase/app",ue=new F.Yd("@firebase/app"),jn="[DEFAULT]",ot={[se]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},nt=new Map,Lr=new Map;function en(dt,tt){try{dt.container.addComponent(tt)}catch(St){ue.debug(`Component ${tt.name} failed to register with FirebaseApp ${dt.name}`,St)}}function Dr(dt,tt){dt.container.addOrOverwriteComponent(tt)}function Zt(dt){const tt=dt.name;if(Lr.has(tt))return ue.debug(`There were multiple attempts to register component ${tt}.`),!1;Lr.set(tt,dt);for(const St of nt.values())en(St,dt);return!0}function Ti(dt,tt){return dt.container.getProvider(tt)}function Ki(dt,tt,St=jn){Ti(dt,tt).clearInstance(St)}function Dn(){Lr.clear()}const Ut=new oe.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class gn{constructor(tt,St,ln){this._isDeleted=!1,this._options=Object.assign({},tt),this._config=Object.assign({},St),this._name=St.name,this._automaticDataCollectionEnabled=St.automaticDataCollectionEnabled,this._container=ln,this.container.addComponent(new J.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(tt){this.checkDestroyed(),this._automaticDataCollectionEnabled=tt}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(tt){this._isDeleted=tt}checkDestroyed(){if(this.isDeleted)throw Ut.create("app-deleted",{appName:this._name})}}const lo="9.6.4";function Kr(dt,tt={}){"object"!=typeof tt&&(tt={name:tt});const St=Object.assign({name:jn,automaticDataCollectionEnabled:!1},tt),ln=St.name;if("string"!=typeof ln||!ln)throw Ut.create("bad-app-name",{appName:String(ln)});const Fr=nt.get(ln);if(Fr){if((0,oe.vZ)(dt,Fr.options)&&(0,oe.vZ)(St,Fr.config))return Fr;throw Ut.create("duplicate-app",{appName:ln})}const At=new J.H0(ln);for(const ut of Lr.values())At.addComponent(ut);const et=new gn(dt,St,At);return nt.set(ln,et),et}function fs(dt=jn){const tt=nt.get(dt);if(!tt)throw Ut.create("no-app",{appName:dt});return tt}function Ae(){return Array.from(nt.values())}function pr(dt){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,m.Z)(function*(dt){const tt=dt.name;nt.has(tt)&&(nt.delete(tt),yield Promise.all(dt.container.getProviders().map(St=>St.delete())),dt.isDeleted=!0)})).apply(this,arguments)}function hi(dt,tt,St){var ln;let Fr=null!==(ln=ot[dt])&&void 0!==ln?ln:dt;St&&(Fr+=`-${St}`);const At=Fr.match(/\s|\//),et=tt.match(/\s|\//);if(At||et){const ut=[`Unable to register library "${Fr}" with version "${tt}":`];return At&&ut.push(`library name "${Fr}" contains illegal characters (whitespace or "/")`),At&&et&&ut.push("and"),et&&ut.push(`version name "${tt}" contains illegal characters (whitespace or "/")`),void ue.warn(ut.join(" "))}Zt(new J.wA(`${Fr}-version`,()=>({library:Fr,version:tt}),"VERSION"))}function Ht(dt,tt){if(null!==dt&&"function"!=typeof dt)throw Ut.create("invalid-log-argument");(0,F.Am)(dt,tt)}function $n(dt){(0,F.Ub)(dt)}!function Fs(dt){Zt(new J.wA("platform-logger",tt=>new ie(tt),"PRIVATE")),hi(se,"0.7.14",dt),hi(se,"0.7.14","esm2017"),hi("fire-js","")}("")},4859:(rt,Ee,L)=>{"use strict";L.d(Ee,{wA:()=>F,H0:()=>ae,zt:()=>ie});var m=L(5861),J=L(2090);class F{constructor(H,q,ee){this.name=H,this.instanceFactory=q,this.type=ee,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(H){return this.instantiationMode=H,this}setMultipleInstances(H){return this.multipleInstances=H,this}setServiceProps(H){return this.serviceProps=H,this}setInstanceCreatedCallback(H){return this.onInstanceCreated=H,this}}const oe="[DEFAULT]";class ie{constructor(H,q){this.name=H,this.container=q,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(H){const q=this.normalizeInstanceIdentifier(H);if(!this.instancesDeferred.has(q)){const ee=new J.BH;if(this.instancesDeferred.set(q,ee),this.isInitialized(q)||this.shouldAutoInitialize())try{const Be=this.getOrInitializeService({instanceIdentifier:q});Be&&ee.resolve(Be)}catch(Be){}}return this.instancesDeferred.get(q).promise}getImmediate(H){var q;const ee=this.normalizeInstanceIdentifier(null==H?void 0:H.identifier),Be=null!==(q=null==H?void 0:H.optional)&&void 0!==q&&q;if(!this.isInitialized(ee)&&!this.shouldAutoInitialize()){if(Be)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:ee})}catch(Ie){if(Be)return null;throw Ie}}getComponent(){return this.component}setComponent(H){if(H.name!==this.name)throw Error(`Mismatching Component ${H.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=H,this.shouldAutoInitialize()){if(function se(ue){return"EAGER"===ue.instantiationMode}(H))try{this.getOrInitializeService({instanceIdentifier:oe})}catch(q){}for(const[q,ee]of this.instancesDeferred.entries()){const Be=this.normalizeInstanceIdentifier(q);try{const Ie=this.getOrInitializeService({instanceIdentifier:Be});ee.resolve(Ie)}catch(Ie){}}}}clearInstance(H=oe){this.instancesDeferred.delete(H),this.instancesOptions.delete(H),this.instances.delete(H)}delete(){var H=this;return(0,m.Z)(function*(){const q=Array.from(H.instances.values());yield Promise.all([...q.filter(ee=>"INTERNAL"in ee).map(ee=>ee.INTERNAL.delete()),...q.filter(ee=>"_delete"in ee).map(ee=>ee._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(H=oe){return this.instances.has(H)}getOptions(H=oe){return this.instancesOptions.get(H)||{}}initialize(H={}){const{options:q={}}=H,ee=this.normalizeInstanceIdentifier(H.instanceIdentifier);if(this.isInitialized(ee))throw Error(`${this.name}(${ee}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Be=this.getOrInitializeService({instanceIdentifier:ee,options:q});for(const[Ie,ke]of this.instancesDeferred.entries())ee===this.normalizeInstanceIdentifier(Ie)&&ke.resolve(Be);return Be}onInit(H,q){var ee;const Be=this.normalizeInstanceIdentifier(q),Ie=null!==(ee=this.onInitCallbacks.get(Be))&&void 0!==ee?ee:new Set;Ie.add(H),this.onInitCallbacks.set(Be,Ie);const ke=this.instances.get(Be);return ke&&H(ke,Be),()=>{Ie.delete(H)}}invokeOnInitCallbacks(H,q){const ee=this.onInitCallbacks.get(q);if(ee)for(const Be of ee)try{Be(H,q)}catch(Ie){}}getOrInitializeService({instanceIdentifier:H,options:q={}}){let ee=this.instances.get(H);if(!ee&&this.component&&(ee=this.component.instanceFactory(this.container,{instanceIdentifier:(ue=H,ue===oe?void 0:ue),options:q}),this.instances.set(H,ee),this.instancesOptions.set(H,q),this.invokeOnInitCallbacks(ee,H),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,H,ee)}catch(Be){}var ue;return ee||null}normalizeInstanceIdentifier(H=oe){return this.component?this.component.multipleInstances?H:oe:H}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ae{constructor(H){this.name=H,this.providers=new Map}addComponent(H){const q=this.getProvider(H.name);if(q.isComponentSet())throw new Error(`Component ${H.name} has already been registered with ${this.name}`);q.setComponent(H)}addOrOverwriteComponent(H){this.getProvider(H.name).isComponentSet()&&this.providers.delete(H.name),this.addComponent(H)}getProvider(H){if(this.providers.has(H))return this.providers.get(H);const q=new ie(H,this);return this.providers.set(H,q),q}getProviders(){return Array.from(this.providers.values())}}},1877:(rt,Ee,L)=>{"use strict";L.d(Ee,{in:()=>J,Yd:()=>se,Ub:()=>ae,Am:()=>ue});const m=[];var J=(()=>{return(H=J||(J={}))[H.DEBUG=0]="DEBUG",H[H.VERBOSE=1]="VERBOSE",H[H.INFO=2]="INFO",H[H.WARN=3]="WARN",H[H.ERROR=4]="ERROR",H[H.SILENT=5]="SILENT",J;var H})();const F={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},oe=J.INFO,ie={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},he=(H,q,...ee)=>{if(q<H.logLevel)return;const Be=(new Date).toISOString(),Ie=ie[q];if(!Ie)throw new Error(`Attempted to log a message with an invalid logType (value: ${q})`);console[Ie](`[${Be}]  ${H.name}:`,...ee)};class se{constructor(q){this.name=q,this._logLevel=oe,this._logHandler=he,this._userLogHandler=null,m.push(this)}get logLevel(){return this._logLevel}set logLevel(q){if(!(q in J))throw new TypeError(`Invalid value "${q}" assigned to \`logLevel\``);this._logLevel=q}setLogLevel(q){this._logLevel="string"==typeof q?F[q]:q}get logHandler(){return this._logHandler}set logHandler(q){if("function"!=typeof q)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=q}get userLogHandler(){return this._userLogHandler}set userLogHandler(q){this._userLogHandler=q}debug(...q){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...q),this._logHandler(this,J.DEBUG,...q)}log(...q){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...q),this._logHandler(this,J.VERBOSE,...q)}info(...q){this._userLogHandler&&this._userLogHandler(this,J.INFO,...q),this._logHandler(this,J.INFO,...q)}warn(...q){this._userLogHandler&&this._userLogHandler(this,J.WARN,...q),this._logHandler(this,J.WARN,...q)}error(...q){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...q),this._logHandler(this,J.ERROR,...q)}}function ae(H){m.forEach(q=>{q.setLogLevel(H)})}function ue(H,q){for(const ee of m){let Be=null;q&&q.level&&(Be=F[q.level]),ee.userLogHandler=null===H?null:(Ie,ke,...Fe)=>{const K=Fe.map(re=>{if(null==re)return null;if("string"==typeof re)return re;if("number"==typeof re||"boolean"==typeof re)return re.toString();if(re instanceof Error)return re.message;try{return JSON.stringify(re)}catch(ge){return null}}).filter(re=>re).join(" ");ke>=(null!=Be?Be:Ie.logLevel)&&H({level:J[ke].toLowerCase(),message:K,args:Fe,type:Ie.name})}}}},5861:(rt,Ee,L)=>{"use strict";function m(F,oe,ie,he,se,ae,ue){try{var H=F[ae](ue),q=H.value}catch(ee){return void ie(ee)}H.done?oe(q):Promise.resolve(q).then(he,se)}function J(F){return function(){var oe=this,ie=arguments;return new Promise(function(he,se){var ae=F.apply(oe,ie);function ue(q){m(ae,he,se,ue,H,"next",q)}function H(q){m(ae,he,se,ue,H,"throw",q)}ue(void 0)})}}L.d(Ee,{Z:()=>J})}},rt=>{rt(rt.s=1406)}]);